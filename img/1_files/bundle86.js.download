/*! For license information please see main.bundle86.js.LICENSE.txt */
(()=>{var __webpack_modules__={2449:(e,t,n)=>{"use strict";n.d(t,{$M:()=>c,AF:()=>f,GR:()=>x,Mf:()=>k,Mk:()=>_,PW:()=>o,U9:()=>p,VA:()=>E,We:()=>d,ao:()=>a,dw:()=>g,fP:()=>m,hQ:()=>w,iP:()=>S,iY:()=>v,j4:()=>h,ju:()=>l,o$:()=>b,pT:()=>y,ul:()=>i,wi:()=>u,x7:()=>s,yF:()=>r});var r="MY_SELF",i="MESSAGE_RECEIVED",o="MESSAGE_SENT",s="SENDING_MESSAGE",a="UPDATING_MESSAGE",u="HISTORY_RECEIVED",c="GET_NEW_CONVERSATION",l="CLEAR_MESSAGES",d="AGENT_CONNECTION_STATUS",f="END_SESSION",p="SEND_PRECHAT_DATA",h="SHOW_PRECHAT_ALLOW",y="DISABLE_EDITING",v="SHOW_VIEW",m="UPDATE_USER_PREFERENCE",g="SHOW_LOADER_VIEW",b="CLIENT_START",_="MESSAGE_TYPING",w="TOGGLE_INPUT",k="READ_MESSAGE",x="SESSION_INFO",S="SENDING_ATTACHMENT",E="UPDATING_STORE_MESSAGE"},1822:(e,t,n)=>{"use strict";n.d(t,{BL:()=>c,Bc:()=>b,KH:()=>d,S0:()=>l,TM:()=>y,WX:()=>g,bG:()=>v,d:()=>_,gY:()=>f,jY:()=>h,lB:()=>w,o6:()=>m,rQ:()=>p});var r=n(6355),i=n.n(r),o=n(2449);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var c=function(){return{type:o.o$}},l=function(e){return{type:o.U9,payload:{body:e}}},d=function(e,t){return{type:o.$M,payload:{conversationId:e,paginationWindow:t}}};function f(e,t){return void 0===t&&(t=!0),{type:o.hQ,payload:{isVoiceInput:e,doesBrowserSupportsMedia:t}}}var p=function(e,t){return{type:o.dw,payload:{showLoaderView:e,error:t}}},h=function(){return{type:o.ju}},y=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return{type:o.AF,payload:{feedback:e,sessionEndedBy:t,endSessionArgs:n}}},v=function(e){return{type:o.x7,payload:{body:e}}},m=function(e,t){return{type:o.ao,payload:{body:e,messageIndex:t}}},g=function(e){return{type:o.iP,payload:{body:e}}},b=function(e){return{type:o.fP,payload:{isSoundNotificationOn:e}}},_=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};window.shopInSync.app_id&&(t=window.shopInSync.app_id),window.shopInSync.appId&&(t=window.shopInSync.appId);var o,s="Bearer "+t+":"+window.shopInSync.clientToken;window.shopInSync.brand_session_token&&(o=window.shopInSync.brand_session_token),window.shopInSync.brandSessionToken&&(o=window.shopInSync.brandSessionToken),o&&(s=o);var u={"Content-type":"application/json",Accept:"application/json",Authorization:s},c={market:window.shopInSync.market.toLowerCase(),channel_id:window.shopInSync.channel_id};c=a(a({},c),e);var l=r.method?r.method:"post",d="";"trackEvents"==n&&(d="/web_hooks/utility/track_events"),"endSession"==n&&(d="/web_hooks/insync/chatbot/twilio/handle_end_session"),"sendMessageToChannelServer"==n&&(d="/web_hooks/insync/chatbot/twilio/agent_message"),"redirection"==n&&(d="/v1/affiliate_redirects_new/redirect_action");var f=window.shopInSync.baseServerUrl+d;f=r.urlParams?f+r.urlParams:f,i()({method:l,url:f,data:c,headers:u}).then((function(e){})).catch((function(e){}))},w=function(e){return function(t){var n;t((n=e,{type:o.Mk,payload:{typedMessage:n}}))}}},6956:(e,t,n)=>{"use strict";n.d(t,{Z:()=>Tt});var r=n(3931),i=n(4808),o=n(6606),s=n(1822),a=n(8420),u=n.n(a),c=n(2631),l=n.n(c);function d(e){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t){return p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},p(e,t)}function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=m(e);if(t){var i=m(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return y(this,n)}}function y(e,t){if(t&&("object"===d(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return v(e)}function v(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m(e){return m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},m(e)}var g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}(s,e);var t,n,i,o=h(s);function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=o.call(this,e)).highlightColor="#000000",t.toggleWindowStyle=t.toggleWindowStyle.bind(v(t)),t.toggleChat=t.toggleChat.bind(v(t)),t.endChat=t.endChat.bind(v(t)),t}return t=s,(n=[{key:"toggleWindowStyle",value:function(e){this.props.toggleWindowStyle(e)}},{key:"toggleChat",value:function(){this.props.toggleChat()}},{key:"endChat",value:function(){void 0!==this.props.showView&&""!=this.props.showView.viewName?this.props.showModalView(this.props.showView.viewName):this.props.showModalView("endChatView")}},{key:"render",value:function(){var e=this;return"tall"==window.shopInSync.styleGuide.windowStyle?this.tallHighlightColor=l().HEADER_TITLE_COLOR:this.tallHighlightColor="transparent","wide"==window.shopInSync.styleGuide.windowStyle?this.wideHighlightColor=l().HEADER_TITLE_COLOR:this.wideHighlightColor="transparent","regular"==window.shopInSync.styleGuide.windowStyle?this.compactHighlightColor=l().HEADER_TITLE_COLOR:this.compactHighlightColor="transparent",u().it("\n\n      .insyncActiveIcon{\n        color: #fff;\n      }\n      .insyncRightIconSpacing{\n        margin-right:4px;\n      }\n      .insyncCompactIcon{\n        margin-top:2px;\n      }\n      .insyncWideIcon{\n        margin-top:2px;\n      }\n      .insyncTallIcon{\n        margin-top:2px;\n      }\n      .insyncShowWindowIcon{\n        display: inherit;\n      }\n      .insyncHideWindowIcon{\n        display: none;\n      }\n      ",(0,r.h)("span",null,(0,r.h)("svg",{onClick:function(){return e.props.toggleWindowStyle("wide")},className:"".concat(this.props.showToggleWindowIcons?"insyncWideIcon insyncRightIconSpacing insyncShowWindowIcon":"insyncHideWindowIcon"),xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,r.h)("g",{id:"Exclusion_1","data-name":"Exclusion 1",transform:"translate(-1371 5478)",fill:this.wideHighlightColor},(0,r.h)("path",{d:"M 1386 -5462.5 L 1371.9990234375 -5462.5 C 1371.7236328125 -5462.5 1371.49951171875 -5462.72412109375 1371.49951171875 -5462.99951171875 L 1371.49951171875 -5477.00048828125 C 1371.49951171875 -5477.27587890625 1371.7236328125 -5477.5 1371.9990234375 -5477.5 L 1386 -5477.5 C 1386.275390625 -5477.5 1386.499389648438 -5477.27587890625 1386.499389648438 -5477.00048828125 L 1386.499389648438 -5462.99951171875 C 1386.499389648438 -5462.72412109375 1386.275390625 -5462.5 1386 -5462.5 Z M 1374.814575195312 -5471.74951171875 C 1373.987060546875 -5471.74951171875 1373.313720703125 -5471.0771484375 1373.313720703125 -5470.25048828125 L 1373.313720703125 -5465.25 C 1373.313720703125 -5464.42333984375 1373.987060546875 -5463.75048828125 1374.814575195312 -5463.75048828125 L 1383.847045898438 -5463.75048828125 C 1384.673828125 -5463.75048828125 1385.346557617188 -5464.42333984375 1385.346557617188 -5465.25 L 1385.346557617188 -5470.25048828125 C 1385.346557617188 -5471.0771484375 1384.673828125 -5471.74951171875 1383.847045898438 -5471.74951171875 L 1374.814575195312 -5471.74951171875 Z",stroke:"white"}),(0,r.h)("path",{d:"M 1385.999389648438 -5463 L 1386 -5477 L 1371.99951171875 -5477.00048828125 L 1371.9990234375 -5463 L 1385.999389648438 -5463 M 1374.814575195312 -5472.24951171875 L 1383.847045898438 -5472.24951171875 C 1384.949584960938 -5472.24951171875 1385.846557617188 -5471.3525390625 1385.846557617188 -5470.25048828125 L 1385.846557617188 -5465.25 C 1385.846557617188 -5464.1474609375 1384.949584960938 -5463.25048828125 1383.847045898438 -5463.25048828125 L 1374.814575195312 -5463.25048828125 C 1373.711303710938 -5463.25048828125 1372.813720703125 -5464.1474609375 1372.813720703125 -5465.25 L 1372.813720703125 -5470.25048828125 C 1372.813720703125 -5471.3525390625 1373.711303710938 -5472.24951171875 1374.814575195312 -5472.24951171875 M 1386 -5462 L 1371.9990234375 -5462 C 1371.447875976562 -5462 1370.99951171875 -5462.4482421875 1370.99951171875 -5462.99951171875 L 1370.99951171875 -5477.00048828125 C 1370.99951171875 -5477.5517578125 1371.447875976562 -5478 1371.9990234375 -5478 L 1386 -5478 C 1386.551025390625 -5478 1386.999389648438 -5477.5517578125 1386.999389648438 -5477.00048828125 L 1386.999389648438 -5462.99951171875 C 1386.999389648438 -5462.4482421875 1386.551025390625 -5462 1386 -5462 Z M 1374.814575195312 -5471.24951171875 C 1374.2626953125 -5471.24951171875 1373.813720703125 -5470.80126953125 1373.813720703125 -5470.25048828125 L 1373.813720703125 -5465.25 C 1373.813720703125 -5464.69873046875 1374.2626953125 -5464.25048828125 1374.814575195312 -5464.25048828125 L 1383.847045898438 -5464.25048828125 C 1384.398193359375 -5464.25048828125 1384.846557617188 -5464.69873046875 1384.846557617188 -5465.25 L 1384.846557617188 -5470.25048828125 C 1384.846557617188 -5470.80126953125 1384.398193359375 -5471.24951171875 1383.847045898438 -5471.24951171875 L 1374.814575195312 -5471.24951171875 Z",stroke:"none",fill:this.wideHighlightColor}))),(0,r.h)("svg",{onClick:function(){return e.props.toggleWindowStyle("regular")},className:"".concat(this.props.showToggleWindowIcons?"insyncCompactIcon insyncRightIconSpacing insyncShowWindowIcon":"insyncHideWindowIcon"),xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,r.h)("g",{id:"Exclusion_2","data-name":"Exclusion 2",transform:"translate(-1371 5478)",fill:this.compactHighlightColor},(0,r.h)("path",{d:"M 1386 -5462.5 L 1371.9990234375 -5462.5 C 1371.7236328125 -5462.5 1371.49951171875 -5462.72412109375 1371.49951171875 -5462.99951171875 L 1371.49951171875 -5477.00048828125 C 1371.49951171875 -5477.27587890625 1371.7236328125 -5477.5 1371.9990234375 -5477.5 L 1386 -5477.5 C 1386.275390625 -5477.5 1386.499389648438 -5477.27587890625 1386.499389648438 -5477.00048828125 L 1386.499389648438 -5462.99951171875 C 1386.499389648438 -5462.72412109375 1386.275390625 -5462.5 1386 -5462.5 Z M 1381.142822265625 -5471.74951171875 C 1380.315307617188 -5471.74951171875 1379.641967773438 -5471.0771484375 1379.641967773438 -5470.25048828125 L 1379.641967773438 -5465.25 C 1379.641967773438 -5464.42333984375 1380.315307617188 -5463.75048828125 1381.142822265625 -5463.75048828125 L 1383.892456054688 -5463.75048828125 C 1384.71923828125 -5463.75048828125 1385.391845703125 -5464.42333984375 1385.391845703125 -5465.25 L 1385.391845703125 -5470.25048828125 C 1385.391845703125 -5471.0771484375 1384.71923828125 -5471.74951171875 1383.892456054688 -5471.74951171875 L 1381.142822265625 -5471.74951171875 Z",stroke:"white"}),(0,r.h)("path",{d:"M 1385.999389648438 -5463 L 1386 -5477 L 1371.99951171875 -5477.00048828125 L 1371.9990234375 -5463 L 1385.999389648438 -5463 M 1381.142822265625 -5472.24951171875 L 1383.892456054688 -5472.24951171875 C 1384.994873046875 -5472.24951171875 1385.891845703125 -5471.3525390625 1385.891845703125 -5470.25048828125 L 1385.891845703125 -5465.25 C 1385.891845703125 -5464.1474609375 1384.994873046875 -5463.25048828125 1383.892456054688 -5463.25048828125 L 1381.142822265625 -5463.25048828125 C 1380.03955078125 -5463.25048828125 1379.141967773438 -5464.1474609375 1379.141967773438 -5465.25 L 1379.141967773438 -5470.25048828125 C 1379.141967773438 -5471.3525390625 1380.03955078125 -5472.24951171875 1381.142822265625 -5472.24951171875 M 1386 -5462 L 1371.9990234375 -5462 C 1371.447875976562 -5462 1370.99951171875 -5462.4482421875 1370.99951171875 -5462.99951171875 L 1370.99951171875 -5477.00048828125 C 1370.99951171875 -5477.5517578125 1371.447875976562 -5478 1371.9990234375 -5478 L 1386 -5478 C 1386.551025390625 -5478 1386.999389648438 -5477.5517578125 1386.999389648438 -5477.00048828125 L 1386.999389648438 -5462.99951171875 C 1386.999389648438 -5462.4482421875 1386.551025390625 -5462 1386 -5462 Z M 1381.142822265625 -5471.24951171875 C 1380.590942382812 -5471.24951171875 1380.141967773438 -5470.80126953125 1380.141967773438 -5470.25048828125 L 1380.141967773438 -5465.25 C 1380.141967773438 -5464.69873046875 1380.590942382812 -5464.25048828125 1381.142822265625 -5464.25048828125 L 1383.892456054688 -5464.25048828125 C 1384.443481445312 -5464.25048828125 1384.891845703125 -5464.69873046875 1384.891845703125 -5465.25 L 1384.891845703125 -5470.25048828125 C 1384.891845703125 -5470.80126953125 1384.443481445312 -5471.24951171875 1383.892456054688 -5471.24951171875 L 1381.142822265625 -5471.24951171875 Z",stroke:"none",fill:this.compactHighlightColor}))),(0,r.h)("svg",{onClick:function(){return e.props.toggleWindowStyle("tall")},className:"".concat(this.props.showToggleWindowIcons?"insyncTallIcon insyncRightIconSpacing insyncShowWindowIcon":"insyncHideWindowIcon"),xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,r.h)("g",{id:"Exclusion_3","data-name":"Exclusion 3",transform:"translate(-1371 5478)",fill:this.tallHighlightColor},(0,r.h)("path",{d:"M 1386 -5462.5 L 1371.9990234375 -5462.5 C 1371.7236328125 -5462.5 1371.49951171875 -5462.72412109375 1371.49951171875 -5462.99951171875 L 1371.49951171875 -5477.00048828125 C 1371.49951171875 -5477.27587890625 1371.7236328125 -5477.5 1371.9990234375 -5477.5 L 1386 -5477.5 C 1386.275390625 -5477.5 1386.499389648438 -5477.27587890625 1386.499389648438 -5477.00048828125 L 1386.499389648438 -5462.99951171875 C 1386.499389648438 -5462.72412109375 1386.275390625 -5462.5 1386 -5462.5 Z M 1381.142822265625 -5476.37744140625 C 1380.315307617188 -5476.37744140625 1379.641967773438 -5475.70458984375 1379.641967773438 -5474.8779296875 L 1379.641967773438 -5464.9931640625 C 1379.641967773438 -5464.16552734375 1380.315307617188 -5463.4921875 1381.142822265625 -5463.4921875 L 1383.892456054688 -5463.4921875 C 1384.71923828125 -5463.4921875 1385.391845703125 -5464.16552734375 1385.391845703125 -5464.9931640625 L 1385.391845703125 -5474.8779296875 C 1385.391845703125 -5475.70458984375 1384.71923828125 -5476.37744140625 1383.892456054688 -5476.37744140625 L 1381.142822265625 -5476.37744140625 Z",stroke:"white"}),(0,r.h)("path",{d:"M 1385.999389648438 -5463 L 1386 -5477 L 1371.99951171875 -5477.00048828125 L 1371.9990234375 -5463 L 1380.965209960938 -5463 C 1379.94482421875 -5463.09033203125 1379.141967773438 -5463.94970703125 1379.141967773438 -5464.9931640625 L 1379.141967773438 -5474.8779296875 C 1379.141967773438 -5475.98046875 1380.03955078125 -5476.87744140625 1381.142822265625 -5476.87744140625 L 1383.892456054688 -5476.87744140625 C 1384.994873046875 -5476.87744140625 1385.891845703125 -5475.98046875 1385.891845703125 -5474.8779296875 L 1385.891845703125 -5464.9931640625 C 1385.891845703125 -5463.94970703125 1385.089477539062 -5463.09033203125 1384.069946289062 -5463 L 1385.999389648438 -5463 M 1386 -5462 L 1371.9990234375 -5462 C 1371.447875976562 -5462 1370.99951171875 -5462.4482421875 1370.99951171875 -5462.99951171875 L 1370.99951171875 -5477.00048828125 C 1370.99951171875 -5477.5517578125 1371.447875976562 -5478 1371.9990234375 -5478 L 1386 -5478 C 1386.551025390625 -5478 1386.999389648438 -5477.5517578125 1386.999389648438 -5477.00048828125 L 1386.999389648438 -5462.99951171875 C 1386.999389648438 -5462.4482421875 1386.551025390625 -5462 1386 -5462 Z M 1381.142822265625 -5475.87744140625 C 1380.590942382812 -5475.87744140625 1380.141967773438 -5475.42919921875 1380.141967773438 -5474.8779296875 L 1380.141967773438 -5464.9931640625 C 1380.141967773438 -5464.44140625 1380.590942382812 -5463.9921875 1381.142822265625 -5463.9921875 L 1383.892456054688 -5463.9921875 C 1384.443481445312 -5463.9921875 1384.891845703125 -5464.44140625 1384.891845703125 -5464.9931640625 L 1384.891845703125 -5474.8779296875 C 1384.891845703125 -5475.42919921875 1384.443481445312 -5475.87744140625 1383.892456054688 -5475.87744140625 L 1381.142822265625 -5475.87744140625 Z",stroke:"none",fill:this.tallHighlightColor}))),(0,r.h)("span",{onClick:function(){return e.props.toggleChat()}},(0,r.h)("svg",{className:"insyncCrossIcon",width:"16px",height:"16px",viewBox:"0 0 20 20",version:"1.1",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink"},(0,r.h)("title",null,"Close"),(0,r.h)("desc",null,"Created with Sketch."),(0,r.h)("defs",null),(0,r.h)("g",{id:"Chat-boxes",stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"},(0,r.h)("g",{id:"agent-not-available---chatbot",transform:"translate(-512.000000, -45.000000)",fill:"#FFFFFF"},(0,r.h)("g",{id:"Team-conversation",transform:"translate(54.000000, 18.000000)"},(0,r.h)("g",{id:"Header",transform:"translate(0.000000, 0.800009)"},(0,r.h)("g",{id:"Background"},(0,r.h)("path",{d:"M468,33.6158861 L475.175489,26.4403972 L477.559603,28.8245111 L470.384114,36 L477.559603,43.1754889 L475.175489,45.5596028 L468,38.3841139 L460.824511,45.5596028 L458.440397,43.1754889 L465.615886,36 L458.440397,28.8245111 L460.824511,26.4403972 L468,33.6158861 Z",id:"Close"}))))))),(0,r.h)("span",{className:"insyncMinimizeIcon"},(0,r.h)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"4",viewBox:"0 0 16 4"},(0,r.h)("line",{id:"Line_22","data-name":"Line 22",x2:"12",transform:"translate(2 2)",fill:"none",stroke:l().HEADER_TITLE_COLOR,"stroke-linecap":"round","stroke-width":"4px"})))),(0,r.h)("span",{onClick:function(){return e.endChat()}},(0,r.h)("svg",{className:"insyncEndChatIcon",width:"16",height:"16",viewBox:"0 0 16 16"},(0,r.h)("path",{id:"ic_clear_24px",d:"M21,6.611,19.389,5,13,11.389,6.611,5,5,6.611,11.389,13,5,19.389,6.611,21,13,14.611,19.389,21,21,19.389,14.611,13Z",transform:"translate(-5 -5)",fill:"#fff"})))))}}])&&f(t.prototype,n),i&&f(t,i),Object.defineProperty(t,"prototype",{writable:!1}),s}(r.wA);function b(e){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},b(e)}function _(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function w(e,t){return w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},w(e,t)}function k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S(e);if(t){var i=S(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return x(this,n)}}function x(e,t){if(t&&("object"===b(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function S(e){return S=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},S(e)}const E=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&w(e,t)}(s,e);var t,n,i,o=k(s);function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=o.call(this,e)).chatHeaderCrossIconClass="insyncCrossIcon",t.backgroundImage="linear-gradient(to right, ".concat(l().CHAT_HEADER_BACKGROUND_GRADIENT_LEFT_COLOR,", ").concat(l().CHAT_HEADER_BACKGROUND_GRADIENT_RIGHT_COLOR,")"),""!=l().CHAT_HEADER_BACKGROUND_IMAGE&&(t.backgroundImage="url(".concat(l().CHAT_HEADER_BACKGROUND_IMAGE,")"),t.chatHeaderCrossIconClass=""),l().END_CHAT_ENABLED?t.chatHeaderCrossIconClass="insyncEndChatIcon":"minimizeIcon"==l().CHAT_HEADER_CROSS_ICON&&(t.chatHeaderCrossIconClass="insyncMinimizeIcon"),t.showToggleWindowIcons=l().SHOW_TOGGLE_WINDOW_ICONS,t.insyncChatHeaderIconsWidth=20,t.showToggleWindowIcons&&(t.insyncChatHeaderIconsWidth=80),t.logoVerticalAlign=l().LOGO_IMG_VERTICAL_ALIGN,t.marginTop="13px","middle"==t.logoVerticalAlign&&(t.marginTop="unset"),t}return t=s,(n=[{key:"render",value:function(){return u().it("\n      .insyncChatHeader {\n        max-height:".concat(l().HEADER_HEIGHT,"px;\n        // width:330px;\n        background-image: ").concat(this.backgroundImage,";\n        //background-color:").concat(l().CHAT_HEADER_BACKGROUND_COLOR,";\n        color: ").concat(l().CHAT_BODY_TEXT_RIGHT_COLOR,";\n        \n        line-height: ").concat(l().HEADER_HEIGHT,'px;\n        //padding-left: 10px;\n        text-align: left;\n        position: relative;\n        z-index: 10;\n        //box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);\n        //border-bottom: "2px #ccc solid";\n        vertical-align: middle;\n        background-repeat: no-repeat;\n        background-size: cover;\n        box-shadow: ').concat(l().CHAT_HEADER_BOX_SHADOW,";\n        //box-shadow: ").concat("customDefault"==l().CARD_STYLE.styleName?"rgb(8 8 8 / 35%) 0px -11px 28px;":"initial","\n      }\n      .insyncHeaderLogo img {\n        //text-align: left;\n        //vertical-align: middle;\n        margin-right:8px;\n        height: ").concat(l().HEADER_LOGO_HEIGHT,";\n        //width: ").concat(l().HEADER_LOGO_WIDTH,";\n        margin-top: ").concat(this.marginTop,";\n        margin-left: 15px;\n        vertical-align: ").concat(this.logoVerticalAlign,";\n      }\n      .insyncChatHeaderIcons{\n        float:right;\n        margin-right:").concat(this.props.width<321?"0px":"15px",";\n        cursor:pointer;\n        color:").concat(l().CHAT_BODY_TEXT_RIGHT_COLOR,";\n        display: block;\n        width:").concat(this.insyncChatHeaderIconsWidth,"px;\n        max-height:").concat(l().HEADER_HEIGHT,"px;\n        position: relative;\n      }\n      .insyncCrossIcon{\n        display: ").concat("insyncCrossIcon"==this.chatHeaderCrossIconClass?"inline-block":"none",";\n      }\n      .insyncMinimizeIcon{\n        position: absolute;\n        margin-top: ").concat(l().HEADER_HEIGHT/2,"px;\n        display: ").concat("insyncMinimizeIcon"==this.chatHeaderCrossIconClass?"initial":"none",";\n      }\n      .insyncMinimizeIcon svg{\n        position: absolute;\n      }\n      .insyncEndChatIcon{\n        display: ").concat("insyncEndChatIcon"==this.chatHeaderCrossIconClass?"inline-block":"none",";\n      }\n      .insyncMinimizeIcon:after{\n        // color: ").concat(l().CHAT_BODY_TEXT_RIGHT_COLOR,';\n        // content: "—";\n        // font-weight: bold;\n        // font-size: 20px;\n        // vertical-align: 4%;\n      }\n      .insyncChatHeaderText{\n        font-weight: ').concat(l().HEADER_TITLE_FONT_WEIGHT,";\n        font-size: ").concat(l().HEADER_TITLE_FONT_SIZE,";\n        vertical-align: top;\n        color: ").concat(l().HEADER_TITLE_COLOR,";\n        letter-spacing: ").concat(l().HEADER_TITLE_LETTER_SPACING,";\n      }\n      "),(0,r.h)("div",null,"web"!=this.props.deviceType||this.props.isAgent?"":(0,r.h)("div",{className:"insyncChatHeader"},(0,r.h)("span",{className:"insyncHeaderLogo"},(0,r.h)("img",{src:l().CHAT_BODY_TEXT_HEADER_LOGO_ICON_URL})),(0,r.h)("span",{className:"insyncChatHeaderText"},l().CHAT_HEADER_TEXT),(0,r.h)("span",{className:"insyncChatHeaderIcons"},(0,r.h)(g,{toggleChat:this.props.toggleChat,showModalView:this.props.showModalView,toggleWindowStyle:this.props.toggleWindowStyle,showToggleWindowIcons:this.showToggleWindowIcons,showViewName:this.props.showViewName})))))}}])&&_(t.prototype,n),i&&_(t,i),Object.defineProperty(t,"prototype",{writable:!1}),s}(r.wA);function T(e){return T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},T(e)}function O(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function I(e,t){return I=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},I(e,t)}function C(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=P(e);if(t){var i=P(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return R(this,n)}}function R(e,t){if(t&&("object"===T(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return A(e)}function A(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function P(e){return P=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},P(e)}var N=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&I(e,t)}(a,e);var t,n,i,s=C(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=s.call(this,e)).handleKeyPress=t.handleKeyPress.bind(A(t)),t.onchange=t.onchange.bind(A(t)),t.sendMessage=t.sendMessage.bind(A(t)),t.toggelVoiceInput=t.toggelVoiceInput.bind(A(t)),t.onKeyboardDisappear=t.onKeyboardDisappear.bind(A(t)),t.state={inputVal:t.props.messageTyped},t.btnTextColor=l().BUTTON_TEXT_COLOR,t}return t=a,n=[{key:"onchange",value:function(e){var t=e.target.value;""!=t.replace(/^\s+|\s+$/g,"")&&(e.preventDefault(),this.props.typingMessage(e.target.value),this.setState({inputVal:t}))}},{key:"handleKeyPress",value:function(e){13===e.keyCode&&(e.preventDefault(),this.sendMessage(e.target.value))}},{key:"sendMessage",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";"string"!=typeof e&&(e=this.state.inputVal),""!=e.replace(/^\s+|\s+$/g,"")&&(this.props.sendMessage(e),(0,o.findDOMNode)(this.myTextArea).value="",this.setState({inputVal:""}))}},{key:"toggelVoiceInput",value:function(){this.props.toggledInput(!0,!0)}},{key:"onKeyboardDisappear",value:function(){document.getElementById("insyncChatbox").style.webkitTransform=document.getElementById("insyncChatbox").style.msTransform=document.getElementById("insyncChatbox").style.transform="scale(1,1)",this.props.onInputBlur()}},{key:"shouldComponentUpdate",value:function(e,t){return this.props.width!=e.width||this.props.disableEditing!=e.disableEditing}},{key:"componentDidMount",value:function(){this.myTextArea.focus()}},{key:"render",value:function(){var e,t=this;return e="v1"==window.shopInSync.styleGuide.user_new_send_icon?(0,r.h)("svg",{width:"22px",height:"22px",viewBox:"0 0 59.94 54.997",fill:this.props.disableEditing?"#919191":l().USER_SEND_ICON_COLOR},(0,r.h)("path",{id:"ic_send_24px",d:"M2.024,45.857S54.559,30.64,52,24.429,2.024,3,2.024,3L8.509,23.241s29.371.61,29.205,1.188S7.846,25.553,7.846,25.553Z",transform:"translate(-2.772 11.474) rotate(-16)"})):"v2"==window.shopInSync.styleGuide.user_new_send_icon?(0,r.h)("svg",{className:"insyncSendIcon",xmlns:"http://www.w3.org/2000/svg",width:"28.589",height:"28.591",viewBox:"0 0 28.589 28.591"},(0,r.h)("g",{id:"Arrow",transform:"translate(0 -0.028)"},(0,r.h)("path",{id:"Path",d:"M1.165,13.131A1.177,1.177,0,0,0,0,14.3,15.3,15.3,0,0,0,.192,16.6a14.021,14.021,0,0,0,1.333,4.119A14.267,14.267,0,0,0,15.835,28.5a14.921,14.921,0,0,0,2.291-.431,15.028,15.028,0,0,0,2.16-.8,14.152,14.152,0,0,0,3.549-2.332,14.245,14.245,0,0,0,4.713-11.683,14.062,14.062,0,0,0-.984-4.265,14.938,14.938,0,0,0-1-2.032,15.144,15.144,0,0,0-1.307-1.828A14.274,14.274,0,0,0,18.2.54a14.375,14.375,0,0,0-8.74.3,14.179,14.179,0,0,0-3.75,2.032,15.022,15.022,0,0,0-1.7,1.491A15.312,15.312,0,0,0,2.591,6.094,14.17,14.17,0,0,0,.684,9.92,14.315,14.315,0,0,0,0,14.3,1.187,1.187,0,0,0,1.165,15.46,1.177,1.177,0,0,0,2.329,14.3a13.49,13.49,0,0,1,.119-1.779c-.012.1-.026.207-.041.309A13.154,13.154,0,0,1,3.316,9.5c-.038.093-.079.186-.116.279A13.287,13.287,0,0,1,4.9,6.872l-.183.236A13.3,13.3,0,0,1,7.106,4.714L6.871,4.9A13.287,13.287,0,0,1,9.779,3.2L9.5,3.317a13.344,13.344,0,0,1,3.325-.908c-.1.012-.207.026-.309.041a13.477,13.477,0,0,1,3.558,0c-.1-.012-.207-.026-.309-.041a13.154,13.154,0,0,1,3.325.908L18.81,3.2a13.287,13.287,0,0,1,2.908,1.7l-.236-.183a13.3,13.3,0,0,1,2.393,2.393l-.183-.236a13.287,13.287,0,0,1,1.7,2.908c-.038-.093-.079-.186-.116-.279a13.344,13.344,0,0,1,.908,3.325c-.012-.1-.026-.207-.041-.309a13.477,13.477,0,0,1,0,3.558c.012-.1.026-.207.041-.309a13.154,13.154,0,0,1-.908,3.325c.038-.093.079-.186.116-.279a13.287,13.287,0,0,1-1.7,2.908l.183-.236a13.3,13.3,0,0,1-2.393,2.393l.236-.183a13.287,13.287,0,0,1-2.908,1.7l.279-.116a13.344,13.344,0,0,1-3.325.908c.1-.012.207-.026.309-.041a13.477,13.477,0,0,1-3.558,0c.1.012.207.026.309.041A13.154,13.154,0,0,1,9.5,25.274l.279.116a13.287,13.287,0,0,1-2.908-1.7l.236.183a13.3,13.3,0,0,1-2.393-2.393l.183.236a13.287,13.287,0,0,1-1.7-2.908c.038.093.079.186.116.279a13.344,13.344,0,0,1-.908-3.325c.012.1.026.207.041.309A13.49,13.49,0,0,1,2.329,14.3,1.185,1.185,0,0,0,1.165,13.131Z",transform:"translate(0 0.028)",fill:l().USER_SEND_ICON_COLOR}),(0,r.h)("path",{id:"Path-2","data-name":"Path",d:"M1.166,0A1.185,1.185,0,0,0,0,1.168,1.177,1.177,0,0,0,1.166,2.333h.02c.489.009.975,0,1.464,0H13.178a1.185,1.185,0,0,0,1.165-1.165A1.177,1.177,0,0,0,13.178,0h-.02c-.489-.009-.975,0-1.464,0H1.166Z",transform:"translate(7.068 13.243)",fill:l().USER_SEND_ICON_COLOR}),(0,r.h)("path",{id:"Path-3","data-name":"Path",d:"M.342,10.882A1.186,1.186,0,0,0,0,11.706a1.166,1.166,0,0,0,.341.824,1.2,1.2,0,0,0,.824.341,1.223,1.223,0,0,0,.824-.341l.693-.64L5.7,9.1q.948-.878,1.9-1.758a1.177,1.177,0,0,0,0-1.648c-.23-.218-.463-.44-.693-.661L3.893,2.154Q2.941,1.242,1.986.332a1.189,1.189,0,0,0-1.648,0,1.175,1.175,0,0,0,0,1.648c.23.218.463.44.693.661L4.045,5.52Q5,6.433,5.952,7.342V5.695l-.693.64L2.243,9.124Q1.3,10,.342,10.882Z",transform:"translate(13.577 7.895)",fill:l().USER_SEND_ICON_COLOR}))):(0,r.h)("svg",{width:"22px",height:"22px",viewBox:"0 0 22 22"},(0,r.h)("g",{stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"},(0,r.h)("g",{transform:"translate(-5.000000, -5.000000)",fill:this.props.disableEditing?"#919191":l().USER_SEND_ICON_COLOR},(0,r.h)("g",null,(0,r.h)("g",{transform:"translate(5.000000, 5.000000)"},(0,r.h)("path",{d:"M2.0300068,0.145970044 L20.9662955,9.37015518 C22.3445682,10.0420071 22.3445682,11.9582654 20.9662955,12.6296618 L2.0300068,21.853847 C1.09728834,22.3084288 0,21.6475087 0,20.6317597 L0.806953417,13.8945654 C0.882225434,13.2659853 1.39089595,12.7699536 2.03608467,12.6957083 L12.0229514,11.6795038 C12.8612292,11.5943266 12.8612292,10.4054904 12.0229514,10.3203132 L2.03608467,9.30410872 C1.39089595,9.23031889 0.882225434,8.7342872 0.806953417,8.10525162 L0,1.36805729 C0,0.352308292 1.09728834,-0.3081563 2.0300068,0.145970044"})))))),l().SEND_MESSAGE_ICON_URL.length>0&&(e=(0,r.h)("img",{className:"insyncSendIcon",src:l().SEND_MESSAGE_ICON_URL})),u().it("\n      .insyncMic{\n        cursor: pointer;\n        border-radius:20px;\n        padding:10px;\n        padding-right: 0px;\n        display: ".concat(this.props.isVoiceInput&&this.props.doesBrowserSupportsMedia?"initial":"none",";\n\n      }\n      input.insyncInputBox{\n        border-bottom-color:rgb(204, 204, 204) !important;\n        border-bottom-left-radius:5px !important;\n        border-bottom-right-radius:5px !important;\n        border-bottom-style:solid !important;\n        border-bottom-width:1px !important;\n        border-image-outset:0 !important;\n        border-image-repeat:stretch !important;\n        border-image-slice:100% !important;\n        border-image-source:none !important;\n        border-image-width:1 !important;\n        border-left-color:rgb(204, 204, 204) !important;\n        border-left-style:solid !important;\n        border-left-width:1px !important;\n        border-right-color:rgb(204, 204, 204) !important;\n        border-right-style:solid !important;\n        border-right-width:1px !important;\n        border-top-color:rgb(204, 204, 204) !important;\n        border-top-left-radius:5px !important;\n        border-top-right-radius:5px !important;\n        border-top-style:solid !important;\n        border-top-width:1px !important;\n        font-family: inherit !important;\n        -webkit-font-smoothing: inherit !important;\n        font-weight: inherit !important;\n        color: inherit !important;\n        display: inline-block;\n      }\n      input.insyncInputBoxBorder{\n        border: none !important;\n        border-radius: ").concat(l().SHOW_FOOTER_V3?"25px !important":"none",";\n      }\n      input:disabled {\n        background-color: #ffffff;\n      }\n      .insyncInputSendWrapper{\n        border: ").concat(l().SHOW_FOOTER_V3?"1px "+this.btnTextColor+" solid":"none",";\n        border-radius: 25px;\n        margin: ").concat(l().SHOW_FOOTER_V3?"0px "+l().CHAT_BODY_MARGIN_RIGHT+"px 0px "+l().CHAT_BODY_MARGIN_LEFT+"px":"none",";\n        min-height: ").concat(l().FOOTER_HEIGHT-4,"px;\n        display: flex;\n      }\n      "),(0,r.h)("div",{className:"insyncInputSendWrapper"},(0,r.h)("input",{className:"".concat(l().SHOW_FOOTER_V2||l().SHOW_FOOTER_V3?"insyncInputBox insyncInputBoxBorder":"insyncInputBox"),autoComplete:"off",ref:function(e){t.myTextArea=e},value:this.state.inputVal,onChange:this.onchange,onKeyDown:this.handleKeyPress,disabled:this.props.disableEditing,placeholder:this.props.disableEditing?this.props.disableEditingGhostText:l().GHOST_TEXT,name:"description",onBlur:this.onKeyboardDisappear}),(0,r.h)("div",{className:"".concat("v0"==l().USER_NEW_SEND_ICON||"v1"==l().USER_NEW_SEND_ICON?"insyncSendImg":"")},(0,r.h)("span",{onClick:this.sendMessage},e),(0,r.h)("span",{className:"insyncMic",onClick:this.toggelVoiceInput},(0,r.h)("svg",{version:"1.0",width:"22px",height:"22px",viewBox:"0 0 655.000000 1280.000000",preserveAspectRatio:"xMidYMid meet"},(0,r.h)("g",{transform:"translate(0.000000,1280.000000) scale(0.100000,-0.100000)",fill:l().USER_SEND_ICON_COLOR,stroke:"none"},(0,r.h)("path",{d:"M3080 12714 c-443 -55 -837 -253 -1146 -577 -302 -316 -494 -735 -544 -1182 -8 -71 -10 -875 -8 -2805 l3 -2705 22 -110 c120 -597 439 -1072 918 -1365 711 -437 1643 -325 2243 269 300 296 481 640 575 1096 21 100 21 111 24 2825 3 2433 2 2737 -12 2840 -118 859 -727 1528 -1540 1690 -86 18 -153 23 -305 25 -107 2 -211 1 -230 -1z"}),(0,r.h)("path",{d:"M112 6962 c-29 -19 -32 -90 -32 -712 0 -860 13 -1067 84 -1377 216 -936 872 -1729 1765 -2133 235 -106 564 -207 789 -242 l82 -12 0 -518 0 -518 -790 0 -790 0 0 -690 0 -690 2055 0 2055 0 0 690 0 690 -790 0 -790 0 0 518 0 518 83 12 c45 7 146 28 223 47 1162 284 2067 1188 2330 2328 71 310 84 517 84 1377 0 622 -3 693 -32 712 -7 4 -223 8 -480 8 l-468 0 -14 -22 c-13 -20 -15 -140 -19 -808 -4 -849 -4 -851 -62 -1081 -183 -720 -756 -1302 -1490 -1512 -468 -134 -991 -113 -1435 58 -659 254 -1148 795 -1315 1454 -58 230 -58 232 -62 1081 -4 668 -6 788 -19 808 l-14 22 -468 0 c-257 0 -473 -4 -480 -8z"})))))))}}],n&&O(t.prototype,n),i&&O(t,i),Object.defineProperty(t,"prototype",{writable:!1}),a}(r.wA);const L=(0,i.$j)((function(e,t){return{messageTyped:e.conversation.messageTyped,disableEditing:e.conversation.disableEditing,disableEditingGhostText:e.conversation.disableEditingGhostText,doesBrowserSupportsMedia:e.conversation.doesBrowserSupportsMedia,isVoiceInput:e.conversation.isVoiceInput}}),(function(e){return{dispatch:e,typingMessage:s.lB,toggledInput:function(t){return e((0,s.gY)(t))}}}))(N);function M(e){return M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},M(e)}function j(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function D(e,t){return D=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},D(e,t)}function B(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=H(e);if(t){var i=H(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return U(this,n)}}function U(e,t){if(t&&("object"===M(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return F(e)}function F(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function H(e){return H=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},H(e)}var G=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&D(e,t)}(a,e);var t,n,i,s=B(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=s.call(this,e)).handleClick=t.handleClick.bind(F(t)),t.toggleMenu=t.toggleMenu.bind(F(t)),t.openUploadAttchment=t.openUploadAttchment.bind(F(t)),t.toggleSoundOption=t.toggleSoundOption.bind(F(t)),t.endChat=t.endChat.bind(F(t)),t.getEndElement=t.getEndElement.bind(F(t)),t.state={showMenu:!1,isSoundNotificationOn:t.props.isSoundNotificationOn},t.enabledIconColor="#848181",t.disabledIconColor="#919191",t}return t=a,(n=[{key:"getEndElement",value:function(e){this.node=(0,o.findDOMNode)(e)}},{key:"toggleMenu",value:function(){this.props.disableEditing||this.setState({showMenu:!0})}},{key:"toggleSoundOption",value:function(){this.setState({isSoundNotificationOn:!this.state.isSoundNotificationOn}),this.props.updateUserPreference(this.state.isSoundNotificationOn)}},{key:"endChat",value:function(){this.setState({showMenu:!1}),this.props.showModalView("endChatView")}},{key:"openUploadAttchment",value:function(e){this.setState({showMenu:!1}),e&&this.props.showModalView("uploadAttachmentView")}},{key:"componentDidMount",value:function(){document.addEventListener("mouseover",this.handleClick)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mouseover",this.handleClick)}},{key:"handleClick",value:function(e){this.props.disableEditing||(this.node&&this.node.contains(e.target)?this.setState({showMenu:!0}):this.setState({showMenu:!1}))}},{key:"render",value:function(){var e=this,t=!1;return c.FILE_ATTACHMENT_ENABLED&&"connected"==this.props.agentConnectionStatus&&(t=!0),u().it("\n      .insyncMenu {\n        border: ".concat(c.CARD_BORDER,";\n        display: ").concat(this.state.showMenu?"block":"none",";\n        position: absolute;\n        bottom: ").concat(c.SHOW_FOOTER_V2?"43px":"41px",";\n        left: ").concat(c.CHAT_BODY_MARGIN_LEFT,"px;\n        background-color: ").concat(c.CHAT_BODY_BACKGORUND_COLOR,";\n        width: 200px;\n        z-index: 1000;\n        //display: block;\n      }\n      .insyncMenuItem{\n        padding: 10px 20px;\n        display: flex;\n        align-items: center;\n        cursor: pointer;\n        background-color: ").concat(c.CHAT_BODY_TEXT_RIGHT_COLOR,";\n        color: ").concat(this.enabledIconColor,";\n      }\n      \n      .insyncMenuItem:hover{\n        background-color: ").concat(c.CHAT_BODY_TEXT_RIGHT_BACKGORUND_COLOR,";\n        color: ").concat(c.CHAT_BODY_TEXT_RIGHT_COLOR,";\n        cursor: 'pointer';\n      }\n      .insyncMenuSoundSwitch{\n        padding-left: 10px;\n      }\n      .insyncMenuSoundOption:hover svg path{\n        fill: ").concat(c.CHAT_BODY_TEXT_RIGHT_COLOR,";\n      }\n      .insyncMenuItemName{\n        padding-left:10px;\n      }\n      .insyncMenuSettingIcon{\n        cursor: pointer;\n        width: ").concat(c.SETTINGS_ICON_WIDTH,"px;\n        margin: 0 auto;\n        box-sizing: initial !important;\n        outline: none!important;\n        padding-top: 22px;\n        padding-bottom: 10px;\n        padding-left: 8px;\n      }\n      \n      .insyncMenuSoundOption{\n        display: ").concat(c.SOUND_FEATURE_ENABLED?"flex":"none",";\n      }\n      \n      .insyncMenuEndChatOption{\n        color: ").concat(this.enabledIconColor,";\n        display: ").concat(c.END_CHAT_ENABLED?"flex":"none",";\n      }\n\n      .insyncMenuEndChatOption:hover svg path{\n        fill: ").concat(c.CHAT_BODY_TEXT_RIGHT_COLOR,";\n      }\n      .insyncMenuUploadOption{\n        color: ").concat(t?this.enabledIconColor:this.disabledIconColor,";\n        cursor: ").concat(t?"pointer":"initial",";\n        display: ").concat(c.FILE_ATTACHMENT_ENABLED?"flex":"none",";\n      }\n      .insyncMenuUploadOption:hover{\n        background-color: ").concat(t?c.CHAT_BODY_TEXT_RIGHT_BACKGORUND_COLOR:c.CHAT_BODY_TEXT_RIGHT_COLOR,";\n        color: ").concat(t?c.CHAT_BODY_TEXT_RIGHT_COLOR:this.disabledIconColor,";\n        cursor: ").concat(t?"pointer":"initial",";\n      }\n      .insyncMenuUploadOption svg path{\n        fill: ").concat(t?this.enabledIconColor:this.disabledIconColor,";\n      }\n      .insyncMenuUploadOption:hover svg path{\n        fill: ").concat(t?c.CHAT_BODY_TEXT_RIGHT_COLOR:this.disabledIconColor,";\n      }\n      svg.insyncMenuSettingIcon:hover path{\n        fill: ").concat(this.props.disableEditing?this.disabledIconColor:"#fff"," !important;\n      }\n      svg.insyncMenuSettingIcon:hover rect {  \n        fill: ").concat(this.props.disableEditing?"#fff":c.CHAT_BODY_TEXT_RIGHT_BACKGORUND_COLOR,' !important;\n      }\n      \n      /* Customize the label (the insyncSoundCheckboxWrapper) */\n      .insyncSoundCheckboxWrapper {\n        display: block;\n        position: relative;\n        padding-left: 14px;\n        margin-bottom: 14px;\n        cursor: pointer;\n        font-size: 22px;\n        -webkit-user-select: none;\n        -moz-user-select: none;\n        -ms-user-select: none;\n        user-select: none;\n      }\n\n      /* Hide the browser\'s default checkbox */\n      .insyncSoundCheckboxWrapper input {\n        position: absolute;\n        opacity: 0;\n        cursor: pointer;\n        height: 0;\n        width: 0;\n      }\n\n      /* Create a custom checkbox */\n      .checkmark {\n        position: absolute;\n        top: 0;\n        left: 0;\n        height: 13px;\n        width: 13px;\n        background-color: #fff;\n        border: 1px solid #848181;\n      }\n\n      /* On mouse-over, add a grey background color */\n      // .insyncSoundCheckboxWrapper:hover input ~ .checkmark {\n      //   background-color: #848181;\n      // }\n\n      /* When the checkbox is checked, add a blue background */\n      .insyncSoundCheckboxWrapper input:checked ~ .checkmark {\n        background-color: #fff;\n      }\n\n      /* Create the checkmark/indicator (hidden when not checked) */\n      .checkmark:after {\n        content: "";\n        position: absolute;\n        display: none;\n      }\n\n      /* Show the checkmark when checked */\n      .insyncSoundCheckboxWrapper input:checked ~ .checkmark:after {\n        display: block;\n      }\n\n      /* Style the checkmark/indicator */\n      .insyncSoundCheckboxWrapper .checkmark:after {\n        left: 4px;\n        top: 0px;\n        width: 4px;\n        height: 9px;\n        border: solid #848181;\n        border-width: 0 1px 1px 0;\n        -webkit-transform: rotate(45deg);\n        -ms-transform: rotate(45deg);\n        transform: rotate(45deg);\n      }\n      \n\n    '),(0,r.h)("div",{ref:function(t){e.getEndElement(t)}},(0,r.h)("svg",{className:"insyncMenuSettingIcon",onClick:function(){return e.toggleMenu()},width:"19",height:"5",viewBox:"0 0 19 5"},(0,r.h)("g",{id:"Group_382","data-name":"Group 382",transform:"translate(-23 -515)"},(0,r.h)("circle",{id:"Ellipse_36","data-name":"Ellipse 36",cx:"2.5",cy:"2.5",r:"2.5",transform:"translate(23 515)",fill:this.props.disableEditing?this.disabledIconColor:c.CHAT_BODY_TEXT_RIGHT_BACKGORUND_COLOR}),(0,r.h)("circle",{id:"Ellipse_37","data-name":"Ellipse 37",cx:"2.5",cy:"2.5",r:"2.5",transform:"translate(30 515)",fill:this.props.disableEditing?this.disabledIconColor:c.CHAT_BODY_TEXT_RIGHT_BACKGORUND_COLOR}),(0,r.h)("circle",{id:"Ellipse_38","data-name":"Ellipse 38",cx:"2.5",cy:"2.5",r:"2.5",transform:"translate(37 515)",fill:this.props.disableEditing?this.disabledIconColor:c.CHAT_BODY_TEXT_RIGHT_BACKGORUND_COLOR}))),(0,r.h)("div",{className:"insyncMenu"},(0,r.h)("div",{className:"insyncMenuItem insyncMenuSoundOption"},(0,r.h)("label",{className:"insyncSoundCheckboxWrapper"},(0,r.h)("input",{type:"checkbox",onClick:function(){return e.toggleSoundOption()},checked:this.state.isSoundNotificationOn}),(0,r.h)("span",{className:"checkmark"})),(0,r.h)("div",{className:"insyncMenuItemName"},"Sound Notifications")),(0,r.h)("div",{className:"insyncMenuItem insyncMenuUploadOption",onClick:function(){return e.openUploadAttchment(t)}},(0,r.h)("svg",{className:"insyncMenuUploadOptionIcon",xmlns:"http://www.w3.org/2000/svg",width:"14.928",height:"17.856",viewBox:"0 0 14.928 17.856"},(0,r.h)("path",{id:"ic_attach_file_24px",d:"M13.909,4.636V13a2.909,2.909,0,1,1-5.818,0V3.909a1.818,1.818,0,0,1,3.636,0v7.636a.727.727,0,0,1-1.455,0V4.636H9.182v6.909a1.818,1.818,0,0,0,3.636,0V3.909A2.909,2.909,0,0,0,7,3.909V13a4,4,0,1,0,8,0V4.636Z",transform:"translate(2.438 -4.366) rotate(30)",fill:this.enabledIconColor})),(0,r.h)("div",{className:"insyncMenuItemName"},"Upload file")),(0,r.h)("div",{className:"insyncMenuItem insyncMenuEndChatOption",onClick:function(){return e.endChat()}},(0,r.h)("svg",{className:"insyncEndChatIcon",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 14 14"},(0,r.h)("path",{id:"ic_exit_to_app_24px",d:"M8.514,12.792l1.1,1.1L13.5,10,9.611,6.111l-1.1,1.1,2.007,2.014H3v1.556h7.521ZM15.444,3H4.556A1.555,1.555,0,0,0,3,4.556V7.667H4.556V4.556H15.444V15.444H4.556V12.333H3v3.111A1.555,1.555,0,0,0,4.556,17H15.444A1.56,1.56,0,0,0,17,15.444V4.556A1.56,1.56,0,0,0,15.444,3Z",transform:"translate(-3 -3)",fill:this.enabledIconColor})),(0,r.h)("div",{className:"insyncMenuItemName"},"End chat")))))}}])&&j(t.prototype,n),i&&j(t,i),Object.defineProperty(t,"prototype",{writable:!1}),a}(r.wA);function W(e){return W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},W(e)}function q(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function V(e,t){return V=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},V(e,t)}function z(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=K(e);if(t){var i=K(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Y(this,n)}}function Y(e,t){if(t&&("object"===W(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function K(e){return K=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},K(e)}var $=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&V(e,t)}(s,e);var t,n,i,o=z(s);function s(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),o.call(this,e)}return t=s,(n=[{key:"shouldComponentUpdate",value:function(e,t){return this.props.width!==e.width}},{key:"render",value:function(){var e,t,n=0,i=l().CHAT_BODY_MARGIN_LEFT;return(l().FILE_ATTACHMENT_ENABLED||l().END_CHAT_ENABLED||l().SOUND_FEATURE_ENABLED)&&(n=l().INPUT_BOX_PADDING_LEFT,i=0,e=(0,r.h)(G,{agentConnectionStatus:this.props.agentConnectionStatus,showModalView:this.props.showModalView,isMobile:this.props.isMobile,updateUserPreference:this.props.updateUserPreference,isSoundNotificationOn:this.props.isSoundNotificationOn})),this.props.isVoiceInput||(t=(0,r.h)(L,{sendMessage:this.props.sendMessage,sendAttachment:this.props.sendAttachment,onInputBlur:this.props.onInputBlur,agentConnectionStatus:this.props.agentConnectionStatus,showModalView:this.props.showModalView})),u().it("\n      .insyncChatInputFooter {\n        background-color:#fff;\n        width: 100%;\n        min-height: ".concat(l().FOOTER_HEIGHT-2,"px;\n        border-top:  ").concat(l().SHOW_FOOTER_V2?l().INPUT_BORDER_TOP:"none",";\n        display: ").concat(this.props.isAgent?"none":"block",";\n        position: relative;\n        //padding-left: ").concat(n,"px;\n      }\n      .insyncChatInputFooter input{\n        overflow: hidden;\n        resize: none;\n        min-height: ").concat(l().FOOTER_HEIGHT-5,"px;\n        display: inline;\n        float: left;\n        width: 100%;\n        // line-height: 26px;\n        color: #000!important;\n        border: ").concat(l().INPUT_BORDER_TOP,";\n        font-size: ").concat(l().INPUT_FONT_SIZE,";\n        padding-left: ").concat(l().SHOW_FOOTER_V3?n+"px":"12px",";\n        margin-left: ").concat(i,"px;\n        border-radius: 5px;\n        box-sizing: border-box;\n        -moz-box-sizing: border-box;\n        -webkit-box-sizing: border-box;\n      }\n      \n      .insyncSendImg {\n        float: right;\n        cursor: pointer;\n        background-color: white;\n        padding-left: 10px;\n        padding-top: 13px;\n        padding-right:15px;\n        padding-bottom: 9px;\n      }\n      img.insyncSendIcon {\n        height: 28px;\n        width: 28px;\n        padding-left: ").concat(l().SHOW_FOOTER_V3?12:5,"px;\n        padding-top: ").concat(l().SHOW_FOOTER_V3?5:11,"px;\n        padding-right:").concat(l().SHOW_FOOTER_V3?5:15,"px;\n        //padding-bottom:").concat(l().SHOW_FOOTER_V3?5:6,"px;\n        cursor: pointer;\n        box-sizing: initial;\n      }\n      svg.insyncSendIcon {\n        height: 28px;\n        width: 28px;\n        padding-left: ").concat(l().SHOW_FOOTER_V3?12:5,"px;\n        padding-top: ").concat(l().SHOW_FOOTER_V3?5:11,"px;\n        padding-right:").concat(l().SHOW_FOOTER_V3?5:15,"px;\n        padding-bottom:").concat(l().SHOW_FOOTER_V3?0:6,"px;\n        cursor: pointer;\n        box-sizing: initial;\n      }\n      .insyncUploadImg {\n        float: left;\n        padding: 12px;\n        cursor: pointer;\n        background-color: white;\n      }\n      input{\n        //border: none;\n        overflow: auto;\n        outline: none;\n\n        -webkit-box-shadow:none;\n        -moz-box-shadow:none;\n        box-shadow:none;\n      }\n      .insyncUploadIconWrapper {\n        float: left;\n      }\n      ::-webkit-input-placeholder { /* Chrome/Opera/Safari */\n        color: #6A7889;\n      }\n      ::-moz-placeholder { /* Firefox 19+ */\n        color: #6A7889;\n      }\n      :-ms-input-placeholder { /* IE 10+ */\n        color: #6A7889;\n      }\n      :-moz-placeholder { /* Firefox 18- */\n        color: #6A7889;\n      }\n      "),(0,r.h)("div",{className:"insyncChatInputFooter"},(0,r.h)("div",{className:"insyncUploadIconWrapper"},e," "),t))}}])&&q(t.prototype,n),i&&q(t,i),Object.defineProperty(t,"prototype",{writable:!1}),s}(r.wA);const X=(0,i.$j)((function(e,t){return{messageTyped:e.conversation.messageTyped,disableEditing:e.conversation.disableEditing,doesBrowserSupportsMedia:e.conversation.doesBrowserSupportsMedia,isVoiceInput:e.conversation.isVoiceInput,agentConnectionStatus:e.conversation.agentConnectionStatus}}),(function(e){return{dispatch:e,toggledInput:s.gY}}))($);function J(e){return J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},J(e)}function Z(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Q(e,t){return Q=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Q(e,t)}function ee(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ne(e);if(t){var i=ne(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return te(this,n)}}function te(e,t){if(t&&("object"===J(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ne(e){return ne=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ne(e)}var re=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Q(e,t)}(s,e);var t,n,i,o=ee(s);function s(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),o.call(this,e)}return t=s,(n=[{key:"render",value:function(){return u().it("\n      .insyncChatPoweredByFooter {\n        text-align: center;\n        background-color:#fff;\n        height:".concat(l().CHAT_FOOTER_POWEREDBY_HEIGHT,"px;\n        box-sizing: border-box;\n        -moz-box-sizing: border-box;\n        -webkit-box-sizing: border-box;\n      }\n      .insyncChatPoweredByFooter a {\n        display: ").concat(l().SHOW_POWEREDBY_LINK?"initial":"none",";\n        vertical-align: middle;\n      }\n\n      .insyncChatPoweredByFooter a img{\n        height: ").concat(l().POWEREDBY_IMAGE_HEIGHT,";\n        vertical-align: middle;\n        display: ").concat(l().SHOW_FOOTER_V3&&!l().SHOW_POWEREDBY_LINK&&"none","\n      }\n      "),(0,r.h)("div",{className:"insyncChatPoweredByFooter"},(0,r.h)("a",{href:l().POWEREDBY_LINK,target:"_blank"},(0,r.h)("img",{src:l().POWEREDBY_IMAGE}))))}}])&&Z(t.prototype,n),i&&Z(t,i),Object.defineProperty(t,"prototype",{writable:!1}),s}(r.wA);function ie(e){return ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ie(e)}function oe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function se(e,t){return se=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},se(e,t)}function ae(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ce(e);if(t){var i=ce(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return ue(this,n)}}function ue(e,t){if(t&&("object"===ie(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ce(e){return ce=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ce(e)}var le=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&se(e,t)}(s,e);var t,n,i,o=ae(s);function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=o.call(this,e)).show_sender_name_with_typing=!0,t}return t=s,(n=[{key:"render",value:function(){return u().it("\n\n\t        .insyncLeft { \n\t            float: left;   \n\t            margin: 7px 52px 2px ".concat(l().CHAT_BODY_MARGIN_LEFT,"px;  \n              background-color:transparent;\n\n\t        }\n          \n          .insyncTypingImg{\n            width: '50px';\n            height: '25px';\n            float: 'left';\n          }\n          \n          .insyncTypingText{\n            display: ").concat(1==this.show_sender_name_with_typing?"inline-block":"none",";\n            padding-top: 5px;\n            color: ").concat(l().GREY_TEXT_COLOR,";\n          }\n\n        "),(0,r.h)("div",{className:"insyncLeft"},(0,r.h)("img",{src:l().ASSETS_URL+"/typing_animation.gif",className:"insyncTypingImg"}),(0,r.h)("div",{className:"insyncTypingText"},this.props.systemSenderName," is typing")))}}])&&oe(t.prototype,n),i&&oe(t,i),Object.defineProperty(t,"prototype",{writable:!1}),s}(r.wA),de=n(3545);function fe(e){return fe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fe(e)}function pe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function he(e,t){return he=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},he(e,t)}function ye(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=me(e);if(t){var i=me(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return ve(this,n)}}function ve(e,t){if(t&&("object"===fe(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function me(e){return me=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},me(e)}var ge=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&he(e,t)}(s,e);var t,n,i,o=ye(s);function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=o.call(this,e)).classStyleName="inysnc-modal-btn",t.props.classStyleName&&(t.classStyleName=t.props.classStyleName),t}return t=s,(n=[{key:"render",value:function(){return u().it("\n        .inysnc-modal-btn {\n          border:  ".concat(l().BUTTON_BORDER,";\n          color: ").concat(l().BUTTON_TEXT_COLOR,";\n          height: ").concat(this.props.btnHeight?this.props.btnHeight:36,"px;\n          cursor: pointer;\n          background-color: #fff;\n          padding: 0px 30px;\n          overflow: hidden;\n          white-space: nowrap;\n          text-overflow: ellipsis;\n          border-radius: ").concat(window.shopInSync.styleGuide.chatBoxBorderRadius,"px;\n          margin-right: ").concat(void 0!==this.props.noMargin&&this.props.noMargin?"0px":"10px",";\n          border-color: ").concat(l().BUTTON_TEXT_COLOR,";\n          font-size: 15px !important;\n          min-width: ").concat(this.props.btnWidth?this.props.btnWidth:"100px",";\n        }\n        .inysnc-modal-btn:hover{\n          color: ").concat(!this.props.isDisabled&&l().CHAT_BODY_TEXT_RIGHT_COLOR,";\n          background-color: ").concat(!this.props.isDisabled&&l().BUTTON_TEXT_COLOR,";\n          border:  ").concat(!this.props.isDisabled&&l().BUTTON_BORDER,";\n          border-color:").concat(!this.props.isDisabled&&l().CHAT_BODY_TEXT_RIGHT_COLOR,";\n        }\n        .inysnc-modal-btn:disabled{\n          color: white;\n          cursor: default;\n          background-color: #dddfe2;\n          border:  ").concat(l().BUTTON_BORDER,";\n          border-color: #F5F4F4;\n        }\n        .insyncLoaderViewCloseBtn{\n          margin-top: 20px;\n          border:  ").concat(l().BUTTON_BORDER,";\n          background-color:").concat(l().CHAT_BODY_TEXT_RIGHT_BACKGORUND_COLOR,";\n          color: ").concat(l().CHAT_BODY_TEXT_RIGHT_COLOR,";\n          border-radius: ").concat(window.shopInSync.styleGuide.chatBoxBorderRadius,"px;\n          width: ").concat(l().BUTTON_WIDTH?l().BUTTON_WIDTH:"110","px;\n          height: 36px;\n          cursor: pointer;\n        }\n        "),(0,r.h)("button",{className:this.classStyleName,onClick:this.props.btnClick,disabled:this.props.isDisabled},this.props.btnTitle))}}])&&pe(t.prototype,n),i&&pe(t,i),Object.defineProperty(t,"prototype",{writable:!1}),s}(r.wA);function be(e){return be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},be(e)}function _e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function we(e,t){return we=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},we(e,t)}function ke(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ee(e);if(t){var i=Ee(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return xe(this,n)}}function xe(e,t){if(t&&("object"===be(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Se(e)}function Se(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ee(e){return Ee=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ee(e)}var Te=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&we(e,t)}(s,e);var t,n,i,o=ke(s);function s(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=o.call(this,e)).sendRatingCommentAndEndSession=t.sendRatingCommentAndEndSession.bind(Se(t)),t.onchange=t.onchange.bind(Se(t)),t.handleKeyPress=t.handleKeyPress.bind(Se(t)),t.captureFeedbackClicked=t.captureFeedbackClicked.bind(Se(t)),t.btnClicked=t.btnClicked.bind(Se(t)),t.loadIcons=t.loadIcons.bind(Se(t)),t.loadCsatIcons=t.loadCsatIcons.bind(Se(t)),t.loadNpsIcons=t.loadNpsIcons.bind(Se(t));var n=t.props.showView.msg.views.length;t.viewsDict={};for(var r=0;r<n;r++)t.viewsDict[t.props.showView.msg.views[r].view_name]={text:t.props.showView.msg.views[r].text,isTextAreaEnabled:void 0!==t.props.showView.msg.views[r].text_area,textAreaGhostText:void 0!==t.props.showView.msg.views[r].text_area?t.props.showView.msg.views[r].text_area.ghost_text:"",iconOptions:t.props.showView.msg.views[r].options,btnText:t.props.showView.msg.views[r].button_text,value:"",userComment:""};return t.state={viewName:t.props.showView.msg.views[0].view_name,csatFeedback:"",npsFeedback:"",userComment:"",sendBtnClicked:!1},t}return t=s,(n=[{key:"loadIcons",value:function(e,t){var n=[];return"csat"==e?n=this.loadCsatIcons(t):"nps"==e&&(n=this.loadNpsIcons(t)),n}},{key:"loadCsatIcons",value:function(e){var t=this,n=[],i=(0,r.h)("svg",{className:"insyncModalFeedbackActions insyncModalUpAction",onClick:function(){return t.captureFeedbackClicked("good")},xmlns:"http://www.w3.org/2000/svg",width:"66",height:"66",viewBox:"0 0 66 66"},(0,r.h)("g",{id:"Group_818","data-name":"Group 818",transform:"translate(-691 -1282)"},(0,r.h)("circle",{id:"Ellipse_34","data-name":"Ellipse 34",cx:"33",cy:"33",r:"33",transform:"translate(691 1282)",fill:"#f0efef"}),(0,r.h)("path",{id:"ic_thumb_down_24px",d:"M15.545,39.364H31.909a3.612,3.612,0,0,0,3.345-2.218l5.491-12.818A3.592,3.592,0,0,0,41,23V19.527l-.018-.018L41,19.364a3.647,3.647,0,0,0-3.636-3.636H25.891l1.727-8.309.055-.582a2.737,2.737,0,0,0-.8-1.927L24.945,3,12.964,14.982a3.614,3.614,0,0,0-1.055,2.564V35.727A3.647,3.647,0,0,0,15.545,39.364Zm-7.273,0V17.545H1V39.364Z",transform:"translate(703 1293.818)",fill:"#fff",stroke:l().CHAT_BODY_TEXT_RIGHT_BACKGORUND_COLOR,"stroke-width":"1"}))),o=(0,r.h)("svg",{className:"insyncModalFeedbackActions insyncModalNeutralAction",onClick:function(){return t.captureFeedbackClicked("neutral")},xmlns:"http://www.w3.org/2000/svg",width:"66",height:"66",viewBox:"0 0 66 66"},(0,r.h)("g",{id:"Group_819","data-name":"Group 819",transform:"translate(-795 -1198)"},(0,r.h)("g",{id:"Group_379","data-name":"Group 379",transform:"translate(334 280)"},(0,r.h)("g",{id:"Group_375","data-name":"Group 375",transform:"translate(461 918)"},(0,r.h)("circle",{id:"Ellipse_34","data-name":"Ellipse 34",cx:"33",cy:"33",r:"33",transform:"translate(0 0)",fill:"#f0efef"}))),(0,r.h)("g",{id:"Component_1_10","data-name":"Component 1 – 10",transform:"translate(808 1211)"},(0,r.h)("g",{id:"Ellipse_92","data-name":"Ellipse 92",fill:"#fff",stroke:l().CHAT_BODY_TEXT_RIGHT_BACKGORUND_COLOR,"stroke-width":"1"},(0,r.h)("circle",{cx:"20",cy:"20",r:"20",stroke:"none"}),(0,r.h)("circle",{cx:"20",cy:"20",r:"19.5",fill:"none"})),(0,r.h)("g",{id:"Ellipse_93","data-name":"Ellipse 93",transform:"translate(9.25 12.875)",fill:l().CHAT_BODY_TEXT_RIGHT_BACKGORUND_COLOR,stroke:l().CHAT_BODY_TEXT_RIGHT_BACKGORUND_COLOR,"stroke-width":"1"},(0,r.h)("circle",{cx:"3.5",cy:"3.5",r:"3.5",stroke:"none"}),(0,r.h)("circle",{cx:"3.5",cy:"3.5",r:"3",fill:"none"})),(0,r.h)("g",{id:"Ellipse_94","data-name":"Ellipse 94",transform:"translate(23.75 12.875)",fill:l().CHAT_BODY_TEXT_RIGHT_BACKGORUND_COLOR,stroke:l().CHAT_BODY_TEXT_RIGHT_BACKGORUND_COLOR,"stroke-width":"1"},(0,r.h)("circle",{cx:"3.5",cy:"3.5",r:"3.5",stroke:"none"}),(0,r.h)("circle",{cx:"3.5",cy:"3.5",r:"3",fill:"none"})),(0,r.h)("g",{id:"Rectangle_1564","data-name":"Rectangle 1564",transform:"translate(13 27.401)",fill:l().CHAT_BODY_TEXT_RIGHT_BACKGORUND_COLOR,stroke:l().CHAT_BODY_TEXT_RIGHT_BACKGORUND_COLOR,"stroke-width":"1"},(0,r.h)("rect",{width:"14",height:"3",stroke:"none"}),(0,r.h)("rect",{x:"0.5",y:"0.5",width:"13",height:"2",fill:"none"}))))),s=(0,r.h)("svg",{className:"insyncModalFeedbackActions insyncModalDownAction",onClick:function(){return t.captureFeedbackClicked("bad")},xmlns:"http://www.w3.org/2000/svg",width:"66",height:"66",viewBox:"0 0 66 66"},(0,r.h)("g",{id:"Group_820","data-name":"Group 820",transform:"translate(-908 -1281)"},(0,r.h)("circle",{id:"Ellipse_32","data-name":"Ellipse 32",cx:"33",cy:"33",r:"33",transform:"translate(908 1281)",fill:"#f0efef"}),(0,r.h)("path",{id:"ic_thumb_down_24px",d:"M26.455,3H10.091A3.612,3.612,0,0,0,6.745,5.218L1.255,18.036A3.592,3.592,0,0,0,1,19.364v3.473l.018.018L1,23a3.647,3.647,0,0,0,3.636,3.636H16.109l-1.727,8.309-.055.582a2.737,2.737,0,0,0,.8,1.927l1.927,1.909L29.036,27.382a3.614,3.614,0,0,0,1.055-2.564V6.636A3.647,3.647,0,0,0,26.455,3Zm7.273,0V24.818H41V3Z",transform:"translate(920 1292.818)",fill:"#fff",stroke:l().CHAT_BODY_TEXT_RIGHT_BACKGORUND_COLOR,"stroke-width":"1"})));return n.push(i),void 0!==e&&e.includes("neutral")&&n.push(o),n.push(s),n}},{key:"loadNpsIcons",value:function(){for(var e=this,t=[],n=(this.state.npsFeedback,function(n){var i="insyncNpsBbl";""!=e.state.npsFeedback&&e.state.npsFeedback==n&&(i="insyncNpsBbl insyncNpsBblSelected");var o=(0,r.h)("div",{className:i,onClick:function(){return e.captureFeedbackClicked(n)}},n);t.push(o)}),i=0;i<11;i++)n(i);return(0,r.h)("div",{className:"insyncNpsBblWrapper"},t)}},{key:"btnClicked",value:function(){var e,t=this.state.viewName;for(var n in this.viewsDict)""==this.viewsDict[n].value&&(e=n);void 0!==e&&this.setState({viewName:e,userComment:""}),t!=this.state.viewName||this.state.sendBtnClicked||(this.setState({sendBtnClicked:!0}),this.sendRatingCommentAndEndSession())}},{key:"onchange",value:function(e){e.preventDefault(),this.setState({userComment:e.target.value}),this.viewsDict[this.state.viewName].userComment=e.target.value}},{key:"handleKeyPress",value:function(e){this.setState({userComment:e.target.value}),this.viewsDict[this.state.viewName].userComment=e.target.value}},{key:"sendRatingCommentAndEndSession",value:function(){var e=!1,t={};for(var n in this.viewsDict)if(void 0!==this.viewsDict[n]&&""!=this.viewsDict[n].value){var r=this.viewsDict[n].value,i=this.viewsDict[n].userComment;t[n+"_feedback"]={value:r,comment:i},e=!0}if(e){var o="agent"==this.props.sessionWith?"agent":"user";this.props.userEndedSession(t,o)}}},{key:"captureFeedbackClicked",value:function(e){"csat"==this.state.viewName&&(this.viewsDict[this.state.viewName].value=e,this.setState({csatFeedback:e})),"nps"==this.state.viewName&&""==this.state.npsFeedback&&(this.viewsDict[this.state.viewName].value=e,this.setState({npsFeedback:e}))}},{key:"render",value:function(){var e=this,t=this.loadIcons(this.state.viewName,this.viewsDict[this.state.viewName].iconOptions),n=.4*this.props.height;return u().it("\n      .insyncCaptureFeedbackWrapper{\n        text-align: center;\n      }\n      .insyncModalFeedbackActions{\n        height: 50px;\n        margin-right: 0;\n        cursor: pointer ;\n      }\n      svg.insyncModalUpAction circle{\n        ".concat("good"==this.state.csatFeedback?"fill: "+l().CHAT_BODY_TEXT_RIGHT_BACKGORUND_COLOR:"",";\n      }\n      svg.insyncModalNeutralAction circle#Ellipse_34{\n        ").concat("neutral"==this.state.csatFeedback?"fill: "+l().CHAT_BODY_TEXT_RIGHT_BACKGORUND_COLOR:"",";\n      }\n      svg.insyncModalDownAction circle{\n        ").concat("bad"==this.state.csatFeedback?"fill: "+l().CHAT_BODY_TEXT_RIGHT_BACKGORUND_COLOR:"",";\n      }\n\n      .insyncCaptureFeedbackTitle {\n        text-align: center;\n        padding-top: 10px;\n        font-size: 16px;\n        font-weight: initial;\n      }\n\n      .insyncCommentTextarea{\n        //margin: 12px 0px;\n        height: ").concat(.5*n,"px;\n        width: 93.5%;\n        border-color: #D8D8D8 !important;\n        outline: none;\n        padding: 10px;\n        font-family: inherit;\n        font-size: inherit;\n      }\n      .insyncCommentTextarea:focus{\n        border-color: #D8D8D8 !important;\n      }\n\n      svg.insyncModalUpAction:hover circle{\n        ").concat(""==this.state.csatFeedback?"fill: "+l().CHAT_BODY_TEXT_RIGHT_BACKGORUND_COLOR:"",";\n      }\n      svg.insyncModalNeutralAction:hover circle#Ellipse_34{\n        ").concat(""==this.state.csatFeedback?"fill: "+l().CHAT_BODY_TEXT_RIGHT_BACKGORUND_COLOR:"",";\n      }\n      svg.insyncModalDownAction:hover circle{\n        ").concat(""==this.state.csatFeedback?"fill: "+l().CHAT_BODY_TEXT_RIGHT_BACKGORUND_COLOR:"",";\n      }\n      .insyncNpsBblWrapper{\n        display: inline-flex;\n      }\n      .insyncNpsBbl{\n        border-radius: 20px;\n        border: 1px solid ").concat(l().CHAT_BODY_TEXT_RIGHT_BACKGORUND_COLOR,";\n        margin-right: 5px;\n        padding: 5px;\n        width: 28px;\n        box-sizing: border-box;\n      }\n      .insyncNpsBbl:hover {\n        background-color: ").concat(l().CHAT_BODY_TEXT_RIGHT_BACKGORUND_COLOR,";\n        color: #ffffff;\n        cursor: pointer ;\n      }\n      .insyncNpsBblSelected {\n        background-color: ").concat(l().CHAT_BODY_TEXT_RIGHT_BACKGORUND_COLOR,";\n        color: #ffffff;\n      }\n      // .insyncFeedbackBtns{\n      //   position: relative;\n      //   margin-top: 25px;\n      // }\n      .insyncLoaderIconWrapper{\n        height: 25px;\n        text-align: center;\n      }\n      .insyncLoaderIcon {\n        height: 20px;\n        display: ").concat(this.state.sendBtnClicked?"initial":"none",";\n      }\n      ::-webkit-resizer {\n        display: none;\n      }\n\t  "),(0,r.h)("div",{className:"insyncCaptureFeedbackWrapper"},(0,r.h)("div",{className:"insyncFeedbackRequestText"},(0,r.h)("div",{className:"insyncModalTitle insyncCaptureFeedbackTitle"},this.viewsDict[this.state.viewName].text)),(0,r.h)("div",{className:"insync-modal-btn-wrapper insyncCenterBtnsWrapper"},t),(0,r.h)("textarea",{maxlength:"150",ref:function(t){e.myTextArea=t},value:this.state.userComment,onChange:this.onchange,onKeyUp:this.handleKeyPress,className:"insyncCommentTextarea",placeholder:this.viewsDict[this.state.viewName].textAreaGhostText,disabled:""==this.viewsDict[this.state.viewName].value}),(0,r.h)("div",{className:"insyncCenterBtnsWrapper insyncFeedbackBtns"},(0,r.h)("div",{className:"insyncLoaderIconWrapper"},(0,r.h)("img",{className:"insyncLoaderIcon",src:l().LOADER_URL})),(0,r.h)(ge,{btnClick:function(){return e.btnClicked()},btnTitle:this.viewsDict[this.state.viewName].btnText,isDisabled:""==this.viewsDict[this.state.viewName].value||this.state.sendBtnClicked,noMargin:!0}))))}}])&&_e(t.prototype,n),i&&_e(t,i),Object.defineProperty(t,"prototype",{writable:!1}),s}(r.wA);function Oe(e){return Oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Oe(e)}function Ie(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ce(e,t){return Ce=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Ce(e,t)}function Re(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ne(e);if(t){var i=Ne(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ae(this,n)}}function Ae(e,t){if(t&&("object"===Oe(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Pe(e)}function Pe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ne(e){return Ne=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ne(e)}var Le=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ce(e,t)}(s,e);var t,n,i,o=Re(s);function s(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=o.call(this,e)).btnClickedWrapper=t.btnClickedWrapper.bind(Pe(t)),t.initiateTimerView=t.initiateTimerView.bind(Pe(t));var n=t.props.showView.msg.views.length;t.viewsDict={};for(var r=0;r<n;r++)t.viewsDict[t.props.showView.msg.views[r].view_name]={text:t.props.showView.msg.views[r].text,subText:t.props.showView.msg.views[r].sub_text,options:t.props.showView.msg.views[r].buttons};t.timer=0,t.scheduleInactivityTimer=t.scheduleInactivityTimer.bind(Pe(t)),t.startInactivityTimer=t.startInactivityTimer.bind(Pe(t)),t.countDown=t.countDown.bind(Pe(t));var i=t.props.showView.msg.sdk_signal_start_timer_after,a=t.props.showView.msg.sdk_signal_count_down_timer_value,u=t.props.showView.msg.sdk_signal_total_time_left_to_close,c=t.props.showView.msg.views[0].view_name,l=t.props.showView.msg.sdk_signal_template_triggered_time;return(u-=Math.round(Date.now()/1e3)-l)<0?c="disconnected_view":u<=a?(c="timer_view",a=u):u>a&&u<=i+a&&(c="reengage_prompt_view",i=u-a),t.state={viewName:c,time:{},countDownViewDuration:a},"reengage_prompt_view"==c?t.scheduleInactivityTimer(i):"timer_view"==c?t.initiateTimerView():t.props.endSession({sdk_insync_user_inactive_timeout:!0}),t}return t=s,n=[{key:"scheduleInactivityTimer",value:function(e){var t=this;setTimeout((function(){t.initiateTimerView()}),1e3*e)}},{key:"initiateTimerView",value:function(){this.startInactivityTimer(),this.setState({viewName:"timer_view"})}},{key:"secondsToTime",value:function(e){var t=Math.floor(e/3600),n=e%3600,r=Math.floor(n/60),i=n%60,o=Math.ceil(i);return{h:t,m:r,s:o,sStr:o>9?""+o:"0"+o}}},{key:"startInactivityTimer",value:function(){this.countDown(!0),0==this.timer&&this.state.countDownViewDuration>0&&(this.timer=setInterval(this.countDown,1e3))}},{key:"countDown",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=e?this.state.countDownViewDuration:this.state.countDownViewDuration-1;t<=0?(clearInterval(this.timer),this.setState({time:this.secondsToTime(t),countDownViewDuration:t,viewName:"disconnected_view"}),this.props.endSession({sdk_insync_user_inactive_timeout:!0})):this.setState({time:this.secondsToTime(t),countDownViewDuration:t,endBtnClicked:!1})}},{key:"btnClickedWrapper",value:function(e){"sdk_action_show_view"!=e.payload&&this.setState({endBtnClicked:!0}),this.props.btnClicked(e)}},{key:"render",value:function(){var e,t=this;return this.viewsDict[this.state.viewName].options&&(e=this.viewsDict[this.state.viewName].options.map((function(e){return(0,r.h)(ge,{btnClick:function(){return t.btnClickedWrapper(e)},btnTitle:e.title,btnHeight:36,btnWidth:void 0})}))),u().it("\n      .insyncReengageViewWrapper{\n        text-align: center;\n        position: relative;\n      }\n\n      .insyncReengageViewTitle {\n        text-align: center;\n        padding-top: ".concat("disconnected_view"==this.state.viewName?"60":"10","px;\n        padding-bottom: ").concat(this.viewsDict[this.state.viewName].subText?"10":"60","px;\n        padding-top: 10px;\n        //padding-bottom: 0px;\n        font-size: 18px;\n        font-weight: initial;\n      }\n      .insyncReengageViewSubTitle {\n        text-align: center;\n        //padding-top: 10px;\n        padding-bottom: 0px;\n        font-size: 14px;\n        font-weight: initial;\n        color: ").concat(l().GREY_TEXT_COLOR,";\n        height: 25px;\n      }\n\n      .insyncLoaderIconWrapper{\n        height: 25px;\n        text-align: center;\n        position: absolute;\n        display: ").concat(this.state.endBtnClicked?"initial":"none",";\n        left: 50%;\n        transform: translate(-50%, 0);\n        bottom: ").concat(36,"px;\n      }\n      .insyncLoaderIcon {\n        height: 20px;\n        \n        \n      }\n      .insyncReengageViewTimer{\n        //padding-top: 10px;\n        //padding-bottom: 26px;\n        font-size: 28px;\n        color: ").concat(l().GREY_TEXT_COLOR,";\n      }\n      .insyncReengageViewButtons{\n        width: 100%;\n        margin: 0 auto;\n      }\n      .insyncReengageBtnsWrapper{\n        padding-top: 10px;\n        text-align: center;\n        position: fixed;\n        bottom: 20px;\n        left: 50%;\n        transform: translate(-50%, 0);\n        width: 100%;\n      }\n      ::-webkit-resizer {\n        display: none;\n      }\n\t  "),(0,r.h)("div",{className:"insyncReengageViewWrapper"},(0,r.h)("div",{className:"insyncFeedbackRequestText"},(0,r.h)("div",{className:"insyncModalTitle insyncReengageViewTitle"},this.viewsDict[this.state.viewName].text),this.viewsDict[this.state.viewName].subText&&(0,r.h)("div",{className:"insyncModalTitle insyncReengageViewSubTitle"},this.viewsDict[this.state.viewName].subText)),"timer_view"==this.state.viewName&&(0,r.h)("div",{className:"insyncModalTitle insyncReengageViewTimer"},this.state.time.m,":",this.state.time.sStr),(0,r.h)("div",{className:"insyncReengageBtnsWrapper"},(0,r.h)("div",{className:"insyncLoaderIconWrapper"},(0,r.h)("img",{className:"insyncLoaderIcon",src:l().LOADER_URL})),e)))}}],n&&Ie(t.prototype,n),i&&Ie(t,i),Object.defineProperty(t,"prototype",{writable:!1}),s}(r.wA);function Me(e){return Me="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Me(e)}function je(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function De(e,t){return De=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},De(e,t)}function Be(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=He(e);if(t){var i=He(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ue(this,n)}}function Ue(e,t){if(t&&("object"===Me(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Fe(e)}function Fe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function He(e){return He=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},He(e)}var Ge=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&De(e,t)}(s,e);var t,n,i,o=Be(s);function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=o.call(this,e)).btnClickedWrapper=t.btnClickedWrapper.bind(Fe(t)),t.loadViews=t.loadViews.bind(Fe(t)),t.viewName=t.props.showView.msg.views[0].view_name,t.state={endBtnClicked:!1},t}return t=s,(n=[{key:"loadViews",value:function(){for(var e={},t=this.props.showView.msg.views.length,n=0;n<t;n++)e[this.props.showView.msg.views[n].view_name]={text:this.props.showView.msg.views[n].text,text1:this.props.showView.msg.views[n].text1,subText:this.props.showView.msg.views[n].sub_text,options:this.props.showView.msg.views[n].buttons};return e}},{key:"btnClickedWrapper",value:function(e){"sdk_action_show_view"!=e.payload&&this.setState({endBtnClicked:!0}),this.props.btnClicked(e)}},{key:"render",value:function(){var e,t=this;return void 0!==this.props.viewName&&(this.viewName=this.props.viewName),this.viewsDict=this.loadViews(),this.viewsDict[this.viewName].options&&(e=this.viewsDict[this.viewName].options.map((function(e){return(0,r.h)(ge,{btnClick:function(){return t.btnClickedWrapper(e)},btnTitle:e.title,btnHeight:36,btnWidth:void 0})}))),u().it("\n      .insyncDefaultModalView{\n        text-align: center;\n        position: relative;\n      }\n\n      .insyncDefaultModalViewTitle {\n        text-align: center;\n        padding-top: 10px;\n        padding-bottom: 0px;\n        font-size: 18px;\n        font-weight: initial;\n      }\n      .insyncDefaultModalViewTitle1 {\n        text-align: center;\n        padding-top: 4px;\n        padding-bottom: 0px;\n        font-size: 14px;\n        font-weight: initial;\n        height: 20px;\n        box-sizing: border-box;\n      }\n      .insyncDefaultModalViewSubTitle {\n        text-align: center;\n        padding-top: 10px;\n        padding-bottom: 10px;\n        font-size: 14px;\n        font-weight: initial;\n        color: ".concat(l().GREY_TEXT_COLOR,";\n        height: 50px;\n      }\n\n      .insyncLoaderIconWrapper{\n        height: 25px;\n        text-align: center;\n        position: absolute;\n        display: ").concat(this.state.endBtnClicked?"initial":"none",";\n        left: 50%;\n        bottom: ").concat(40,"px;\n      }\n      .insyncLoaderIcon {\n        height: 20px;\n        \n        \n      }\n      .insyncDefaultModalViewButtons{\n        width: 100%;\n        margin: 0 auto;\n      }\n      .insyncDefaultModalBtnsWrapper{\n        text-align: center;\n        position: relative;\n        padding-top: 20px;\n      }\n      ::-webkit-resizer {\n        display: none;\n      }\n\t  "),(0,r.h)("div",{className:"insyncDefaultModalView"},(0,r.h)("div",{className:"insyncFeedbackRequestText"},(0,r.h)("div",{className:"insyncModalTitle insyncDefaultModalViewTitle",dangerouslySetInnerHTML:{__html:this.viewsDict[this.viewName].text}}),(0,r.h)("div",{className:"insyncModalTitle insyncDefaultModalViewTitle1",dangerouslySetInnerHTML:{__html:this.viewsDict[this.viewName].text1}}),this.viewsDict[this.viewName].subText&&(0,r.h)("div",{className:"insyncModalTitle insyncDefaultModalViewSubTitle",dangerouslySetInnerHTML:{__html:this.viewsDict[this.viewName].subText}})),(0,r.h)("div",{className:"insyncDefaultModalBtnsWrapper"},(0,r.h)("div",{className:"insyncLoaderIconWrapper"},(0,r.h)("img",{className:"insyncLoaderIcon",src:l().LOADER_URL})),e)))}}])&&je(t.prototype,n),i&&je(t,i),Object.defineProperty(t,"prototype",{writable:!1}),s}(r.wA),We=n(8484);function qe(e){return qe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qe(e)}function Ve(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ze(e,t){return ze=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ze(e,t)}function Ye(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Xe(e);if(t){var i=Xe(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke(this,n)}}function Ke(e,t){if(t&&("object"===qe(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return $e(e)}function $e(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Xe(e){return Xe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Xe(e)}var Je=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ze(e,t)}(s,e);var t,n,i,o=Ye(s);function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=o.call(this,e)).onClose=t.onClose.bind($e(t)),t.handleEscKey=t.handleEscKey.bind($e(t)),t.paddingTop=l().HEADER_HEIGHT+27*l().HEADER_HEIGHT/100,t}return t=s,(n=[{key:"onClose",value:function(e){this.props.closeUrl()}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleEscKey,!1)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleEscKey,!1)}},{key:"handleEscKey",value:function(e){27==e.keyCode&&this.onClose()}},{key:"render",value:function(){var e=this.props.height+l().SCREEN_HEIGHT_EXCEPT_BODY+1,t=!1;return this.props.url&&this.props.url.includes("hide_ext_link=true")&&(t=!0),u().it("\n\t\t#insync-modal{\n\t\t    position: absolute; /* Stay in place */\n\t\t    z-index: 999; /* Sit on top */\n\t\t    //left: 0;\n\t\t    top: 0px;\n\t\t    width: 100%; /* Full width */\n\t\t    height: ".concat(e,"px; //100%; /* Full height */\n\t\t    overflow: hidden; /* Enable scroll if needed */\n\t\t    //background-color: rgb(0,0,0); /* Fallback color */\n\t\t    background-color: rgba(204, 204, 204, 0.68);\n\t      //box-shadow: 0 -4px 8px 0 rgba(0, 0, 0, 0.2), 0 -6px 20px 0 rgba(0, 0, 0, 0.19);\n          \n\n\t\t}\n\t\t.insync-modal-body{\n\t\t\t//height:40px;\n      //background-color: rgba(255, 255, 255, 0.2);\n      //height: 100%;\n      max-height: inherit;\n      padding-top: ").concat(this.paddingTop,"px;\n      width:92%;\n      margin: 0 auto;\n      position: relative;\n\t\t}\n\t\t.insync-modal-content {\n\t\t    background-color: #b6b6b6;\n\t\t    background-image: linear-gradient(to right, #fff, #fff);\n        margin-top:0px;\n\t\t    width: 100%; /* Could be more or less, depending on screen size */\n\t\t    height: ").concat(e-this.paddingTop-l().FOOTER_HEIGHT/2,"px;\n\t\t    border: none;\n\t\t    box-shadow: none;\n        border-radius: 8px;\n        padding-top: 30px;\n        padding-bottom: 15px;\n        padding-left: 15px;\n        padding-right: 15px;\n        box-sizing: border-box;\n\t\t}\n\n    .insync-iframe-icons{\n      //background-color: grey;\n      position: absolute;\n      right: 8px;\n      top: 77px;\n      z-index: 1000;\n    }\n\n\t\t/* The Close Button */\n\t\t.insync-close {\n\t\t    color: black;\n\t\t    float: right;\n\t\t    font-size: 18px;\n\t\t    font-weight: bold;\n        //margin-top:37px;\n        opacity: 1;\n        right: -19px;\n        top: -15px;\n\t\t}\n\t\t.insync-link {\n\t\t    color: black;\n\t\t    float: right;\n\t\t    font-size: 18px;\n\t\t    font-weight: bold;\n\t\t    opacity: 1;\n\t\t    display: ").concat(t?"none":"block",";\n        \n\t\t}\n\n\t\t.insync-close:hover,\n\t\t.insync-close:focus {\n\t\t    color: black;\n\t\t    text-decoration: none;\n\t\t    cursor: pointer;\n\t\t}\n\n\t\tiframe#insync-iframe\n\t\t{\n\t\t    position: relative;\n\t\t    height: 100%;\n\t\t    width: 100%; \n\t\t    border-width: 0px;\n\t\t    background-color:#fff;\n        max-height: inherit;\n        border-radius: inherit;\n        //border: 1px solid rgb(232, 227, 227) !important;\n\t\t}\n\n\t  "),(0,r.h)("div",{id:"insync-modal"},(0,r.h)("div",{className:"insync-modal-body"},(0,r.h)("div",{className:"insync-iframe-icons"},(0,r.h)("span",{className:"insync-close",onClick:this.onClose},(0,r.h)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"30",height:"30",viewBox:"0 0 30 30"},(0,r.h)("g",{id:"Group_366","data-name":"Group 366",transform:"translate(-729 -85)"},(0,r.h)("path",{id:"ic_clear_24px",d:"M17,6.209,15.791,5,11,9.791,6.209,5,5,6.209,9.791,11,5,15.791,6.209,17,11,12.209,15.791,17,17,15.791,12.209,11Z",transform:"translate(733 89)",fill:l().USER_SEND_ICON_COLOR})))),(0,r.h)("span",{className:"insync-link"},(0,r.h)("a",{href:this.props.origUrl?this.props.origUrl:this.props.url,target:"_blank"},(0,r.h)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"30",height:"30",viewBox:"0 0 30 30"},(0,r.h)("g",{id:"Group_365","data-name":"Group 365",transform:"translate(-681 -85)"},(0,r.h)("path",{id:"ic_open_in_new_24px",d:"M13.667,13.667H4.333V4.333H9V3H4.333A1.333,1.333,0,0,0,3,4.333v9.333A1.333,1.333,0,0,0,4.333,15h9.333A1.337,1.337,0,0,0,15,13.667V9H13.667ZM10.333,3V4.333h2.393L6.173,10.887l.94.94,6.553-6.553V7.667H15V3Z",transform:"translate(687 91)",fill:l().USER_SEND_ICON_COLOR})))))),(0,r.h)("div",{className:"insync-modal-content"},(0,r.h)("iframe",{scrolling:"yes",src:this.props.url,id:"insync-iframe"})))))}}])&&Ve(t.prototype,n),i&&Ve(t,i),Object.defineProperty(t,"prototype",{writable:!1}),s}(r.wA);function Ze(e){return Ze="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ze(e)}function Qe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function et(e,t){return et=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},et(e,t)}function tt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=it(e);if(t){var i=it(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return nt(this,n)}}function nt(e,t){if(t&&("object"===Ze(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return rt(e)}function rt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function it(e){return it=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},it(e)}var ot=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&et(e,t)}(s,e);var t,n,i,o=tt(s);function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=o.call(this,e)).bubbles=[],t.endSessionClicked=t.endSessionClicked.bind(rt(t)),t.endSession=t.endSession.bind(rt(t)),t.btnClicked=t.btnClicked.bind(rt(t)),t.assignViewElements=t.assignViewElements.bind(rt(t)),t.closeBtnClicked=t.closeBtnClicked.bind(rt(t)),t.openExtUrl=t.openExtUrl.bind(rt(t)),t.paddingTop=2*l().HEADER_HEIGHT,t.state={showError:!1,userFeedback:"",userComment:"",selectedUpIcon:"thumbs_up_white_bg.png",selectedDownIcon:"thumbs_down_white_bg.png"},t.errHeader="Oh Snap!",void 0!==l().ERROR_HEADER&&(t.errHeader=l().ERROR_HEADER),t.errMsg="An error has occured while trying to connect. Please try again in sometime.",void 0!==l().ERROR_MESSAGE&&(t.errMsg=l().ERROR_MESSAGE),t}return t=s,n=[{key:"assignViewElements",value:function(){if(this.displayModal,"endChatView"==this.props.modalType&&(this.displayModal="insyncEndSessionView"),"feedbackView"==this.props.modalType&&(this.displayModal="insyncCaptureFeedbackView"),"modalView"==this.props.modalType&&(this.displayModal="insyncDefaultModalView"),"reengageView"==this.props.modalType&&(this.displayModal="insyncReengageView"),"uploadAttachmentView"==this.props.modalType&&(this.displayModal="insyncUploadView"),"showLoaderView"==this.props.modalType&&(this.displayModal="insyncShowLoaderView"),"initialLoadingView"==this.props.modalType&&(this.displayModal="insyncInitialLoadingView"),"iFrameView"==this.props.modalType&&(this.displayModal="insynciFrameView"),"connected"==this.props.agentConnectionStatus?this.viewTitle=(0,r.h)("div",{className:"insyncModalTitle insyncModalEndSessionTitle"},(0,r.h)("div",null,"Exiting will end this session with the Live Agent."),(0,r.h)("strong",null,"Do you still wish to exit?")):this.viewTitle=(0,r.h)("div",{className:"insyncModalTitle insyncModalEndSessionTitle"},"Are you sure you want to end this chat?"),"insyncExternalLinkPopoutView"==this.props.modalType){this.displayModal="insyncExternalLinkPopoutView";var e="Certainly! We have a page on shopDisney for that topic. Choose 'Continue' to view it on shopDisney or click 'Cancel' to stay in the chat. \n\nYou can return here any time for more assistance.";""!=l().LINK_POPOUT_CONFIRMATION_TEXT&&(e=l().LINK_POPOUT_CONFIRMATION_TEXT),this.viewTitle=(0,r.h)("div",{className:"insyncModalTitle insyncExternalLinkPopoutModalTitle"},(0,r.h)("div",null,e))}}},{key:"endSessionClicked",value:function(e){"yes"==e?"closed"==this.props.sessionStatus||"bot"==this.props.sessionWith&&!l().CSAT_FOR_BOT_SESSIONS_ENABLED||"agent"==this.props.sessionWith&&!l().CSAT_FOR_AGENT_SESSIONS_ENABLED?this.props.userEndedSession({}):this.setState({displayModal:"insyncCaptureFeedbackView"}):"no"==e&&this.props.closeUrl()}},{key:"closeBtnClicked",value:function(){this.props.closeWindow()}},{key:"openExtUrl",value:function(e){this.props.closeUrl(),window.open(e,"_target")}},{key:"endSession",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={},n="bot";e.sdk_user_ended_session&&(n="user"),this.props.userEndedSession(t,n,e)}},{key:"btnClicked",value:function(e){if(e.hasOwnProperty("payload")&&e.payload.includes("sdk_action"))switch(e.payload){case"sdk_action_end_chat":this.endSession({sdk_user_ended_session:!0});break;case"sdk_action_exit_agent_queue":this.endSession({sdk_user_exit_agent_queue:!0});break;case"sdk_action_user_exit_agent_queue_and_leave_message":this.endSession({sdk_user_exit_agent_queue_and_leave_message:!0});break;case"sdk_action_close_window":this.closeBtnClicked();break;case"sdk_action_post_back":this.props.sendPayload(e);break;case"sdk_action_show_view":this.setState({viewName:e.show_view})}else e.hasOwnProperty("type")&&"user_message_log"==e.type&&this.props.sendPayload(e)}},{key:"render",value:function(){var e=this;this.assignViewElements();var t=!0;"insyncShowLoaderView"==this.displayModal&&(t=!1);var n=this.props.height+l().SCREEN_HEIGHT_EXCEPT_BODY,i=380;return"insyncEndSessionView"==this.displayModal?i=140:"insyncCaptureFeedbackView"==this.displayModal?i=this.props.height:"insynciFrameView"==this.displayModal?i=this.props.height+l().SCREEN_HEIGHT_EXCEPT_BODY-this.paddingTop:"insyncInitialLoadingView"==this.displayModal&&(t=!1,i=this.props.height),u().it("\n      #insync-modal{\n        position: absolute; /* Stay in place */\n        z-index: 999; /* Sit on top */\n        top: 0px;\n        width: 100%; /* Full width */\n        height: 100%; /* Full height */\n        overflow: hidden; /* Enable scroll if needed */\n        background-color: ".concat(t?"rgba(129, 129, 129, 0.5)":"none",";\n      }\n      .insyncModalBody{\n        max-height: inherit;\n        //padding-top: ").concat(this.paddingTop,"px;\n        width:").concat("insyncCaptureFeedbackView"==this.displayModal?"100%":"98%",";\n\n        margin: 0 auto;\n        position: relative;\n        height: ").concat(n,"px;\n        overflow: hidden;\n      }\n      .insyncModalContent {\n        background-color: #fff;\n        margin-top:0px;\n        width: 98%; /* Could be more or less, depending on screen size */\n        height: ").concat(i,"px;\n        border: none;\n        box-shadow: none;\n        border-radius: ").concat(window.shopInSync.styleGuide.chatBoxBorderRadius,"px;\n        padding: 20px;\n        box-sizing: border-box;\n        text-align: center;\n        position: fixed;\n        bottom: 7px !important;\n        height: 0px;\n        transform: translateY(10px);\n        transition: height 5s;\n        animation: .5s ease-in slidein;\n      }\n      @keyframes slidein {\n        from {\n          transform: translateY(100%);\n          bottom: 100%\n          \n        }\n        to {\n          transform: translateY(0%);\n          bottom: 0%\n        }\n      }\n\n      .insyncInitialLoadingView {\n        height: ").concat(i-30,"px;\n        display: ").concat("insyncInitialLoadingView"==this.displayModal?"initial":"none",";\n        top: ").concat(l().HEADER_HEIGHT+20,"px !important;\n        border-radius: 0px;\n        animation: none;\n      }\n      .insyncShowLoaderView {\n        position: relative !important;\n        height: ").concat(n-l().HEADER_HEIGHT,"px;\n        bottom: 0px !important;\n        width: 100% !important;\n        margin-top: ").concat(l().HEADER_HEIGHT,"px;\n        border-top-left-radius: 0px;\n        border-top-right-radius: 0px;\n      }\n      .insyncShowLoaderViewWrapper {\n        position: absolute;\n        top: 0;\n        bottom: 0;\n        right: 0;\n        left: 0;\n        margin: auto;\n        display: ").concat("insyncShowLoaderView"==this.displayModal?"inline-block":"none",";\n        height: 250px;   \n      }\n      .insyncShowLoaderViewMessage{\n        border-radius: ").concat(window.shopInSync.styleGuide.chatBoxBorderRadius,"px;\n        display: ").concat("insyncShowLoaderView"==this.displayModal?"inline-block":"none",";\n        // border:  ").concat(l().BUTTON_BORDER,";\n        width: 70%;\n        margin: 0 auto;\n        border-left-width: ").concat(l().BUTTON_STYLE.borderWidth,";\n        border-right-width: ").concat(l().BUTTON_STYLE.borderWidth,";\n        border-bottom-width: ").concat(l().BUTTON_STYLE.borderWidth,";\n        //height: 36px;\n        cursor: pointer;\n        //font-weight: ").concat(l().BUTTON_FONT_WEIGHT,";\n        background-color: ").concat(l().CHAT_BODY_BACKGORUND_COLOR,";\n        padding: 15px;   \n        margin-bottom: ").concat(l().BUTTON_STYLE.marginBottom,";\n        box-shadow: rgb(8 8 8 / 10%) 2px 6px 13px;\n        font-size: 18px;\n        line-height: 30px;\n      }\n      .insyncErrorIcon {\n        height: 30px;\n      }\n      .insyncShowLoaderViewMessageHeader{\n        font-size: 24px;\n        margin-bottom: 5px;\n        color: #7b7b7b;\n        margin-top: 5px;\n      }\n      .insyncShowLoaderViewMessageText{\n        color: #b4b4b4;\n      }\n      .insyncDefaultModalView {\n        display: ").concat("insyncDefaultModalView"==this.displayModal?"initial":"none",";\n        height: ").concat(l().DEFAULT_MODAL_VIEW_HEIGHT,"px;\n      }\n      .insynciFrame {\n        height: ").concat(n,"px;\n        display: ").concat("insynciFrameView"==this.displayModal?"initial":"none",";\n      }\n      .insynciFrameView {\n        display: ").concat("insynciFrameView"==this.displayModal?"none":"initial",";\n      }\n      // .insyncExternalLinkPopout {\n      //   display: ").concat("insyncExternalLinkPopoutView"==this.displayModal?"initial":"none",";\n      // }\n      .insyncExternalLinkPopoutView {\n        position: absolute !important;\n        top: 50% !important;\n        left: 50% !important;\n        transform: translate(-50%, -50%) !important;\n        min-width: 320px;\n        width: 70%;\n        height: 240px;\n      }\n      .insyncEndSessionView {\n        position: absolute !important;\n        top: 50% !important;\n        left: 50% !important;\n        transform: translate(-50%, -50%) !important;\n        min-width: 320px;\n        width: 70%;\n        height: 160px;\n      }\n      .insyncCaptureFeedbackView {\n        bottom: 0px !important;\n        width: 100% !important;\n        height: ").concat(l().FEEDBACK_MODAL_VIEW_HEIGHT,"px;\n      }\n      .insync-modal-btn-wrapper{\n        padding-top:25px;\n        padding-bottom:25px;\n      }\n      .insyncModalTitle{\n        font-size:15px;\n        font-weight: 500;\n        color: ").concat(l().MODAL_TITLE_COLOR,";\n      }\n      .insyncExternalLinkPopoutModalTitle{\n        line-height: 20px;\n        color: ").concat(l().CHAT_BODY_TEXT_LEFT_COLOR,";\n        font-size:15px;\n        white-space: pre-line;\n        font-weight: initial;\n      }\n      .insyncModalEndSessionTitle{\n        height: 54px;\n      }\n      .insyncCaptureFeedback{\n        //display: ").concat("insyncCaptureFeedbackView"==this.displayModal?"inline-block":"none",";\n        text-align: initial;\n        margin: 0 auto;\n        width: 100%;\n        height: 300px;\n      }\n      .insyncReengageView{\n        height: ").concat(l().REENGAGE_MODAL_VIEW_HEIGHT,"px;\n      }\n      .insyncCenterBtnsWrapper{\n        text-align: center;\n      }\n      ::-webkit-resizer {\n        display: none;\n      }\n      \n\t  "),(0,r.h)("div",{id:"insync-modal"},(0,r.h)("div",{className:"insynciFrame"},"insyncExternalLinkPopoutView"!=this.displayModal&&(0,r.h)(Je,{closeUrl:this.props.closeUrl,url:this.props.url,origUrl:this.props.origUrl,isMobile:this.props.isMobile,width:"100%",height:this.props.height})),(0,r.h)("div",{className:"insyncModalBody"},(0,r.h)("div",{className:"insyncModalContent ".concat(this.displayModal)},"insyncInitialLoadingView"==this.displayModal&&(0,r.h)(We.Z,{source:"modal"}),"insyncShowLoaderView"==this.displayModal&&(0,r.h)("div",{className:"insyncShowLoaderViewWrapper"},(0,r.h)("div",{className:"insyncShowLoaderViewText"},this.props.error.message),(0,r.h)("div",{className:"insyncShowLoaderViewMessage"},(0,r.h)("img",{className:"insyncErrorIcon",src:l().ERROR_ICON}),(0,r.h)("div",{className:"insyncShowLoaderViewMessageHeader"},this.errHeader),(0,r.h)("span",{className:"insyncShowLoaderViewMessageText"},this.errMsg),(0,r.h)("br",null),(0,r.h)(ge,{btnClick:function(){return e.closeBtnClicked()},btnTitle:"Close",classStyleName:"insyncLoaderViewCloseBtn"}))),"insyncExternalLinkPopoutView"==this.displayModal&&(0,r.h)("div",{className:"insyncExternalLinkPopout"},this.viewTitle,(0,r.h)("div",{className:"insync-modal-btn-wrapper"},(0,r.h)(ge,{btnClick:function(){return e.openExtUrl(e.props.url)},btnTitle:"Continue"}),(0,r.h)(ge,{btnClick:function(){return e.props.closeUrl()},btnTitle:"Cancel"}))),"insyncEndSessionView"==this.displayModal&&(0,r.h)("div",{className:"insyncEndSession"},this.viewTitle,(0,r.h)("div",{className:"insync-modal-btn-wrapper"},(0,r.h)(ge,{btnClick:function(){return e.endSessionClicked("no")},btnTitle:"Cancel"}),(0,r.h)(ge,{btnClick:function(){return e.endSessionClicked("yes")},btnTitle:"End"}))),"insyncCaptureFeedbackView"==this.displayModal&&(0,r.h)("div",{className:"insyncCaptureFeedback"},(0,r.h)(Te,{showView:this.props.showView,updateMessage:this.updateMessage,height:this.props.height,width:this.props.width,sessionWith:this.props.sessionWith,userEndedSession:this.props.userEndedSession})),"insyncReengageView"==this.displayModal&&(0,r.h)("div",{className:"insyncReengageWrapper"},(0,r.h)(Le,{showView:this.props.showView,updateMessage:this.updateMessage,height:this.props.height,width:this.props.width,sessionWith:this.props.sessionWith,endSession:this.endSession,btnClicked:this.btnClicked})),"insyncDefaultModalView"==this.displayModal&&(0,r.h)(Ge,{showView:this.props.showView,updateMessage:this.updateMessage,height:this.props.height,width:this.props.width,sessionWith:this.props.sessionWith,endSession:this.endSession,btnClicked:this.btnClicked,viewName:this.state.viewName})))))}}],n&&Qe(t.prototype,n),i&&Qe(t,i),Object.defineProperty(t,"prototype",{writable:!1}),s}(r.wA);function st(e){return st="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},st(e)}function at(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ut(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?at(Object(n),!0).forEach((function(t){yt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):at(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ct(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function lt(e,t){return lt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},lt(e,t)}function dt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ht(e);if(t){var i=ht(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return ft(this,n)}}function ft(e,t){if(t&&("object"===st(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return pt(e)}function pt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ht(e){return ht=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ht(e)}function yt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var vt=(0,o.lazy)((function(){return Promise.all([n.e(416),n.e(531)]).then(n.bind(n,5587))})),mt=(0,o.lazy)((function(){return n.e(680).then(n.bind(n,7890))})),gt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&lt(e,t)}(c,e);var t,n,i,a=dt(c);function c(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),yt(pt(t=a.call(this,e)),"screenWidth",void 0),yt(pt(t),"screenHeight",void 0),yt(pt(t),"scrollToEnd",(function(){t.messagesEnd&&t.messagesEnd.scrollIntoView&&t.messagesEnd.scrollIntoView({behavior:"smooth"})})),yt(pt(t),"getTotalHeight",(function(e,n){for(var r in t.heightByIndex[e]=n,t.recentMessageResponseHeight=0,t.heightByIndex)t.recentMessageResponseHeight+=t.heightByIndex[r];t.recentMessageResponseHeight+=20}));var n=!1,r=!1,i=!0;t.headerTitle=l().CHAT_HEADER_TEXT,"web"!=t.props.deviceType&&(n=!0,r=!1,i=!1),t.state={isMessageDisplayed:!1,showChat:n,showSpinner:r,showHeader:i,inputVal:"",numOfBubbleRows:1,windowHeight:window.innerHeight,windowStyle:window.shopInSync.windowStyle},t.isMobile=!1,t.isTyping=!1,t.showBubble=!0,t.messageCount=0,t.isLastMessage=!1,t.oldMsgCount=0,t.isAgent=!1,t.isAgent=window.shopInSync.isAgent,t.onTap=t.onTap.bind(pt(t)),t.showModalView=t.showModalView.bind(pt(t)),t.sendPayload=t.sendPayload.bind(pt(t)),t.userEndedSession=t.userEndedSession.bind(pt(t)),t.sendMessage=t.sendMessage.bind(pt(t)),t.sendAttachment=t.sendAttachment.bind(pt(t)),t.updateMessage=t.updateMessage.bind(pt(t)),t.openUrl=t.openUrl.bind(pt(t)),t.closeUrl=t.closeUrl.bind(pt(t)),t.title=document.title,t.checkFocus=t.checkFocus.bind(pt(t)),t.updateFevicon=t.updateFevicon.bind(pt(t)),t.faviconLink="",t.onInputBlur=t.onInputBlur.bind(pt(t)),t.handleScroll=t.handleScroll.bind(pt(t)),t.windowWidth=window.innerWidth,t.messageCountAfterComponentUpdate=0,t.getEndElement=t.getEndElement.bind(pt(t)),t.setSentMessageAsNode=t.setSentMessageAsNode.bind(pt(t)),t.updateRows=t.updateRows.bind(pt(t)),t.scrollToBottom=t.scrollToBottom.bind(pt(t)),t.sendPreChatform=t.sendPreChatform.bind(pt(t)),t.logDataAndPerformAction=t.logDataAndPerformAction.bind(pt(t)),t.openExtLinkConfirmation=t.openExtLinkConfirmation.bind(pt(t)),t.toggleWindowStyle=t.toggleWindowStyle.bind(pt(t)),t.closeWindow=t.closeWindow.bind(pt(t)),t.minimizeWindow=t.minimizeWindow.bind(pt(t)),t.updateUserPreference=t.updateUserPreference.bind(pt(t)),t.sessionDataArgs=null,t.setHeaderTitle=t.setHeaderTitle.bind(pt(t)),t.topTimerFunc=t.topTimerFunc.bind(pt(t)),t.hasAnyMessageSentRecently=!1,t.lastMessageSentIndex=0,t.heightToAdjust=0,t.recentMessageResponseHeight=0,t.heightByIndex={},t.topTimer=0;var o=document.querySelector("link[rel*='icon']")||document.createElement("link");void 0!==o.href&&(t.faviconLink=o.href);var u=pt(t);return window.shopInSync.showChat=function(){u.onTap()},window.shopInSync.sendSessionData=function(e){if(u.props&&u.props.myself&&u.props.myself!=l().DEFAULT_USER_ID){var t;e=JSON.parse(e),void 0!==window.shopInSync.user_id&&(t=window.shopInSync.user_id),void 0!==window.shopInSync.userId&&(t=window.shopInSync.userId);var n=(0,de.h)(window.shopInSync.market,window.shopInSync.env,t,window.shopInSync.isAgent),r={event_type:e.eventType,ext_user_id:n,channel_id:window.shopInSync.channel_id,market:window.shopInSync.market,data:e.data};(0,s.d)(r,"trackEvents")}else u.sessionDataArgs=e},window.shopInSync.showNewConversation=function(e,t){u.props.dispatch((0,s.KH)(e,t))},window.onfocus=function(){document.title=u.title},"ios"==t.props.deviceType&&t.props.dispatch((0,s.BL)()),(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|ipad|iris|kindle|Android|Silk|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(navigator.userAgent)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(navigator.userAgent.substr(0,4)))&&(t.isMobile=!0),u=pt(t),window.addEventListener("resize",(function(){void 0!==this.bodyElement&&(this.chatBodyHeight=this.bodyElement.clientHeight),u.setState({windowHeight:window.innerHeight})}),!1),t}return t=c,n=[{key:"updateUserPreference",value:function(e){this.props.dispatch((0,s.Bc)(e))}},{key:"updateFevicon",value:function(e){var t=document.querySelector("link[rel*='icon']")||document.createElement("link");t.type="image/x-icon",t.rel="shortcut icon",t.href=e,document.getElementsByTagName("head")[0].appendChild(t)}},{key:"minimizeWindow",value:function(){this.setState({showChat:!1,showModal:!1}),void 0!==window.shopInSync.hideIframe&&window.shopInSync.hideIframe()}},{key:"logDataAndPerformAction",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"trackEvents",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=e.data,i=e.url,o=e.action;(void 0!==n.urlParams||Object.keys(r).length>0)&&(0,s.d)(r,t,n),"openUrlAtSource"==o&&(void 0!==window.shopInSync.openUrlAtSource?(setTimeout(window.shopInSync.openUrlAtSource(i),300),i.includes("http")&&this.minimizeWindow()):setTimeout("window.location='"+i+"'",300))}},{key:"openExtLinkConfirmation",value:function(e,t){this.setState({showModal:!0,modalType:"insyncExternalLinkPopoutView",showUrl:e,origUrl:t})}},{key:"checkFocus",value:function(){document.hasFocus()?(document.title=this.title,this.messageCount=this.props.messages.length):this.messageCount>1&&this.props.messages.length>this.messageCount&&(document.title="("+(this.props.messages.length-this.messageCount)+") "+this.title,l().SOUND_FEATURE_ENABLED&&this.props.isSoundNotificationOn&&"user"!=this.props.messages[this.props.messages.length-1].senderType&&new Audio(l().SOUND_FILE_URL).play())}},{key:"setHeaderTitle",value:function(e){["agent","system"].includes(e.senderType)&&this.headerTitle!==e.senderName&&(this.headerTitle=e.senderName)}},{key:"topTimerFunc",value:function(e,t){this.hasAnyMessageSentRecently=!1,this.heightByIndex={}}},{key:"componentWillReceiveProps",value:function(e){var t=this;if(void 0!==e.messages&&e.messages.length>0){if(e.shouldClose)return this.closeUrl(!1),this.setState({showChat:!1}),void(void 0!==window.shopInSync.hideIframe&&window.shopInSync.hideIframe());if(0==this.state.isMessageDisplayed)this.setState({showChat:!0,isMessageDisplayed:!0,showSpinner:!1});else if(e.messages.length>=this.oldMsgCount+1){var n=e.messages.length;this.hasAnyMessageSentRecently&&(e.messages.slice(Math.max(n-7,0)),0!=this.topTimer?clearTimeout(this.topTimer):this.lastMessageSentIndex=n-1,this.topTimer=setTimeout((function(){t.topTimerFunc(e.messages)}),4e3));var r=e.messages[n-1];this.setHeaderTitle(r),void 0!==window.shopInSync.isAgent&&1==window.shopInSync.isAgent||(r.sender.indexOf(this.props.myself)<0?this.isTyping=!1:this.isTyping=!0,r.body.type&&["system_message_info","user_message_log"].includes(r.body.type)&&(this.isTyping=!1),e.sessionWith&&"agent"==e.sessionWith&&!l().SHOW_AGENT_TYPING_INDICATOR&&(this.isTyping=!1)),this.isTyping||void 0!==this.typingTimeoutVar&&clearTimeout(this.typingTimeoutVar),setTimeout(this.scrollToBottom(),1e3)}}"function"==typeof window.shopInSync.log&&window.shopInSync.log("MySelf : "+this.props.myself),this.props&&this.props.myself&&this.props.myself!=l().DEFAULT_USER_ID&&null!=this.sessionDataArgs&&(window.shopInSync.sendSessionData(this.sessionDataArgs),this.sessionDataArgs=null)}},{key:"componentDidMount",value:function(){"function"==typeof window.shopInSync.webAppMounted&&window.shopInSync.webAppMounted("componentDidMount Called"),window.shopInSync.envArgs.isVoiceFeatureEnabled&&(void 0===navigator.mediaDevices&&(navigator.mediaDevices={}),void 0===navigator.mediaDevices.getUserMedia&&(navigator.mediaDevices.getUserMedia=function(e){var t=navigator.webkitGetUserMedia||navigator.mozGetUserMedia;if(!t){alert("FATAL Error: getUserMedia is not implemented in this browser");var n={isVoiceInput:!1,doesBrowserSupportsMedia:!1};return this.props.dispatch(this.props.toggledInput(n.isVoiceInput,n.doesBrowserSupportsMedia)),Promise.reject(new Error("getUserMedia is not implemented in this browser"))}return new Promise((function(n,r){t.call(navigator,e,n,r)}))}))}},{key:"componentWillUnmount",value:function(){}},{key:"chatBoxMounted",value:function(e){e&&(this.chatBoxme=e,e.addEventListener("scroll",this.handleScroll.bind(this)))}},{key:"onInputBlur",value:function(){this.setState((function(e){return{windowHeight:e.windowHeight}}))}},{key:"handleScroll",value:function(e){var t=e.target;t.scrollHeight,t.scrollTop,t.clientHeight,this.isLastMessage&&this.forceUpdate()}},{key:"componentDidUpdate",value:function(){this.props.messages.length>this.messageCountAfterComponentUpdate&&(this.messageCountAfterComponentUpdate=this.props.messages.length,this.scrollToBottom()),window.shopInSync.selectedWindowStyle!=window.shopInSync.styleGuide.windowStyle&&this.scrollToBottom()}},{key:"sendMessage",value:function(e){var t=(" "+e+" ").replace(/^[ ](\d{4}[-. ]){4}|^[ ]\d{4}[-. ]\d{6}[-. ]\d{5}[ ]$/gim,"****-****-****-****").replace(/(^[ ]\d{3}[-. ]\d{2}[-. ]\d{4}[ ]$)/gim,"***-**-****");t=t.replace(/^\s+|\s+$/g,""),this.isTyping=!0,this.hasAnyMessageSentRecently=!0,this.lastMessageSentIndex=this.props.messages.length,void 0!==this.typingTimeoutVar&&clearTimeout(this.typingTimeoutVar);var n=this;this.typingTimeoutVar=setTimeout((function(){n.isTyping=!1,n.forceUpdate()}),15e3),void 0!==window.shopInSync.sendMessage?window.shopInSync.sendMessage(t):this.props.dispatch(this.props.sendMessage(t))}},{key:"sendAttachment",value:function(e){this.props.dispatch(this.props.sendAttachment(e)),this.closeUrl()}},{key:"updateMessage",value:function(e,t){this.props.dispatch(this.props.updateMessage(JSON.stringify(e),t))}},{key:"onTap",value:function(){this.props.isStarted?this.state.showChat?this.minimizeWindow():this.setState({showChat:!0,showModal:!1}):(this.props.dispatch((0,s.BL)()),l().PRE_CHAT_WELCOME_SCREEN_ENABLED?this.setState({showChat:!0,showModal:!1}):this.setState({showSpinner:!0,showModal:!1}),this.messageCountAfterComponentUpdate>0&&(this.messageCountAfterComponentUpdate=0),void 0!==this.messagesEnd&&(this.messagesEnd=void 0))}},{key:"retryClientStart",value:function(){this.props.dispatch((0,s.rQ)(!0,{source:"",type:"",message:"Trying again...Please Wait..."})),this.props.dispatch((0,s.BL)())}},{key:"closeWindow",value:function(){this.props.dispatch((0,s.jY)())}},{key:"showModalView",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"user";this.setState({showModal:!0,modalType:e,sessionEndedBy:t})}},{key:"userEndedSession",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.props.dispatch((0,s.TM)(e,t,n))}},{key:"toggleWindowStyle",value:function(e){e&&window.shopInSync.styleGuide.windowStyle!=e&&(this.setState({windowStyle:e}),window.shopInSync.styleGuide=ut(ut({},window.shopInSync.styleGuide),window.shopInSync.windowStyles[e]))}},{key:"scrollToBottom",value:function(){var e=(0,o.findDOMNode)(this.messagesEnd);if(void 0===e||null==e||"function"!=typeof e.scrollIntoView)return void 0!==this.scroller&&clearTimeout(this.scroller),void(this.scroller=setTimeout(this.scrollToBottom,400));if(this.hasAnyMessageSentRecently)if(this.chatBodyHeight>this.recentMessageResponseHeight){var t=(0,o.findDOMNode)(this.bodyBottonElm);t&&t.scrollIntoView({behavior:"smooth",block:"end"})}else e.scrollIntoView(!0);else setTimeout(this.scrollToEnd,500)}},{key:"sendPayload",value:function(e){this.hasAnyMessageSentRecently=!0,this.lastMessageSentIndex=this.props.messages.length,void 0!==window.shopInSync.sendMessage?window.shopInSync.sendMessage(JSON.stringify(e)):this.props.dispatch(this.props.sendMessage(JSON.stringify(e)))}},{key:"openUrl",value:function(e,t){this.setState({showModal:!0,modalType:"iFrameView",showUrl:e,origUrl:t})}},{key:"closeUrl",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];delete this.state.showUrl,delete this.state.showModal,e&&this.setState(ut({},this.state))}},{key:"sendPreChatform",value:function(e){this.props.dispatch((0,s.S0)(e))}},{key:"updateRows",value:function(e){this.setState({numOfBubbleRows:e}),setTimeout(this.scrollToBottom(),500)}},{key:"getEndElement",value:function(e){this.hasAnyMessageSentRecently?this.bodyBottonElm=e:this.messagesEnd=e}},{key:"setSentMessageAsNode",value:function(e){this.hasAnyMessageSentRecently&&(this.messagesEnd=e)}},{key:"renderMessenger",value:function(){var e=this;if(l().PRE_CHAT_WELCOME_SCREEN_ENABLED&&this.props.isStarted||!l().PRE_CHAT_WELCOME_SCREEN_ENABLED&&this.props.messages.length>0){this.checkFocus();var t=this.state.modalType;this.props.showLoaderView&&(t="showLoaderView");var n=!1;void 0!==this.props.showView&&""!=this.props.showView.viewName&&(n=!0,t=this.props.showView.viewName);var i=!1,s=this.props.messages.length,a="",u="",c="",d=this,f=this.props.messages.map((function(t,l){l==s-1&&(i=!0);var f=(0,r.h)(o.Suspense,null,(0,r.h)(vt,{msg:t,openExtLinkConfirmation:e.openExtLinkConfirmation,logDataAndPerformAction:e.logDataAndPerformAction,updateRows:e.updateRows,numRows:e.state.numOfBubbleRows,myself:e.props.myself,isAgent:e.isAgent,openUrl:e.openUrl,sendPayload:e.sendPayload,updateMessage:e.updateMessage,deviceType:e.props.deviceType,isLastMessage:i,width:e.screenWidth,prevMsgSender:a,prevMsgSenderName:u,prevMsgType:c,showModalView:e.showModalView,needToShowView:n,sendElementHeight:l>d.lastMessageSentIndex?function(e){return d.getTotalHeight(l,e)}:void 0,ref:function(e){l==d.lastMessageSentIndex&&d.setSentMessageAsNode(e)}}));return a=t.sender.indexOf(e.props.myself)>=0?"user":"system",u=t.sender.indexOf(e.props.myself)>=0?"":t.senderName,c=t.type,f}));this.oldMsgCount=s;var p="insyncTypingWrapper";l().SHOW_SYSTEM_ICON||(p="insyncTypingWrapperWithoutIcon");var h=this.props.showPreChat;return l().SHOW_PRECHAT_FORM_USER_NAME||l().SHOW_PRECHAT_FORM_USER_EMAIL||(h=!1),(0,r.h)("div",{id:"insyncChatbox",className:"insyncChatBox ".concat(this.state.showChat?"":"insyncHideChat"),ref:function(e){d.chatBoxme=e}},(0,r.h)(E,{deviceType:this.props.deviceType,isMobile:this.isMobile,width:this.screenWidth,isAgent:this.isAgent,toggleChat:this.onTap,showModalView:this.showModalView,toggleWindowStyle:this.toggleWindowStyle,showViewName:this.props.showView.viewName}),this.state.showModal||this.props.showLoaderView||n?(0,r.h)(ot,{closeUrl:this.closeUrl,isMobile:this.isMobile,width:this.screenWidth,height:this.screenHeight,agentConnectionStatus:this.props.agentConnectionStatus,userEndedSession:this.userEndedSession,closeWindow:this.closeWindow,modalType:t,sendAttachment:this.sendAttachment,sessionStatus:this.props.sessionStatus,sessionEndedBy:this.state.sessionEndedBy,sessionWith:this.props.sessionWith,url:this.state.showUrl,origUrl:this.state.origUrl,error:this.props.error,logDataAndPerformAction:this.logDataAndPerformAction,showView:this.props.showView,updateMessage:this.updateMessage,sendPayload:this.sendPayload}):"",h?(0,r.h)(o.Suspense,null,(0,r.h)(mt,{sendPreChatform:this.sendPreChatform,isMobile:this.isMobile,height:this.screenHeight})):"",(0,r.h)("div",{className:"insyncChatBody",ref:function(t){e.bodyElement=t,d=e,t&&setTimeout((function(){d.chatBodyHeight=d.bodyElement.clientHeight}),100)}},(0,r.h)("div",{className:"insyncChat insyncShowChat",onScroll:this.handleScroll,ref:function(e){return d.chat=e}},f,this.isTyping?(0,r.h)("div",{className:p},(0,r.h)(le,{systemSenderName:this.props.systemSenderName})):"",(0,r.h)("div",{style:{float:"left",clear:"both",height:"0px"},ref:function(e){d.getEndElement(e)},id:"endElementToScroll"}))),(0,r.h)(X,{sendMessage:this.sendMessage,onInputBlur:this.onInputBlur,width:this.screenWidth,isAgent:this.isAgent,showModalView:this.showModalView,isMobile:this.isMobile,updateUserPreference:this.updateUserPreference,isSoundNotificationOn:this.props.isSoundNotificationOn}),(0,r.h)(re,null))}return this.props.shouldClose?"":(0,r.h)("div",{className:"insyncSpinner  ".concat(this.state.showSpinner?"insyncShowSpinner":"insyncHideSpinner"),id:"spinner",ref:function(t){return e.spinner=t}})}},{key:"render",value:function(){var e=this,t=window.shopInSync.styleGuide.bottom,n=0,i=window.shopInSync.styleGuide.right,o=l().SCREEN_POSITION,s=l().CHAT_BOX_TRANSITION,a=l().CHAT_BOX_BORDER_RADIUS,c=l().CHAT_BOX_SHADOW;void 0!==window.shopInSync.isAgent&&window.shopInSync.isAgent&&(s="unset",a=0,c="none"),"web"!==this.props.deviceType?this.screenHeight=window.shopInSync.styleGuide.screenHeight-100:this.screenHeight=window.shopInSync.styleGuide.screenHeight,this.screenWidth=window.shopInSync.styleGuide.screenWidth,"web"===this.props.deviceType&&window.innerWidth<500&&window.innerWidth>0&&(this.screenWidth=window.innerWidth,t=0),window.innerWidth>0&&window.innerWidth<this.screenWidth+i&&(this.screenWidth=window.innerWidth,i=0,t=0),this.state.windowHeight<this.screenHeight+l().SCREEN_HEIGHT_EXCEPT_BODY+t&&(i=0,t=0,this.screenHeight=this.state.windowHeight-(l().SCREEN_HEIGHT_EXCEPT_BODY+t)),"web"!==this.props.deviceType&&(t=0,n=0,i=0);var d=this.renderMessenger(),f=this.props.messages.filter((function(e){return"user"!=e.senderType})),p=f[f.length-1],h=void 0!==p&&"object"===st(p)&&void 0!==p.senderType&&"agent"==p.senderType?l().CHAT_BODY_TEXT_AGENT_LOGO_ICON_URL:l().CHAT_BODY_TEXT_LEFT_LOGO_ICON_URL;return u().it('\n      body{\n        background-color: #a80000;\n      }\n      // .insyncMiddlePart {\n      //   background-color: #a8a7a7;\n      //   height: 800px;\n      //   width: 100%;\n      // }\n      // .insyncBottom {\n      //   background-color: #000;\n      //   height: 80px;\n      //   width: 100%;\n      //\n      // }\n      .insyncTypingWrapper:after {\n          content: " "; \n          display: block;\n          clear: both;\n          padding-bottom: 4px;\n      }\n      .insyncTypingWrapper {\n          background-image: url(\''.concat(h,'\');\n          background-position: left 8px;\n          background-repeat: no-repeat;\n          padding-left: 20px;  \n          //background-size: 30px 33px;   \n          background-size: 25px;\n          margin-bottom: 10px;\n          margin-left: 10px;\n      }\n      .insyncTypingWrapperWithoutIcon {\n          margin-bottom: 10px;\n      }\n      .insyncTypingWrapperWithoutIcon:after {\n          content: " "; \n          display: block;\n          clear: both;\n          padding-bottom: 4px;\n      }\n      button {\n        font-size: ').concat(l().BUTTON_FONT_SIZE,";\n        outline: none !important;\n        //border-radius: 0px!important;\n      }\n      .insyncChatBox {\n\t\t    z-index: 99999999999;\n        font-size: 14px;\n        font-family: ").concat(l().FONT_FAMILY,";\n        font-weight: normal;\n        height:auto;\n        width:100%;\n        max-width: ").concat(this.screenWidth,"px;\n        right:").concat(i,"px;\n        bottom:").concat(t,"px;\n        position: ").concat(o,";\n        float: right;\n        overflow:hidden;\n        border-radius: ").concat(a,"px; \n        transform: translateY(").concat(n,"px);\n        transition: ").concat(s,";\n        box-shadow: ").concat(c,";\n        border: ").concat(l().CHAT_BOX_BORDER_WIDTH,"px solid ").concat(l().CHAT_HEADER_BACKGROUND_GRADIENT_LEFT_COLOR,";\n        box-sizing: border-box;\n      }   \n      .insyncChatBody {\n        max-height:100%;\n        width:100%;\n        background-color:#fff;\n      }\n\n      .insyncShowChat{\n        width:").concat(this.screenWidth,"px;\n        height:").concat(this.screenHeight,"px;\n    \t\toverflow-x:hidden;\n        -webkit-font-smoothing: antialiased;\n      }\n      \n      .insyncHideChat{\n        width:0px;\n        height:0px;\n      }\n      .insyncSpinner {\n        position: ").concat(o,";\n        bottom: 20px;\n        right: 20px;\n        margin: 100px auto;\n    \t\tbackground-image: url(").concat(l().LOADER_URL,");\n    \t\tbackground-repeat: no-repeat;\n    \t\tbackground-size: 25px 25px;\n    \t\tz-index: 99999999999;\n      }\n      .insyncShowSpinner{\n        width:25px;\n        height:25px;\n      }\n      .insyncHideSpinner{\n        width:0px;\n        height:0px;\n      }\n\n      .insyncChat {\n\t\t      padding-top: ").concat(this.isMobile?0:l().CHAT_BODY_PADDING_TOP,"px;\n          box-sizing: border-box;\n          background-color: ").concat(l().CHAT_BODY_BACKGORUND_COLOR,";\n          display: block;\n          position: relative;\n          overflow-y: auto;\n          -webkit-overflow-scrolling: touch;\n          -webkit-box-flex: 1;\n          -webkit-flex-grow: 1;\n              -ms-flex-positive: 1;\n                  flex-grow: 1;\n      }\n      .iphoneHeading {\n        text-align: center;\n        color: #333;\n        font-size: 14px;\n      }\n      // @media (min-width: 300px) and (max-width: 500px) {\n      //   .insyncShowChat{\n      //     width:").concat("web"===this.props.deviceType?window.innerWidth:this.screenWidth,"px;\n      //     height:").concat(this.screenHeight,"px;\n      //     overflow-x:hidden;\n      //     -webkit-font-smoothing: antialiased;\n      //   }\n      //   .insyncChatBox {\n      //     width:").concat("web"==this.props.deviceType?window.innerWidth:this.screenWidth,"px;\n      //     max-width: ").concat("web"==this.props.deviceType?window.innerWidth:this.screenWidth,"px;\n      //     right:").concat("web"==this.props.deviceType?0:i,"px;\n      //     bottom:").concat("web"==this.props.deviceType?0:t,"px;\n      //   }\n      // }\n      "),(0,r.h)("div",{ref:function(t){return e.node=t}},d))}}],n&&ct(t.prototype,n),i&&ct(t,i),Object.defineProperty(t,"prototype",{writable:!1}),c}(r.wA);const bt=(0,i.$j)((function(e,t){return{messages:e.conversation.messages,myself:e.conversation.myself,isStarted:e.conversation.started,showPreChat:e.conversation.showPreChat,shouldClose:e.conversation.close,systemSenderName:e.conversation.systemSenderName,agentConnectionStatus:e.conversation.agentConnectionStatus,endSession:e.conversation.endSession,sessionStatus:e.conversation.sessionStatus,sessionWith:e.conversation.sessionWith,showView:e.conversation.showView,isSoundNotificationOn:e.conversation.isSoundNotificationOn,showLoaderView:e.conversation.showLoaderView,error:e.conversation.error}}),(function(e){return{dispatch:e,sendMessage:s.bG,updateMessage:s.o6,toggledInput:s.gY,sendAttachment:s.WX,clearMessages:s.jY}}))(gt);function _t(e){return _t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_t(e)}function wt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function kt(e,t){return kt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},kt(e,t)}function xt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Et(e);if(t){var i=Et(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return St(this,n)}}function St(e,t){if(t&&("object"===_t(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Et(e){return Et=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Et(e)}var Tt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&kt(e,t)}(s,e);var t,n,i,o=xt(s);function s(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),o.call(this,e)}return t=s,(n=[{key:"render",value:function(){return(0,r.h)("div",{id:"main"},(0,r.h)(bt,{deviceType:this.props.deviceType}))}}])&&wt(t.prototype,n),i&&wt(t,i),Object.defineProperty(t,"prototype",{writable:!1}),s}(r.wA)},8484:(e,t,n)=>{"use strict";n.d(t,{Z:()=>h});var r=n(3931),i=n(8420),o=n.n(i),s=n(2631),a=n.n(s);function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t){return l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},l(e,t)}function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=p(e);if(t){var i=p(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f(this,n)}}function f(e,t){if(t&&("object"===u(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function p(e){return p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},p(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t)}(u,e);var t,n,i,s=d(u);function u(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),s.call(this,e)}return t=u,(n=[{key:"render",value:function(){var e=a().CLIENT_DISPLAY_NAME;return o().it("\n          .insyncInitialLoadingSection{\n            //width: 100%;\n            text-align: center;\n            margin: 0px ".concat("modal"==this.props.source?"0":a().CHAT_BODY_MARGIN_RIGHT,"px 0px ").concat("modal"==this.props.source?"0":a().CHAT_BODY_MARGIN_LEFT,"px;\n          }\n          .insyncInitialLoadingTitle{\n            font-size: 18px;\n            margin-top: 10px;\n          }\n          .insyncInitialLoadingSubTitle{\n            font-style: italic;\n            margin-top: 10px;\n            margin-bottom: ").concat("modal"==this.props.source?"0px":"20px",";\n          }\n          .insyncInitialLoadingClientImg{\n            max-height: 90px;\n          }\n          \n          .insyncInitialLoadingImg{\n            width: '60px';\n          }\n          .insyncClientName {\n            text-transform: capitalize;\n          }\n        "),(0,r.h)("div",{className:"insyncInitialLoadingSection"},(0,r.h)("img",{className:"insyncInitialLoadingClientImg",src:a().ASSETS_URL+"/"+window.shopInSync.market.split("_")[1]+"_business_card.png"}),(0,r.h)("div",{className:"insyncInitialLoadingTitle"},(0,r.h)("span",{className:"insyncClientName"},e)," ",a().CHAT_HEADER_TEXT),(0,r.h)("div",{className:"insyncInitialLoadingSubTitle",dangerouslySetInnerHTML:{__html:a().PRE_CHAT_WELCOME_SCREEN_TEXT}}),"modal"==this.props.source&&(0,r.h)("img",{className:"insyncInitialLoadingImg",src:a().ASSETS_URL+"/progress_indicator.gif"})))}}])&&c(t.prototype,n),i&&c(t,i),Object.defineProperty(t,"prototype",{writable:!1}),u}(r.wA)},2631:module=>{function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){_defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}window.shopInSync.styleGuide={list_style:"default",button_style:"default",card_style:"default",bubble_style:"withoutFang",chatBoxShadow:"rgba(8, 8, 8, 0.35) 20px 20px 25px",chatBoxBorderWidth:0,cardBorderRadius:12,chat_header_height:56,header_title_font_size:16,header_logo_height:30,header_logo_width:30,header_box_shadow:"initial",quick_reply_bubble_radius:5,chat_header_cross_icon:"minimizeIcon",show_system_messages:!1,show_system_icon:!1,show_user_icon:!1,show_toggle_window_icons:!1,user_new_send_icon:"v1",show_prechat_form_user_name:!0,show_prechat_form_user_email:!0,show_feedback_icons:"none",show_poweredby_footer:!0,show_footer_v2:!1,show_footer_v3:!1,custom_send_icon:!1,file_attachment_enabled:!1,end_chat_feature_enabled:!1,sound_feature_enabled:!1,enable_csat_for_va_sessions:!1,enable_csat_for_agent_sessions:!1,handle_load_error:!1,request_timeout:10,enable_ext_link_popout_confirmation:!1,link_popout_confirmation_text:"",input_field_ghost_text:"Type here...",quick_reply_margin_left:5,pre_chat_welcome_screen_enabled:!1,pre_chat_welcome_screen_text:"I can help you with all your questions!",header_title_letter_spacing:"initial",client_display_name:window.shopInSync.market.split("_")[1],show_agent_typing_indicator:!0,chat_user_display_name:"",container_border:"1px solid rgba(0, 0, 0, .10)"},void 0!==window.shopInSync.clientStyleGuide?(window.shopInSync.styleGuide=_objectSpread(_objectSpread({},window.shopInSync.styleGuide),window.shopInSync.clientStyleGuide),window.shopInSync.windowStyles=JSON.parse(JSON.stringify(window.shopInSync.clientStyleGuide.windowStyles))):window.shopInSync.clientStyleGuide={};var buttonStyles={default:{borderRadius:"0px !important",marginBottom:"0px",borderWidth:"0px",buttonContainerBorder:window.shopInSync.styleGuide.container_border,buttonContainerTopMargin:"0px"},rounded:{borderRadius:"20px !important",marginBottom:"10px",borderWidth:"1px",buttonContainerBorder:"none",buttonContainerTopMargin:"8px"}};void 0!==buttonStyles[window.shopInSync.styleGuide.button_style]&&buttonStyles[window.shopInSync.styleGuide.button_style]||(window.shopInSync.styleGuide.button_style="default");var listStyles={default:{listContainerBorder:window.shopInSync.styleGuide.container_border,listTextPaddingLeft:"12px",listTextMarginLeft:"0px",listTextPaddingRight:"12px",listTextMarginRight:"0px",listTextPaddingBottom:"0px",listButtonRightPosition:"20px",listLastElementBorderBottomWidth:"0px",hidelistElementHoverColor:!1},custom:{listContainerBorder:"none",listTextPaddingLeft:"0px",listTextMarginLeft:"12px",listTextPaddingRight:"0px",listTextMarginRight:"12px",listTextPaddingBottom:"0px",listButtonRightPosition:"2px",buttonContainerBorder:"none",listLastElementBorderBottomWidth:"1px",hidelistElementHoverColor:!0}},sub_folder_path="";"development"==window.shopInSync.env&&(sub_folder_path="/sdk-assets/development"),"staging"==window.shopInSync.env&&(sub_folder_path="/sdk-assets/staging"),"backoffice_chat_setup_ui"==window.shopInSync.source&&(sub_folder_path="/sdk-assets/draft");var assets_base_url="https://d2c0xhqyhmtkod.cloudfront.net"+sub_folder_path,isMobile=!1;(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|ipad|iris|kindle|Android|Silk|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(navigator.userAgent)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(navigator.userAgent.substr(0,4)))&&(isMobile=!0);var chat_header_height=null!=window.shopInSync.styleGuide.chat_header_height?window.shopInSync.styleGuide.chat_header_height:72,headerHeight=chat_header_height,footerHeight=50;window.shopInSync.styleGuide.show_footer_v3&&(footerHeight=42);var poweredByFooterHeight=10;(window.shopInSync.styleGuide.show_poweredby_footer||window.shopInSync.styleGuide.show_footer_v3)&&(poweredByFooterHeight=24);var poweredby_image=assets_base_url+"/poweredby_insync_logo.png",poweredby_image_height="12px";(window.shopInSync.styleGuide.show_footer_v2||window.shopInSync.styleGuide.show_footer_v3)&&(poweredby_image=assets_base_url+"/poweredby_insync_logo_v2.png",poweredby_image_height="14px",window.shopInSync.styleGuide.show_poweredby_footer||window.shopInSync.styleGuide.show_footer_v3||(poweredByFooterHeight=0));var screen_height_except_body=headerHeight+footerHeight+poweredByFooterHeight;for(var windowStyleKey in window.shopInSync.windowStyles){if("tall"==windowStyleKey){var windowStyleTop=void 0!==window.shopInSync.windowStyles[windowStyleKey].top?window.shopInSync.windowStyles[windowStyleKey].top:0;window.shopInSync.windowStyles[windowStyleKey].screenHeight=window.innerHeight-(headerHeight+footerHeight+window.shopInSync.windowStyles[windowStyleKey].bottom+windowStyleTop)+2}else window.shopInSync.windowStyles[windowStyleKey].screenHeight=window.shopInSync.windowStyles[windowStyleKey].screenHeight-(headerHeight+footerHeight);window.shopInSync.windowStyles[windowStyleKey].screenHeight-=poweredByFooterHeight}var windowStyle="regular";window.shopInSync.clientStyleGuide.windowStyle&&(windowStyle=window.shopInSync.clientStyleGuide.windowStyle),void 0!==window.shopInSync.styleGuide.chatBoxBorderRadius&&(window.shopInSync.windowStyles[windowStyle].chatBoxBorderRadius=window.shopInSync.styleGuide.chatBoxBorderRadius);var chatBoxShadow=window.shopInSync.styleGuide.chat_box_shadow;window.shopInSync.styleGuide.chatBoxShadow&&(chatBoxShadow=window.shopInSync.styleGuide.chatBoxShadow),window.shopInSync.windowStyles[windowStyle].chatBoxShadow=chatBoxShadow,window.shopInSync.styleGuide=_objectSpread(_objectSpread({},window.shopInSync.styleGuide),window.shopInSync.windowStyles[windowStyle]),isMobile&&(window.shopInSync.styleGuide.show_toggle_window_icons=!1),void 0!==window.shopInSync.clientStyleGuide.screen_height&&(window.shopInSync.styleGuide.screenHeight=window.shopInSync.clientStyleGuide.screen_height-(headerHeight+footerHeight)),void 0!==window.shopInSync.clientStyleGuide.screen_width&&(window.shopInSync.styleGuide.screenWidth=window.shopInSync.clientStyleGuide.screen_width),void 0!==window.shopInSync.adminClientStyleGuide&&window.shopInSync.adminClientStyleGuide&&(window.shopInSync.styleGuide=_objectSpread(_objectSpread({},window.shopInSync.styleGuide),window.shopInSync.adminClientStyleGuide),window.shopInSync.styleGuide.screenHeight=window.shopInSync.adminClientStyleGuide.screen_height,window.shopInSync.styleGuide.screenWidth=window.shopInSync.adminClientStyleGuide.screen_width);var isIframe=null!=window.shopInSync.contextParams&&null!=window.shopInSync.contextParams.isIframe&&window.shopInSync.contextParams.isIframe;isIframe&&window.shopInSync.contextParams.iframeParentWidth<500&&(window.shopInSync.styleGuide.screenWidth=window.shopInSync.contextParams.iframeParentWidth,isMobile&&(window.shopInSync.styleGuide.screenHeight=window.shopInSync.contextParams.iframeParentHeight-(headerHeight+footerHeight+poweredByFooterHeight)));var width=window.shopInSync.styleGuide.screenWidth,height=window.shopInSync.styleGuide.screenHeight-(headerHeight+footerHeight),selectedStyle=eval("window.shopInSync.windowStyles."+windowStyle),chatBoxBorderRadius=isMobile?0:selectedStyle.chatBoxBorderRadius,chat_box_transition=null!=window.shopInSync.styleGuide.chat_box_transition?window.shopInSync.styleGuide.chat_box_transition:"all 0.5s",bottom=null!=window.shopInSync.styleGuide.bottom?window.shopInSync.styleGuide.bottom:eval("window.shopInSync.windowStyles."+window.shopInSync.clientStyleGuide.windowStyle+".bottom"),right=null!=window.shopInSync.styleGuide.right?window.shopInSync.styleGuide.right:eval("window.shopInSync.windowStyles."+window.shopInSync.clientStyleGuide.windowStyle+".right"),position=null!=window.shopInSync.styleGuide.position?window.shopInSync.styleGuide.position:"fixed",header_bg_gradient_left_color=null!=window.shopInSync.styleGuide.header_bg_gradient_left_color?window.shopInSync.styleGuide.header_bg_gradient_left_color:"#0795e6",header_bg_gradient_right_color=null!=window.shopInSync.styleGuide.header_bg_gradient_right_color?window.shopInSync.styleGuide.header_bg_gradient_right_color:null!=window.shopInSync.styleGuide.header_bg_gradient_left_color?window.shopInSync.styleGuide.header_bg_gradient_left_color:"#0795e6",font_family=null!=window.shopInSync.styleGuide.text_font_family?window.shopInSync.styleGuide.text_font_family:"'Helvetica neue', 'Arial', 'Lucida Grande', 'sans-serif'",header_logo_height=null!=window.shopInSync.styleGuide.header_logo_height?window.shopInSync.styleGuide.header_logo_height+"px":"40px",header_logo_width=null!=window.shopInSync.styleGuide.header_logo_width?window.shopInSync.styleGuide.header_logo_width+"px":"40px",header_title_font_size=null!=window.shopInSync.styleGuide.header_title_font_size?window.shopInSync.styleGuide.header_title_font_size+"px":"22px",header_title_font_weight=null!=window.shopInSync.styleGuide.header_title_font_weight?window.shopInSync.styleGuide.header_title_font_weight:"700",text_msg_font_size=null!=window.shopInSync.styleGuide.text_msg_font_size?window.shopInSync.styleGuide.text_msg_font_size+"px":"16px",btn_text_font_weight=null!=window.shopInSync.styleGuide.btn_text_font_weight?window.shopInSync.styleGuide.btn_text_font_weight:"500",user_text_msg_bg_color=null!=window.shopInSync.styleGuide.user_text_msg_bg_color?window.shopInSync.styleGuide.user_text_msg_bg_color:"#0795e6",quick_reply_padding=null!=window.shopInSync.styleGuide.quick_reply_padding?window.shopInSync.styleGuide.quick_reply_padding:6,system_text_msg_bg_color=null!=window.shopInSync.styleGuide.system_text_msg_bg_color?window.shopInSync.styleGuide.system_text_msg_bg_color:"#F5F4F4",user_text_msg_color=null!=window.shopInSync.styleGuide.user_text_msg_color?window.shopInSync.styleGuide.user_text_msg_color:"#fff",system_text_msg_color=null!=window.shopInSync.styleGuide.system_text_msg_color?window.shopInSync.styleGuide.system_text_msg_color:"black",button_text_color=null!=window.shopInSync.styleGuide.button_text_color?window.shopInSync.styleGuide.button_text_color:user_text_msg_bg_color,button_background_color=null!=window.shopInSync.styleGuide.button_background_color?window.shopInSync.styleGuide.button_background_color:user_text_msg_color,button_hover_text_color=null!=window.shopInSync.styleGuide.button_hover_text_color?window.shopInSync.styleGuide.button_hover_text_color:button_background_color,button_hover_background_color=null!=window.shopInSync.styleGuide.button_hover_background_color?window.shopInSync.styleGuide.button_hover_background_color:button_text_color,quick_reply_bubble_text_color=null!=window.shopInSync.styleGuide.quick_reply_bubble_text_color?window.shopInSync.styleGuide.quick_reply_bubble_text_color:button_text_color,quick_reply_bubble_bg_color=null!=window.shopInSync.styleGuide.quick_reply_bubble_bg_color?window.shopInSync.styleGuide.quick_reply_bubble_bg_color:button_background_color,quick_reply_bubble_hover_text_color=null!=window.shopInSync.styleGuide.quick_reply_bubble_hover_text_color?window.shopInSync.styleGuide.quick_reply_bubble_hover_text_color:button_hover_text_color,quick_reply_bubble_hover_bg_color=null!=window.shopInSync.styleGuide.quick_reply_bubble_hover_bg_color?window.shopInSync.styleGuide.quick_reply_bubble_hover_bg_color:button_hover_background_color,header_title_color=null!=window.shopInSync.styleGuide.header_title_color?window.shopInSync.styleGuide.header_title_color:user_text_msg_color,show_user_icon=null!=window.shopInSync.styleGuide.show_user_icon&&window.shopInSync.styleGuide.show_user_icon,show_system_icon=null!=window.shopInSync.styleGuide.show_system_icon&&window.shopInSync.styleGuide.show_system_icon,bubble_style=null!=window.shopInSync.styleGuide.bubble_style?window.shopInSync.styleGuide.bubble_style:"withFang",chat_body_background_color=null!=window.shopInSync.styleGuide.chat_body_background_color?window.shopInSync.styleGuide.chat_body_background_color:"#fff",chat_user_display_name=null==window.shopInSync.styleGuide.chat_user_display_name?"":window.shopInSync.styleGuide.chat_user_display_name,right_fang_border_radius_key=chat_user_display_name?"border-top-right-radius":"border-bottom-right-radius",quick_reply_bubble_radius=null!=window.shopInSync.styleGuide.quick_reply_bubble_radius?window.shopInSync.styleGuide.quick_reply_bubble_radius+"px":"15px",chat_header_background_image=null!=window.shopInSync.styleGuide.chat_header_bg_image?window.shopInSync.styleGuide.chat_header_bg_image:"",chat_header_title=null!=window.shopInSync.styleGuide.chat_header_title?window.shopInSync.styleGuide.chat_header_title:"Chat Assistant",chat_header_cross_icon=null!=window.shopInSync.styleGuide.chat_header_cross_icon?window.shopInSync.styleGuide.chat_header_cross_icon:"crossIcon",chat_system_display_name=null!=window.shopInSync.styleGuide.chat_system_display_name?window.shopInSync.styleGuide.chat_system_display_name:"Virtual Assistant",show_system_messages=null!=window.shopInSync.styleGuide.show_system_messages&&window.shopInSync.styleGuide.show_system_messages,logo_img_vertical_align=null!=window.shopInSync.styleGuide.logo_img_vertical_align?window.shopInSync.styleGuide.logo_img_vertical_align:"unset",prechat_form_title=null!=window.shopInSync.styleGuide.prechat_form_title?window.shopInSync.styleGuide.prechat_form_title:"Welcome to Secure Live Chat! Please fill in the form below to start chatting!",market=window.shopInSync.market.split("_")[1];void 0!==window.shopInSync.contextParams&&void 0!==window.shopInSync.contextParams.nobrand&&"true"==window.shopInSync.contextParams.nobrand&&(market="nobrand","backoffice_agent"==window.shopInSync.source?void 0===window.shopInSync.styleGuide.chat_header_title&&(chat_header_title="Virtual Agent Assistant"):chat_header_title="Virtual Assistant");var send_icon_url=window.shopInSync.styleGuide.custom_send_icon?assets_base_url+"/"+market+"_send_icon.png":"",system_icon_url=assets_base_url+"/"+market+"_sdk_logo.png";window.shopInSync.styleGuide.hasOwnProperty("sdk_logo_name")&&""!=window.shopInSync.styleGuide.sdk_logo_name&&(system_icon_url=assets_base_url+"/"+market+"_"+window.shopInSync.styleGuide.sdk_logo_name);var user_icon_url=assets_base_url+"/"+market+"_user_icon.png",bot_icon_url=assets_base_url+"/"+market+"_bot_icon.png",agentIconUrl=assets_base_url+"/"+market+"_agent_icon.png",leftIconUrl=bot_icon_url,rightIconUrl=user_icon_url;null!=window.shopInSync.isAgent&&1==window.shopInSync.isAgent&&(leftIconUrl=user_icon_url,rightIconUrl=bot_icon_url);var cardStyles={defaultOld:{styleName:"default",cardWidth:200,cardBorderColor:"rgba(0, 0, 0, .10)",cardBgColor:"transparent",cardBgSize:"contain",cardPaddingLeftRight:"0px",cardTextPaddingLeftRight:"12",cardTextPaddingTopBottom:"7",cardTextMarginBottom:"initial",cardTextSingleLineHeight:18,cardTextMinHeight:44,cardSubTitleFontSize:"inherit",cardSubTitleLineHeight:"inherit",cardSubTitleBgColor:"transparent",cardSubTitleColor:"rgba(0, 0, 0, .40)",cardSubTitlePadding:"initial",cardSubTitleTextPadding:"initial",cardSubtitleMarginTop:4,cardBtnHeight:"inherit",cardBtnPadding:"7px",cardBtnFontSize:"inherit",cardBtnFontWeight:"inherit",cardBtnBgColor:"inherit",cardBtnStyle:"default",cardBtnWidth:"100%",cardBtnMarginBottom:buttonStyles[window.shopInSync.styleGuide.button_style].marginBottom,cardBtnLeftRightPadding:"auto",cardPaddingLeft:"10px",minCardBtns:0,cardImgHolderPadding:"10px",cardScrollArrowStyleName:"default",cardsPaddingTopBottom:7,cardsContainerLeftMargin:0,cardsBackgroundColor:"transparent",cardsPadding:"10px",bannerViewBorderColor:"transparent",bannerView1BorderBottomWidth:0},custom:{styleName:"custom",cardWidth:174,cardBorderColor:"transparent",cardBgColor:system_text_msg_bg_color,cardBgSize:"contain",cardPaddingLeftRight:"12px",cardTextPaddingLeftRight:"0",cardTextPaddingTopBottom:"7",cardTextMarginBottom:"10px",cardTextSingleLineHeight:22,cardTextMinHeight:40,cardSubTitleFontSize:"12px",cardSubTitleLineHeight:"12px",cardSubTitleBgColor:user_text_msg_bg_color,cardSubTitleColor:user_text_msg_color,cardSubTitlePadding:"5px 0px",cardSubTitleTextPadding:"5px 7px 5px 7px",cardSubtitleMarginTop:4,cardBtnHeight:"28px",cardBtnPadding:"5px",cardBtnFontSize:"14px",cardBtnFontWeight:"normal",cardBtnBgColor:"transparent",cardBtnStyle:"rounded",cardBtnWidth:"92%",cardBtnMarginBottom:"7px",cardBtnLeftRightPadding:"auto",cardPaddingLeft:"7px",minCardBtns:0,cardImgHolderPadding:"10px",cardScrollArrowStyleName:"default",cardsPaddingTopBottom:10,cardsContainerLeftMargin:10,cardsBackgroundColor:"initial",cardsPadding:"initial",bannerViewBorderColor:system_text_msg_bg_color,bannerView1BorderBottomWidth:2},default:{styleName:"default",cardWidth:192,cardBorderColor:"transparent",cardBgColor:"white",cardBgSize:"cover",cardPaddingLeftRight:"0px",cardTextPaddingLeftRight:"12",cardTextPaddingTopBottom:"7",cardTextMarginBottom:"10px",cardTextSingleLineHeight:19,cardTextMinHeight:40,cardSubTitleFontSize:"12px",cardSubTitleLineHeight:"15px",cardSubTitleBgColor:"initial",cardSubTitleColor:"rgba(0, 0, 0, .40)",cardSubTitlePadding:"initial",cardSubTitleTextPadding:"initial",cardSubtitleMarginTop:10,cardBtnHeight:"28px",cardBtnPadding:"5px",cardBtnFontSize:"14px",cardBtnFontWeight:"normal",cardBtnBgColor:"transparent",cardBtnStyle:"rounded",cardBtnWidth:"92%",cardBtnMarginBottom:"7px",cardBtnLeftRightPadding:"12px",cardPaddingLeft:"7px",minCardBtns:0,cardImgHolderPadding:"0px",cardScrollArrowStyleName:"rounded",cardsPaddingTopBottom:7,cardsContainerLeftMargin:0,cardsBackgroundColor:system_text_msg_bg_color,cardsPadding:"10px",bannerViewBorderColor:system_text_msg_bg_color,bannerView1BorderBottomWidth:0}},cardScrollArrowStyles={default:{arrowBorderColor:"#636A78",rightArrowIconMargin:"",leftArrowIconMargin:"",arrowContainerBgColor:"#ffffff",arrowContainerBorder:"1px solid #dddfe2",arrowContainerBorderRadius:"initial",arrowIconMargin:"11",arrowIconPadding:"3"},rounded:{arrowBorderColor:"black",rightArrowIconMargin:"9px 9px 9px 7px",leftArrowIconMargin:"9px 9px 9px 11px",arrowContainerBgColor:"#f5f4f4",arrowContainerBorder:"none",arrowContainerBorderRadius:"20px",arrowIconMargin:"9",arrowIconPadding:"5"}};void 0!==cardStyles[window.shopInSync.styleGuide.card_style]&&cardStyles[window.shopInSync.styleGuide.card_style]||(window.shopInSync.styleGuide.card_style="default"),module.exports=Object.freeze({DEFAULT_USER_ID:"visitor",SCREEN_WIDTH:width,SCREEN_HEIGHT:height,HEADER_HEIGHT:headerHeight,FOOTER_HEIGHT:footerHeight,CHAT_BODY_PADDING_TOP:10,SCREEN_BOTTOM:bottom,SCREEN_RIGHT:right,SCREEN_POSITION:position,SCREEN_HEIGHT_EXCEPT_BODY:screen_height_except_body,FONT_FAMILY:font_family,LOADER_URL:assets_base_url+"/loader.gif",CHAT_BOX_TRANSITION:chat_box_transition,CHAT_BOX_BORDER_RADIUS:chatBoxBorderRadius,CHAT_HEADER_BACKGROUND_GRADIENT_LEFT_COLOR:header_bg_gradient_left_color,CHAT_HEADER_BACKGROUND_GRADIENT_RIGHT_COLOR:header_bg_gradient_right_color,CHAT_HEADER_BACKGROUND_IMAGE:chat_header_background_image,CHAT_HEADER_TEXT:chat_header_title,CHAT_HEADER_CROSS_ICON:chat_header_cross_icon,CHAT_HEADER_BOX_SHADOW:window.shopInSync.styleGuide.header_box_shadow,HEADER_TITLE_COLOR:header_title_color,HEADER_TITLE_FONT_SIZE:header_title_font_size,HEADER_TITLE_FONT_WEIGHT:header_title_font_weight,HEADER_TITLE_LETTER_SPACING:window.shopInSync.styleGuide.header_title_letter_spacing,CHAT_TEXT_FONT_SIZE:text_msg_font_size,CHAT_BODY_BACKGORUND_COLOR:chat_body_background_color,CHAT_BODY_TEXT_HEADER_LOGO_ICON_URL:system_icon_url,CHAT_BODY_TEXT_AGENT_LOGO_ICON_URL:agentIconUrl,CHAT_BODY_TEXT_LEFT_LOGO_ICON_URL:leftIconUrl,CHAT_BODY_TEXT_RIGHT_LOGO_ICON_URL:rightIconUrl,CHAT_BODY_TEXT_LEFT_BACKGORUND_COLOR:system_text_msg_bg_color,CHAT_BODY_TEXT_RIGHT_BACKGORUND_COLOR:user_text_msg_bg_color,CHAT_BODY_TEXT_RIGHT_COLOR:user_text_msg_color,CHAT_BODY_TEXT_LEFT_COLOR:system_text_msg_color,CHAT_BODY_TEXT_RIGHT_FANG_BORDER_RADIUS_KEY:right_fang_border_radius_key,INPUT_BOX_PADDING_LEFT:14,CHAT_BODY_MARGIN_LEFT:15,CHAT_BODY_MARGIN_RIGHT:15,CHAT_BOX_BORDER_WIDTH:window.shopInSync.styleGuide.chatBoxBorderWidth,CHAT_BODY_MESSAGE_BORDER_RADIUS:window.shopInSync.styleGuide.message_bubble_border_radius?window.shopInSync.styleGuide.message_bubble_border_radius:14,CARD_BORDER:"1px solid "+cardStyles[window.shopInSync.styleGuide.card_style].cardBorderColor,CARD_BORDER_RADIUS:window.shopInSync.styleGuide.cardBorderRadius,CARD_SUB_TITLE_COLOR:"rgba(0, 0, 0, .40)",BUTTON_TEXT_ALIGNMENT:null!=window.shopInSync.styleGuide.button_text_alignment?window.shopInSync.styleGuide.button_text_alignment:"center",BUTTON_TEXT_COLOR:button_text_color,BUTTON_BACKGROUND_COLOR:button_background_color,BUTTON_HOVER_TEXT_COLOR:button_hover_text_color,BUTTON_HOVER_BACKGROUND_COLOR:button_hover_background_color,BUTTON_BORDER:window.shopInSync.styleGuide.hasOwnProperty("button_border")?window.shopInSync.styleGuide.button_border:"1px solid "+button_text_color,BUTTON_FONT_SIZE:text_msg_font_size,BUTTON_FONT_WEIGHT:btn_text_font_weight,BUBBLE_TEXT_COLOR:quick_reply_bubble_text_color,BUBBLE_BACKGROUND_COLOR:quick_reply_bubble_bg_color,BUBBLE_HOVER_TEXT_COLOR:quick_reply_bubble_hover_text_color,BUBBLE_HOVER_BACKGROUND_COLOR:quick_reply_bubble_hover_bg_color,BUBBLE_BORDER_COLOR:window.shopInSync.styleGuide.quick_reply_bubble_border_color?window.shopInSync.styleGuide.quick_reply_bubble_border_color:quick_reply_bubble_text_color,BUBBLE_FONT_SIZE:window.shopInSync.styleGuide.quick_reply_bubble_font_size?window.shopInSync.styleGuide.quick_reply_bubble_font_size+"px":"13px",BUBBLE_CONTAINER_HEIGHT:42,BUBBLE_RADIUS:quick_reply_bubble_radius,BUBBLE_PADDING:quick_reply_padding,BUBBLE_MARGIN_LEFT:window.shopInSync.styleGuide.quick_reply_margin_left,BUBBLE_ALIGNMENT:window.shopInSync.styleGuide.quick_reply_bubbles_alignment?window.shopInSync.styleGuide.quick_reply_bubbles_alignment:"center",INPUT_FONT_SIZE:text_msg_font_size,DISABLED_TEXT_COLOR:"rgba(0, 0, 0, .40)",LIST_STYLE:listStyles[window.shopInSync.styleGuide.list_style],LIST_BORDER:window.shopInSync.styleGuide.container_border,LIST_TEXT_COLOR:"custom"==window.shopInSync.styleGuide.list_style?user_text_msg_bg_color:"#000",LIST_ELEMENT_BORDER_BOTTOM:window.shopInSync.styleGuide.container_border,LIST_ELEMENT_BUTTON_BORDER:"1px solid rgb(0, 132, 255)",DISABLED_LIST_ELEMENT_BUTTON_BORDER:window.shopInSync.styleGuide.container_border,RIGHT_FANG_IMG_URL:assets_base_url+"/right_fang.png",LEFT_FANG_IMG_URL:assets_base_url+"/left_fang.png",INPUT_BORDER_TOP:window.shopInSync.styleGuide.input_border_top?window.shopInSync.styleGuide.input_border_top:"1px #ccc solid",SHOW_USER_ICON:show_user_icon,SHOW_SYSTEM_ICON:show_system_icon,BUBBLE_STYLE:bubble_style,CHAT_BOX_SHADOW:chatBoxShadow,HEADER_LOGO_HEIGHT:header_logo_height,HEADER_LOGO_WIDTH:header_logo_width,CHAT_SYSTEM_DISPLAY_NAME:chat_system_display_name,SHOW_SYSTEM_MESSAGES:show_system_messages,SHOW_TOGGLE_WINDOW_ICONS:window.shopInSync.styleGuide.show_toggle_window_icons,BUTTON_WIDTH:window.shopInSync.styleGuide.button_width,SHOW_PRECHAT_FORM_USER_NAME:window.shopInSync.styleGuide.show_prechat_form_user_name,SHOW_PRECHAT_FORM_USER_EMAIL:window.shopInSync.styleGuide.show_prechat_form_user_email,LOGO_IMG_VERTICAL_ALIGN:logo_img_vertical_align,SHOW_FEEDBACK_ICONS:window.shopInSync.styleGuide.show_feedback_icons,POWEREDBY_IMAGE:poweredby_image,POWEREDBY_IMAGE_HEIGHT:poweredby_image_height,POWEREDBY_LINK:"https://www.insyncai.com?source=".concat(window.shopInSync.triggerPoint,"&utm_source=").concat(window.shopInSync.triggerPoint,"&utm_medium=chat_bot"),CHAT_FOOTER_POWEREDBY_HEIGHT:poweredByFooterHeight,SHOW_POWEREDBY_LINK:window.shopInSync.styleGuide.show_poweredby_footer,CHAT_USER_DISPLAY_NAME:chat_user_display_name,SHOW_FOOTER_V2:window.shopInSync.styleGuide.show_footer_v2,SHOW_FOOTER_V3:window.shopInSync.styleGuide.show_footer_v3,SEND_MESSAGE_ICON_URL:send_icon_url,BUTTON_STYLE:buttonStyles[window.shopInSync.styleGuide.button_style],CARD_BUTTON_STYLE:buttonStyles[cardStyles[window.shopInSync.styleGuide.card_style].cardBtnStyle],CARD_SCROLL_ARROW_STYLE:window.shopInSync.styleGuide.card_scroll_arrow_style?cardScrollArrowStyles[window.shopInSync.styleGuide.card_scroll_arrow_style]:cardScrollArrowStyles[cardStyles[window.shopInSync.styleGuide.card_style].cardScrollArrowStyleName],CARD_STYLE:cardStyles[window.shopInSync.styleGuide.card_style],FILE_ATTACHMENT_ENABLED:window.shopInSync.styleGuide.file_attachment_enabled,SOUND_FEATURE_ENABLED:window.shopInSync.styleGuide.sound_feature_enabled,SOUND_FILE_URL:assets_base_url+"/notification.m4a",SETTINGS_ICON_WIDTH:42,IMAGE_LOADER_URL:assets_base_url+"/image_loader.gif",PRECHAT_FORM_TITLE:prechat_form_title,END_CHAT_ENABLED:window.shopInSync.styleGuide.end_chat_feature_enabled,ATTCHED_FILE_ICON:assets_base_url+"/sdk-attach-file-in-message-icon.png",DELETE_ICON:assets_base_url+"/sdk-delete-file.png",CLOUD_ICON:assets_base_url+"/sdk-upload-file.png",ERROR_ICON:assets_base_url+"/sdk-error-icon.png",FEEDBACK_ICON_IMAGES:{neutralFeedbackUnselected:assets_base_url+"/thumbs-sideways-neutral-feedback-unselected.png",neutralFeedbackSelected:assets_base_url+"/thumbs-sideways-neutral-feedback-selected.png",upFeedbackUnselected:assets_base_url+"/thumbs-up-positive-feedback-unselected.png",upFeedbackSelected:assets_base_url+"/thumbs-up-positive-feedback-selected.png",downFeedbackUnselected:assets_base_url+"/thumbs-down-negative-feedback-unselected.png",downFeedbackSelected:assets_base_url+"/thumbs-down-negative-feedback-selected.png"},MODAL_TITLE_FONT_SIZE:20,MODAL_TITLE_COLOR:"black",ASSETS_URL:assets_base_url,CSAT_FOR_BOT_SESSIONS_ENABLED:window.shopInSync.styleGuide.enable_csat_for_va_sessions,CSAT_FOR_AGENT_SESSIONS_ENABLED:window.shopInSync.styleGuide.enable_csat_for_agent_sessions,BANNER_VIEW_BUTTON_WIDTH:"auto",ERROR_HEADER:window.shopInSync.styleGuide.error_header,ERROR_MESSAGE:window.shopInSync.styleGuide.error_message,HANDLE_LOAD_ERROR:window.shopInSync.styleGuide.handle_load_error,REQUEST_TIMEOUT:window.shopInSync.styleGuide.request_timeout,ENABLE_EXT_LINK_POPOUT_CONFIRMATION:window.shopInSync.styleGuide.enable_ext_link_popout_confirmation,LINK_POPOUT_CONFIRMATION_TEXT:window.shopInSync.styleGuide.link_popout_confirmation_text,GHOST_TEXT:window.shopInSync.styleGuide.input_field_ghost_text,DISABLED_GHOST_TEXT:window.shopInSync.styleGuide.disabled_ghost_text?window.shopInSync.styleGuide.disabled_ghost_text:"Select from the options above.",FEEDBACK_MODAL_VIEW_HEIGHT:390,REENGAGE_MODAL_VIEW_HEIGHT:200,DEFAULT_MODAL_VIEW_HEIGHT:224,USER_NEW_SEND_ICON:window.shopInSync.styleGuide.user_new_send_icon,USER_SEND_ICON_COLOR:null!=window.shopInSync.styleGuide.user_send_icon_color?window.shopInSync.styleGuide.user_send_icon_color:user_text_msg_bg_color,GREY_TEXT_COLOR:"#828A92",PRE_CHAT_WELCOME_SCREEN_ENABLED:window.shopInSync.styleGuide.pre_chat_welcome_screen_enabled,PRE_CHAT_WELCOME_SCREEN_TEXT:window.shopInSync.styleGuide.pre_chat_welcome_screen_text,CLIENT_DISPLAY_NAME:window.shopInSync.styleGuide.client_display_name,SHOW_AGENT_TYPING_INDICATOR:window.shopInSync.styleGuide.show_agent_typing_indicator})},8739:(e,t,n)=>{"use strict";n.d(t,{Z:()=>be});const r="object"==typeof global&&global&&global.Object===Object&&global;var i="object"==typeof self&&self&&self.Object===Object&&self;const o=(r||i||Function("return this")()).Symbol;var s=Object.prototype,a=s.hasOwnProperty,u=s.toString,c=o?o.toStringTag:void 0;const l=function(e){var t=a.call(e,c),n=e[c];try{e[c]=void 0;var r=!0}catch(e){}var i=u.call(e);return r&&(t?e[c]=n:delete e[c]),i};var d=Object.prototype.toString;const f=function(e){return d.call(e)};var p=o?o.toStringTag:void 0;const h=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":p&&p in Object(e)?l(e):f(e)};const y=function(e,t){return function(n){return e(t(n))}}(Object.getPrototypeOf,Object);const v=function(e){return null!=e&&"object"==typeof e};var m=Function.prototype,g=Object.prototype,b=m.toString,_=g.hasOwnProperty,w=b.call(Object);const k=function(e){if(!v(e)||"[object Object]"!=h(e))return!1;var t=y(e);if(null===t)return!0;var n=_.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&b.call(n)==w};var x=n(4948),S="@@redux/INIT";function E(e,t,n){var r;if("function"==typeof t&&void 0===n&&(n=t,t=void 0),void 0!==n){if("function"!=typeof n)throw new Error("Expected the enhancer to be a function.");return n(E)(e,t)}if("function"!=typeof e)throw new Error("Expected the reducer to be a function.");var i=e,o=t,s=[],a=s,u=!1;function c(){a===s&&(a=s.slice())}function l(){return o}function d(e){if("function"!=typeof e)throw new Error("Expected listener to be a function.");var t=!0;return c(),a.push(e),function(){if(t){t=!1,c();var n=a.indexOf(e);a.splice(n,1)}}}function f(e){if(!k(e))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if(void 0===e.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(u)throw new Error("Reducers may not dispatch actions.");try{u=!0,o=i(o,e)}finally{u=!1}for(var t=s=a,n=0;n<t.length;n++){(0,t[n])()}return e}return f({type:S}),(r={dispatch:f,subscribe:d,getState:l,replaceReducer:function(e){if("function"!=typeof e)throw new Error("Expected the nextReducer to be a function.");i=e,f({type:S})}})[x.Z]=function(){var e,t=d;return(e={subscribe:function(e){if("object"!=typeof e)throw new TypeError("Expected the observer to be an object.");function n(){e.next&&e.next(l())}return n(),{unsubscribe:t(n)}}})[x.Z]=function(){return this},e},r}function T(e,t){var n=t&&t.type;return"Given action "+(n&&'"'+n.toString()+'"'||"an action")+', reducer "'+e+'" returned undefined. To ignore an action, you must explicitly return the previous state. If you want this reducer to hold no value, you can return null instead of undefined.'}function O(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce((function(e,t){return function(){return e(t.apply(void 0,arguments))}}))}var I=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};function C(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return function(n,r,i){var o,s=e(n,r,i),a=s.dispatch,u={getState:s.getState,dispatch:function(e){return a(e)}};return o=t.map((function(e){return e(u)})),a=O.apply(void 0,o)(s.dispatch),I({},s,{dispatch:a})}}}const R=function(e){for(var t=Object.keys(e),n={},r=0;r<t.length;r++){var i=t[r];0,"function"==typeof e[i]&&(n[i]=e[i])}var o=Object.keys(n),s=void 0;try{!function(e){Object.keys(e).forEach((function(t){var n=e[t];if(void 0===n(void 0,{type:S}))throw new Error('Reducer "'+t+"\" returned undefined during initialization. If the state passed to the reducer is undefined, you must explicitly return the initial state. The initial state may not be undefined. If you don't want to set a value for this reducer, you can use null instead of undefined.");if(void 0===n(void 0,{type:"@@redux/PROBE_UNKNOWN_ACTION_"+Math.random().toString(36).substring(7).split("").join(".")}))throw new Error('Reducer "'+t+"\" returned undefined when probed with a random type. Don't try to handle "+S+' or other actions in "redux/*" namespace. They are considered private. Instead, you must return the current state for any unknown actions, unless it is undefined, in which case you must return the initial state, regardless of the action type. The initial state may not be undefined, but can be null.')}))}(n)}catch(e){s=e}return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];if(s)throw s;for(var r=!1,i={},a=0;a<o.length;a++){var u=o[a],c=n[u],l=e[u],d=c(l,t);if(void 0===d){var f=T(u,t);throw new Error(f)}i[u]=d,r=r||d!==l}return r?i:e}}({conversation:n(2095).Z});var A=n(1236),P=n(6355),N=n.n(P),L=n(1822),M=n(3545);function j(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var D,B,U=function(){function e(t){var n,r,i,o=t.userId,s=t.authorisation,a=t.channel_id,u=t.isAgent,c=t.market,l=t.env,d=t.baseServerUrl,f=t.sdk_version,p=t.args;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),i=function(e){return new Promise((function(t,n){var r=new A.KU(e);r.on("stateChanged",(function(e){"initialized"===e&&t(r)}))}))},(r="getTwilioClient")in(n=this)?Object.defineProperty(n,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[r]=i,this.userId=o,this.authorisation=s,this.channel_id=a,this.isAgent=u,this.market=c,this.env=l,this.baseServerUrl=d,this.sdk_version=f,this.handleLoadError=p.handleLoadError,this.requestTimeout=p.requestTimeout,this.connect=this.connect.bind(this),this.listenAuthExpireEvent=this.listenAuthExpireEvent.bind(this),this.getAccessTokenParameters=this.getAccessTokenParameters.bind(this),this.setResponseInitiated=this.setResponseInitiated.bind(this),this.setResponseReceived=this.setResponseReceived.bind(this),this.uniqueLogId=(Date.now()+Math.round(1e8*(Math.random()+1))+Date.now()).toString(),this.retryCount=0,this.responseReceived={getUserIdentity:!1,twilioConnect:!1,getChannel:!1,getMessages:!1},this.timeoutVar}var t,n,r;return t=e,n=[{key:"getAccessTokenParameters",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.shopInSync.triggeredBy,t="desktop";(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|ipad|iris|kindle|Android|Silk|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(navigator.userAgent)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(navigator.userAgent.substr(0,4)))&&(t="mobile");var n=!1;"undefined"!=this.isAgent&&(n=this.isAgent);var r=(0,M.h)(this.market,this.env,this.userId,n),i={"Content-type":"application/json",Accept:"application/json",Authorization:this.authorisation},o={};void 0!==window.shopInSync.contextParams&&(o=window.shopInSync.contextParams),void 0===e&&(e="user");var s={channel_id:this.channel_id,isAgent:this.isAgent,ext_user_id:r,market:this.market,args:{device_type:t,sdk_version:window.shopInSync.sdk_version,trigger_point:window.shopInSync.triggerPoint,contextParams:o,unique_log_id:this.uniqueLogId,page_full_url:window.shopInSync.hasOwnProperty("hostedPageRef")?window.shopInSync.hostedPageRef:"",source:e}},a=this.baseServerUrl+"/v1/get_user_identity";return{headers:i,data:s,url:a}}},{key:"connect",value:function(e){var t=this;(0,L.d)({utility:{event_type:"logs",action:"sdk_rt_breakdown",section:"client_start_initiated",unique_log_id:this.uniqueLogId}},"trackEvents");var n,r=Date.now(),i=this.getAccessTokenParameters(),o=0,s=!1,a={};this.setResponseInitiated(e,{source:"getUserIdenty",startTime:r});var u=this;N().post(i.url,i.data,{headers:i.headers}).then((function(i){u.setResponseReceived(e),i.data.result.sdk_auto_destroy_connection_in_secs&&(o=i.data.result.sdk_auto_destroy_connection_in_secs),void 0!==i.data.result.sdk_agent_channel_keys&&(n=i.data.result.sdk_agent_channel_keys);var c=i.data.result.identity_token;u.conversationId=i.data.result.conversation_id,u.user_id=i.data.result.user_id,s=i.data.result.sdk_show_pre_chat_form;var l=!1;void 0!==i.data.result.is_log_events_on&&(l=i.data.result.is_log_events_on),l&&(0,L.d)({utility:{event_type:"logs",action:"sdk_rt_breakdown",section:"client_start_get_user_identity_api",duration:Date.now()-r,conversation_id:i.data.result.conversation_id,unique_log_id:t.uniqueLogId}},"trackEvents"),a.isLogEventsOnForUser=l,a.uniqueLogId=t.uniqueLogId,void 0!==i.data.result.is_new_user&&(a.isNewUser=i.data.result.is_new_user);var d=Date.now();u.setResponseInitiated(e,{source:"twilioCreateClient",startTime:r,conversationId:u.conversation_id}),t.getTwilioClient(c).then((function(i){u.setResponseReceived(e,a),l&&(0,L.d)({utility:{event_type:"logs",action:"sdk_rt_breakdown",section:"client_start_twilio_client_init",duration:Date.now()-d,conversation_id:u.conversationId,unique_log_id:t.uniqueLogId}},"trackEvents"),u.client=i,u.twilioGetChannelStartTime=Date.now(),u.extraArgs=a,u.isLogEventsOnForUser=l,u.setResponseInitiated(e,{source:"twilioGetChannel",startTime:r,conversationId:u.conversation_id}),i.getConversationBySid(u.conversationId).then((function(r){u.setResponseReceived(e,u.extraArgs),u.isLogEventsOnForUser&&(0,L.d)({utility:{event_type:"logs",action:"sdk_rt_breakdown",section:"client_start_twilio_get_channel",duration:Date.now()-u.twilioGetChannelStartTime,conversation_id:u.conversationId,unique_log_id:t.uniqueLogId}},"trackEvents"),e(u.user_id,r,o,n,s,u.extraArgs)})).catch((function(t){a.error={source:"twilioGetChannel",type:"serverError",conversation_id:u.conversationId,duration:Date.now()-u.twilioGetChannelStartTime},u.setResponseReceived(e,a,!0)}))})).catch((function(n){l&&(0,L.d)({utility:{event_type:"logs",action:"sdk_rt_breakdown",section:"client_start_twilio_client_init",duration:Date.now()-d,conversation_id:u.conversationId,unique_log_id:t.uniqueLogId}},"trackEvents"),a.error={source:"twilioCreateClient",type:"serverError",conversation_id:u.conversationId,duration:Date.now()-r},u.setResponseReceived(e,a,!0)}))})).catch((function(n){var i=Date.now()-r;0==t.retryCount?(t.retryCount+=1,u.setResponseReceived(e),t.connect(e)):(a.error={source:"getUserIdenty",type:"serverError",duration:i},u.setResponseReceived(e,a,!0))}))}},{key:"listenAuthExpireEvent",value:function(){var e=this;this.client.on("tokenAboutToExpire",(function(){var t=e.getAccessTokenParameters("token_about_to_expire");N().post(t.url,t.data,{headers:t.headers}).then((function(t){var n=t.data.result.identity_token;e.client.updateToken(n)})).catch((function(e){}))})),this.client.on("tokenExpired",(function(){var t=this,n=e.getAccessTokenParameters("token_expired");N().post(n.url,n.data,{headers:n.headers}).then((function(n){var r=n.data.result.identity_token;t.getTwilioClient(r).then((function(t){e.client=t,t.getConversationByUniqueName(e.conversationId).then((function(e){})).catch((function(e){}))}))})).catch((function(e){}))}))}},{key:"setResponseInitiated",value:function(e,t){this.handleLoadError&&(this.responseReceived=!1,void 0!==this.timeoutVar&&clearTimeout(this.timeoutVar),this.timeoutVar=setTimeout((function(){if(!this.responseReceived){var n=JSON.parse(JSON.stringify(t));n.error={source:t.source,type:"timeoutError"},(0,L.d)({utility:{event_type:"logs",action:"sdk_load_error",section:t.source,conversation_id:t.conversation_id,duration:Date.now()-t.startTime,unique_log_id:this.uniqueLogId}},"trackEvents"),e(null,null,null,null,null,n)}}),1e3*this.requestTimeout))}},{key:"setResponseReceived",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.handleLoadError&&(this.responseReceived=!0,clearTimeout(this.timeoutVar),n&&((0,L.d)({utility:{event_type:"logs",action:"sdk_load_error",section:t.error.source,conversation_id:t.error.conversation_id,duration:t.error.duration,unique_log_id:this.uniqueLogId}},"trackEvents"),e(null,null,null,null,null,t)))}}],n&&j(t.prototype,n),r&&j(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),F=n(2631),H=n.n(F),G=n(2449);function W(e){return W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},W(e)}function q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function V(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?q(Object(n),!0).forEach((function(t){z(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function z(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Y=0,K={};var $=function(e){var t=D.attributes,n=[];for(var r in e){var i={property:r};t[r]?e[r]!=t[r]&&(i.from=t[r],i.value=e[r]):i.value=e[r],i.value&&n.push(i),"userInfo"==r&&(e[r]=Object.assign({},e[r],t[r])),t[r]=e[r],n.length>0&&(t.changes=n)}D.updateAttributes(t)},X=function(e,t,n){void 0!==B&&clearTimeout(B),B=setTimeout((function(){J(e,n),clearTimeout(B)}),1e3*t)},J=function(e,t){!1,void 0!==window.shopInSync.hideIframe&&window.shopInSync.hideIframe(),e.dispatch({type:G.ju,payload:{}})},Z=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"system_message_info",n={type:t,text:""},r={body:JSON.stringify(n),timestamp:Date.now(),author:"system",index:0},i=ne([r],e);return r=i[0]},Q=function(e,t){H().HANDLE_LOAD_ERROR&&((0,L.d)({utility:{event_type:"logs",action:"sdk_rt_breakdown",section:"client_start_reload_view",duration:Date.now()-K.clientStartTime,conversation_id:t.conversation_id,unique_log_id:K.uniqueLogId}},"trackEvents"),void 0!==t.hideView&&t.hideView?e.dispatch({type:G.dw,payload:{showLoaderView:!1,error:{}}}):(e.dispatch({type:G.dw,payload:{showLoaderView:!0,error:t.error}}),H().PRE_CHAT_WELCOME_SCREEN_ENABLED||function(e){var t=Z(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:"system_message_info");e.dispatch({type:G.PW,payload:{message:t}})}(e)))},ee=function e(t,n){var r=Date.now(),i=n.pageSize,o=0;n.retryCount&&(o=n.retryCount),D.getMessages(i).then((function(n){if(K.isLogEventsOnForUser&&(0,L.d)({utility:{event_type:"logs",action:"sdk_rt_breakdown",section:"client_start_twilio_get_messages",duration:Date.now()-r,conversation_id:D.sid,unique_log_id:K.uniqueLogId}},"trackEvents"),n=ne(n.items,t),H().PRE_CHAT_WELCOME_SCREEN_ENABLED&&K&&void 0!==K.isNewUser&&K.isNewUser){n=[Z(t,"welcome_message")].concat(n)}t.dispatch({type:G.wi,payload:{messages:n}});var s=!1,a={};if(0==n.length){if(0==o)e(t,{pageSize:i,retryCount:o+=1});else s=!0;a={error:{source:"twilioGetMessages",type:"serverError",conversation_id:D.sid}},Q(t,a)}else s=!0,o=0,t.getState().conversation.showLoaderView&&Q(t,a={hideView:!0});s&&(0,L.d)({utility:{event_type:"logs",action:"sdk_rt_breakdown",section:"client_start_done",duration:Date.now()-K.clientStartTime,conversation_id:D.sid,unique_log_id:K.uniqueLogId}},"trackEvents")})).catch((function(e){(0,L.d)({utility:{event_type:"logs",action:"sdk_load_error",section:"twilioGetMessages",conversation_id:D.sid,duration:Date.now()-K.clientStartTime,unique_log_id:K.uniqueLogId}},"trackEvents");var n={error:{source:"twilioGetMessages",type:"serverError",conversation_id:D.sid}};Q(t,n)}))},te=function(e,t){var n=t.media.filename;return t.media.contentType.includes("image")||(n=t.media.filename),t.media.getContentTemporaryUrl().then((function(r){var i={type:"text",text:r,message_type:"image_url",filename:n,filetype:t.media.contentType};e.dispatch({type:G.VA,payload:{body:i,messageIndex:t.index}})})),JSON.stringify({type:"text",text:H().IMAGE_LOADER_URL,message_type:"image_url",filename:n,filetype:t.media.contentType})},ne=function(e,t){e.length;var n=e.map((function(n){0;var r=function(e,t){return"media"==t.type?te(e,t):t.body}(t,n),i=!1;try{JSON.parse(r),i=!0}catch(e){i=!1}if(e[e.length-1]!=n||re(c)||ie(i,r,t,n.index),i&&JSON.parse(r).elements){var o=JSON.parse(r),s=JSON.parse(n.body).elements;o.elements=s,o.products&&delete o.products,r=o}else if(i&&"text_and_buttons"==JSON.parse(r).type&&e[e.length-1]!=n){var a=JSON.parse(r);if(a&&!a.buttons)a.type="text",r=a;else if(a&&a.buttons&&a.buttons.length>=1){var u=0;for(u=0;u<a.buttons.length;u++)("disable_bot"==a.buttons[u].payload||"show_sdk_inline_view"==a.buttons[u].payload)&&(a.buttons[u].isDisabled=!0,r=a)}}var c="text",l=!1,d=n.author,f="bot";n.author==t.getState().conversation.myself&&(f="user");var p="";try{if(("string"==typeof r||r instanceof String)&&(r=JSON.parse(r)),f=se(r,f),["agent","system"].includes(f)&&(p=oe(r)),c=function(e){var t="text";return e.hasOwnProperty("type")&&("text"===e.type?t=e.hasOwnProperty("message_type")&&"image_url"==e.message_type?"imageView":e.hasOwnProperty("selection_array")?"bubble":"text":"generic"===e.type?t="card":"text_and_buttons"===e.type?t="button":"list_view"===e.type?t="list":"modal_view"===e.type?t="modal":"system_message_info"===e.type?t="systemMessageInfo":"system_message_log"===e.type?t="systemMessageLog":"user_message_log"===e.type?t="userMessageLog":"welcome_message"===e.type&&(t="welcome_message")),t}(r),!re(c))return l=ae(r),{body:r,sender:d,type:c,senderType:f,senderName:p,sentAt:n.timestamp,messageId:n.sid,messageIndex:n.index,isUserFeedbackAllowed:l}}catch(e){return f=se(r,f),["agent","system"].includes(f)&&(p=oe(r)),l=ae(r),{body:r,sender:d,type:c,senderType:f,senderName:p,sentAt:n.timestamp,messageId:n.sid,messageIndex:n.index,isUserFeedbackAllowed:l}}})).filter(Boolean);return n.sort((function(e,t){return e.messageIndex-t.messageIndex})),n},re=function(e){var t=!1;return["systemMessageLog"].includes(e)&&(t=!0,"production"!=window.shopInSync.env&&window.shopInSync.hasOwnProperty("contextParams")&&window.shopInSync.contextParams.hasOwnProperty("debugMode")&&"true"==window.shopInSync.contextParams.debugMode&&(t=!1)),t},ie=function(e,t,n,r){var i=t;if(e&&(i=JSON.parse(t)),i){if(i.sdk_signal_disable_editbox){var o=H().DISABLED_GHOST_TEXT;i.sdk_signal_disable_editbox_ghosttext&&(o=i.sdk_signal_disable_editbox_ghosttext),n.getState().conversation.disableEditing!=i.sdk_signal_disable_editbox&&n.dispatch({type:G.pT,payload:{disableEditing:!0,disableEditingGhostText:o}})}else 0!=n.getState().conversation.disableEditing&&n.dispatch({type:G.pT,payload:{disableEditing:!1,disableEditingGhostText:""}});if("modal_view"==i.type){var s=n.getState().conversation.showView;s.viewName==i.sdk_signal_show_view_type&&JSON.stringify(s.msg)==JSON.stringify(i)||n.dispatch({type:G.iY,payload:{viewName:i.sdk_signal_show_view_type,msg:i,msgIndex:r}})}else""!=n.getState().conversation.showView.viewName&&n.dispatch({type:G.iY,payload:{viewName:"",msg:""}})}},oe=function(e){var t="";return void 0!==e.sender_name&&""!=e.sender_name&&(t=e.sender_name),t},se=function(e,t){return"object"===W(e)&&void 0!==e.sender&&"agent"==e.sender&&(t="agent"),"object"===W(e)&&void 0!==e.sender&&"system"==e.sender&&(t="system"),t},ae=function(e){var t=!1;return void 0!==e.signal_user_feedback_state&&""!=e.signal_user_feedback_state&&(t=e.signal_user_feedback_state),t},ue=function(e,t,n){n.listenAuthExpireEvent(),e.on("messageAdded",(function(e){var n=ne([e],t)[0];if(n){var r=!1;void 0!==window.shopInSync.source&&"backoffice_agent"==window.shopInSync.source&&(r=!0),(e.author!=t.getState().conversation.myself||r)&&("bot"==n.senderType&&t.getState().conversation.systemSenderName!=H().CHAT_SYSTEM_DISPLAY_NAME?t.dispatch({type:G.GR,payload:{systemSenderName:H().CHAT_SYSTEM_DISPLAY_NAME,sessionWith:"bot"}}):("agent"==n.senderType||"system"==n.senderType&&"agent"==D.attributes.sessionWith&&"agent"!=t.getState().conversation.sessionWith)&&t.getState().conversation.systemSenderName!=n.senderName&&t.dispatch({type:G.GR,payload:{systemSenderName:n.senderName,sessionWith:"agent"}}),t.getState().conversation.shouldReadMessage&&!t.getState().conversation.isVoiceInput&&(t.dispatch({type:G.Mf,payload:{shouldReadMessage:!1}}),function(e){var t=window.speechSynthesis,n=new SpeechSynthesisUtterance(e.body.text);t.speak(n)}(n)),t.getState().conversation.showLoaderView&&((K={}).hideView=!0,Q(t,K)),t.dispatch({type:G.ul,payload:{message:n}}))}}))};const ce=function(){return function(e){var t,n;void 0!==window.shopInSync.user_id&&(t=window.shopInSync.user_id),void 0!==window.shopInSync.userId&&(t=window.shopInSync.userId),window.shopInSync.app_id&&(n=window.shopInSync.app_id),window.shopInSync.appId&&(n=window.shopInSync.appId);var r="Token token="+window.shopInSync.token;void 0!==window.shopInSync.clientToken&&(r="Bearer "+n+":"+window.shopInSync.clientToken),void 0!==window.shopInSync.brand_session_token&&window.shopInSync.brand_session_token.length>0&&(r=window.shopInSync.brand_session_token),void 0!==window.shopInSync.brandSessionToken&&window.shopInSync.brandSessionToken.length>0&&(r=window.shopInSync.brandSessionToken);window.shopInSync.channel_id=12;var i=window.shopInSync.market,o=window.shopInSync.env,s=window.shopInSync.baseServerUrl,a=window.shopInSync.sdk_version,u={handleLoadError:H().HANDLE_LOAD_ERROR,requestTimeout:H().REQUEST_TIMEOUT},c=new U({userId:t,authorisation:r,channel_id:12,isAgent:!1,market:i,env:o,baseServerUrl:s,sdk_version:a,args:u});return function(t){return function(n){e.getState();return function(e,t,n,r,i){var o=r.type,s=r.payload;switch(o){case G.o$:var a=Date.now();return H().PRE_CHAT_WELCOME_SCREEN_ENABLED&&(t.dispatch({type:G.iY,payload:{viewName:"initialLoadingView"}}),t.dispatch({type:G.pT,payload:{disableEditing:!0,disableEditingGhostText:""}})),void e.connect((function(n,r,i,o,s){if(D=r,(K=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{}).clientStartTime=a,void 0!==o&&o,K&&void 0!==K.error)Q(t,K);else{t.getState().conversation.showLoaderView&&(K.hideView=!0,Q(t,K)),ee(t,{pageSize:20}),t.dispatch({type:G.GR,payload:{sessionStatus:D.attributes.sessionStatus,sessionWith:D.attributes.sessionWith}}),i>0&&(Y=i,X(t,i,e)),!s||void 0!==D.attributes.userInfo&&void 0!==D.attributes.userInfo.User_Email||t.dispatch({type:G.j4,payload:!0}),ue(r,t,e),t.dispatch({type:G.yF,payload:{myHandle:n}});var u=void 0===D.attributes.isSoundNotificationOn||D.attributes.isSoundNotificationOn;t.getState().conversation.isSoundNotificationOn!=u&&t.dispatch({type:G.fP,payload:{isSoundNotificationOn:u}})}}));case G.U9:var u=s.body;return $({userInfo:{User_Name:u.name,User_Email:u.email}}),void t.dispatch({type:G.j4,payload:!1});case G.x7:var c={body:s.body,author:t.getState().conversation.myself,timestamp:Date.now(),type:"text"},l=ne([c],t);if(l.length>0){var d=l[0],f=!1;void 0!==window.shopInSync.source&&"backoffice_agent"==window.shopInSync.source&&(f=!0),f||t.dispatch({type:G.PW,payload:{message:d}})}return D.sendMessage(s.body),void(Y>0&&X(t,Y,e));case G.iP:var p=new FormData;p.append("file",s.body);var h=!1;if(void 0!==window.shopInSync.source&&"backoffice_agent"===window.shopInSync.source&&(h=!0),!h){var y={body:JSON.stringify({type:"text",text:H().IMAGE_LOADER_URL,message_type:"image_url",filename:"Sending "+s.body.name+"...",filetype:s.body.type}),author:t.getState().conversation.myself,timestamp:Date.now(),type:"text"};y=ne([y],t)[0],t.dispatch({type:G.PW,payload:{message:y}})}return void D.sendMessage(p).then((function(e){var n=D.messagesEntity.messagesByIndex.get(e);te(t,n),"agent"===D.attributes.sessionWith&&D.attributes.agentStatus}));case G.ao:return void(d=D.messagesEntity.messagesByIndex.get(s.messageIndex)).updateBody(s.body);case G.AF:var v="AI Assistant";"agent"==D.attributes.sessionWith&&(s.feedback&&s.feedback.value&&s.feedback.value,s.feedback&&s.feedback.comment&&s.feedback.comment,(v=t.getState().conversation.systemSenderName)==H().CHAT_SYSTEM_DISPLAY_NAME&&(v="Agent"));var m={conversation_id:D.sid,feedback:s.feedback,feedback_for:v,session_ended_by:s.sessionEndedBy};return s.endSessionArgs&&(m=V(V({},m),s.endSessionArgs)),void(0,L.d)(m,"endSession");case G.ju:return(0,L.d)({utility:{event_type:"logs",action:"fe_activity",section:"auto_destroy_window",conversation_id:D.sid,unique_log_id:K.uniqueLogId}},"trackEvents"),void(void 0!==e&&void 0!==e.client&&e.client.shutdown());case G.fP:var g=!0;if(void 0!==D.attributes.isSoundNotificationOn&&(g=D.attributes.isSoundNotificationOn),g!=s.isSoundNotificationOn){var b=D.attributes;b.isSoundNotificationOn=s.isSoundNotificationOn,D.updateAttributes(b)}return;default:;}}(c,e,0,n),t(n)}}}};var le=n(5885),de="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function fe(e){return null!==e&&"object"===(void 0===e?"undefined":de(e))&&(e&&"function"==typeof e.then)}var pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},he=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ye=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{!r&&a.return&&a.return()}finally{if(i)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},ve=["PENDING","FULFILLED","REJECTED"];function me(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.promiseTypeSuffixes||ve,n=e.promiseTypeSeparator||"_";return function(e){var r=e.dispatch;return function(e){return function(i){if(!i.payload)return e(i);if(!fe(i.payload)&&!fe(i.payload.promise))return e(i);var o=i.type,s=i.payload,a=i.meta,u=ye(t,3),c=u[0],l=u[1],d=u[2],f=function(e,t){return he({type:[o,t?d:l].join(n)},null==e?{}:{payload:e},void 0!==a?{meta:a}:{},t?{error:!0}:{})},p=void 0,h=void 0;fe(i.payload)||"object"!==pe(i.payload)?(p=s,h=void 0):(p=s.promise,h=s.data),e(he({type:[o,c].join(n)},void 0!==h?{payload:h}:{},void 0!==a?{meta:a}:{}));return p.then((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=f(e,!1);return r(t),{value:e,action:t}}),(function(e){var t=f(e,!0);throw r(t),e}))}}}}var ge=n(9e3);function be(e){return O("production"==window.shopInSync.env?C(ce(),me(),ge.Z):C(ce(),(0,le.createLogger)(),me(),ge.Z))(E)(R,e)}},3545:(e,t,n)=>{"use strict";n.d(t,{h:()=>r});var r=function(e,t,n,r){var i;return void 0!==n&&(i=r?n.toLowerCase():n.toLowerCase()+"_"+e.toLowerCase()+"_"+t.toLowerCase()),i}},2095:(e,t,n)=>{"use strict";n.d(t,{Z:()=>f});var r=n(2631),i=n.n(r),o=n(2449);function s(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var d={myself:i().DEFAULT_USER_ID,started:!1,myHandle:"",messages:[],messagePagination:20,messageTyped:"",showPreChat:!1,close:!1,disableEditing:!1,isVoiceInput:!1,doesBrowserSupportsMedia:!0,shouldReadMessage:!1,systemSenderName:i().CHAT_SYSTEM_DISPLAY_NAME,sessionWith:"bot",agentConnectionStatus:"not-connected",sessionStatus:"closed",showView:{viewName:"",msg:"",msgIndex:-1},isSoundNotificationOn:!0,showLoaderView:!1,error:{}};const f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,t=arguments.length>1?arguments[1]:void 0,n=t.payload,r=t.type;switch("function"==typeof window.shopInSync.log&&window.shopInSync.log("Got Dispatch call : "),r){case o.j4:return c(c({},e),{},{showPreChat:n});case o.o$:return c(c({},e),{},{started:!0,close:!1});case o.yF:return c(c({},e),{},{myself:n.myHandle});case o.dw:return void 0!==n.error&&Object.keys(n.error).length>0&&(n.error.message=i().LOADING_ERROR_MESSAGE),c(c({},e),{},{showLoaderView:n.showLoaderView,error:n.error});case o.GR:var a=e.systemSenderName;n.systemSenderName&&(a=n.systemSenderName);var u=e.sessionWith;n.sessionWith&&(u=n.sessionWith);var l=e.sessionStatus;return n.sessionStatus&&(l=n.sessionStatus),c(c({},e),{},{systemSenderName:a,sessionWith:u,sessionStatus:l});case o.We:return c(c({},e),{},{agentConnectionStatus:n.agentConnectionStatus});case o.PW:if(e.messages.length>0){var f=e.messages[e.messages.length-1].messageIndex;n.message.messageIndex=f+1}return c(c({},e),{},{messages:[].concat(s(e.messages),[n.message])});case o.ul:return c(c({},e),{},{messages:[].concat(s(e.messages),[n.message])});case o.wi:return c(c({},e),{},{messages:n.messages});case o.ju:return c(c({},e),{},{messages:[],started:!1,close:!0});case o.Mk:return c(c({},e),{},{messageTyped:n.typedMessage});case o.$M:var p={messages:[],messageTyped:"",messagePagination:n.paginationWindow};return c(c({},e),p);case o.pT:return c(c({},e),{},{disableEditing:n.disableEditing,disableEditingGhostText:n.disableEditingGhostText});case o.iY:return c(c({},e),{},{showView:{viewName:n.viewName,msg:n.msg,msgIndex:n.msgIndex}});case o.hQ:return c(c({},e),{},{isVoiceInput:n.isVoiceInput,doesBrowserSupportsMedia:n.doesBrowserSupportsMedia});case o.Mf:return c(c({},e),{},{shouldReadMessage:n.shouldReadMessage});case o.VA:for(var h=e.messages,y=[],v=0;v<h.length;v++){if(h[v].messageIndex==n.messageIndex){var m=h[v];m.body=n.body,h[v]=m}y.push(h[v])}return c(c({},e),{},{messages:y});case o.fP:return c(c({},e),{},{isSoundNotificationOn:n.isSoundNotificationOn});default:return e}}},2676:e=>{e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r},e.exports.__esModule=!0,e.exports.default=e.exports},6401:e=>{e.exports=function(e){if(Array.isArray(e))return e},e.exports.__esModule=!0,e.exports.default=e.exports},781:(e,t,n)=>{var r=n(2676);e.exports=function(e){if(Array.isArray(e))return r(e)},e.exports.__esModule=!0,e.exports.default=e.exports},5206:e=>{e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},e.exports.__esModule=!0,e.exports.default=e.exports},5341:e=>{function t(e,t,n,r,i,o,s){try{var a=e[o](s),u=a.value}catch(e){return void n(e)}a.done?t(u):Promise.resolve(u).then(r,i)}e.exports=function(e){return function(){var n=this,r=arguments;return new Promise((function(i,o){var s=e.apply(n,r);function a(e){t(s,i,o,a,u,"next",e)}function u(e){t(s,i,o,a,u,"throw",e)}a(void 0)}))}},e.exports.__esModule=!0,e.exports.default=e.exports},9516:e=>{e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.__esModule=!0,e.exports.default=e.exports},8311:(e,t,n)=>{var r=n(4632),i=n(6470);function o(t,n,s){return i()?(e.exports=o=Reflect.construct.bind(),e.exports.__esModule=!0,e.exports.default=e.exports):(e.exports=o=function(e,t,n){var i=[null];i.push.apply(i,t);var o=new(Function.bind.apply(e,i));return n&&r(o,n.prototype),o},e.exports.__esModule=!0,e.exports.default=e.exports),o.apply(null,arguments)}e.exports=o,e.exports.__esModule=!0,e.exports.default=e.exports},2281:e=>{function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}e.exports=function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e},e.exports.__esModule=!0,e.exports.default=e.exports},7322:e=>{e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},e.exports.__esModule=!0,e.exports.default=e.exports},555:(e,t,n)=>{var r=n(8177);function i(){return"undefined"!=typeof Reflect&&Reflect.get?(e.exports=i=Reflect.get.bind(),e.exports.__esModule=!0,e.exports.default=e.exports):(e.exports=i=function(e,t,n){var i=r(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},e.exports.__esModule=!0,e.exports.default=e.exports),i.apply(this,arguments)}e.exports=i,e.exports.__esModule=!0,e.exports.default=e.exports},1559:e=>{function t(n){return e.exports=t=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},5895:(e,t,n)=>{var r=n(4632);e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&r(e,t)},e.exports.__esModule=!0,e.exports.default=e.exports},9592:e=>{e.exports=function(e){return-1!==Function.toString.call(e).indexOf("[native code]")},e.exports.__esModule=!0,e.exports.default=e.exports},6470:e=>{e.exports=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}},e.exports.__esModule=!0,e.exports.default=e.exports},3778:e=>{e.exports=function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)},e.exports.__esModule=!0,e.exports.default=e.exports},4956:e=>{e.exports=function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o=[],s=!0,a=!1;try{for(n=n.call(e);!(s=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);s=!0);}catch(e){a=!0,i=e}finally{try{s||null==n.return||n.return()}finally{if(a)throw i}}return o}},e.exports.__esModule=!0,e.exports.default=e.exports},4505:e=>{e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports},4913:e=>{e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports},1167:(e,t,n)=>{var r=n(4492).default,i=n(5206);e.exports=function(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return i(e)},e.exports.__esModule=!0,e.exports.default=e.exports},6305:(e,t,n)=>{var r=n(4492).default;function i(){"use strict";e.exports=i=function(){return t},e.exports.__esModule=!0,e.exports.default=e.exports;var t={},n=Object.prototype,o=n.hasOwnProperty,s="function"==typeof Symbol?Symbol:{},a=s.iterator||"@@iterator",u=s.asyncIterator||"@@asyncIterator",c=s.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function d(e,t,n,r){var i=t&&t.prototype instanceof h?t:h,o=Object.create(i.prototype),s=new T(r||[]);return o._invoke=function(e,t,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return I()}for(n.method=i,n.arg=o;;){var s=n.delegate;if(s){var a=x(s,n);if(a){if(a===p)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=f(e,t,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===p)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}(e,n,s),o}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=d;var p={};function h(){}function y(){}function v(){}var m={};l(m,a,(function(){return this}));var g=Object.getPrototypeOf,b=g&&g(g(O([])));b&&b!==n&&o.call(b,a)&&(m=b);var _=v.prototype=h.prototype=Object.create(m);function w(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function k(e,t){function n(i,s,a,u){var c=f(e[i],e,s);if("throw"!==c.type){var l=c.arg,d=l.value;return d&&"object"==r(d)&&o.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,a,u)}),(function(e){n("throw",e,a,u)})):t.resolve(d).then((function(e){l.value=e,a(l)}),(function(e){return n("throw",e,a,u)}))}u(c.arg)}var i;this._invoke=function(e,r){function o(){return new t((function(t,i){n(e,r,t,i)}))}return i=i?i.then(o,o):o()}}function x(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,x(e,t),"throw"===t.method))return p;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return p}var r=f(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,p;var i=r.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,p):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function O(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function t(){for(;++n<e.length;)if(o.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return r.next=r}}return{next:I}}function I(){return{value:void 0,done:!0}}return y.prototype=v,l(_,"constructor",v),l(v,"constructor",y),y.displayName=l(v,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,l(e,c,"GeneratorFunction")),e.prototype=Object.create(_),e},t.awrap=function(e){return{__await:e}},w(k.prototype),l(k.prototype,u,(function(){return this})),t.AsyncIterator=k,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var s=new k(d(e,n,r,i),o);return t.isGeneratorFunction(n)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},w(_),l(_,c,"Generator"),l(_,a,(function(){return this})),l(_,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=O,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(E),!e)for(var t in this)"t"===t.charAt(0)&&o.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(n,r){return s.type="throw",s.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r],s=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var a=o.call(i,"catchLoc"),u=o.call(i,"finallyLoc");if(a&&u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(a){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&o.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var s=i?i.completion:{};return s.type=e,s.arg=t,i?(this.method="next",this.next=i.finallyLoc,p):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),E(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;E(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:O(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),p}},t}e.exports=i,e.exports.__esModule=!0,e.exports.default=e.exports},4632:e=>{function t(n,r){return e.exports=t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n,r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},2013:(e,t,n)=>{var r=n(6401),i=n(4956),o=n(8854),s=n(4505);e.exports=function(e,t){return r(e)||i(e,t)||o(e,t)||s()},e.exports.__esModule=!0,e.exports.default=e.exports},8177:(e,t,n)=>{var r=n(1559);e.exports=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=r(e)););return e},e.exports.__esModule=!0,e.exports.default=e.exports},6507:(e,t,n)=>{var r=n(781),i=n(3778),o=n(8854),s=n(4913);e.exports=function(e){return r(e)||i(e)||o(e)||s()},e.exports.__esModule=!0,e.exports.default=e.exports},4492:e=>{function t(n){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},8854:(e,t,n)=>{var r=n(2676);e.exports=function(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}},e.exports.__esModule=!0,e.exports.default=e.exports},2771:(e,t,n)=>{var r=n(1559),i=n(4632),o=n(9592),s=n(8311);function a(t){var n="function"==typeof Map?new Map:void 0;return e.exports=a=function(e){if(null===e||!o(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(e))return n.get(e);n.set(e,t)}function t(){return s(e,arguments,r(this).constructor)}return t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),i(t,e)},e.exports.__esModule=!0,e.exports.default=e.exports,a(t)}e.exports=a,e.exports.__esModule=!0,e.exports.default=e.exports},3879:(e,t,n)=>{var r=n(6305)();e.exports=r;try{regeneratorRuntime=r}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=r:Function("r","regeneratorRuntime = r")(r)}},1236:(e,t,n)=>{"use strict";n(3143),n(5664),n(8330),n(5857),n(8505),n(7913),n(6023);var r=n(5341),i=n(2281),o=n(5206),s=n(5895),a=n(1167),u=n(1559),c=n(7322),l=n(9516);n(1825),n(5648),n(6029),n(5607);var d=n(3879),f=n(4492);n(6294),n(2893),n(8389);var p=n(1144),h=n(528);n(7039),n(7583),n(2502),n(6564),n(5169),n(1117);var y=n(321);n(1022);var v=n(6180),m=n(1419);n(7472),n(5324),n(711),n(6909);var g=n(2013);n(2905);var b=n(4051),_=n(3821),w=n(1602),k=n(6724),x=n(7206),S=n(6507);n(8270),n(3708),n(6607),n(2171),n(1186),n(9423),n(7675),n(9514),n(9477),n(9934),n(8513),n(9272),n(2946),n(6994),n(9566),n(5360),n(5132),n(4123),n(1024),n(3957),n(4255),n(1697),n(7114),n(1761),n(6163),n(4362),n(8437),n(2671),n(4519),n(8362),n(5073),n(6781);var E=n(4755);function T(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function O(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(n){if("default"!==n){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})}})),t.default=e,Object.freeze(t)}var I=T(r),C=T(i),R=T(o),A=T(s),P=T(a),N=T(u),L=T(c),M=T(l),j=T(d),D=T(f),B=O(p),U=T(m),F=T(g),H=T(S);function G(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":D.default(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}function W(e,t){if("object"===("undefined"==typeof Reflect?"undefined":D.default(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function q(e,t){return["".concat((new Date).toISOString()," Conversations ").concat(e,":")].concat(Array.from(t))}var V=B.getLogger("twilio-conversations"),z=function(){function e(t){M.default(this,e),L.default(this,"prefix",""),this.prefix=null!=t&&t.length>0?t+" ":""}return C.default(e,[{key:"setLevel",value:function(e){V.setLevel(e)}},{key:"trace",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];V.trace.apply(null,q(this.prefix+"T",t))}},{key:"debug",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];V.debug.apply(null,q(this.prefix+"D",t))}},{key:"info",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];V.info.apply(null,q(this.prefix+"I",t))}},{key:"warn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];V.warn.apply(null,q(this.prefix+"W",t))}},{key:"error",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];V.error.apply(null,q(this.prefix+"E",t))}}],[{key:"scope",value:function(t){return new e(t)}},{key:"setLevel",value:function(e){V.setLevel(e)}},{key:"trace",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];V.trace.apply(null,q("T",t))}},{key:"debug",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];V.debug.apply(null,q("D",t))}},{key:"info",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];V.info.apply(null,q("I",t))}},{key:"warn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];V.warn.apply(null,q("W",t))}},{key:"error",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];V.error.apply(null,q("E",t))}}]),e}();function Y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function K(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Y(Object(n),!0).forEach((function(t){L.default(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var $="PT5S",X="PT5S",J=function e(){var t,n,r,i,o,s,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},u=arguments.length>1?arguments[1]:void 0,c=arguments.length>2?arguments[2]:void 0;M.default(this,e),L.default(this,"typingIndicatorTimeoutDefault",5e3);var l=a.Chat||a.IPMessaging||a||{};this.productId=l.productId,this.links={myConversations:u.links.my_conversations,conversations:u.links.conversations,users:u.links.users,currentUser:u.links.current_user,typing:u.links.typing,mediaService:u.links.media_service,mediaSetService:u.links.media_set_service,messagesReceipts:u.links.messages_receipts},this.limits={mediaAttachmentsCountLimit:u.options.media_attachments_count_limit,mediaAttachmentSizeLimitInMb:u.options.media_attachment_size_limit_in_mb,mediaAttachmentsTotalSizeLimitInMb:u.options.media_attachments_total_size_limit_in_mb,emailHistoriesAllowedMimeTypes:u.options.email_histories_allowed_mime_types,emailBodiesAllowedMimeTypes:u.options.email_bodies_allowed_mime_types},this.typingIndicatorTimeoutOverride=l.typingIndicatorTimeoutOverride,this.backoffConfiguration=K({min:1e3,max:4e3,maxAttemptsCount:3},l.backoffConfigOverride),this.retryWhenThrottled=void 0===l.retryWhenThrottledOverride||l.retryWhenThrottledOverride,this.userInfosToSubscribe=null!==(t=null!==(n=l.userInfosToSubscribeOverride)&&void 0!==n?n:u.options.user_infos_to_subscribe)&&void 0!==t?t:100,this.reachabilityEnabled=u.options.reachability_enabled,this.userIdentity=u.identity,this.userInfo=u.sync_objects.my_user_info,this.myConversations=u.sync_objects.my_conversations;var d=null!==(r=null!==(i=l.httpCacheIntervalOverride)&&void 0!==i?i:u.options.http_cache_interval)&&void 0!==r?r:$;try{this.httpCacheInterval=h.toSeconds(h.parse(d))}catch(e){c.error("Failed to parse http cache interval ".concat(d,", using default value ").concat($)),this.httpCacheInterval=h.toSeconds(h.parse($))}var f=null!==(o=null!==(s=l.consumptionReportIntervalOverride)&&void 0!==s?s:u.options.consumption_report_interval)&&void 0!==o?o:X;try{this.consumptionReportInterval=h.toSeconds(h.parse(f))}catch(e){c.error("Failed to parse consumption report interval ".concat(f,", using default value ").concat(X)),this.consumptionReportInterval=h.toSeconds(h.parse(X))}};function Z(e){return JSON.parse(JSON.stringify(e))}function Q(e){return void 0===e||isNaN(Number(e))?null:Number(e)}function ee(e){try{return new Date(e)}catch(e){return null}}function te(e,t,n){var r={};if(e)try{r=JSON.parse(e)}catch(e){n.warn(t,e)}return r}var ne=function(){function e(t){M.default(this,e),this.base=t.replace(/\/$/,""),this.args=[],this.paths=[]}return C.default(e,[{key:"arg",value:function(e,t){return void 0!==t&&this.args.push(encodeURIComponent(e)+"="+encodeURIComponent(t)),this}},{key:"path",value:function(e){return this.paths.push(encodeURIComponent(e)),this}},{key:"build",value:function(){var e=this.base;return this.paths.length&&(e+="/"+this.paths.join("/")),this.args.length&&(e+="?"+this.args.join("&")),e}}]),e}(),re=y.custom((function(e){return[["string","number","boolean","object"].includes(D.default(e)),"a JSON type"]})),ie=y.custom((function(e){return[["undefined","string","number","boolean","object"].includes(D.default(e)),"an optional JSON type"]}));function oe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=N.default(e);if(t){var i=N.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return P.default(this,n)}}var se=z.scope("User"),ae=function(e){A.default(c,e);var t,n,r,i,o,s,a,u=oe(c);function c(e,t,n,r){var i;return M.default(this,c),i=u.call(this),L.default(R.default(i),"promiseToFetch",null),L.default(R.default(i),"updated","updated"),L.default(R.default(i),"userSubscribed","userSubscribed"),L.default(R.default(i),"userUnsubscribed","userUnsubscribed"),i.services=r,i.subscribed="initializing",i.setMaxListeners(0),i.state={identity:e,entityName:t,friendlyName:null,attributes:{},online:null,notifiable:null},i._initializationPromise=new Promise((function(e){i._resolveInitializationPromise=e})),null!==n&&i._resolveInitialization(n,e,t,!1),i}return C.default(c,[{key:"identity",get:function(){return this.state.identity},set:function(e){this.state.identity=e}},{key:"entityName",set:function(e){this.state.entityName=e}},{key:"attributes",get:function(){return this.state.attributes}},{key:"friendlyName",get:function(){return this.state.friendlyName}},{key:"isOnline",get:function(){return this.state.online}},{key:"isNotifiable",get:function(){return this.state.notifiable}},{key:"isSubscribed",get:function(){return"subscribed"==this.subscribed}},{key:"_update",value:(a=I.default(j.default.mark((function e(t,n){var r,i;return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._initializationPromise;case 2:r=[],se.debug("User for",this.state.identity,"updated:",t,n),e.t0=t,e.next="friendlyName"===e.t0?7:"attributes"===e.t0?9:"reachability"===e.t0?12:15;break;case 7:return this.state.friendlyName!==n.value&&(r.push("friendlyName"),this.state.friendlyName=n.value),e.abrupt("break",16);case 9:return i=te(n.value,"Retrieved malformed attributes from the server for user: ".concat(this.state.identity),se),U.default(this.state.attributes,i)||(this.state.attributes=i,r.push("attributes")),e.abrupt("break",16);case 12:return this.state.online!==n.online&&(this.state.online=n.online,r.push("reachabilityOnline")),this.state.notifiable!==n.notifiable&&(this.state.notifiable=n.notifiable,r.push("reachabilityNotifiable")),e.abrupt("break",16);case 15:return e.abrupt("return");case 16:r.length>0&&this.emit("updated",{user:this,updateReasons:r});case 17:case"end":return e.stop()}}),e,this)}))),function(e,t){return a.apply(this,arguments)})},{key:"_updateReachabilityInfo",value:(s=I.default(j.default.mark((function e(t,n){var r=this;return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._initializationPromise;case 2:if(this.configuration.reachabilityEnabled){e.next=4;break}return e.abrupt("return",Promise.resolve());case 4:return e.abrupt("return",t.get("reachability").then(n).catch((function(e){se.warn("Failed to get reachability info for ",r.state.identity,e)})));case 5:case"end":return e.stop()}}),e,this)}))),function(e,t){return s.apply(this,arguments)})},{key:"_fetch",value:(o=I.default(j.default.mark((function e(){var t=this;return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._initializationPromise;case 2:if(this.state.entityName){e.next=4;break}return e.abrupt("return",this);case 4:return this.promiseToFetch=this.services.syncClient.map({id:this.state.entityName,mode:"open_existing",includeItems:!0}).then((function(e){return t.entity=e,e.on("itemUpdated",(function(e){return se.debug(t.state.entityName+" ("+t.state.identity+") itemUpdated: "+e.item.key),t._update(e.item.key,e.item.data)})),Promise.all([e.get("friendlyName").then((function(e){return t._update(e.key,e.data)})),e.get("attributes").then((function(e){return t._update(e.key,e.data)})),t._updateReachabilityInfo(e,(function(e){return t._update(e.key,e.data)}))])})).then((function(){return se.debug("Fetched for",t.identity),t.subscribed="subscribed",t.emit("userSubscribed",t),t})).catch((function(e){throw t.promiseToFetch=null,e})),e.abrupt("return",this.promiseToFetch);case 6:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"_ensureFetched",value:(i=I.default(j.default.mark((function e(){return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._initializationPromise;case 2:return e.abrupt("return",this.promiseToFetch||this._fetch());case 3:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"updateAttributes",value:(r=I.default(j.default.mark((function e(t){return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._initializationPromise;case 2:if("unsubscribed"!=this.subscribed){e.next=4;break}throw new Error("Can't modify unsubscribed object");case 4:return e.next=6,this.services.commandExecutor.mutateResource("post",this.links.self,{attributes:JSON.stringify(t)});case 6:return e.abrupt("return",this);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"updateFriendlyName",value:(n=I.default(j.default.mark((function e(t){return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._initializationPromise;case 2:if("unsubscribed"!=this.subscribed){e.next=4;break}throw new Error("Can't modify unsubscribed object");case 4:return e.next=6,this.services.commandExecutor.mutateResource("post",this.links.self,{friendly_name:t});case 6:return e.abrupt("return",this);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"unsubscribe",value:(t=I.default(j.default.mark((function e(){return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._initializationPromise;case 2:if(!this.promiseToFetch){e.next=9;break}return e.next=5,this.promiseToFetch;case 5:this.entity.close(),this.promiseToFetch=null,this.subscribed="unsubscribed",this.emit("userUnsubscribed",this);case 9:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"_resolveInitialization",value:function(e,t,n,r){this.configuration=e,this.identity=t,this.entityName=n,this.links={self:"".concat(this.configuration.links.users,"/").concat(this.identity)},this._resolveInitializationPromise(),r&&this.emit("updated",{user:this,updateReasons:["friendlyName","attributes","reachabilityOnline","reachabilityNotifiable"]})}}]),c}(v.ReplayEventEmitter);function ue(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return ce(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ce(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function ce(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}G([y.validateTypesAsync(re),W("design:type",Function),W("design:paramtypes",[Object]),W("design:returntype",Promise)],ae.prototype,"updateAttributes",null),G([y.validateTypesAsync(["string"]),W("design:type",Function),W("design:paramtypes",[String]),W("design:returntype",Promise)],ae.prototype,"updateFriendlyName",null);var le=function(){function e(t,n){M.default(this,e),this.configuration=t,this.services=n,this.cache=new Map,this.cacheLifetime=100*this.configuration.httpCacheInterval,this.cleanupCache()}var t;return C.default(e,[{key:"isExpired",value:function(e){return!this.cacheLifetime||Date.now()-e>this.cacheLifetime}},{key:"cleanupCache",value:function(){var e,t=ue(this.cache);try{for(t.s();!(e=t.n()).done;){var n=F.default(e.value,2),r=n[0],i=n[1];this.isExpired(i.timestamp)&&this.cache.delete(r)}}catch(e){t.e(e)}finally{t.f()}0===this.cache.size&&clearInterval(this.timer)}},{key:"pokeTimer",value:function(){var e=this;this.timer=this.timer||setInterval((function(){return e.cleanupCache()}),2*this.cacheLifetime)}},{key:"executeWithRetry",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new Promise((function(r,i){var o=[502,503,504];n&&o.push(429);var s=new b.Retrier(t.configuration.backoffConfiguration);s.on("attempt",(function(){e().then((function(e){return s.succeeded(e)})).catch((function(e){o.indexOf(e.status)>-1||"Twilsock disconnected"===e.message?s.failed(e):(s.removeAllListeners(),s.cancel(),i(e))}))})),s.on("succeeded",(function(e){r(e)})),s.on("cancelled",(function(e){return i(e)})),s.on("failed",(function(e){return i(e)})),s.start()}))}},{key:"get",value:(t=I.default(j.default.mark((function e(t){var n,r,i,o=this;return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=this.cache.get(t))||this.isExpired(n.timestamp)){e.next=3;break}return e.abrupt("return",n.response);case 3:return r={},e.next=6,this.executeWithRetry((function(){return o.services.transport.get(t,r,o.configuration.productId)}),this.configuration.retryWhenThrottled);case 6:return i=e.sent,this.cache.set(t,{response:i,timestamp:Date.now()}),this.pokeTimer(),e.abrupt("return",i);case 10:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),e}(),de=function e(){M.default(this,e)};function fe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=N.default(e);if(t){var i=N.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return P.default(this,n)}}L.default(de,"TYPING_INDICATOR","twilio.ipmsg.typing_indicator"),L.default(de,"NEW_MESSAGE","twilio.conversations.new_message"),L.default(de,"ADDED_TO_CONVERSATION","twilio.conversations.added_to_conversation"),L.default(de,"REMOVED_FROM_CONVERSATION","twilio.conversations.removed_from_conversation"),L.default(de,"CONSUMPTION_UPDATE","twilio.channel.consumption_update");var pe=z.scope("Participant"),he=function(e){A.default(o,e);var t,n,r,i=fe(o);function o(e,t,n,r,s){var a,u,c;if(M.default(this,o),(c=i.call(this)).conversation=n,c.links=r,c.services=s,c.state={attributes:te(e.attributes,"Retrieved malformed attributes from the server for participant: "+t,pe),dateCreated:e.dateCreated?ee(e.dateCreated):null,dateUpdated:e.dateCreated?ee(e.dateUpdated):null,sid:t,typingTimeout:null,isTyping:!1,identity:e.identity,roleSid:null!==(a=e.roleSid)&&void 0!==a?a:"",lastReadMessageIndex:Number.isInteger(e.lastConsumedMessageIndex)?e.lastConsumedMessageIndex:null,lastReadTimestamp:e.lastConsumptionTimestamp?ee(e.lastConsumptionTimestamp):null,type:e.type||"chat",userInfo:e.userInfo,bindings:null!==(u=e.bindings)&&void 0!==u?u:{}},!e.identity&&!e.type)throw new Error("Received invalid Participant object from server: Missing identity or type of Participant.");return c}return C.default(o,[{key:"sid",get:function(){return this.state.sid}},{key:"attributes",get:function(){return this.state.attributes}},{key:"dateCreated",get:function(){return this.state.dateCreated}},{key:"dateUpdated",get:function(){return this.state.dateUpdated}},{key:"identity",get:function(){return this.state.identity}},{key:"isTyping",get:function(){return this.state.isTyping}},{key:"lastReadMessageIndex",get:function(){return this.state.lastReadMessageIndex}},{key:"lastReadTimestamp",get:function(){return this.state.lastReadTimestamp}},{key:"roleSid",get:function(){return this.state.roleSid}},{key:"type",get:function(){return this.state.type}},{key:"bindings",get:function(){var e;return null!==(e=this.state.bindings)&&void 0!==e?e:{}}},{key:"_startTyping",value:function(e){var t=this;return this.state.typingTimeout&&clearTimeout(this.state.typingTimeout),this.state.isTyping=!0,this.emit("typingStarted",this),this.conversation.emit("typingStarted",this),this.state.typingTimeout=Number(setTimeout((function(){return t._endTyping()}),e)),this}},{key:"_endTyping",value:function(){this.state.typingTimeout&&(this.state.isTyping=!1,this.emit("typingEnded",this),this.conversation.emit("typingEnded",this),clearInterval(this.state.typingTimeout),this.state.typingTimeout=null)}},{key:"_update",value:function(e){var t=[],n=te(e.attributes,"Retrieved malformed attributes from the server for participant: "+this.state.sid,pe);e.attributes&&!U.default(this.state.attributes,n)&&(this.state.attributes=n,t.push("attributes"));var r=ee(e.dateUpdated);e.dateUpdated&&(null==r?void 0:r.getTime())!==(this.state.dateUpdated&&this.state.dateUpdated.getTime())&&(this.state.dateUpdated=r,t.push("dateUpdated"));var i=ee(e.dateCreated);if(e.dateCreated&&(null==i?void 0:i.getTime())!==(this.state.dateCreated&&this.state.dateCreated.getTime())&&(this.state.dateCreated=i,t.push("dateCreated")),e.roleSid&&this.state.roleSid!==e.roleSid&&(this.state.roleSid=e.roleSid,t.push("roleSid")),!Number.isInteger(e.lastConsumedMessageIndex)&&null!==e.lastConsumedMessageIndex||this.state.lastReadMessageIndex===e.lastConsumedMessageIndex||(this.state.lastReadMessageIndex=e.lastConsumedMessageIndex,t.push("lastReadMessageIndex")),e.lastConsumptionTimestamp){var o=new Date(e.lastConsumptionTimestamp);this.state.lastReadTimestamp&&this.state.lastReadTimestamp.getTime()===o.getTime()||(this.state.lastReadTimestamp=o,t.push("lastReadTimestamp"))}return e.bindings&&!U.default(this.state.bindings,e.bindings)&&(this.state.bindings=e.bindings,t.push("bindings")),t.length>0&&this.emit("updated",{participant:this,updateReasons:t}),this}},{key:"getUser",value:(r=I.default(j.default.mark((function e(){return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("chat"==this.type){e.next=2;break}throw new Error("Getting User is not supported for this Participant type: "+this.type);case 2:return e.abrupt("return",this.services.users.getUser(this.state.identity,this.state.userInfo));case 3:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"remove",value:(n=I.default(j.default.mark((function e(){return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.conversation.removeParticipant(this));case 1:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"updateAttributes",value:(t=I.default(j.default.mark((function e(t){return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.services.commandExecutor.mutateResource("post",this.links.self,{attributes:JSON.stringify(t)});case 2:return e.abrupt("return",this);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),o}(v.ReplayEventEmitter);function ye(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=N.default(e);if(t){var i=N.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return P.default(this,n)}}L.default(he,"typingStarted","typingStarted"),L.default(he,"typingEnded","typingEnded"),L.default(he,"updated","updated"),G([y.validateTypesAsync(re),W("design:type",Function),W("design:paramtypes",[Object]),W("design:returntype",Promise)],he.prototype,"updateAttributes",null);var ve=z.scope("Participants"),me=function(e){A.default(u,e);var t,n,r,i,o,s,a=ye(u);function u(e,t,n,r,i){var o;return M.default(this,u),o=a.call(this),L.default(R.default(o),"rosterEntityPromise",null),o.conversation=e,o.participants=t,o.links=n,o.configuration=r,o.services=i,o}return C.default(u,[{key:"unsubscribe",value:(s=I.default(j.default.mark((function e(){return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.rosterEntityPromise){e.next=6;break}return e.next=3,this.rosterEntityPromise;case 3:e.sent.close(),this.rosterEntityPromise=null;case 6:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"subscribe",value:function(e){var t=this;return this.rosterEntityPromise=this.rosterEntityPromise||this.services.syncClient.map({id:e,mode:"open_existing"}).then((function(e){e.on("itemAdded",(function(e){ve.debug(t.conversation.sid+" itemAdded: "+e.item.key),t.upsertParticipant(e.item.key,e.item.data).then((function(e){t.emit("participantJoined",e)}))})),e.on("itemRemoved",(function(e){ve.debug(t.conversation.sid+" itemRemoved: "+e.key);var n=e.key;if(t.participants.has(n)){var r=t.participants.get(n);t.participants.delete(n),r&&t.emit("participantLeft",r)}})),e.on("itemUpdated",(function(e){ve.debug(t.conversation.sid+" itemUpdated: "+e.item.key),t.upsertParticipant(e.item.key,e.item.data)}));var n=[];return e.getItems().then((function e(r){return r.items.forEach((function(e){n.push(t.upsertParticipant(e.key,e.data))})),r.hasNextPage?r.nextPage().then(e):null})).then((function(){return Promise.all(n)})).then((function(){return e}))})).catch((function(e){throw t.rosterEntityPromise=null,"disconnected"!=t.services.syncClient.connectionState&&ve.error("Failed to get roster object for conversation",t.conversation.sid,e),ve.debug("ERROR: Failed to get roster object for conversation",t.conversation.sid,e),e}))}},{key:"upsertParticipant",value:(o=I.default(j.default.mark((function e(t,n){var r,i,o=this;return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=this.participants.get(t))){e.next=3;break}return e.abrupt("return",r._update(n));case 3:return i={self:"".concat(this.links.participants,"/").concat(t)},r=new he(n,t,this.conversation,i,this.services),this.participants.set(t,r),r.on("updated",(function(e){return o.emit("participantUpdated",e)})),e.abrupt("return",r);case 8:case"end":return e.stop()}}),e,this)}))),function(e,t){return o.apply(this,arguments)})},{key:"getParticipants",value:(i=I.default(j.default.mark((function e(){var t=this;return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.rosterEntityPromise?this.rosterEntityPromise.then((function(){var e=[];return t.participants.forEach((function(t){return e.push(t)})),e})):[]);case 1:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"getParticipantBySid",value:(r=I.default(j.default.mark((function e(t){var n=this;return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.rosterEntityPromise?this.rosterEntityPromise.then((function(){var e=n.participants.get(t);if(!e)throw new Error("Participant with SID "+t+" was not found");return e})):null);case 1:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"getParticipantByIdentity",value:(n=I.default(j.default.mark((function e(t){var n,r=this;return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=null,e.abrupt("return",this.rosterEntityPromise?this.rosterEntityPromise.then((function(){if(r.participants.forEach((function(e){e.identity===t&&(n=e)})),!n)throw new Error("Participant with identity "+t+" was not found");return n})):null);case 2:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"add",value:(t=I.default(j.default.mark((function e(t,n){return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.services.commandExecutor.mutateResource("post",this.links.participants,{identity:t,attributes:void 0!==n?JSON.stringify(n):void 0});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:"addNonChatParticipant",value:function(e,t){var n,r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.services.commandExecutor.mutateResource("post",this.links.participants,{attributes:void 0!==i?JSON.stringify(i):void 0,messaging_binding:{address:t,proxy_address:e,name:null==o||null===(n=o.email)||void 0===n?void 0:n.name,level:null==o||null===(r=o.email)||void 0===r?void 0:r.level}})}},{key:"remove",value:function(e){return this.services.commandExecutor.mutateResource("delete","".concat(this.links.participants,"/").concat(e))}}]),u}(v.ReplayEventEmitter),ge=function(){function e(t,n){M.default(this,e),L.default(this,"mcsMedia",null),this.services=n,t instanceof x.McsMedia&&(this.mcsMedia=t),this.state={sid:t.sid,category:t.category,filename:t.filename,contentType:t.contentType,size:t.size}}var t,n,r;return C.default(e,[{key:"sid",get:function(){return this.state.sid}},{key:"filename",get:function(){return this.state.filename}},{key:"contentType",get:function(){return this.state.contentType}},{key:"size",get:function(){return this.state.size}},{key:"category",get:function(){return this.state.category}},{key:"getContentTemporaryUrl",value:(r=I.default(j.default.mark((function e(){var t,n;return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._fetchMcsMedia();case 2:return e.abrupt("return",null!==(t=null===(n=this.mcsMedia)||void 0===n?void 0:n.getContentUrl())&&void 0!==t?t:null);case 3:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"getCachedTemporaryUrl",value:(n=I.default(j.default.mark((function e(){var t,n;return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._fetchMcsMedia();case 2:return e.abrupt("return",null!==(t=null===(n=this.mcsMedia)||void 0===n?void 0:n.getCachedContentUrl())&&void 0!==t?t:null);case 3:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"_fetchMcsMedia",value:(t=I.default(j.default.mark((function e(){return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.mcsMedia){e.next=8;break}if(!this.services.mcsClient){e.next=7;break}return e.next=4,this.services.mcsClient.get(this.state.sid);case 4:this.mcsMedia=e.sent,e.next=8;break;case 7:throw new Error("Media Content Service is unavailable");case 8:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}(),be=function(){function e(t){M.default(this,e),this.state=t}return C.default(e,[{key:"total",get:function(){return this.state.total}},{key:"sent",get:function(){return this.state.sent}},{key:"delivered",get:function(){return this.state.delivered}},{key:"read",get:function(){return this.state.read}},{key:"undelivered",get:function(){return this.state.undelivered}},{key:"failed",get:function(){return this.state.failed}},{key:"_update",value:function(e){this.state=e}},{key:"_isEquals",value:function(e){var t=this.total===e.total,n=this.sent===e.sent,r=this.delivered===e.delivered,i=this.read===e.read,o=this.undelivered===e.undelivered,s=this.failed===e.failed;return t&&n&&r&&i&&o&&s}}]),e}(),_e=function(){function e(t,n,r,i){M.default(this,e),this.state={prevToken:r,nextToken:i,source:n,items:t}}return C.default(e,[{key:"hasNextPage",get:function(){return!!this.state.nextToken}},{key:"hasPrevPage",get:function(){return!!this.state.prevToken}},{key:"items",get:function(){return this.state.items}},{key:"nextPage",value:function(){return this.hasNextPage?this.state.source(this.state.nextToken):Promise.reject(new Error("No next page"))}},{key:"prevPage",value:function(){return this.hasPrevPage?this.state.source(this.state.prevToken):Promise.reject(new Error("No previous page"))}}]),e}(),we=function e(t){M.default(this,e),this.sid=t.sid,this.messageSid=t.message_sid,this.conversationSid=t.conversation_sid,this.channelMessageSid=t.channel_message_sid,this.participantSid=t.participant_sid,this.status=t.status||"queued",this.errorCode=t.error_code||0,this.dateCreated=t.date_created,this.dateUpdated=t.date_updated};function ke(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=N.default(e);if(t){var i=N.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return P.default(this,n)}}var xe=z.scope("Message"),Se=function(e){A.default(c,e);var t,n,r,i,o,s,a,u=ke(c);function c(e,t,n,r,i,o){var s,a,l,d,f;return M.default(this,c),(f=u.call(this)).conversation=n,f.links=r,f.configuration=i,f.services=o,f.state={sid:t.sid,index:e,author:t.author,subject:t.subject,body:null!==(s=t.text)&&void 0!==s?s:null,timestamp:t.timestamp?new Date(t.timestamp):null,dateUpdated:t.dateUpdated?new Date(t.dateUpdated):null,lastUpdatedBy:null!==(a=t.lastUpdatedBy)&&void 0!==a?a:null,attributes:te(t.attributes,"Got malformed attributes for the message ".concat(t.sid),xe),type:null!==(l=t.type)&&void 0!==l?l:"text",media:t.type&&"media"===t.type&&t.media?new ge(t.media,f.services):null,medias:t.type&&"media"===t.type&&t.medias?t.medias.map((function(e){return new ge(e,f.services)})):null,participantSid:null!==(d=t.memberSid)&&void 0!==d?d:null,aggregatedDeliveryReceipt:t.delivery?new be(t.delivery):null},f}return C.default(c,[{key:"sid",get:function(){return this.state.sid}},{key:"author",get:function(){return this.state.author}},{key:"subject",get:function(){return this.state.subject}},{key:"body",get:function(){return this.state.body}},{key:"dateUpdated",get:function(){return this.state.dateUpdated}},{key:"index",get:function(){return this.state.index}},{key:"lastUpdatedBy",get:function(){return this.state.lastUpdatedBy}},{key:"dateCreated",get:function(){return this.state.timestamp}},{key:"attributes",get:function(){return this.state.attributes}},{key:"type",get:function(){return this.state.type}},{key:"media",get:function(){return this.state.media}},{key:"attachedMedia",get:function(){return this.getMediaByCategory(["media"])}},{key:"participantSid",get:function(){return this.state.participantSid}},{key:"aggregatedDeliveryReceipt",get:function(){return this.state.aggregatedDeliveryReceipt}},{key:"getMediaByCategory",value:function(e){var t;return(null!==(t=this.state.medias)&&void 0!==t?t:[]).filter((function(t){return e.includes(t.category)}))}},{key:"getEmailBody",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"text/plain";return null!==(e=null===(t=this.getMediaByCategory(["body"]))||void 0===t?void 0:t.filter((function(e){return e.contentType==n})).shift())&&void 0!==e?e:null}},{key:"getEmailHistory",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"text/plain";return null!==(e=null===(t=this.getMediaByCategory(["history"]))||void 0===t?void 0:t.filter((function(e){return e.contentType==n})).shift())&&void 0!==e?e:null}},{key:"_update",value:function(e){var t=[];!e.text&&"string"!=typeof e.text||e.text===this.state.body||(this.state.body=e.text,t.push("body")),e.subject&&e.subject!==this.state.subject&&(this.state.subject=e.subject,t.push("subject")),e.lastUpdatedBy&&e.lastUpdatedBy!==this.state.lastUpdatedBy&&(this.state.lastUpdatedBy=e.lastUpdatedBy,t.push("lastUpdatedBy")),e.author&&e.author!==this.state.author&&(this.state.author=e.author,t.push("author")),e.dateUpdated&&new Date(e.dateUpdated).getTime()!==(this.state.dateUpdated&&this.state.dateUpdated.getTime())&&(this.state.dateUpdated=new Date(e.dateUpdated),t.push("dateUpdated")),e.timestamp&&new Date(e.timestamp).getTime()!==(this.state.timestamp&&this.state.timestamp.getTime())&&(this.state.timestamp=new Date(e.timestamp),t.push("dateCreated"));var n=te(e.attributes,"Got malformed attributes for the message ".concat(this.sid),xe);U.default(this.state.attributes,n)||(this.state.attributes=n,t.push("attributes"));var r=e.delivery,i=this.state.aggregatedDeliveryReceipt;!!(r&&r.total&&r.delivered&&r.failed&&r.read&&r.sent&&r.undelivered)&&(i?i._isEquals(r)||(i._update(r),t.push("deliveryReceipt")):(this.state.aggregatedDeliveryReceipt=new be(r),t.push("deliveryReceipt"))),t.length>0&&this.emit("updated",{message:this,updateReasons:t})}},{key:"getParticipant",value:(a=I.default(j.default.mark((function e(){var t,n,r=this;return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=null,!this.state.participantSid){e.next=5;break}return e.next=4,this.conversation.getParticipantBySid(this.state.participantSid).catch((function(){return xe.debug('Participant with sid "'.concat(r.participantSid,'" not found for message ').concat(r.sid)),null}));case 4:t=e.sent;case 5:if(t||!this.state.author){e.next=9;break}return e.next=8,this.conversation.getParticipantByIdentity(this.state.author).catch((function(){return xe.debug('Participant with identity "'.concat(r.author,'" not found for message ').concat(r.sid)),null}));case 8:t=e.sent;case 9:if(!t){e.next=11;break}return e.abrupt("return",t);case 11:throw n="Participant with ",this.state.participantSid&&(n+="SID '"+this.state.participantSid+"' "),this.state.author&&(this.state.participantSid&&(n+="or "),n+="identity '"+this.state.author+"' "),"Participant with "===n&&(n="Participant "),n+="was not found",new Error(n);case 17:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"getDetailedDeliveryReceipts",value:(s=I.default(j.default.mark((function e(){var t,n;return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._getDetailedDeliveryReceiptsPaginator();case 2:t=e.sent,n=[];case 4:if(n=[].concat(H.default(n),H.default(t.items)),t.hasNextPage){e.next=8;break}return e.abrupt("break",13);case 8:return e.next=10,t.nextPage();case 10:t=e.sent,e.next=4;break;case 13:return e.abrupt("return",n);case 14:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"remove",value:(o=I.default(j.default.mark((function e(){return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.services.commandExecutor.mutateResource("delete",this.links.self);case 2:return e.abrupt("return",this);case 3:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"updateBody",value:(i=I.default(j.default.mark((function e(t){return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.services.commandExecutor.mutateResource("post",this.links.self,{body:t});case 2:return e.abrupt("return",this);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"updateAttributes",value:(r=I.default(j.default.mark((function e(t){return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.services.commandExecutor.mutateResource("post",this.links.self,{attributes:void 0!==t?JSON.stringify(t):void 0});case 2:return e.abrupt("return",this);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"attachTemporaryUrlsFor",value:(n=I.default(j.default.mark((function e(t){var n,r=this;return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=null==t?void 0:t.map((function(e){return e.sid})),!this.services.mcsClient||!n){e.next=7;break}return e.next=4,this.services.mcsClient.mediaSetGet(n);case 4:return e.abrupt("return",e.sent.map((function(e){return new ge(e,r.services)})));case 7:throw new Error("Media Content Service is unavailable");case 8:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"_getDetailedDeliveryReceiptsPaginator",value:(t=I.default(j.default.mark((function e(t){var n,r,i,o=this;return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.configuration.links.messagesReceipts.replace("%s",this.conversation.sid).replace("%s",this.sid),r=new ne(n).arg("PageToken",null==t?void 0:t.pageToken).arg("PageSize",null==t?void 0:t.pageSize).build(),e.next=4,this.services.network.get(r);case 4:return i=e.sent,e.abrupt("return",new _e(i.body.delivery_receipts.map((function(e){return new we(e)})),(function(e,t){return o._getDetailedDeliveryReceiptsPaginator({pageToken:e,pageSize:t})}),i.body.meta.previous_token,i.body.meta.next_token));case 6:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),c}(v.ReplayEventEmitter);function Ee(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Te(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Te(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function Te(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Oe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=N.default(e);if(t){var i=N.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return P.default(this,n)}}L.default(Se,"updated","updated"),G([y.validateTypes([y.nonEmptyString,"undefined"]),W("design:type",Function),W("design:paramtypes",[Object]),W("design:returntype",ge)],Se.prototype,"getEmailBody",null),G([y.validateTypes([y.nonEmptyString,"undefined"]),W("design:type",Function),W("design:paramtypes",[Object]),W("design:returntype",ge)],Se.prototype,"getEmailHistory",null),G([y.validateTypesAsync("string"),W("design:type",Function),W("design:paramtypes",[String]),W("design:returntype",Promise)],Se.prototype,"updateBody",null),G([y.validateTypesAsync(re),W("design:type",Function),W("design:paramtypes",[Object]),W("design:returntype",Promise)],Se.prototype,"updateAttributes",null),G([y.validateTypesAsync(y.custom((function(e){return[e instanceof Array&&e.length>0&&e.reduce((function(e,t){return e&&t instanceof ge}),!0),"a non-empty array of Media"]}))),W("design:type",Function),W("design:paramtypes",[Array]),W("design:returntype",Promise)],Se.prototype,"attachTemporaryUrlsFor",null);var Ie=z.scope("Messages"),Ce=function(e){A.default(c,e);var t,n,r,i,o,s,a,u=Oe(c);function c(e,t,n){var r;return M.default(this,c),(r=u.call(this)).conversation=e,r.configuration=t,r.services=n,r.messagesByIndex=new Map,r.messagesListPromise=null,r}return C.default(c,[{key:"subscribe",value:(a=I.default(j.default.mark((function e(t){var n,r=this;return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.messagesListPromise){e.next=2;break}return e.abrupt("return",this.messagesListPromise);case 2:return this.messagesListPromise=this.services.syncClient.list({id:t,mode:"open_existing"}),e.prev=3,e.next=6,this.messagesListPromise;case 6:return(n=e.sent).on("itemAdded",(function(e){Ie.debug("".concat(r.conversation.sid," itemAdded: ").concat(e.item.index));var t={self:"".concat(r.conversation.links.messages,"/").concat(e.item.data.sid),conversation:r.conversation.links.self,messages_receipts:"".concat(r.conversation.links.messages,"/").concat(e.item.data.sid,"/Receipts")},n=new Se(e.item.index,e.item.data,r.conversation,t,r.configuration,r.services);r.messagesByIndex.has(n.index)?Ie.debug("Message arrived, but is already known and ignored",r.conversation.sid,n.index):(r.messagesByIndex.set(n.index,n),n.on("updated",(function(e){return r.emit("messageUpdated",e)})),r.emit("messageAdded",n))})),n.on("itemRemoved",(function(e){Ie.debug("#{this.conversation.sid} itemRemoved: ".concat(e.index));var t=e.index;if(r.messagesByIndex.has(t)){var n=r.messagesByIndex.get(t);if(!n)return;r.messagesByIndex.delete(n.index),n.removeAllListeners("updated"),r.emit("messageRemoved",n)}})),n.on("itemUpdated",(function(e){Ie.debug("".concat(r.conversation.sid," itemUpdated: ").concat(e.item.index));var t=r.messagesByIndex.get(e.item.index);t&&t._update(e.item.data)})),e.abrupt("return",n);case 13:throw e.prev=13,e.t0=e.catch(3),this.messagesListPromise=null,"disconnected"!==this.services.syncClient.connectionState&&Ie.error("Failed to get messages object for conversation",this.conversation.sid,e.t0),Ie.debug("ERROR: Failed to get messages object for conversation",this.conversation.sid,e.t0),e.t0;case 19:case"end":return e.stop()}}),e,this,[[3,13]])}))),function(e){return a.apply(this,arguments)})},{key:"unsubscribe",value:(s=I.default(j.default.mark((function e(){return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.messagesListPromise){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.messagesListPromise;case 4:e.sent.close(),this.messagesListPromise=null;case 7:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"sendV2",value:(o=I.default(j.default.mark((function e(t){var n,r,i,o,s,a,u,c,l;return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Ie.debug("Sending message V2",t.mediaContent,t.attributes,t.emailOptions),r=[],i=Ee(t.mediaContent),e.prev=3,i.s();case 5:if((o=i.n()).done){e.next=22;break}if(u=F.default(o.value,2),c=u[0],l=u[1],Ie.debug("Adding media to a message as ".concat(l instanceof FormData?"FormData":"SendMediaOptions"),l),e.t0=r,!(l instanceof FormData)){e.next=15;break}return e.next=12,this.services.mcsClient.postFormData(l,c);case 12:e.t1=e.sent,e.next=18;break;case 15:return e.next=17,this.services.mcsClient.post(null!==(s=l.contentType)&&void 0!==s?s:"",null!==(a=l.media)&&void 0!==a?a:"",c,l.filename);case 17:e.t1=e.sent;case 18:e.t2=e.t1,e.t0.push.call(e.t0,e.t2);case 20:e.next=5;break;case 22:e.next=27;break;case 24:e.prev=24,e.t3=e.catch(3),i.e(e.t3);case 27:return e.prev=27,i.f(),e.finish(27);case 30:return e.next=32,this.services.commandExecutor.mutateResource("post",this.conversation.links.messages,{body:t.text,subject:null===(n=t.emailOptions)||void 0===n?void 0:n.subject,media_sids:r.map((function(e){return e.sid})),attributes:void 0!==t.attributes?JSON.stringify(t.attributes):void 0});case 32:return e.abrupt("return",e.sent);case 33:case"end":return e.stop()}}),e,this,[[3,24,27,30]])}))),function(e){return o.apply(this,arguments)})},{key:"send",value:(i=I.default(j.default.mark((function e(t){var n,r,i=arguments;return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:{},r=i.length>2?i[2]:void 0,Ie.debug("Sending text message",t,n,r),e.next=5,this.services.commandExecutor.mutateResource("post",this.conversation.links.messages,{body:null!=t?t:"",attributes:void 0!==n?JSON.stringify(n):void 0,subject:null==r?void 0:r.subject});case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"sendMedia",value:(r=I.default(j.default.mark((function e(t){var n,r,i,o,s,a=arguments;return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=a.length>1&&void 0!==a[1]?a[1]:{},o=a.length>2?a[2]:void 0,Ie.debug("Sending media message",t,i,o),Ie.debug("Sending media message as ".concat(t instanceof FormData?"FormData":"SendMediaOptions"),t,i),!(t instanceof FormData)){e.next=10;break}return e.next=7,this.services.mcsClient.postFormData(t);case 7:e.t0=e.sent,e.next=13;break;case 10:return e.next=12,this.services.mcsClient.post(null!==(n=t.contentType)&&void 0!==n?n:"",null!==(r=t.media)&&void 0!==r?r:"","media",t.filename);case 12:e.t0=e.sent;case 13:return s=e.t0,e.next=16,this.services.commandExecutor.mutateResource("post",this.conversation.links.messages,{media_sids:[s.sid],attributes:void 0!==i?JSON.stringify(i):void 0});case 16:return e.abrupt("return",e.sent);case 17:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"getMessages",value:(n=I.default(j.default.mark((function e(t,n){var r,i=arguments;return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.length>2&&void 0!==i[2]?i[2]:"backwards",e.abrupt("return",this._getMessages(t,n,r));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"_wrapPaginator",value:function(e,t,n){var r=this,i="desc"===e,o=function(){return t.nextPage().then((function(t){return r._wrapPaginator(e,t,n)}))},s=function(){return t.prevPage().then((function(t){return r._wrapPaginator(e,t,n)}))};return n(t.items).then((function(e){return{items:e.sort((function(e,t){return e.index-t.index})),hasPrevPage:i?t.hasNextPage:t.hasPrevPage,hasNextPage:i?t.hasPrevPage:t.hasNextPage,prevPage:i?o:s,nextPage:i?s:o}}))}},{key:"_upsertMessage",value:function(e,t){var n=this,r=this.messagesByIndex.get(e);if(r)return r;var i={self:"".concat(this.conversation.links.messages,"/").concat(t.sid),conversation:this.conversation.links.self,messages_receipts:"".concat(this.conversation.links.messages,"/").concat(t.sid,"/Receipts")},o=new Se(e,t,this.conversation,i,this.configuration,this.services);return this.messagesByIndex.set(o.index,o),o.on("updated",(function(e){return n.emit("messageUpdated",e)})),o}},{key:"_getMessages",value:(t=I.default(j.default.mark((function e(){var t,n,r,i,o,s,a=this,u=arguments;return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=u.length>0&&void 0!==u[0]?u[0]:30,n=u.length>1&&void 0!==u[1]?u[1]:"end",r=u.length>2&&void 0!==u[2]?u[2]:"forward",i="backwards"===r?"desc":"asc",e.next=6,this.messagesListPromise;case 6:return o=e.sent,e.next=9,null==o?void 0:o.getItems({from:"end"!==n?n:void 0,pageSize:t,order:i,limit:t});case 9:return s=e.sent,e.next=12,this._wrapPaginator(i,s,(function(e){return Promise.all(e.map((function(e){return a._upsertMessage(e.index,e.data)})))}));case 12:return e.abrupt("return",e.sent);case 13:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),c}(v.ReplayEventEmitter),Re=function(){function e(t){M.default(this,e),L.default(this,"attributes",{}),L.default(this,"mediaContent",[]),L.default(this,"emailOptions",{}),this.messagesEntity=t}var t;return C.default(e,[{key:"send",value:(t=I.default(j.default.mark((function e(){var t;return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.messagesEntity.sendV2(this);case 2:return t=e.sent,e.abrupt("return",Q(t.index));case 4:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}(),Ae=function(){function e(t,n){M.default(this,e),this.limits=t,this.message=new Re(n),this.emailBodies=new Map,this.emailHistories=new Map}return C.default(e,[{key:"setBody",value:function(e){return this.message.text=e,this}},{key:"setSubject",value:function(e){return this.message.emailOptions.subject=e,this}},{key:"setAttributes",value:function(e){return this.message.attributes=e,this}},{key:"setEmailBody",value:function(e,t){return this.emailBodies.set(e,t),this}},{key:"setEmailHistory",value:function(e,t){return this.emailHistories.set(e,t),this}},{key:"addMedia",value:function(e){if("undefined"==typeof FormData&&e instanceof FormData)throw new Error("Could not add FormData content whilst not in a browser");if(!(e instanceof FormData)){var t=e;if(!t.contentType||!t.media)throw new Error("Media content in SendMediaOptions must contain non-empty contentType and media")}return this.message.mediaContent.push(["media",e]),this}},{key:"build",value:function(){var e=this;if(this.emailBodies.forEach((function(t,n){if(!e.limits.emailBodiesAllowedMimeTypes.includes(n))throw new Error("Unsupported email body MIME type ".concat(n))})),this.emailHistories.forEach((function(t,n){if(!e.limits.emailHistoriesAllowedMimeTypes.includes(n))throw new Error("Unsupported email history MIME type ".concat(n))})),this.emailBodies.size>this.limits.emailBodiesAllowedMimeTypes.length)throw new Error("Too many email bodies attached to the message (".concat(this.emailBodies.size," > ").concat(this.limits.emailBodiesAllowedMimeTypes.length,")"));if(this.emailHistories.size>this.limits.emailHistoriesAllowedMimeTypes.length)throw new Error("Too many email histories attached to the message (".concat(this.emailHistories.size," > ").concat(this.limits.emailHistoriesAllowedMimeTypes.length,")"));if(this.message.mediaContent.length>this.limits.mediaAttachmentsCountLimit)throw new Error("Too many media attachments in the message (".concat(this.message.mediaContent.length," > ").concat(this.limits.mediaAttachmentsCountLimit,")"));return this.emailBodies.forEach((function(t){e.message.mediaContent.push(["body",t])})),this.emailHistories.forEach((function(t){e.message.mediaContent.push(["history",t])})),this.message}},{key:"getPayloadContentType",value:function(e){return"undefined"!=typeof FormData&&e instanceof FormData?e.get("Content-Type"):e.contentType}}]),e}();function Pe(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Ne(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ne(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function Ne(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Le(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=N.default(e);if(t){var i=N.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return P.default(this,n)}}var Me=z.scope("Conversation"),je={lastMessage:"lastMessage",attributes:"attributes",createdBy:"createdBy",dateCreated:"dateCreated",dateUpdated:"dateUpdated",friendlyName:"friendlyName",lastConsumedMessageIndex:"lastConsumedMessageIndex",notificationLevel:"notificationLevel",sid:"sid",status:"status",uniqueName:"uniqueName",state:"state",bindings:"bindings"};function De(e){try{return new Date(e)}catch(e){return null}}var Be=function(e){A.default(P,e);var t,n,r,i,o,s,a,u,c,l,d,f,p,h,y,v,m,g,b,_,w,k,x,S,E,T,O=Le(P);function P(e,t,n,r,i){var o,s;M.default(this,P),(s=O.call(this)).sid=t,s.links=n,s.configuration=r,s.services=i;var a=e.attributes||{},u=e.createdBy,c=De(e.dateCreated),l=De(e.dateUpdated),d=e.friendlyName||null,f=Number.isInteger(e.lastConsumedMessageIndex)?e.lastConsumedMessageIndex:null,p=e.uniqueName||null;try{JSON.stringify(a)}catch(e){throw new Error("Attributes must be a valid JSON object.")}s.entityName=e.channel,s.channelState={uniqueName:p,status:"notParticipating",attributes:a,createdBy:u,dateCreated:c,dateUpdated:l,friendlyName:d,lastReadMessageIndex:f,bindings:null!==(o=e.bindings)&&void 0!==o?o:{}},e.notificationLevel&&(s.channelState.notificationLevel=e.notificationLevel);var h={participants:s.links.participants};return s.participants=new Map,s.participantsEntity=new me(R.default(s),s.participants,h,s.configuration,s.services),s.participantsEntity.on("participantJoined",(function(e){return s.emit("participantJoined",e)})),s.participantsEntity.on("participantLeft",(function(e){return s.emit("participantLeft",e)})),s.participantsEntity.on("participantUpdated",(function(e){return s.emit("participantUpdated",e)})),s.messagesEntity=new Ce(R.default(s),r,i),s.messagesEntity.on("messageAdded",(function(e){return s._onMessageAdded(e)})),s.messagesEntity.on("messageUpdated",(function(e){return s.emit("messageUpdated",e)})),s.messagesEntity.on("messageRemoved",(function(e){return s.emit("messageRemoved",e)})),s}return C.default(P,[{key:"uniqueName",get:function(){return this.channelState.uniqueName}},{key:"status",get:function(){return this.channelState.status}},{key:"friendlyName",get:function(){return this.channelState.friendlyName}},{key:"dateUpdated",get:function(){return this.channelState.dateUpdated}},{key:"dateCreated",get:function(){return this.channelState.dateCreated}},{key:"createdBy",get:function(){var e;return null!==(e=this.channelState.createdBy)&&void 0!==e?e:""}},{key:"attributes",get:function(){return this.channelState.attributes}},{key:"lastReadMessageIndex",get:function(){return this.channelState.lastReadMessageIndex}},{key:"lastMessage",get:function(){var e;return null!==(e=this.channelState.lastMessage)&&void 0!==e?e:void 0}},{key:"notificationLevel",get:function(){var e;return null!==(e=this.channelState.notificationLevel)&&void 0!==e?e:"default"}},{key:"bindings",get:function(){return this.channelState.bindings}},{key:"limits",get:function(){return this.configuration.limits}},{key:"state",get:function(){return this.channelState.state}},{key:"_subscribe",value:function(){var e,t=this;return this.entityPromise=null!==(e=this.entityPromise)&&void 0!==e?e:this.services.syncClient.document({id:this.entityName,mode:"open_existing"}).then((function(e){return t.entity=e,t.entity.on("updated",(function(e){t._update(e.data)})),t.entity.on("removed",(function(){return t.emit("removed",t)})),t._update(t.entity.data),e})).catch((function(e){throw t.entity=null,t.entityPromise=null,"disconnected"!=t.services.syncClient.connectionState&&Me.error("Failed to get conversation object",e),Me.debug("ERROR: Failed to get conversation object",e),e}))}},{key:"_subscribeStreams",value:(T=I.default(j.default.mark((function e(){var t,n,r,i,o;return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this._subscribe();case 3:return Me.trace("_subscribeStreams, this.entity.data=",null===(t=this.entity)||void 0===t?void 0:t.data),i=null===(n=this.entity)||void 0===n?void 0:n.data.messages,o=null===(r=this.entity)||void 0===r?void 0:r.data.roster,e.next=8,Promise.all([this.messagesEntity.subscribe(i),this.participantsEntity.subscribe(o)]);case 8:e.next=15;break;case 10:throw e.prev=10,e.t0=e.catch(0),"disconnected"!==this.services.syncClient.connectionState&&Me.error("Failed to subscribe on conversation objects",this.sid,e.t0),Me.debug("ERROR: Failed to subscribe on conversation objects",this.sid,e.t0),e.t0;case 15:case"end":return e.stop()}}),e,this,[[0,10]])}))),function(){return T.apply(this,arguments)})},{key:"_unsubscribe",value:(E=I.default(j.default.mark((function e(){return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.entity){e.next=5;break}return e.next=3,this.entity.close();case 3:this.entity=null,this.entityPromise=null;case 5:return e.abrupt("return",Promise.all([this.participantsEntity.unsubscribe(),this.messagesEntity.unsubscribe()]));case 6:case"end":return e.stop()}}),e,this)}))),function(){return E.apply(this,arguments)})},{key:"_setStatus",value:function(e,t){var n=this;this.statusSource=t,this.channelState.status!==e&&(this.channelState.status=e,"joined"===e?this._subscribeStreams().catch((function(t){if(Me.debug("ERROR while setting conversation status "+e,t),"disconnected"!==n.services.syncClient.connectionState)throw t})):this.entityPromise&&this._unsubscribe().catch((function(t){if(Me.debug("ERROR while setting conversation status "+e,t),"disconnected"!==n.services.syncClient.connectionState)throw t})))}},{key:"_statusSource",value:function(){return this.statusSource}},{key:"_update",value:function(e){var t,n,r,i,o;Me.trace("_update",e),P.preprocessUpdate(e,this.sid);for(var s=new Set,a=0,u=Object.keys(e);a<u.length;a++){var c=u[a],l=je[c];if(l)switch(l){case je.status:if(!e.status||"unknown"===e.status||this.channelState.status===e.status)break;this.channelState.status=e.status,s.add(l);break;case je.attributes:if(U.default(this.channelState.attributes,e.attributes))break;this.channelState.attributes=e.attributes,s.add(l);break;case je.lastConsumedMessageIndex:if(void 0===e.lastConsumedMessageIndex||e.lastConsumedMessageIndex===this.channelState.lastReadMessageIndex)break;this.channelState.lastReadMessageIndex=e.lastConsumedMessageIndex,s.add("lastReadMessageIndex");break;case je.lastMessage:if(this.channelState.lastMessage&&!e.lastMessage){delete this.channelState.lastMessage,s.add(l);break}this.channelState.lastMessage=this.channelState.lastMessage||{},void 0!==(null===(t=e.lastMessage)||void 0===t?void 0:t.index)&&e.lastMessage.index!==this.channelState.lastMessage.index&&(this.channelState.lastMessage.index=e.lastMessage.index,s.add(l)),void 0!==(null===(n=e.lastMessage)||void 0===n?void 0:n.timestamp)&&(null===(r=this.channelState.lastMessage)||void 0===r||null===(i=r.dateCreated)||void 0===i?void 0:i.getTime())!==e.lastMessage.timestamp.getTime()&&(this.channelState.lastMessage.dateCreated=e.lastMessage.timestamp,s.add(l)),U.default(this.channelState.lastMessage,{})&&delete this.channelState.lastMessage;break;case je.state:var d=e.state||void 0;if(void 0!==d&&(d.dateUpdated=new Date(d.dateUpdated)),U.default(this.channelState.state,d))break;this.channelState.state=d,s.add(l);break;case je.bindings:if(U.default(this.channelState.bindings,e.bindings))break;this.channelState.bindings=e.bindings,s.add(l);break;default:var f=e[c]instanceof Date,p=f&&(null===(o=this.channelState[l])||void 0===o?void 0:o.getTime())===e[c].getTime(),h=!f&&this[l]===e[c];if(p||h)break;this.channelState[l]=e[c],s.add(l)}}s.size>0&&this.emit("updated",{conversation:this,updateReasons:H.default(s)})}},{key:"_onMessageAdded",value:function(e){var t,n=Pe(this.participants.values());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.identity===e.author){r._endTyping();break}}}catch(e){n.e(e)}finally{n.f()}this.emit("messageAdded",e)}},{key:"_setLastReadMessageIndex",value:(S=I.default(j.default.mark((function e(t){var n;return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.services.commandExecutor.mutateResource("post","".concat(this.configuration.links.myConversations,"/").concat(this.sid),{last_read_message_index:t});case 2:return n=e.sent,e.abrupt("return",n.unread_messages_count);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return S.apply(this,arguments)})},{key:"add",value:(x=I.default(j.default.mark((function e(t,n){return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.participantsEntity.add(t,null!=n?n:{}));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return x.apply(this,arguments)})},{key:"addNonChatParticipant",value:(k=I.default(j.default.mark((function e(t,n){var r,i,o=arguments;return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=o.length>2&&void 0!==o[2]?o[2]:{},i=o.length>3&&void 0!==o[3]?o[3]:{},e.abrupt("return",this.participantsEntity.addNonChatParticipant(t,n,null!=r?r:{},null!=i?i:{}));case 3:case"end":return e.stop()}}),e,this)}))),function(e,t){return k.apply(this,arguments)})},{key:"advanceLastReadMessageIndex",value:(w=I.default(j.default.mark((function e(t){return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._subscribeStreams();case 2:if(!(t<(this.lastReadMessageIndex||0))){e.next=6;break}return e.next=5,this._setLastReadMessageIndex(this.lastReadMessageIndex);case 5:case 8:return e.abrupt("return",e.sent);case 6:return e.next=8,this._setLastReadMessageIndex(t);case 9:case"end":return e.stop()}}),e,this)}))),function(e){return w.apply(this,arguments)})},{key:"delete",value:(_=I.default(j.default.mark((function e(){return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.services.commandExecutor.mutateResource("delete",this.links.self);case 2:return e.abrupt("return",this);case 3:case"end":return e.stop()}}),e,this)}))),function(){return _.apply(this,arguments)})},{key:"getAttributes",value:(b=I.default(j.default.mark((function e(){return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._subscribe();case 2:return e.abrupt("return",this.attributes);case 3:case"end":return e.stop()}}),e,this)}))),function(){return b.apply(this,arguments)})},{key:"getMessages",value:(g=I.default(j.default.mark((function e(t,n,r){return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._subscribeStreams();case 2:return e.abrupt("return",this.messagesEntity.getMessages(t,n,r));case 3:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return g.apply(this,arguments)})},{key:"getParticipants",value:(m=I.default(j.default.mark((function e(){return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._subscribeStreams();case 2:return e.abrupt("return",this.participantsEntity.getParticipants());case 3:case"end":return e.stop()}}),e,this)}))),function(){return m.apply(this,arguments)})},{key:"getParticipantsCount",value:(v=I.default(j.default.mark((function e(){var t,n,r;return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new ne(this.configuration.links.conversations).path(this.sid).build(),e.next=3,this.services.network.get(n);case 3:return r=e.sent,e.abrupt("return",null!==(t=r.body.participants_count)&&void 0!==t?t:0);case 5:case"end":return e.stop()}}),e,this)}))),function(){return v.apply(this,arguments)})},{key:"getParticipantBySid",value:(y=I.default(j.default.mark((function e(t){return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.participantsEntity.getParticipantBySid(t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return y.apply(this,arguments)})},{key:"getParticipantByIdentity",value:(h=I.default(j.default.mark((function e(){var t,n=arguments;return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:"",e.abrupt("return",this.participantsEntity.getParticipantByIdentity(null!=t?t:""));case 2:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)})},{key:"getMessagesCount",value:(p=I.default(j.default.mark((function e(){var t,n,r;return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new ne(this.configuration.links.conversations).path(this.sid).build(),e.next=3,this.services.network.get(n);case 3:return r=e.sent,e.abrupt("return",null!==(t=r.body.messages_count)&&void 0!==t?t:0);case 5:case"end":return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)})},{key:"getUnreadMessagesCount",value:(f=I.default(j.default.mark((function e(){var t,n,r;return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new ne(this.configuration.links.myConversations).path(this.sid).build(),e.next=3,this.services.network.get(t);case 3:if((n=e.sent).body.conversation_sid===this.sid){e.next=6;break}throw new Error("Conversation was not found in the user conversations list");case 6:if("number"!=typeof(r=n.body.unread_messages_count)){e.next=9;break}return e.abrupt("return",r);case 9:return e.abrupt("return",null);case 10:case"end":return e.stop()}}),e,this)}))),function(){return f.apply(this,arguments)})},{key:"join",value:(d=I.default(j.default.mark((function e(){return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.services.commandExecutor.mutateResource("post",this.links.participants,{identity:this.configuration.userIdentity});case 2:return e.abrupt("return",this);case 3:case"end":return e.stop()}}),e,this)}))),function(){return d.apply(this,arguments)})},{key:"leave",value:(l=I.default(j.default.mark((function e(){return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("joined"!==this.channelState.status){e.next=3;break}return e.next=3,this.services.commandExecutor.mutateResource("delete","".concat(this.links.participants,"/").concat(this.configuration.userIdentity));case 3:return e.abrupt("return",this);case 4:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"removeParticipant",value:(c=I.default(j.default.mark((function e(t){return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.participantsEntity.remove("string"==typeof t?t:t.sid);case 2:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"sendMessage",value:(u=I.default(j.default.mark((function e(t,n,r){var i,o,s,a;return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t&&null!==t){e.next=5;break}return e.next=3,this.messagesEntity.send(t,n,r);case 3:return s=e.sent,e.abrupt("return",null!==(o=Q(s.index))&&void 0!==o?o:0);case 5:return e.next=7,this.messagesEntity.sendMedia(t,n,r);case 7:return a=e.sent,e.abrupt("return",null!==(i=Q(a.index))&&void 0!==i?i:0);case 9:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return u.apply(this,arguments)})},{key:"prepareMessage",value:function(){return new Ae(this.limits,this.messagesEntity)}},{key:"setAllMessagesRead",value:(a=I.default(j.default.mark((function e(){var t;return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._subscribeStreams();case 2:return e.next=4,this.getMessages(1);case 4:if(!((t=e.sent).items.length>0)){e.next=7;break}return e.abrupt("return",this.advanceLastReadMessageIndex(t.items[0].index));case 7:return e.abrupt("return",Promise.resolve(0));case 8:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"setAllMessagesUnread",value:(s=I.default(j.default.mark((function e(){return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._subscribeStreams();case 2:return e.next=4,this._setLastReadMessageIndex(null);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"setUserNotificationLevel",value:(o=I.default(j.default.mark((function e(t){return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.services.commandExecutor.mutateResource("post","".concat(this.configuration.links.myConversations,"/").concat(this.sid),{notification_level:t});case 2:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"typing",value:function(){return this.services.typingIndicator.send(this.sid)}},{key:"updateAttributes",value:(i=I.default(j.default.mark((function e(t){return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.services.commandExecutor.mutateResource("post",this.links.self,{attributes:void 0!==t?JSON.stringify(t):void 0});case 2:return e.abrupt("return",this);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"updateFriendlyName",value:(r=I.default(j.default.mark((function e(t){return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.channelState.friendlyName===t){e.next=3;break}return e.next=3,this.services.commandExecutor.mutateResource("post",this.links.self,{friendly_name:t});case 3:return e.abrupt("return",this);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"updateLastReadMessageIndex",value:(n=I.default(j.default.mark((function e(t){return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._subscribeStreams();case 2:return e.abrupt("return",this._setLastReadMessageIndex(t));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"updateUniqueName",value:(t=I.default(j.default.mark((function e(t){return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.channelState.uniqueName===t){e.next=4;break}return t||(t=""),e.next=4,this.services.commandExecutor.mutateResource("post",this.links.self,{unique_name:t});case 4:return e.abrupt("return",this);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}],[{key:"preprocessUpdate",value:function(e,t){try{"string"==typeof e.attributes?e.attributes=JSON.parse(e.attributes):e.attributes&&JSON.stringify(e.attributes)}catch(n){Me.warn("Retrieved malformed attributes from the server for conversation: "+t),e.attributes={}}try{e.dateCreated&&(e.dateCreated=new Date(e.dateCreated))}catch(n){Me.warn("Retrieved malformed dateCreated from the server for conversation: "+t),delete e.dateCreated}try{e.dateUpdated&&(e.dateUpdated=new Date(e.dateUpdated))}catch(n){Me.warn("Retrieved malformed dateUpdated from the server for conversation: "+t),delete e.dateUpdated}try{e.lastMessage&&e.lastMessage.timestamp&&(e.lastMessage.timestamp=new Date(e.lastMessage.timestamp))}catch(n){Me.warn("Retrieved malformed lastMessage.timestamp from the server for conversation: "+t),delete e.lastMessage.timestamp}}}]),P}(v.ReplayEventEmitter);L.default(Be,"participantJoined","participantJoined"),L.default(Be,"participantLeft","participantLeft"),L.default(Be,"participantUpdated","participantUpdated"),L.default(Be,"messageAdded","messageAdded"),L.default(Be,"messageRemoved","messageRemoved"),L.default(Be,"messageUpdated","messageUpdated"),L.default(Be,"typingEnded","typingEnded"),L.default(Be,"typingStarted","typingStarted"),L.default(Be,"updated","updated"),L.default(Be,"removed","removed"),G([y.validateTypesAsync(y.nonEmptyString,ie),W("design:type",Function),W("design:paramtypes",[String,Object]),W("design:returntype",Promise)],Be.prototype,"add",null),G([y.validateTypesAsync(y.nonEmptyString,y.nonEmptyString,ie),W("design:type",Function),W("design:paramtypes",[String,String,Object,Object]),W("design:returntype",Promise)],Be.prototype,"addNonChatParticipant",null),G([y.validateTypesAsync(y.nonNegativeInteger),W("design:type",Function),W("design:paramtypes",[Number]),W("design:returntype",Promise)],Be.prototype,"advanceLastReadMessageIndex",null),G([y.validateTypesAsync(["undefined",y.nonNegativeInteger],["undefined",y.nonNegativeInteger],["undefined",y.literal("backwards","forward")]),W("design:type",Function),W("design:paramtypes",[Number,Number,String]),W("design:returntype",Promise)],Be.prototype,"getMessages",null),G([y.validateTypesAsync(y.nonEmptyString),W("design:type",Function),W("design:paramtypes",[String]),W("design:returntype",Promise)],Be.prototype,"getParticipantBySid",null),G([y.validateTypesAsync(y.nonEmptyString),W("design:type",Function),W("design:paramtypes",[String]),W("design:returntype",Promise)],Be.prototype,"getParticipantByIdentity",null),G([y.validateTypesAsync([y.nonEmptyString,he]),W("design:type",Function),W("design:paramtypes",[Object]),W("design:returntype",Promise)],Be.prototype,"removeParticipant",null),G([y.validateTypesAsync(["string",y.literal(null),y.custom((function(e){return[e instanceof FormData,"an instance of FormData"]})),y.objectSchema("media options",{contentType:y.nonEmptyString,media:y.custom((function(e){var t="string"==typeof e&&e.length>0||e instanceof Uint8Array||e instanceof ArrayBuffer;return"function"==typeof Blob&&(t=t||e instanceof Blob),[t,"a non-empty string, an instance of Buffer or an instance of Blob"]}))})],ie,["undefined",y.literal(null),y.objectSchema("email attributes",{subject:[y.nonEmptyString,"undefined"]})]),W("design:type",Function),W("design:paramtypes",[Object,Object,Object]),W("design:returntype",Promise)],Be.prototype,"sendMessage",null),G([y.validateTypesAsync(y.literal("default","muted")),W("design:type",Function),W("design:paramtypes",[String]),W("design:returntype",Promise)],Be.prototype,"setUserNotificationLevel",null),G([y.validateTypesAsync(re),W("design:type",Function),W("design:paramtypes",[Object]),W("design:returntype",Promise)],Be.prototype,"updateAttributes",null),G([y.validateTypesAsync(["string"]),W("design:type",Function),W("design:paramtypes",[String]),W("design:returntype",Promise)],Be.prototype,"updateFriendlyName",null),G([y.validateTypesAsync([y.literal(null),y.nonNegativeInteger]),W("design:type",Function),W("design:paramtypes",[Number]),W("design:returntype",Promise)],Be.prototype,"updateLastReadMessageIndex",null),G([y.validateTypesAsync(["string",y.literal(null)]),W("design:type",Function),W("design:paramtypes",[String]),W("design:returntype",Promise)],Be.prototype,"updateUniqueName",null);var Ue=function(){function e(){var t=this;M.default(this,e),this._promise=new Promise((function(e,n){t._resolve=e,t._reject=n}))}return C.default(e,[{key:"promise",get:function(){return this._promise}},{key:"update",value:function(e){this._resolve(e)}},{key:"set",value:function(e){this.current=e,this._resolve(e)}},{key:"fail",value:function(e){this._reject(e)}}]),e}();function Fe(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return He(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return He(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function He(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ge(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function We(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ge(Object(n),!0).forEach((function(t){L.default(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ge(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function qe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=N.default(e);if(t){var i=N.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return P.default(this,n)}}var Ve=z.scope("Conversations"),ze=function(e){A.default(p,e);var t,n,r,i,o,s,a,u,c,l,d,f=qe(p);function p(e,t){var n;return M.default(this,p),n=f.call(this),L.default(R.default(n),"conversations",new Map),L.default(R.default(n),"myConversationsRead",new Ue),L.default(R.default(n),"tombstones",new Set),L.default(R.default(n),"myConversationsFetched",!1),n.configuration=e,n.services=t,n}return C.default(p,[{key:"addConversation",value:(d=I.default(j.default.mark((function e(t){var n,r,i,o,s,a,u,c,l,d;return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=void 0!==(null==t?void 0:t.attributes)?t.attributes:{},e.next=3,this.services.commandExecutor.mutateResource("post",this.configuration.links.conversations,{friendly_name:t.friendlyName,unique_name:t.uniqueName,attributes:void 0!==o?JSON.stringify(o):void 0});case 3:if(s=e.sent,a=null!==(n=s.sid)&&void 0!==n?n:null,u=null!==(r=null===(i=s.sync_objects)||void 0===i?void 0:i.conversation)&&void 0!==r?r:null,c=We({self:s.url},s.links),!(l=this.conversations.get(a))){e.next=12;break}return e.next=11,l._subscribe();case 11:return e.abrupt("return",l);case 12:return d=new Be({channel:u,entityName:"",uniqueName:"",attributes:null,createdBy:"",friendlyName:"",lastConsumedMessageIndex:0,dateCreated:null,dateUpdated:null},a,c,this.configuration,this.services),this.conversations.set(d.sid,d),this._registerForEvents(d),e.next=17,d._subscribe();case 17:return this.emit("conversationAdded",d),e.abrupt("return",d);case 19:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:"fetchConversations",value:(l=I.default(j.default.mark((function e(){var t,n,r,i,o,s,a,u=this;return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this._getMap();case 3:return(t=e.sent).on("itemAdded",(function(e){Ve.debug("itemAdded: ".concat(e.item.key)),u._upsertConversation("sync",e.item.key,e.item.data)})),t.on("itemRemoved",(function(e){Ve.debug("itemRemoved: ".concat(e.key));var t=e.key;u.myConversationsFetched||u.tombstones.add(t);var n=u.conversations.get(t);n&&("joined"===n.status&&(n._setStatus("notParticipating","sync"),u.emit("conversationLeft",n)),u.conversations.delete(t),u.emit("conversationRemoved",n),n.emit("removed",n))})),t.on("itemUpdated",(function(e){Ve.debug("itemUpdated: ".concat(e.item.key)),u._upsertConversation("sync",e.item.key,e.item.data)})),e.next=9,this._fetchMyConversations();case 9:n=e.sent,r=[],i=Fe(n);try{for(i.s();!(o=i.n()).done;)s=o.value,r.push(this._upsertConversation("rest",s.channel_sid,s))}catch(e){i.e(e)}finally{i.f()}return this.myConversationsRead.set(!0),e.next=16,Promise.all(r);case 16:return this.myConversationsFetched=!0,this.tombstones.clear(),Ve.debug("The conversations list has been successfully fetched"),e.abrupt("return",this);case 22:throw e.prev=22,e.t0=e.catch(0),a="Failed to fetch the conversations list","disconnected"!==this.services.syncClient.connectionState&&Ve.error(a,e.t0),Ve.debug("ERROR: ".concat(a),e.t0),e.t0;case 28:case"end":return e.stop()}}),e,this,[[0,22]])}))),function(){return l.apply(this,arguments)})},{key:"getConversations",value:(c=I.default(j.default.mark((function e(){var t,n,r=this;return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._getMap();case 2:return t=e.sent,e.next=5,t.getItems();case 5:return n=e.sent,e.abrupt("return",this._wrapPaginator(n,(function(e){return Promise.all(e.map((function(e){return r._upsertConversation("sync",e.key,e.data)})))})));case 7:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"getConversation",value:(u=I.default(j.default.mark((function e(t){var n,r,i,o=this;return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._getMap();case 2:return n=e.sent,e.next=5,n.getItems({key:t});case 5:return r=e.sent,i=r.items.map((function(e){return o._upsertConversation("sync",e.key,e.data)})),e.abrupt("return",i.length>0?i[0]:null);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"getConversationByUniqueName",value:(a=I.default(j.default.mark((function e(t){var n,r,i,o,s;return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new ne(this.configuration.links.myConversations).path(t).build(),e.next=3,this.services.network.get(n);case 3:return r=e.sent,i=r.body,o=i.conversation_sid,s={entityName:null,lastConsumedMessageIndex:i.last_read_message_index,status:(null==i?void 0:i.status)||"unknown",friendlyName:i.friendly_name,dateUpdated:i.date_updated,dateCreated:i.date_created,uniqueName:i.unique_name,createdBy:i.created_by,attributes:i.attributes,channel:i.sync_objects.conversation,notificationLevel:null==i?void 0:i.notification_level,sid:o},e.abrupt("return",o?this._upsertConversation("sync",o,s):null);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"peekConversation",value:(s=I.default(j.default.mark((function e(t){var n,r,i,o;return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new ne(this.configuration.links.conversations).path(t).build(),e.next=3,this.services.network.get(n);case 3:return r=e.sent,i=r.body,o={entityName:null,status:(null==i?void 0:i.status)||"unknown",friendlyName:i.friendly_name,dateUpdated:i.date_updated,dateCreated:i.date_created,uniqueName:i.unique_name,createdBy:i.created_by,attributes:i.attributes,channel:"".concat(t,".channel"),sid:t},e.abrupt("return",this._upsertConversation("sync",t,o));case 7:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"_getMap",value:(o=I.default(j.default.mark((function e(){return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.services.syncClient.map({id:this.configuration.myConversations,mode:"open_existing"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"_wrapPaginator",value:(i=I.default(j.default.mark((function e(t,n){var r,i=this;return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n(t.items);case 2:return r=e.sent,e.abrupt("return",{items:r,hasNextPage:t.hasNextPage,hasPrevPage:t.hasPrevPage,nextPage:function(){return t.nextPage().then((function(e){return i._wrapPaginator(e,n)}))},prevPage:function(){return t.prevPage().then((function(e){return i._wrapPaginator(e,n)}))}});case 4:case"end":return e.stop()}}),e)}))),function(e,t){return i.apply(this,arguments)})},{key:"_updateConversation",value:(r=I.default(j.default.mark((function e(t,n,r){var i,o,s,a=this;return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=void 0!==n._statusSource()&&t!==n._statusSource(),o="rest"!==t||"sync"===n._statusSource(),!i||!o||"sync"===t){e.next=5;break}return Ve.trace("upsertConversation: conversation is known from sync and came from chat, ignoring",{sid:n.sid,data:r.status,conversation:n.status}),e.abrupt("return");case 5:if("joined"!==r.status||"joined"===n.status){e.next=13;break}return n._setStatus("joined",t),s={},void 0!==r.notificationLevel&&(s.notificationLevel=r.notificationLevel),void 0!==r.lastConsumedMessageIndex&&(s.lastConsumedMessageIndex=r.lastConsumedMessageIndex),U.default(s,{})||n._update(s),n._subscribe().then((function(){a.emit("conversationJoined",n)})),e.abrupt("return");case 13:if("notParticipating"!==r.status||"joined"!==n.status){e.next=20;break}return n._setStatus("notParticipating",t),n._update(r),e.next=18,n._subscribe();case 18:return this.emit("conversationLeft",n),e.abrupt("return");case 20:if("notParticipating"!==r.status){e.next=24;break}return e.next=23,n._subscribe();case 23:return e.abrupt("return");case 24:n._update(r);case 25:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return r.apply(this,arguments)})},{key:"_upsertConversation",value:(n=I.default(j.default.mark((function e(t,n,r){var i,o,s,a;return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Ve.trace("upsertConversation called for ".concat(n),r),!(i=this.conversations.get(n))){e.next=9;break}return Ve.trace("upsertConversation: the conversation ".concat(i.sid," is known;")+"its status is known from the source ".concat(i._statusSource()," ")+"and the update came from the source ".concat(t),i),e.next=6,this._updateConversation(t,i,r);case 6:return e.next=8,i._subscribe();case 8:return e.abrupt("return",i);case 9:if(!["chat","rest"].includes(t)||!this.tombstones.has(n)){e.next=12;break}return Ve.trace("upsertChannel: the channel is deleted but reappeared again from chat, ignoring",n),e.abrupt("return",null);case 12:return Ve.trace("upsertConversation: creating a local conversation object with sid "+n,r),o="".concat(this.configuration.links.conversations,"/").concat(n),s={self:o,messages:"".concat(o,"/Messages"),participants:"".concat(o,"/Participants")},a=new Be(r,n,s,this.configuration,this.services),this.conversations.set(n,a),e.next=19,a._subscribe();case 19:return this._registerForEvents(a),this.emit("conversationAdded",a),"joined"===r.status&&(a._setStatus("joined",t),this.emit("conversationJoined",a)),e.abrupt("return",a);case 23:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return n.apply(this,arguments)})},{key:"_fetchMyConversations",value:(t=I.default(j.default.mark((function e(){var t,n,r,i,o,s;return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=[],n=null;case 2:return i=new ne(this.configuration.links.myConversations),n&&i.arg("PageToken",n),e.next=6,this.services.network.get(i.build());case 6:o=e.sent,s=null===(r=o.body)||void 0===r?void 0:r.conversations.map((function(e){return{descriptor:e,channel_sid:e.conversation_sid,status:e.status,channel:e.sync_objects.conversation,messages:e.sync_objects.messages,roster:"".concat(e.conversation_sid,".roster"),lastConsumedMessageIndex:e.last_read_message_index,notificationLevel:e.notification_level}})),n=o.body.meta.next_token,t=[].concat(H.default(t),H.default(s));case 10:if(n){e.next=2;break}case 11:return e.abrupt("return",t);case 12:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"_onConversationRemoved",value:function(e){var t=this.conversations.get(e);t&&(this.conversations.delete(e),this.emit("conversationRemoved",t))}},{key:"_registerForEvents",value:function(e){var t=this;e.on("removed",(function(){return t._onConversationRemoved(e.sid)})),e.on("updated",(function(e){return t.emit("conversationUpdated",e)})),e.on("participantJoined",(function(e){return t.emit("participantJoined",e)})),e.on("participantLeft",(function(e){return t.emit("participantLeft",e)})),e.on("participantUpdated",(function(e){return t.emit("participantUpdated",e)})),e.on("messageAdded",(function(e){return t.emit("messageAdded",e)})),e.on("messageUpdated",(function(e){return t.emit("messageUpdated",e)})),e.on("messageRemoved",(function(e){return t.emit("messageRemoved",e)})),e.on("typingStarted",(function(e){return t.emit("typingStarted",e)})),e.on("typingEnded",(function(e){return t.emit("typingEnded",e)}))}}]),p}(v.ReplayEventEmitter);function Ye(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=N.default(e);if(t){var i=N.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return P.default(this,n)}}var Ke=function(e){A.default(o,e);var t,n,r,i=Ye(o);function o(e,t,n){var r;return M.default(this,o),(r=i.call(this)).configuration=t,r.services=n,r.fifoStack=[],r.myself=e,r.myself.on("updated",(function(e){return r.emit("userUpdated",e)})),r.myself.on("userSubscribed",(function(){return r.emit("userSubscribed",r.myself)})),r.myself.on("userUnsubscribed",(function(){r.emit("userUnsubscribed",r.myself),r.myself._ensureFetched()})),r.subscribedUsers=new Map,r}return C.default(o,[{key:"handleUnsubscribeUser",value:function(e){this.subscribedUsers.has(e.identity)&&this.subscribedUsers.delete(e.identity);var t=0;this.fifoStack.find((function(n,r){return n==e.identity&&(t=r,!0)}))&&this.fifoStack.splice(t,1),this.emit("userUnsubscribed",e)}},{key:"handleSubscribeUser",value:function(e){if(!this.subscribedUsers.has(e.identity)){if(this.fifoStack.length>=this.configuration.userInfosToSubscribe){var t,n,r=this.fifoStack.shift();null===(t=this.subscribedUsers)||void 0===t||null===(n=t.get(r))||void 0===n||n.unsubscribe()}this.fifoStack.push(e.identity),this.subscribedUsers.set(e.identity,e),this.emit("userSubscribed",e)}}},{key:"getUser",value:(r=I.default(j.default.mark((function e(){var t,n,r,i,o=this,s=arguments;return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:"",n=s.length>1&&void 0!==s[1]?s[1]:"",e.next=4,this.myself._ensureFetched();case 4:if(t!=this.myself.identity){e.next=6;break}return e.abrupt("return",this.myself);case 6:if(!(r=this.subscribedUsers.get(t))){e.next=9;break}return e.abrupt("return",r);case 9:if(e.t0=n,e.t0){e.next=14;break}return e.next=13,this.getSyncUniqueName(t);case 13:e.t0=e.sent;case 14:return n=e.t0,(i=new ae(t,n,this.configuration,this.services)).on("updated",(function(e){return o.emit("userUpdated",e)})),i.on("userSubscribed",(function(){return o.handleSubscribeUser(i)})),i.on("userUnsubscribed",(function(){return o.handleUnsubscribeUser(i)})),e.next=21,i._ensureFetched();case 21:return e.abrupt("return",i);case 22:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"getSubscribedUsers",value:(n=I.default(j.default.mark((function e(){var t;return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.myself._ensureFetched();case 2:return t=[this.myself],this.subscribedUsers.forEach((function(e){return t.push(e)})),e.abrupt("return",t);case 5:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"getSyncUniqueName",value:(t=I.default(j.default.mark((function e(t){var n,r,i,o;return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=new ne(this.configuration.links.users).path(t).build(),e.next=3,this.services.network.get(i);case 3:return o=e.sent,e.abrupt("return",null!==(n=null===(r=o.body)||void 0===r?void 0:r.sync_objects.user_info_map)&&void 0!==n?n:"");case 5:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),o}(v.ReplayEventEmitter),$e=z.scope("TypingIndicator"),Xe=function(){function e(t,n,r){M.default(this,e),this.configuration=n,this.services=r,this.getConversation=t,this.serviceTypingTimeout=null,this.sentUpdates=new Map}var t;return C.default(e,[{key:"typingTimeout",get:function(){return this.configuration.typingIndicatorTimeoutOverride||this.serviceTypingTimeout||this.configuration.typingIndicatorTimeoutDefault}},{key:"initialize",value:function(){var e=this;this.services.notificationClient.on("message",function(){var t=I.default(j.default.mark((function t(n,r){return j.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n!==de.TYPING_INDICATOR){t.next=3;break}return t.next=3,e._handleRemoteTyping(r);case 3:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}())}},{key:"_handleRemoteTyping",value:(t=I.default(j.default.mark((function e(t){var n=this;return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:$e.trace("Got new typing indicator ",t),this.getConversation(t.channel_sid).then((function(e){e&&e.participants.forEach((function(e){if(e.identity===t.identity){var r=n.configuration.typingIndicatorTimeoutOverride?n.configuration.typingIndicatorTimeoutOverride+1e3:1e3*t.typing_timeout;e._startTyping(r)}}))})).catch((function(e){throw $e.error(e),e}));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"send",value:function(e){var t=this.sentUpdates.get(e);return t&&t>Date.now()-this.typingTimeout?Promise.resolve():(this.sentUpdates.set(e,Date.now()),this._send(e))}},{key:"_send",value:function(e){var t=this;$e.trace("Sending typing indicator");var n=this.configuration.links.typing,r="ChannelSid=".concat(e);return this.services.twilsockClient.post(n,{"Content-Type":"application/x-www-form-urlencoded"},r,this.configuration.productId).then((function(e){e.body.hasOwnProperty("typing_timeout")&&(t.serviceTypingTimeout=1e3*e.body.typing_timeout)})).catch((function(e){throw $e.error("Failed to send typing indicator:",e),e}))}}]),e}(),Je=function e(t){M.default(this,e),this.title=t.title||null,this.body=t.body||null,this.sound=t.sound||null,this.badge=t.badge||null,this.action=t.action||null,this.type=t.type||null,this.data=t.data||{}};function Ze(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Qe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ze(Object(n),!0).forEach((function(t){L.default(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ze(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var et,tt,nt,rt=function(e){return e.replace(/(^\/+|\/+$)/g,"")},it=function(){function e(t,n,r){M.default(this,e),this._serviceUrl=t,this._services=n,this._productId=r}var t,n,r;return C.default(e,[{key:"_preProcessUrl",value:function(e){var t=rt(e);return/^https?:\/\//.test(e)?t:"".concat(rt(this._serviceUrl),"/").concat(t)}},{key:"_makeRequest",value:(r=I.default(j.default.mark((function e(t,n,r,i){var o,s,a,u;return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=this._preProcessUrl(n),s=Qe({"Content-Type":"application/json; charset=utf-8"},i||{}),e.t0=t,e.next="get"===e.t0?5:"post"===e.t0?11:"delete"===e.t0?15:19;break;case 5:return u=o,r&&(u+="?"+Object.entries(r).map((function(e){return e.map(encodeURIComponent).join("=")})).join("&")),e.next=9,this._services.transport.get(u,s,this._productId);case 9:case 13:case 17:return a=e.sent,e.abrupt("break",19);case 11:return e.next=13,this._services.transport.post(o,s,JSON.stringify(r),this._productId);case 15:return e.next=17,this._services.transport.delete(o,s,{},this._productId);case 19:if(!(a.status.code<200||a.status.code>=300)){e.next=21;break}throw new Error("Request responded with a non-success code ".concat(a.status.code));case 21:return e.abrupt("return",a);case 22:case"end":return e.stop()}}),e,this)}))),function(e,t,n,i){return r.apply(this,arguments)})},{key:"fetchResource",value:(n=I.default(j.default.mark((function e(t,n){var r,i=this;return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=1,e.next=4,new b.AsyncRetrier({min:50,max:1600,maxAttemptsCount:6}).run((function(){return i._makeRequest("get",t,n)}));case 4:return r=e.sent,e.abrupt("return",r.body);case 8:throw e.prev=8,e.t0=e.catch(1),new Error('Fetch resource from "'.concat(t,'" failed.'));case 11:case"end":return e.stop()}}),e,null,[[1,8]])}))),function(e,t){return n.apply(this,arguments)})},{key:"mutateResource",value:(t=I.default(j.default.mark((function e(t,n,r){var i;return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._makeRequest(t,n,r,{"X-Twilio-Mutation-Id":E.v4()});case 2:if(202!==(i=e.sent).status.code){e.next=7;break}return e.next=6,this.fetchResource(i.body.resource_url);case 6:return e.abrupt("return",e.sent);case 7:return e.abrupt("return",i.body);case 8:case"end":return e.stop()}}),e,this)}))),function(e,n,r){return t.apply(this,arguments)})}]),e}();function ot(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function st(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ot(Object(n),!0).forEach((function(t){L.default(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ot(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function at(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=N.default(e);if(t){var i=N.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return P.default(this,n)}}var ut=z.scope("Client"),ct="2.1.0",lt=function e(){M.default(this,e)};t.KU=(tt=et=function(e){A.default(v,e);var t,n,r,i,o,s,a,u,c,l,d,f,p,h,y=at(v);function v(e){var t,n,r,i,o,s,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(M.default(this,v),s=y.call(this),L.default(R.default(s),"connectionState","unknown"),L.default(R.default(s),"version",ct),L.default(R.default(s),"parsePushNotification",nt.parsePushNotification),s.fpaToken=null!=e?e:"",s.options=null!=a?a:{},!s.options.disableDeepClone){var u=st(st({},s.options),{},{transport:void 0,twilsockClient:void 0});(u=Z(u)).transport=s.options.transport,u.twilsockClient=s.options.twilsockClient,s.options=u}s.options.logLevel=null!==(t=s.options.logLevel)&&void 0!==t?t:"silent",ut.setLevel(s.options.logLevel);var c=s.options.productId="ip_messaging";if(s.options.clientMetadata=s.options.clientMetadata||{},s.options.clientMetadata.hasOwnProperty("type")||(s.options.clientMetadata.type="conversations"),s.options.clientMetadata.hasOwnProperty("sdk")||(s.options.clientMetadata.sdk="JS",s.options.clientMetadata.sdkv=ct),s.options.Sync=s.options.Sync||{},void 0===s.options.Sync.enableSessionStorage&&(s.options.Sync.enableSessionStorage=!0),s.options.region&&(s.options.Sync.region=s.options.region),!e)throw new Error("A valid Twilio token should be provided");s.services=new lt,s._myself=new ae("","",null,s.services);var l=!s.options.twilsockClient;if(!s.options.initRegistrations){var d=new _.InitRegistration(c);nt.populateInitRegistrations(d),s.options.initRegistrations=[d]}s.services.twilsockClient=s.options.twilsockClient=null!==(n=s.options.twilsockClient)&&void 0!==n?n:new _.TwilsockClient(e,c,s.options),s.services.twilsockClient.on("tokenAboutToExpire",(function(e){return s.emit("tokenAboutToExpire",e)})),s.services.twilsockClient.on("tokenExpired",(function(){return s.emit("tokenExpired")})),s.services.twilsockClient.on("connectionError",(function(e){return s.emit("connectionError",e)})),s.services.twilsockClient.on("stateChanged",(function(e){ut.debug("Handling stateChanged for ConversationsClient: new state ".concat(e)),e!==s.connectionState&&(s.connectionState=e,s.emit("connectionStateChanged",s.connectionState))})),s.services.transport=s.options.transport=null!==(r=s.options.transport)&&void 0!==r?r:s.options.twilsockClient,s.services.notificationClient=s.options.notificationsClient=null!==(i=s.options.notificationsClient)&&void 0!==i?i:new w.Notifications(e,s.options),s.services.syncClient=s.options.syncClient=null!==(o=s.options.syncClient)&&void 0!==o?o:new k.SyncClient(e,s.options);var f=(null==a?void 0:a.Chat)||(null==a?void 0:a.IPMessaging)||a||{},p=f.region||(null==a?void 0:a.region),h=f.apiUri||f.typingUri||"https://aim.".concat(p||"us1",".twilio.com");s.services.commandExecutor=new it(h,{transport:s.options.transport},c);var m=function(e){s._rejectEnsureReady(e),s.emit("stateChanged","failed")};return s.services.twilsockClient.once("connectionError",m),s.services.twilsockClient.once("disconnected",m),s.services.twilsockClient.once("connected",I.default(j.default.mark((function e(){var t;return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ut.debug("ConversationsClient started INITIALIZING"),s.services.twilsockClient.off("connectionError",m),s.services.twilsockClient.off("disconnected",m),e.prev=3,t="conversations.client.startup",s.services.twilsockClient.addPartialTelemetryEvent(new _.TelemetryEventDescription(t,"Conversations client startup",new Date),t,_.TelemetryPoint.Start),e.next=8,s._initialize();case 8:s.services.twilsockClient.addPartialTelemetryEvent(new _.TelemetryEventDescription("","",new Date),t,_.TelemetryPoint.End),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(3),s._rejectEnsureReady(e.t0),s.emit("stateChanged","failed");case 15:case"end":return e.stop()}}),e,null,[[3,11]])})))),s._ensureReady=new Promise((function(e,t){s._resolveEnsureReady=e,s._rejectEnsureReady=t})).catch((function(){})),l&&s.services.twilsockClient.connect(),s}return C.default(v,[{key:"user",get:function(){return this._myself}},{key:"reachabilityEnabled",get:function(){if(!this.configuration)throw new Error("Reachability information could not yet be accessed as the client has not yet been initialized. Subscribe to the 'stateChanged' event to properly react to the client initialization.");return this.configuration.reachabilityEnabled}},{key:"token",get:function(){return this.fpaToken}},{key:"_subscribeToPushNotifications",value:function(e){var t=this;[de.NEW_MESSAGE,de.ADDED_TO_CONVERSATION,de.REMOVED_FROM_CONVERSATION,de.TYPING_INDICATOR,de.CONSUMPTION_UPDATE].forEach((function(n){t.services.notificationClient.subscribe(e,n)}))}},{key:"_unsubscribeFromPushNotifications",value:function(e){var t=this;[de.NEW_MESSAGE,de.ADDED_TO_CONVERSATION,de.REMOVED_FROM_CONVERSATION,de.TYPING_INDICATOR,de.CONSUMPTION_UPDATE].forEach((function(n){t.services.notificationClient.unsubscribe(e,n)}))}},{key:"_initialize",value:(h=I.default(j.default.mark((function e(){var t,n=this;return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.services.commandExecutor.fetchResource("Client/v2/Configuration");case 2:return t=e.sent,this.configuration=new J(this.options,t,ut),this._myself._resolveInitialization(this.configuration,this.configuration.userIdentity,this.configuration.userInfo,!0),this.services.typingIndicator=new Xe(this.getConversationBySid.bind(this),this.configuration,this.services),this.services.network=new le(this.configuration,this.services),this.services.users=new Ke(this._myself,this.configuration,this.services),this.services.users.on("userSubscribed",(function(e){n.emit("userSubscribed",e)})),this.services.users.on("userUpdated",(function(e){return n.emit("userUpdated",e)})),this.services.users.on("userUnsubscribed",(function(e){n.emit("userUnsubscribed",e)})),this.conversations=new ze(this.configuration,this.services),this.conversations.on("conversationAdded",(function(e){n.emit("conversationAdded",e)})),this.conversations.on("conversationRemoved",(function(e){n.emit("conversationRemoved",e)})),this.conversations.on("conversationJoined",(function(e){n.emit("conversationJoined",e)})),this.conversations.on("conversationLeft",(function(e){n.emit("conversationLeft",e)})),this.conversations.on("conversationUpdated",(function(e){return n.emit("conversationUpdated",e)})),this.conversations.on("participantJoined",(function(e){n.emit("participantJoined",e)})),this.conversations.on("participantLeft",(function(e){n.emit("participantLeft",e)})),this.conversations.on("participantUpdated",(function(e){return n.emit("participantUpdated",e)})),this.conversations.on("messageAdded",(function(e){return n.emit("messageAdded",e)})),this.conversations.on("messageUpdated",(function(e){return n.emit("messageUpdated",e)})),this.conversations.on("messageRemoved",(function(e){return n.emit("messageRemoved",e)})),this.conversations.on("typingStarted",(function(e){return n.emit("typingStarted",e)})),this.conversations.on("typingEnded",(function(e){return n.emit("typingEnded",e)})),this.conversationsPromise=this.conversations.fetchConversations().then((function(){return n.conversations})).catch((function(e){throw e})),e.next=28,this.services.users.myself._ensureFetched();case 28:nt.supportedPushChannels.forEach((function(e){return n._subscribeToPushNotifications(e)})),this.services.typingIndicator.initialize(),this.services.mcsClient=new x.McsClient(this.fpaToken,this.configuration.links.mediaService,this.configuration.links.mediaSetService,st(st({},this.options),{},{transport:void 0})),this._resolveEnsureReady(),this.emit("stateChanged","initialized");case 33:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)})},{key:"shutdown",value:(p=I.default(j.default.mark((function e(){return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._ensureReady;case 2:return e.next=4,this.services.twilsockClient.disconnect();case 4:case"end":return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)})},{key:"updateToken",value:(f=I.default(j.default.mark((function e(t){return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._ensureReady;case 2:if(ut.info("updateToken"),this.fpaToken!==t){e.next=5;break}return e.abrupt("return",this);case 5:return e.next=7,this.services.twilsockClient.updateToken(t);case 7:return e.next=9,this.services.notificationClient.updateToken(t);case 9:return e.next=11,this.services.mcsClient.updateToken(t);case 11:return this.fpaToken=t,e.abrupt("return",this);case 13:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})},{key:"getConversationBySid",value:(d=I.default(j.default.mark((function e(t){var n;return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._ensureReady;case 2:return e.next=4,this.conversations.myConversationsRead.promise;case 4:return e.next=6,this.conversations.getConversation(t);case 6:if(n=e.sent){e.next=11;break}return e.next=10,this.conversations.peekConversation(t);case 10:n=e.sent;case 11:if(n){e.next=13;break}throw new Error("Conversation with SID ".concat(t," is not found."));case 13:return e.abrupt("return",n);case 14:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:"getConversationByUniqueName",value:(l=I.default(j.default.mark((function e(t){var n;return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._ensureReady;case 2:return e.next=4,this.conversations.myConversationsRead.promise;case 4:return e.next=6,this.conversations.getConversationByUniqueName(t);case 6:if(n=e.sent){e.next=9;break}throw new Error("Conversation with unique name ".concat(t," is not found."));case 9:return e.abrupt("return",n);case 10:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"getSubscribedConversations",value:(c=I.default(j.default.mark((function e(){return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._ensureReady;case 2:return e.abrupt("return",this.conversationsPromise.then((function(e){return e.getConversations()})));case 3:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"createConversation",value:(u=I.default(j.default.mark((function e(t){return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._ensureReady;case 2:return t=t||{},e.abrupt("return",this.conversationsPromise.then((function(e){return e.addConversation(t)})));case 4:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"setPushRegistrationId",value:(a=I.default(j.default.mark((function e(t,n){return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._ensureReady;case 2:return this._subscribeToPushNotifications(t),this.services.notificationClient.setPushRegistrationId(t,n),e.next=6,this.services.notificationClient.commitChanges();case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return a.apply(this,arguments)})},{key:"unsetPushRegistrationId",value:(s=I.default(j.default.mark((function e(t){return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._ensureReady;case 2:return this._unsubscribeFromPushNotifications(t),e.next=5,this.services.notificationClient.commitChanges();case 5:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"removePushRegistrations",value:(o=I.default(j.default.mark((function e(t,n){return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.services.notificationClient.removeRegistrations(t,n);case 2:case"end":return e.stop()}}),e,this)}))),function(e,t){return o.apply(this,arguments)})},{key:"handlePushNotification",value:(i=I.default(j.default.mark((function e(t){return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._ensureReady;case 2:ut.debug("handlePushNotification, notificationPayload=",t),this.emit("pushNotification",nt.parsePushNotification(t));case 4:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"getUser",value:(r=I.default(j.default.mark((function e(t){return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._ensureReady;case 2:return e.abrupt("return",this.services.users.getUser(t));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"getSubscribedUsers",value:(n=I.default(j.default.mark((function e(){return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._ensureReady;case 2:return e.abrupt("return",this.services.users.getSubscribedUsers());case 3:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})}],[{key:"populateInitRegistrations",value:function(e){e.populateInitRegistrations([de.TYPING_INDICATOR]),k.SyncClient.populateInitRegistrations(e)}},{key:"create",value:(t=I.default(j.default.mark((function e(t,n){var r;return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==n||!n.twilsockClient){e.next=2;break}throw new Error("Obsolete usage of ConversationsClient.create() factory method: if you pass twilsock from the outside then you must use ConversationsClient constructor and be prepared to work with uninitialized client.");case 2:return r=new nt(t,n),e.next=5,r._ensureReady;case 5:return e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)}))),function(e,n){return t.apply(this,arguments)})},{key:"parsePushNotificationChatData",value:function(e){var t={};for(var n in nt.supportedPushDataFields)void 0!==e[n]&&null!==e[n]&&("message_index"===n?null!==Q(e[n])&&(t[nt.supportedPushDataFields[n]]=Number(e[n])):t[nt.supportedPushDataFields[n]]=e[n]);return t}},{key:"parsePushNotification",value:function(e){if(ut.debug("parsePushNotification, notificationPayload=",e),void 0!==e.aps){if(!e.twi_message_type)throw new Error("Provided push notification payload does not contain Programmable Chat push notification type");var t,n=nt.parsePushNotificationChatData(e),r=e.aps,i=null;return"string"==typeof r.alert?t=r.alert||null:(t=r.alert.body||null,i=r.alert.title||null),new Je({title:i,body:t,sound:r.sound||null,badge:r.badge||null,action:r.category||null,type:e.twi_message_type,data:n})}if(void 0!==e.data){var o=e.data;if(!o.twi_message_type)throw new Error("Provided push notification payload does not contain Programmable Chat push notification type");var s=nt.parsePushNotificationChatData(e.data);return new Je({title:o.twi_title||null,body:o.twi_body||null,sound:o.twi_sound||null,badge:null,action:o.twi_action||null,type:o.twi_message_type,data:s})}throw new Error("Provided push notification payload is not Programmable Chat notification")}}]),v}(v.ReplayEventEmitter),L.default(et,"version",ct),L.default(et,"supportedPushChannels",["fcm","apn"]),L.default(et,"supportedPushDataFields",{conversation_sid:"conversationSid",message_sid:"messageSid",message_index:"messageIndex"}),L.default(et,"conversationAdded","conversationAdded"),L.default(et,"conversationJoined","conversationJoined"),L.default(et,"conversationLeft","conversationLeft"),L.default(et,"conversationRemoved","conversationRemoved"),L.default(et,"conversationUpdated","conversationUpdated"),L.default(et,"participantJoined","participantJoined"),L.default(et,"participantLeft","participantLeft"),L.default(et,"participantUpdated","participantUpdated"),L.default(et,"messageAdded","messageAdded"),L.default(et,"messageRemoved","messageRemoved"),L.default(et,"messageUpdated","messageUpdated"),L.default(et,"tokenAboutToExpire","tokenAboutToExpire"),L.default(et,"tokenExpired","tokenExpired"),L.default(et,"typingEnded","typingEnded"),L.default(et,"typingStarted","typingStarted"),L.default(et,"pushNotification","pushNotification"),L.default(et,"userSubscribed","userSubscribed"),L.default(et,"userUnsubscribed","userUnsubscribed"),L.default(et,"userUpdated","userUpdated"),L.default(et,"stateChanged","stateChanged"),L.default(et,"connectionStateChanged","connectionStateChanged"),L.default(et,"connectionError","connectionError"),nt=tt),G([y.validateTypesAsync(y.nonEmptyString),W("design:type",Function),W("design:paramtypes",[String]),W("design:returntype",Promise)],t.KU.prototype,"updateToken",null),G([y.validateTypesAsync(y.nonEmptyString),W("design:type",Function),W("design:paramtypes",[String]),W("design:returntype",Promise)],t.KU.prototype,"getConversationBySid",null),G([y.validateTypesAsync(y.nonEmptyString),W("design:type",Function),W("design:paramtypes",[String]),W("design:returntype",Promise)],t.KU.prototype,"getConversationByUniqueName",null),G([y.validateTypesAsync(["undefined",y.objectSchema("conversation options",{friendlyName:["string","undefined"],isPrivate:["boolean","undefined"],uniqueName:["string","undefined"]})]),W("design:type",Function),W("design:paramtypes",[Object]),W("design:returntype",Promise)],t.KU.prototype,"createConversation",null),G([y.validateTypesAsync(y.literal("fcm","apn"),"string"),W("design:type",Function),W("design:paramtypes",[String,String]),W("design:returntype",Promise)],t.KU.prototype,"setPushRegistrationId",null),G([y.validateTypesAsync(y.literal("fcm","apn")),W("design:type",Function),W("design:paramtypes",[String]),W("design:returntype",Promise)],t.KU.prototype,"unsetPushRegistrationId",null),G([y.validateTypesAsync(y.literal("fcm","apn"),y.nonEmptyString),W("design:type",Function),W("design:paramtypes",[String,String]),W("design:returntype",Promise)],t.KU.prototype,"removePushRegistrations",null),G([y.validateTypesAsync(y.pureObject),W("design:type",Function),W("design:paramtypes",[Object]),W("design:returntype",Promise)],t.KU.prototype,"handlePushNotification",null),G([y.validateTypesAsync(y.nonEmptyString),W("design:type",Function),W("design:paramtypes",[String]),W("design:returntype",Promise)],t.KU.prototype,"getUser",null),G([y.validateTypesAsync("string",["undefined",y.pureObject]),W("design:type",Function),W("design:paramtypes",[String,Object]),W("design:returntype",Promise)],t.KU,"create",null),G([y.validateTypes(y.pureObject),W("design:type",Function),W("design:paramtypes",[Object]),W("design:returntype",Je)],t.KU,"parsePushNotification",null),t.KU=nt=G([y.validateConstructorTypes(y.nonEmptyString,[y.pureObject,"undefined"]),W("design:paramtypes",[String,Object])],t.KU)},321:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(7472),n(1825),n(2893),n(8389),n(5857),n(711),n(6909),n(7583),n(2502);var r=n(4492);n(5324),n(3708),n(5607);var i=n(2013);n(6781),n(6294),n(5664);var o=n(6507),s=n(9516),a=n(5895),u=n(1167),c=n(1559);function l(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}n(1022),n(5648),n(1117);var d=l(r),f=l(i),p=l(o),h=l(s),y=l(a),v=l(u),m=l(c),g=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return{checks:t}};function b(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return _(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function _(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var w=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return g((function(e){var n,r=!1,i=[],o=b(t);try{for(o.s();!(n=o.n()).done;){var s=n.value;"string"!=typeof s?(r=r||e instanceof s,i.push("an instance of ".concat(s.name))):(r=r||d.default(e)===s,i.push("of type ".concat(s)))}}catch(e){o.e(e)}finally{o.f()}return[r,i]}))};function k(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return x(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return x(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var S=g((function(e){return["string"==typeof e&&e.length>0,"a non-empty string"]})),E=g((function(e){return["number"==typeof e&&Number.isInteger(e)&&e>=0,"a non-negative integer"]})),T=g((function(e){return["object"===d.default(e)&&null!==e&&!Array.isArray(e),"a pure object (non-null and non-array)"]}));function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=m.default(e);if(t){var i=m.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return v.default(this,n)}}function I(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return C(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return C(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var R=function(e,t){if(t.length>e.length)throw new Error("Expected at most ".concat(e.length," argument(s), but got ").concat(t.length));for(;t.length<e.length;)t.push(void 0);var n,r=I(t.entries());try{for(r.s();!(n=r.n()).done;){var i=f.default(n.value,2),o=i[0],s=i[1],a=L(e[o],s),u=f.default(a,4),c=u[0],l=u[1],d=u[2],p=u[3];if(!c)throw new Error("Argument ".concat(o+1," is expected to be ").concat(d).concat(p," but got ").concat(l))}}catch(e){r.e(e)}finally{r.f()}},A=function(e){var t,n,r;(["undefined","boolean","number","bigint","string"].includes(d.default(e))&&(n="string"==typeof e?'"'.concat(e,'"'):"".concat(e)),"object"===d.default(e)&&"Object"!==(null==e||null===(t=e.constructor)||void 0===t?void 0:t.name))&&(n=null===e?"null":"instance of ".concat(null==e||null===(r=e.constructor)||void 0===r?void 0:r.name));return n||(n=d.default(e)),n},P=function(e){var t,n=[],r=I(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;n.push(N(i))}}catch(e){r.e(e)}finally{r.f()}return n},N=function(e){var t,n=[],r=I(Array.isArray(e)?e:[e]);try{for(r.s();!(t=r.n()).done;){var i=t.value;"string"!=typeof i&&"function"!=typeof i?n.push(i):n.push(w(i))}}catch(e){r.e(e)}finally{r.f()}return n},L=function(e,t){var n,r,i=[],o=!1,s=I(e);try{for(s.s();!(r=s.n()).done;){var a,u=I(r.value.checks);try{for(u.s();!(a=u.n()).done;){var c=(0,a.value)(t),l=f.default(c,3),d=l[0],h=l[1],y=l[2];o=o||d,!n&&y&&(n=y),h&&(i=[].concat(p.default(i),"string"==typeof h?[h]:p.default(h)))}}catch(e){u.e(e)}finally{u.f()}}}catch(e){s.e(e)}finally{s.f()}if(o)return[!0];var v=n||A(t),m=i.length-1;return[!1,v,m>0?"".concat(i.slice(0,m).join(", ")," or ").concat(i[m]):i.join(", "),m>1?";":","]};function M(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return j(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return j(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function j(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}t.array=function(e,t){return g((function(n){if(!Array.isArray(n))return[!1,"an array of ".concat(e)];var r,i=M(n.entries());try{for(i.s();!(r=i.n()).done;){var o=f.default(r.value,2),s=o[0],a=o[1],u=L(N(t),a),c=f.default(u,3),l=c[0],d=c[1],p=c[2];if(!l)return[!1,"a valid array of ".concat(e," (index ").concat(s," should be ").concat(p,")"),"malformed array of ".concat(e," (index ").concat(s," is ").concat(d,")")]}}catch(e){i.e(e)}finally{i.f()}return[!0]}))},t.custom=g,t.literal=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return g((function(e){var n,r=!1,i=[],o=k(t);try{for(o.s();!(n=o.n()).done;){var s=n.value;r=r||e===s,i.push("string"==typeof s?'"'.concat(s,'"'):"".concat(s))}}catch(e){o.e(e)}finally{o.f()}return[r,i]}))},t.nonEmptyString=S,t.nonNegativeInteger=E,t.objectSchema=function(e,t){return g((function(n){if("object"!==d.default(n)||null===n||Array.isArray(n))return[!1,"valid ".concat(e," (should be a pure object)")];for(var r=0,i=Object.entries(t);r<i.length;r++){var o=f.default(i[r],2),s=o[0],a=o[1],u=L(N(a),n[s]),c=f.default(u,3),l=c[0],p=c[1],h=c[2];if(!l)return[!1,"valid ".concat(e,' (key "').concat(s,'" should be ').concat(h,")"),"malformed ".concat(e,' (key "').concat(s,'" is ').concat(p,")")]}return[!0]}))},t.pureObject=T,t.runtimeTypeValidation=R,t.stringifyReceivedType=A,t.type=w,t.validateConstructorTypes=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=P(t);return function(e){return function(e){y.default(n,e);var t=O(n);function n(){h.default(this,n);for(var e=arguments.length,i=new Array(e),o=0;o<e;o++)i[o]=arguments[o];return R(r,i),t.call.apply(t,[this].concat(i))}return n}(e)}},t.validateTypes=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=P(t);return function(e,t,n){if("function"!=typeof n.value)throw new Error("The validateTypes decorator can only be applied to methods");var i=n.value;n.value=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return R(r,t),i.apply(this,t)}}},t.validateTypesAsync=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=P(t);return function(e,t,n){if("function"!=typeof n.value)throw new Error("The validateTypesAsync decorator can only be applied to methods");var i=n.value;n.value=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];try{R(r,t)}catch(e){return Promise.reject(e)}return i.apply(this,t)}}}},7206:(e,t,n)=>{"use strict";var r=void 0!==r?r:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{};Object.defineProperty(t,"__esModule",{value:!0});var i=n(5341),o=n(7322);n(5648);var s=n(3879);n(2893);var a=n(1144);n(6571),n(4465),n(6564),n(740),n(806),n(7583),n(2502),n(4912);var u=n(4051),c=n(321);function l(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function d(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(n){if("default"!==n){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})}})),t.default=e,Object.freeze(t)}var f=l(i),p=l(o),h=l(s),y=d(a);function v(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}function m(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function g(e,t){return["".concat((new Date).toISOString()," MCS Client ").concat(e,":")].concat(Array.from(t))}class b{constructor(e){p.default(this,"prefix",""),this.prefix=null!=e&&e.length>0?e+" ":""}static scope(e){return new b(e)}setLevel(e){y.setLevel(e)}static setLevel(e){y.setLevel(e)}trace(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];y.trace.apply(null,g(this.prefix+"T",t))}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];y.debug.apply(null,g(this.prefix+"D",t))}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];y.info.apply(null,g(this.prefix+"I",t))}warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];y.warn.apply(null,g(this.prefix+"W",t))}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];y.error.apply(null,g(this.prefix+"E",t))}static trace(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];y.trace.apply(null,g("T",t))}static debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];y.debug.apply(null,g("D",t))}static info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];y.info.apply(null,g("I",t))}static warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];y.warn.apply(null,g("W",t))}static error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];y.error.apply(null,g("E",t))}}var _=(e,t)=>{return"".concat((n=e,n.startsWith("http")?"":(e=>"https://mcs.".concat(null!=e?e:"us1",".twilio.com"))(t))).concat(e);var n};class w{constructor(e,t,n,r){var i,o,s,a,u,c,l=null!==(i=null!==(o=r.MCS)&&void 0!==o?o:r)&&void 0!==i?i:{};this.region=null!==(s=null!==(a=l.region)&&void 0!==a?a:r.region)&&void 0!==s?s:"us1",this.mediaUrl=_(t,this.region),this.mediaSetUrl=n?_(n):"".concat(this.mediaUrl,"Set"),this.token=e,this.retryWhenThrottledOverride=null===(u=l.retryWhenThrottledOverride)||void 0===u||u,this.backoffConfigOverride=null!==(c=l.backoffConfigOverride)&&void 0!==c?c:w.backoffConfigDefault}static get backoffConfigDefault(){return{min:1e3,max:4e3,maxAttemptsCount:3}}static get retryWhenThrottledDefault(){return true}updateToken(e){this.token=e}}class k{constructor(e,t,n){this.config=e,this.network=t,this._update(n)}get sid(){return this.state.sid}get serviceSid(){return this.state.serviceSid}get dateCreated(){return this.state.dateCreated}get dateUpdated(){return this.state.dateUpdated}get contentType(){return this.state.contentType}get size(){return this.state.size}get fileName(){return this.state.filename}get filename(){return this.state.filename}get category(){return this.state.category}getContentUrl(){var e=this;return f.default(h.default.mark((function t(){var n;return h.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.network.get("".concat(e.config.mediaUrl,"/").concat(e.sid));case 2:return n=t.sent,e._update(n.body),t.abrupt("return",Promise.resolve(e.state.contentDirectUrl));case 5:case"end":return t.stop()}}),t)})))()}getCachedContentUrl(){var e=this;return f.default(h.default.mark((function t(){return h.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.state.contentDirectUrl){t.next=2;break}return t.abrupt("return",Promise.resolve(e.state.contentDirectUrl));case 2:return t.next=4,e.getContentUrl();case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}}),t)})))()}_update(e){var t,n,r,i;this.state={sid:e.sid,serviceSid:e.service_sid,channelSid:e.channel_sid,messageSid:e.message_sid,dateCreated:e.date_created?new Date(e.date_created):null,dateUploadUpdated:e.date_upload_updated?new Date(e.date_upload_updated):null,dateUpdated:e.date_updated?new Date(e.date_updated):null,size:e.size,contentType:e.content_type,author:e.author,url:e.url,contentUrl:e.links.content,contentDirectUrl:null!==(t=e.links.content_direct_temporary)&&void 0!==t?t:null,filename:null!==(n=e.filename)&&void 0!==n?n:null,category:null!==(r=e.category)&&void 0!==r?r:"media",isMultipartUpstream:null!==(i=e.is_multipart_upstream)&&void 0!==i&&i}}}class x extends Error{constructor(e,t,n,r,i){super(e),this.code=t,this.body=n,this.status=r,this.headers=i}}var S=r.XMLHttpRequest||{};function E(e){var t=e.getResponseHeader("Content-Type");if(!t||0!==t.indexOf("application/json")||0===e.responseText.length)return e.responseText;try{return JSON.parse(e.responseText)}catch(t){return e.responseText}}class T{static request(e,t,n,r){return f.default(h.default.mark((function i(){return h.default.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",new Promise(((i,o)=>{var s=new S;for(var a in s.open(e,t,!0),s.onreadystatechange=function(){if(4===s.readyState){var e,t=(e=s.getAllResponseHeaders())?e.split("\r\n").map((e=>e.split(": "))).filter((e=>2===e.length&&e[1].length>0)).reduce(((e,t)=>(e[t[0]]=t[1],e)),{}):{},n=E(s);if(200<=s.status&&s.status<300)i({status:s.status,headers:t,body:n});else{var r,a,u=null!==(r=s.statusText)&&void 0!==r?r:"NONE";a="string"==typeof n?n&&1===n.split("\n",2).length?n:"":JSON.stringify(n);var c="".concat(s.status,": [").concat(u,"] ").concat(a);o(new x(c,s.status,n,u,t))}}},n)s.setRequestHeader(a,n[a]),"Content-Type"===a&&"application/json"===n[a]&&(r=JSON.stringify(r));s.send(r)})));case 1:case"end":return i.stop()}}),i)})))()}get(e,t){return f.default(h.default.mark((function n(){return h.default.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",T.request("GET",e,t));case 1:case"end":return n.stop()}}),n)})))()}post(e,t,n){return f.default(h.default.mark((function r(){return h.default.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",T.request("POST",e,t,n));case 1:case"end":return r.stop()}}),r)})))()}}var O=b.scope("Network");class I{constructor(e,t){this.config=e,this.transport=t}backoffConfig(){return Object.assign(w.backoffConfigDefault,this.config.backoffConfigOverride)}retryWhenThrottled(){var e,t;return null!==(e=null!==(t=this.config.retryWhenThrottledOverride)&&void 0!==t?t:w.retryWhenThrottledDefault)&&void 0!==e&&e}executeWithRetry(e,t){var n=this;return f.default(h.default.mark((function r(){return h.default.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",new Promise(((r,i)=>{var o=[502,503,504];t&&o.push(429);var s=new u.Retrier(n.backoffConfig());s.on("attempt",f.default(h.default.mark((function t(){var n;return h.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e();case 3:n=t.sent,s.succeeded(n),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),o.indexOf(t.t0.status)>-1||"Twilsock disconnected"===t.t0.message?s.failed(t.t0):(s.removeAllListeners(),s.cancel(),i(t.t0));case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))),s.on("succeeded",(e=>{r(e)})),s.on("cancelled",(e=>i(e))),s.on("failed",(e=>i(e))),s.start()})));case 1:case"end":return r.stop()}}),r)})))()}get(e){var t=this;return f.default(h.default.mark((function n(){var r,i;return h.default.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r={"X-Twilio-Token":t.config.token},O.trace("sending GET request to ",e," headers ",r),n.prev=2,n.next=5,t.executeWithRetry((()=>t.transport.get(e,r)),t.retryWhenThrottled());case 5:return i=n.sent,O.trace("response",i),n.abrupt("return",i);case 10:throw n.prev=10,n.t0=n.catch(2),O.debug("get() error ".concat(n.t0)),n.t0;case 14:case"end":return n.stop()}}),n,null,[[2,10]])})))()}post(e,t,n,i,o){var s=this;return f.default(h.default.mark((function a(){var u,c,l;return h.default.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return u={"X-Twilio-Token":s.config.token},"undefined"!=typeof FormData&&n instanceof FormData||!i||Object.assign(u,{"Content-Type":i}),c=new URL(e),t&&c.searchParams.append("Category",t),o&&c.searchParams.append("Filename",o),O.trace("sending POST request to ".concat(e," with headers ").concat(u)),a.prev=6,a.next=9,s.transport.post(c.href,u,n);case 9:l=a.sent,a.next=18;break;case 12:if(a.prev=12,a.t0=a.catch(6),!(void 0===r.XMLHttpRequest&&n instanceof FormData)){a.next=16;break}throw new TypeError("Posting FormData supported only with browser engine's FormData");case 16:throw O.debug("post() error ".concat(a.t0)),a.t0;case 18:return O.trace("response",l),a.abrupt("return",l);case 20:case"end":return a.stop()}}),a,null,[[6,12]])})))()}}var C,R,A=b.scope("");t.default=(R=C=class{constructor(e,t,n){var r,i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this.options=o,this.options.logLevel=null!==(r=this.options.logLevel)&&void 0!==r?r:"silent",this.config=new w(e,t,n,this.options),A.setLevel(this.options.logLevel),this.options.transport=null!==(i=this.options.transport)&&void 0!==i?i:new T,this.transport=this.options.transport,this.network=new I(this.config,this.transport)}updateToken(e){A.info("updateToken"),this.config.updateToken(e)}get(e){var t=this;return f.default(h.default.mark((function n(){var r;return h.default.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.network.get("".concat(t.config.mediaUrl,"/").concat(e));case 2:return r=n.sent,n.abrupt("return",new k(t.config,t.network,r.body));case 4:case"end":return n.stop()}}),n)})))()}post(e,t,n,r){var i=this;return f.default(h.default.mark((function o(){var s;return h.default.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,i.network.post(i.config.mediaUrl,null!=n?n:"media",t,e,r);case 2:return s=o.sent,o.abrupt("return",new k(i.config,i.network,s.body));case 4:case"end":return o.stop()}}),o)})))()}postFormData(e,t){var n=this;return f.default(h.default.mark((function r(){var i;return h.default.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.network.post(n.config.mediaUrl,null!=t?t:"media",e);case 2:return i=r.sent,r.abrupt("return",new k(n.config,n.network,i.body));case 4:case"end":return r.stop()}}),r)})))()}mediaSetGet(e){var t=this;return f.default(h.default.mark((function n(){var r,i;return h.default.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r={command:"get",list:e.map((e=>({media_sid:e})))},n.next=3,t.network.post("".concat(t.config.mediaSetUrl),null,r,"application/json");case 3:return i=n.sent,n.abrupt("return",i.body.map((e=>{if(200!==e.code)throw new Error("Failed to obtain detailed information about Media items (failed SID ".concat(e.media_record.sid,")"));return new k(t.config,t.network,e.media_record)})));case 5:case"end":return n.stop()}}),n)})))()}},p.default(C,"version","0.5.3"),R),v([c.validateTypes(c.nonEmptyString),m("design:type",Function),m("design:paramtypes",[String]),m("design:returntype",void 0)],t.default.prototype,"updateToken",null),v([c.validateTypesAsync(c.nonEmptyString),m("design:type",Function),m("design:paramtypes",[String]),m("design:returntype",Promise)],t.default.prototype,"get",null),t.default=v([c.validateConstructorTypes(c.nonEmptyString,c.nonEmptyString,[c.nonEmptyString,c.literal(null)],[c.pureObject,"undefined"]),m("design:paramtypes",[String,String,Object,Object])],t.default),t.Client=t.default,t.McsClient=t.default,t.McsMedia=k,t.Media=k,t.default=t.default},1602:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(5664);var r=n(5341),i=n(9516),o=n(2281),s=n(5895),a=n(1167),u=n(1559),c=n(3879);n(7583),n(2905),n(1825),n(8389),n(2502),n(6294),n(6029),n(5648);var l=n(4492),d=n(3821),f=n(5206),p=n(7322);n(770),n(2893),n(806);var h=n(4051),y=n(2013),v=n(6507);n(8270),n(8505);var m=n(1144),g=n(4755),b=n(321);function _(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function w(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(n){if("default"!==n){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})}})),t.default=e,Object.freeze(t)}var k=_(r),x=_(i),S=_(o),E=_(s),T=_(a),O=_(u),I=_(c),C=_(l),R=_(f),A=_(p),P=_(y),N=_(v),L=w(m),M=w(g);function j(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":C.default(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}function D(e,t){if("object"===("undefined"==typeof Reflect?"undefined":C.default(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function B(){}function U(){U.init.call(this)}function F(e){return void 0===e._maxListeners?U.defaultMaxListeners:e._maxListeners}function H(e,t,n){if(t)e.call(n);else for(var r=e.length,i=$(e,r),o=0;o<r;++o)i[o].call(n)}function G(e,t,n,r){if(t)e.call(n,r);else for(var i=e.length,o=$(e,i),s=0;s<i;++s)o[s].call(n,r)}function W(e,t,n,r,i){if(t)e.call(n,r,i);else for(var o=e.length,s=$(e,o),a=0;a<o;++a)s[a].call(n,r,i)}function q(e,t,n,r,i,o){if(t)e.call(n,r,i,o);else for(var s=e.length,a=$(e,s),u=0;u<s;++u)a[u].call(n,r,i,o)}function V(e,t,n,r){if(t)e.apply(n,r);else for(var i=e.length,o=$(e,i),s=0;s<i;++s)o[s].apply(n,r)}function z(e,t,n,r){var i,o,s;if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');if((o=e._events)?(o.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),s=o[t]):(o=e._events=new B,e._eventsCount=0),s){if("function"==typeof s?s=o[t]=r?[n,s]:[s,n]:r?s.unshift(n):s.push(n),!s.warned&&(i=F(e))&&i>0&&s.length>i){s.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=e,a.type=t,a.count=s.length,console.warn}}else s=o[t]=n,++e._eventsCount;return e}function Y(e,t,n){var r=!1;function i(){e.removeListener(t,i),r||(r=!0,n.apply(e,arguments))}return i.listener=n,i}function K(e){var t=this._events;if(t){var n=t[e];if("function"==typeof n)return 1;if(n)return n.length}return 0}function $(e,t){for(var n=new Array(t);t--;)n[t]=e[t];return n}B.prototype=Object.create(null),U.EventEmitter=U,U.usingDomains=!1,U.prototype.domain=void 0,U.prototype._events=void 0,U.prototype._maxListeners=void 0,U.defaultMaxListeners=10,U.init=function(){this.domain=null,U.usingDomains&&undefined.active,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new B,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},U.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},U.prototype.getMaxListeners=function(){return F(this)},U.prototype.emit=function(e){var t,n,r,i,o,s,a,u="error"===e;if(s=this._events)u=u&&null==s.error;else if(!u)return!1;if(a=this.domain,u){if(t=arguments[1],!a){if(t instanceof Error)throw t;var c=new Error('Uncaught, unspecified "error" event. ('+t+")");throw c.context=t,c}return t||(t=new Error('Uncaught, unspecified "error" event')),t.domainEmitter=this,t.domain=a,t.domainThrown=!1,a.emit("error",t),!1}if(!(n=s[e]))return!1;var l="function"==typeof n;switch(r=arguments.length){case 1:H(n,l,this);break;case 2:G(n,l,this,arguments[1]);break;case 3:W(n,l,this,arguments[1],arguments[2]);break;case 4:q(n,l,this,arguments[1],arguments[2],arguments[3]);break;default:for(i=new Array(r-1),o=1;o<r;o++)i[o-1]=arguments[o];V(n,l,this,i)}return!0},U.prototype.addListener=function(e,t){return z(this,e,t,!1)},U.prototype.on=U.prototype.addListener,U.prototype.prependListener=function(e,t){return z(this,e,t,!0)},U.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,Y(this,e,t)),this},U.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,Y(this,e,t)),this},U.prototype.removeListener=function(e,t){var n,r,i,o,s;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if(!(r=this._events))return this;if(!(n=r[e]))return this;if(n===t||n.listener&&n.listener===t)0==--this._eventsCount?this._events=new B:(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,o=n.length;o-- >0;)if(n[o]===t||n[o].listener&&n[o].listener===t){s=n[o].listener,i=o;break}if(i<0)return this;if(1===n.length){if(n[0]=void 0,0==--this._eventsCount)return this._events=new B,this;delete r[e]}else!function(e,t){for(var n=t,r=n+1,i=e.length;r<i;n+=1,r+=1)e[n]=e[r];e.pop()}(n,i);r.removeListener&&this.emit("removeListener",e,s||t)}return this},U.prototype.off=function(e,t){return this.removeListener(e,t)},U.prototype.removeAllListeners=function(e){var t,n;if(!(n=this._events))return this;if(!n.removeListener)return 0===arguments.length?(this._events=new B,this._eventsCount=0):n[e]&&(0==--this._eventsCount?this._events=new B:delete n[e]),this;if(0===arguments.length){for(var r,i=Object.keys(n),o=0;o<i.length;++o)"removeListener"!==(r=i[o])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=new B,this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(t)do{this.removeListener(e,t[t.length-1])}while(t[0]);return this},U.prototype.listeners=function(e){var t,n=this._events;return n&&(t=n[e])?"function"==typeof t?[t.listener||t]:function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(t):[]},U.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):K.call(e,t)},U.prototype.listenerCount=K,U.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};var X=L.getLogger("twilio-notificatiions");function J(e,t){return["".concat((new Date).toISOString()," Twilio.Notifications ").concat(e,":")].concat(Array.from(t))}var Z=new(function(){function e(){x.default(this,e)}return S.default(e,[{key:"setLevel",value:function(e){X.setLevel(e)}},{key:"trace",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];X.trace.apply(null,J("T",t))}},{key:"debug",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];X.debug.apply(null,J("D",t))}},{key:"info",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];X.info.apply(null,J("I",t))}},{key:"warn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];X.warn.apply(null,J("W",t))}},{key:"error",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];X.error.apply(null,J("E",t))}}]),e}());function Q(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=O.default(e);if(t){var i=O.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return T.default(this,n)}}var ee=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Set;x.default(this,e),this.token=t,this.notificationId=n,this.messageTypes=r};function te(e,t){var n=new Set;return e.notificationId!==t.notificationId&&n.add("notificationId"),e.token!==t.token&&n.add("token"),function(e,t){return[].concat(N.default(N.default(e).filter((function(e){return!t.has(e)}))),N.default(N.default(t).filter((function(t){return!e.has(t)}))))}(e.messageTypes,t.messageTypes).length>0&&n.add("messageType"),[n.size>0,n]}var ne=function(e){E.default(r,e);var t,n=Q(r);function r(e){var t;return x.default(this,r),t=n.call(this),A.default(R.default(t),"desiredState",new ee),A.default(R.default(t),"currentState",new ee),A.default(R.default(t),"_hasActiveAttempt",!1),t.channelType=e,t}return S.default(r,[{key:"setNotificationId",value:function(e){this.desiredState.notificationId=e}},{key:"isActive",value:function(){return""!==this.desiredState.notificationId}},{key:"subscribe",value:function(e){this.desiredState.messageTypes.has(e)?Z.debug("message type '".concat(e,"' for channel ").concat(this.channelType," is already registered")):this.desiredState.messageTypes.add(e)}},{key:"unsubscribe",value:function(e){this.desiredState.messageTypes.has(e)&&this.desiredState.messageTypes.delete(e)}},{key:"updateToken",value:function(e){this.desiredState.token=e}},{key:"commitChanges",value:(t=k.default(I.default.mark((function e(){var t,n,r,i,o,s;return I.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._hasActiveAttempt){e.next=3;break}throw Z.error("One registration attempt is already in progress"),new Error("One registration attempt is already in progress");case 3:if(t=te(this.desiredState,this.currentState),n=P.default(t,2),r=n[0],i=n[1],r){e.next=6;break}return e.abrupt("return");case 6:if(this.currentState.notificationId||i.delete("notificationId"),Z.trace("Persisting ".concat(this.channelType," registration"),i,this.desiredState),e.prev=8,this._hasActiveAttempt=!0,(o=new ee).token=this.desiredState.token,o.notificationId=this.desiredState.notificationId,o.messageTypes=new Set(this.desiredState.messageTypes),!(o.messageTypes.size>0)){e.next=24;break}return e.next=17,this.updateRegistration(o,i);case 17:s=e.sent,this.currentState.token=s.token,this.currentState.notificationId=s.notificationId,this.currentState.messageTypes=new Set(s.messageTypes),this.emit("stateChanged",this.channelType,"registered",this.currentState),e.next=30;break;case 24:return e.next=26,this.removeRegistration();case 26:this.currentState.token=o.token,this.currentState.notificationId=o.notificationId,this.currentState.messageTypes.clear(),this.emit("stateChanged",this.channelType,"unregistered",this.currentState);case 30:e.next=35;break;case 32:throw e.prev=32,e.t0=e.catch(8),e.t0;case 35:return e.prev=35,this._hasActiveAttempt=!1,e.finish(35);case 38:case"end":return e.stop()}}),e,this,[[8,32,35,38]])}))),function(){return t.apply(this,arguments)})}]),r}(U);function re(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=O.default(e);if(t){var i=O.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return T.default(this,n)}}var ie={min:2e3,max:12e4,randomness:.2},oe=function(e){E.default(o,e);var t,n,r,i=re(o);function o(e,t,n,r){var s;return x.default(this,o),s=i.call(this,e),A.default(R.default(s),"registrationId",null),s.context=t,s.twilsock=n,s.registrarUrl=r,s}return S.default(o,[{key:"updateRegistration",value:(r=k.default(I.default.mark((function e(t,n){var r,i,o,s,a,u=this;return I.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.has("notificationId")){e.next=3;break}return e.next=3,this.removeRegistration();case 3:if(t.notificationId&&t.notificationId.length){e.next=6;break}throw Z.error("No push notification ID for registration"),new Error("No push notification ID for registration");case 6:return Z.trace("Registering",this.channelType,t),r={endpoint_platform:this.context.platform,channel_type:this.channelType,version:this.context.protocolVersion.toString(),message_types:Array.from(t.messageTypes),data:{registration_id:t.notificationId}},i=this.context.productId,o="".concat(this.registrarUrl,"?productId=").concat(i),s={"Content-Type":"application/json"},Z.trace("Creating registration for channel ".concat(this.channelType)),e.prev=12,e.next=15,new h.AsyncRetrier(ie).run((function(){return u.twilsock.post(o,s,r,i)}));case 15:a=e.sent,this.registrationId=a.body.id,Z.debug("Registration created: ",a),e.next=24;break;case 20:throw e.prev=20,e.t0=e.catch(12),Z.error("Registration failed: ",e.t0),e.t0;case 24:return e.abrupt("return",t);case 25:case"end":return e.stop()}}),e,this,[[12,20]])}))),function(e,t){return r.apply(this,arguments)})},{key:"removeRegistration",value:(n=k.default(I.default.mark((function e(){var t,n,r,i=this;return I.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.registrationId){e.next=2;break}return e.abrupt("return");case 2:return t=this.context.productId,n="".concat(this.registrarUrl,"/").concat(this.registrationId,"?productId=").concat(t),r={"Content-Type":"application/json"},Z.trace("Removing registration for ".concat(this.channelType)),e.prev=6,e.next=9,new h.AsyncRetrier(Object.assign(ie,{maxAttemptsCount:3})).run((function(){return i.twilsock.delete(n,r,{},t)}));case 9:this.registrationId=null,this.currentState.notificationId="",Z.debug("Registration removed for ".concat(this.channelType)),e.next=18;break;case 14:throw e.prev=14,e.t0=e.catch(6),Z.error("Failed to remove registration ",this.channelType,e.t0),e.t0;case 18:case"end":return e.stop()}}),e,this,[[6,14]])}))),function(){return n.apply(this,arguments)})},{key:"sendDeviceRemoveRequest",value:(t=k.default(I.default.mark((function e(t){var n,r,i,o,s=this;return I.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==t){e.next=2;break}throw new Error("Empty registration ID");case 2:return n=this.context.productId,r="".concat(this.registrarUrl,"?productId=").concat(n),i={"Content-Type":"application/json"},o={binding_type:this.channelType,address:t},e.prev=6,Z.trace("Removing old registrations for ".concat(this.channelType)),e.next=10,new h.AsyncRetrier(Object.assign(ie,{maxAttemptsCount:3})).run((function(){return s.twilsock.delete(r,i,o,n)}));case 10:this.registrationId=null,this.currentState.notificationId="",Z.debug("Registration removed for ".concat(this.channelType)),e.next=19;break;case 15:throw e.prev=15,e.t0=e.catch(6),Z.error("Failed to remove registration ",this.channelType,e.t0),e.t0;case 19:case"end":return e.stop()}}),e,this,[[6,15]])}))),function(e){return t.apply(this,arguments)})}]),o}(ne);function se(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=O.default(e);if(t){var i=O.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return T.default(this,n)}}var ae,ue=function(e){E.default(o,e);var t,n,r,i=se(o);function o(e,t,n){var r;return x.default(this,o),r=i.call(this,"twilsock"),A.default(R.default(r),"contextId",M.v4()),r.productId=e,r.platform=t,r.twilsock=n,r}return S.default(o,[{key:"updateRegistration",value:(r=k.default(I.default.mark((function e(t,n){var r,i;return I.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.has("messageType")){e.next=2;break}return e.abrupt("return",t);case 2:return r=Array.from(t.messageTypes),i={product_id:this.productId,notification_protocol_version:4,endpoint_platform:this.platform,message_types:r},e.prev=4,e.next=7,this.twilsock.setNotificationsContext(this.contextId,i);case 7:e.next=13;break;case 9:throw e.prev=9,e.t0=e.catch(4),Z.error("Failed to update twilsock notification context: ".concat(e.t0)),e.t0;case 13:return e.abrupt("return",t);case 14:case"end":return e.stop()}}),e,this,[[4,9]])}))),function(e,t){return r.apply(this,arguments)})},{key:"removeRegistration",value:(n=k.default(I.default.mark((function e(){return I.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.twilsock.removeNotificationsContext(this.contextId);case 3:e.next=9;break;case 5:throw e.prev=5,e.t0=e.catch(0),Z.error("Failed to remove twilsock notification context: ".concat(e.t0)),e.t0;case 9:case"end":return e.stop()}}),e,this,[[0,5]])}))),function(){return n.apply(this,arguments)})},{key:"sendDeviceRemoveRequest",value:(t=k.default(I.default.mark((function e(t){return I.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})}]),o}(ne);function ce(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=O.default(e);if(t){var i=O.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return T.default(this,n)}}var le=b.literal("apn","fcm","twilsock");t.Notifications=ae=function(e){E.default(o,e);var t,n,r,i=ce(o);function o(e){var t,n,r,s,a,u,c,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};x.default(this,o),c=i.call(this),l.logLevel=null!==(t=l.logLevel)&&void 0!==t?t:"error",Z.setLevel(l.logLevel);var f=null!==(n=l.productId)&&void 0!==n?n:"notifications",p=!l.twilsockClient,h=l.twilsockClient=null!==(r=l.twilsockClient)&&void 0!==r?r:new d.TwilsockClient(e,f,l),y=null!==(s=l.notifications)&&void 0!==s?s:{},v=null!==(a=null!==(u=y.region)&&void 0!==u?u:l.region)&&void 0!==a?a:"us1",m="https://ers.".concat(v,".twilio.com/v1/registrations"),g=y.ersUrl||m;c.connectors=new Map;var b=ae._detectPlatform();return c.connectors.set("apn",new oe("apn",{protocolVersion:4,productId:f,platform:b},h,g)),c.connectors.set("fcm",new oe("fcm",{protocolVersion:3,productId:f,platform:b},h,g)),c.connectors.set("twilsock",new ue(f,b,h)),h.on("stateChanged",(function(e){return c.emit("transportState",e)})),c._connector("twilsock").on("stateChanged",(function(e,t,n){return c.emit("stateChanged",e,t,n)})),c._connector("apn").on("stateChanged",(function(e,t,n){return c.emit("stateChanged",e,t,n)})),c._connector("fcm").on("stateChanged",(function(e,t,n){return c.emit("stateChanged",e,t,n)})),h.on("message",(function(e,t){return c._routeMessage(e,t)})),c.updateToken(e),p&&(h.connect(),c.twilsock=h),c}return S.default(o,[{key:"shutdown",value:(r=k.default(I.default.mark((function e(){return I.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.connectors.clear(),!this.twilsock){e.next=4;break}return e.next=4,this.twilsock.disconnect();case 4:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"setPushRegistrationId",value:function(e,t){Z.debug("Set ".concat(e," push registration id '").concat(t,"'")),this._connector(e).setNotificationId(t)}},{key:"subscribe",value:function(e,t){Z.debug("Add ".concat(e," subscriptions for message type ").concat(t)),this._connector(e).subscribe(t)}},{key:"unsubscribe",value:function(e,t){Z.debug("Remove ".concat(e," subscriptions for message type ").concat(t)),this._connector(e).unsubscribe(t)}},{key:"updateToken",value:function(e){this.connectors.forEach((function(t){return t.updateToken(e)}))}},{key:"commitChanges",value:(n=k.default(I.default.mark((function e(){var t;return I.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],this.connectors.forEach((function(e){e.isActive()&&t.push(e.commitChanges())})),e.next=4,Promise.all(t);case 4:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"removeRegistrations",value:(t=k.default(I.default.mark((function e(t,n){return I.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._connector(t).sendDeviceRemoveRequest(n);case 2:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:"handlePushNotification",value:function(e){return{messageType:e.twi_message_type,payload:e.payload}}},{key:"_routeMessage",value:function(e,t){Z.debug("Notification message arrived: ",e,t),this.emit("message",e,t)}},{key:"_connector",value:function(e){var t=this.connectors.get(e);if(!t)throw new Error("Unknown channel type: ".concat(e));return t}}],[{key:"_detectPlatform",value:function(){var e="";return"undefined"!=typeof navigator?(e="unknown",void 0!==navigator.product&&(e=navigator.product),void 0!==navigator.userAgent&&(e=navigator.userAgent)):e="web",e.substring(0,128)}}]),o}(U),j([b.validateTypes(le,b.nonEmptyString),D("design:type",Function),D("design:paramtypes",[String,String]),D("design:returntype",void 0)],t.Notifications.prototype,"setPushRegistrationId",null),j([b.validateTypes(le,b.nonEmptyString),D("design:type",Function),D("design:paramtypes",[String,String]),D("design:returntype",void 0)],t.Notifications.prototype,"subscribe",null),j([b.validateTypes(le,b.nonEmptyString),D("design:type",Function),D("design:paramtypes",[String,String]),D("design:returntype",void 0)],t.Notifications.prototype,"unsubscribe",null),j([b.validateTypes(b.nonEmptyString),D("design:type",Function),D("design:paramtypes",[String]),D("design:returntype",void 0)],t.Notifications.prototype,"updateToken",null),j([b.validateTypesAsync(le,b.nonEmptyString),D("design:type",Function),D("design:paramtypes",[String,String]),D("design:returntype",Promise)],t.Notifications.prototype,"removeRegistrations",null),t.Notifications=ae=j([b.validateConstructorTypes(b.nonEmptyString,[b.pureObject,"undefined",b.literal(null)]),D("design:paramtypes",[String,Object])],t.Notifications)},4051:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(5664);var r=n(9516),i=n(2281),o=n(5206),s=n(5895),a=n(1167),u=n(1559),c=n(7322);function l(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}n(1825),n(5648);var d=l(r),f=l(i),p=l(o),h=l(s),y=l(a),v=l(u),m=l(c);function g(){}function b(){b.init.call(this)}function _(e){return void 0===e._maxListeners?b.defaultMaxListeners:e._maxListeners}function w(e,t,n){if(t)e.call(n);else for(var r=e.length,i=C(e,r),o=0;o<r;++o)i[o].call(n)}function k(e,t,n,r){if(t)e.call(n,r);else for(var i=e.length,o=C(e,i),s=0;s<i;++s)o[s].call(n,r)}function x(e,t,n,r,i){if(t)e.call(n,r,i);else for(var o=e.length,s=C(e,o),a=0;a<o;++a)s[a].call(n,r,i)}function S(e,t,n,r,i,o){if(t)e.call(n,r,i,o);else for(var s=e.length,a=C(e,s),u=0;u<s;++u)a[u].call(n,r,i,o)}function E(e,t,n,r){if(t)e.apply(n,r);else for(var i=e.length,o=C(e,i),s=0;s<i;++s)o[s].apply(n,r)}function T(e,t,n,r){var i,o,s;if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');if((o=e._events)?(o.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),s=o[t]):(o=e._events=new g,e._eventsCount=0),s){if("function"==typeof s?s=o[t]=r?[n,s]:[s,n]:r?s.unshift(n):s.push(n),!s.warned&&(i=_(e))&&i>0&&s.length>i){s.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=e,a.type=t,a.count=s.length,console.warn}}else s=o[t]=n,++e._eventsCount;return e}function O(e,t,n){var r=!1;function i(){e.removeListener(t,i),r||(r=!0,n.apply(e,arguments))}return i.listener=n,i}function I(e){var t=this._events;if(t){var n=t[e];if("function"==typeof n)return 1;if(n)return n.length}return 0}function C(e,t){for(var n=new Array(t);t--;)n[t]=e[t];return n}function R(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v.default(e);if(t){var i=v.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return y.default(this,n)}}g.prototype=Object.create(null),b.EventEmitter=b,b.usingDomains=!1,b.prototype.domain=void 0,b.prototype._events=void 0,b.prototype._maxListeners=void 0,b.defaultMaxListeners=10,b.init=function(){this.domain=null,b.usingDomains&&undefined.active,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new g,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},b.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},b.prototype.getMaxListeners=function(){return _(this)},b.prototype.emit=function(e){var t,n,r,i,o,s,a,u="error"===e;if(s=this._events)u=u&&null==s.error;else if(!u)return!1;if(a=this.domain,u){if(t=arguments[1],!a){if(t instanceof Error)throw t;var c=new Error('Uncaught, unspecified "error" event. ('+t+")");throw c.context=t,c}return t||(t=new Error('Uncaught, unspecified "error" event')),t.domainEmitter=this,t.domain=a,t.domainThrown=!1,a.emit("error",t),!1}if(!(n=s[e]))return!1;var l="function"==typeof n;switch(r=arguments.length){case 1:w(n,l,this);break;case 2:k(n,l,this,arguments[1]);break;case 3:x(n,l,this,arguments[1],arguments[2]);break;case 4:S(n,l,this,arguments[1],arguments[2],arguments[3]);break;default:for(i=new Array(r-1),o=1;o<r;o++)i[o-1]=arguments[o];E(n,l,this,i)}return!0},b.prototype.addListener=function(e,t){return T(this,e,t,!1)},b.prototype.on=b.prototype.addListener,b.prototype.prependListener=function(e,t){return T(this,e,t,!0)},b.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,O(this,e,t)),this},b.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,O(this,e,t)),this},b.prototype.removeListener=function(e,t){var n,r,i,o,s;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if(!(r=this._events))return this;if(!(n=r[e]))return this;if(n===t||n.listener&&n.listener===t)0==--this._eventsCount?this._events=new g:(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,o=n.length;o-- >0;)if(n[o]===t||n[o].listener&&n[o].listener===t){s=n[o].listener,i=o;break}if(i<0)return this;if(1===n.length){if(n[0]=void 0,0==--this._eventsCount)return this._events=new g,this;delete r[e]}else!function(e,t){for(var n=t,r=n+1,i=e.length;r<i;n+=1,r+=1)e[n]=e[r];e.pop()}(n,i);r.removeListener&&this.emit("removeListener",e,s||t)}return this},b.prototype.off=function(e,t){return this.removeListener(e,t)},b.prototype.removeAllListeners=function(e){var t,n;if(!(n=this._events))return this;if(!n.removeListener)return 0===arguments.length?(this._events=new g,this._eventsCount=0):n[e]&&(0==--this._eventsCount?this._events=new g:delete n[e]),this;if(0===arguments.length){for(var r,i=Object.keys(n),o=0;o<i.length;++o)"removeListener"!==(r=i[o])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=new g,this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(t)do{this.removeListener(e,t[t.length-1])}while(t[0]);return this},b.prototype.listeners=function(e){var t,n=this._events;return n&&(t=n[e])?"function"==typeof t?[t.listener||t]:function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(t):[]},b.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):I.call(e,t)},b.prototype.listenerCount=I,b.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};var A=function(e){h.default(n,e);var t=R(n);function n(e){var r;return d.default(this,n),r=t.call(this),m.default(p.default(r),"timeout",null),m.default(p.default(r),"startTimestamp",-1),r.minDelay=e.min,r.maxDelay=e.max,r.initialDelay=e.initial||0,r.maxAttemptsCount=e.maxAttemptsCount||0,r.maxAttemptsTime=e.maxAttemptsTime||0,r.randomness=e.randomness||0,r.inProgress=!1,r.attemptNum=0,r.prevDelay=0,r.currDelay=0,r}return f.default(n,[{key:"attempt",value:function(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null),this.attemptNum++,this.emit("attempt",this)}},{key:"nextDelay",value:function(e){if("number"==typeof e)return this.prevDelay=0,this.currDelay=e,e;if(0==this.attemptNum)return this.initialDelay;if(1==this.attemptNum)return this.currDelay=this.minDelay,this.currDelay;this.prevDelay=this.currDelay;var t=this.currDelay+this.prevDelay;return this.maxDelay&&t>this.maxDelay&&(this.currDelay=this.maxDelay,t=this.maxDelay),this.currDelay=t,t}},{key:"randomize",value:function(e){var t=e*this.randomness,n=Math.round(Math.random()*t*2-t);return Math.max(0,e+n)}},{key:"scheduleAttempt",value:function(e){var t=this;if(this.maxAttemptsCount&&this.attemptNum>=this.maxAttemptsCount)return this.cleanup(),void this.emit("failed",new Error("Maximum attempt count limit reached"));var n=this.nextDelay(e);if(n=this.randomize(n),this.maxAttemptsTime&&this.startTimestamp+this.maxAttemptsTime<Date.now()+n)return this.cleanup(),void this.emit("failed",new Error("Maximum attempt time limit reached"));this.timeout=setTimeout((function(){return t.attempt()}),n)}},{key:"cleanup",value:function(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null),this.inProgress=!1,this.attemptNum=0,this.prevDelay=0,this.currDelay=0}},{key:"start",value:function(){if(this.inProgress)throw new Error("Retrier is already in progress");this.inProgress=!0,this.startTimestamp=Date.now(),this.scheduleAttempt(this.initialDelay)}},{key:"cancel",value:function(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null,this.inProgress=!1,this.emit("cancelled"))}},{key:"succeeded",value:function(e){this.emit("succeeded",e)}},{key:"failed",value:function(e,t){if(this.timeout)throw new Error("Retrier attempt is already in progress");this.scheduleAttempt(t)}}]),n}(b),P=function(e){h.default(n,e);var t=R(n);function n(e){var r;return d.default(this,n),r=t.call(this),m.default(p.default(r),"resolve",(function(){})),m.default(p.default(r),"reject",(function(){})),r.retrier=new A(e),r}return f.default(n,[{key:"run",value:function(e){var t=this;return this.retrier.on("attempt",(function(){e().then((function(e){return t.retrier.succeeded(e)})).catch((function(e){return t.retrier.failed(e)}))})),this.retrier.on("succeeded",(function(e){return t.resolve(e)})),this.retrier.on("cancelled",(function(){return t.reject(new Error("Cancelled"))})),this.retrier.on("failed",(function(e){return t.reject(e)})),new Promise((function(e,n){t.resolve=e,t.reject=n,t.retrier.start()}))}},{key:"cancel",value:function(){this.retrier.cancel()}}]),n}(b);function N(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v.default(e);if(t){var i=v.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return y.default(this,n)}}function L(e){return null!=e}var M=function(e){h.default(n,e);var t=N(n);function n(e){var r;d.default(this,n),r=t.call(this),m.default(p.default(r),"backoffDelay",0),m.default(p.default(r),"nextBackoffDelay",0),m.default(p.default(r),"backoffNumber",0),m.default(p.default(r),"timeoutID",null),m.default(p.default(r),"maxNumberOfRetry",-1);var i=e=e||{},o=i.initialDelay,s=i.maxDelay,a=i.randomisationFactor,u=i.factor;if(L(o)&&o<1)throw new Error("The initial timeout must be equal to or greater than 1.");if(L(s)&&s<=1)throw new Error("The maximal timeout must be greater than 1.");if(L(a)&&(a<0||a>1))throw new Error("The randomisation factor must be between 0 and 1.");if(L(u)&&u<=1)throw new Error("Exponential factor should be greater than 1.");if(r.initialDelay=o||100,r.maxDelay=s||1e4,r.maxDelay<=r.initialDelay)throw new Error("The maximal backoff delay must be greater than the initial backoff delay.");return r.randomisationFactor=a||0,r.factor=u||2,r.reset(),r}return f.default(n,[{key:"backoff",value:function(e){null==this.timeoutID&&(this.backoffNumber===this.maxNumberOfRetry?(this.emit("fail",e),this.reset()):(this.backoffDelay=this.next(),this.timeoutID=setTimeout(this.onBackoff.bind(this),this.backoffDelay),this.emit("backoff",this.backoffNumber,this.backoffDelay,e)))}},{key:"reset",value:function(){this.backoffDelay=0,this.nextBackoffDelay=this.initialDelay,this.backoffNumber=0,this.timeoutID&&clearTimeout(this.timeoutID),this.timeoutID=null}},{key:"failAfter",value:function(e){if(e<=0)throw new Error("Expected a maximum number of retry greater than 0 but got ".concat(e));this.maxNumberOfRetry=e}},{key:"next",value:function(){this.backoffDelay=Math.min(this.nextBackoffDelay,this.maxDelay),this.nextBackoffDelay=this.backoffDelay*this.factor;var e=1+Math.random()*this.randomisationFactor;return Math.min(this.maxDelay,Math.round(this.backoffDelay*e))}},{key:"onBackoff",value:function(){this.timeoutID=null,this.emit("ready",this.backoffNumber,this.backoffDelay),this.backoffNumber++}}],[{key:"exponential",value:function(e){return new n(e)}}]),n}(b);t.AsyncRetrier=P,t.Backoff=M,t.Retrier=A},6180:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6507),i=n(9516),o=n(2281),s=n(5206),a=n(555),u=n(5895),c=n(1167),l=n(1559),d=n(7322);function f(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var p=f(r),h=f(i),y=f(o),v=f(s),m=f(a),g=f(u),b=f(c),_=f(l),w=f(d);function k(){}function x(){x.init.call(this)}function S(e){return void 0===e._maxListeners?x.defaultMaxListeners:e._maxListeners}function E(e,t,n){if(t)e.call(n);else for(var r=e.length,i=N(e,r),o=0;o<r;++o)i[o].call(n)}function T(e,t,n,r){if(t)e.call(n,r);else for(var i=e.length,o=N(e,i),s=0;s<i;++s)o[s].call(n,r)}function O(e,t,n,r,i){if(t)e.call(n,r,i);else for(var o=e.length,s=N(e,o),a=0;a<o;++a)s[a].call(n,r,i)}function I(e,t,n,r,i,o){if(t)e.call(n,r,i,o);else for(var s=e.length,a=N(e,s),u=0;u<s;++u)a[u].call(n,r,i,o)}function C(e,t,n,r){if(t)e.apply(n,r);else for(var i=e.length,o=N(e,i),s=0;s<i;++s)o[s].apply(n,r)}function R(e,t,n,r){var i,o,s;if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');if((o=e._events)?(o.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),s=o[t]):(o=e._events=new k,e._eventsCount=0),s){if("function"==typeof s?s=o[t]=r?[n,s]:[s,n]:r?s.unshift(n):s.push(n),!s.warned&&(i=S(e))&&i>0&&s.length>i){s.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=e,a.type=t,a.count=s.length,console.warn}}else s=o[t]=n,++e._eventsCount;return e}function A(e,t,n){var r=!1;function i(){e.removeListener(t,i),r||(r=!0,n.apply(e,arguments))}return i.listener=n,i}function P(e){var t=this._events;if(t){var n=t[e];if("function"==typeof n)return 1;if(n)return n.length}return 0}function N(e,t){for(var n=new Array(t);t--;)n[t]=e[t];return n}function L(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=_.default(e);if(t){var i=_.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b.default(this,n)}}k.prototype=Object.create(null),x.EventEmitter=x,x.usingDomains=!1,x.prototype.domain=void 0,x.prototype._events=void 0,x.prototype._maxListeners=void 0,x.defaultMaxListeners=10,x.init=function(){this.domain=null,x.usingDomains&&undefined.active,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new k,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},x.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},x.prototype.getMaxListeners=function(){return S(this)},x.prototype.emit=function(e){var t,n,r,i,o,s,a,u="error"===e;if(s=this._events)u=u&&null==s.error;else if(!u)return!1;if(a=this.domain,u){if(t=arguments[1],!a){if(t instanceof Error)throw t;var c=new Error('Uncaught, unspecified "error" event. ('+t+")");throw c.context=t,c}return t||(t=new Error('Uncaught, unspecified "error" event')),t.domainEmitter=this,t.domain=a,t.domainThrown=!1,a.emit("error",t),!1}if(!(n=s[e]))return!1;var l="function"==typeof n;switch(r=arguments.length){case 1:E(n,l,this);break;case 2:T(n,l,this,arguments[1]);break;case 3:O(n,l,this,arguments[1],arguments[2]);break;case 4:I(n,l,this,arguments[1],arguments[2],arguments[3]);break;default:for(i=new Array(r-1),o=1;o<r;o++)i[o-1]=arguments[o];C(n,l,this,i)}return!0},x.prototype.addListener=function(e,t){return R(this,e,t,!1)},x.prototype.on=x.prototype.addListener,x.prototype.prependListener=function(e,t){return R(this,e,t,!0)},x.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,A(this,e,t)),this},x.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,A(this,e,t)),this},x.prototype.removeListener=function(e,t){var n,r,i,o,s;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if(!(r=this._events))return this;if(!(n=r[e]))return this;if(n===t||n.listener&&n.listener===t)0==--this._eventsCount?this._events=new k:(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,o=n.length;o-- >0;)if(n[o]===t||n[o].listener&&n[o].listener===t){s=n[o].listener,i=o;break}if(i<0)return this;if(1===n.length){if(n[0]=void 0,0==--this._eventsCount)return this._events=new k,this;delete r[e]}else!function(e,t){for(var n=t,r=n+1,i=e.length;r<i;n+=1,r+=1)e[n]=e[r];e.pop()}(n,i);r.removeListener&&this.emit("removeListener",e,s||t)}return this},x.prototype.off=function(e,t){return this.removeListener(e,t)},x.prototype.removeAllListeners=function(e){var t,n;if(!(n=this._events))return this;if(!n.removeListener)return 0===arguments.length?(this._events=new k,this._eventsCount=0):n[e]&&(0==--this._eventsCount?this._events=new k:delete n[e]),this;if(0===arguments.length){for(var r,i=Object.keys(n),o=0;o<i.length;++o)"removeListener"!==(r=i[o])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=new k,this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(t)do{this.removeListener(e,t[t.length-1])}while(t[0]);return this},x.prototype.listeners=function(e){var t,n=this._events;return n&&(t=n[e])?"function"==typeof t?[t.listener||t]:function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(t):[]},x.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):P.call(e,t)},x.prototype.listenerCount=P,x.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};var M=function(e){g.default(n,e);var t=L(n);function n(){var e;return h.default(this,n),e=t.call(this),w.default(v.default(e),"eventHistory",new Map),e}return y.default(n,[{key:"on",value:function(e,t){return m.default(_.default(n.prototype),"on",this).call(this,e,t)}},{key:"once",value:function(e,t){return m.default(_.default(n.prototype),"once",this).call(this,e,t)}},{key:"off",value:function(e,t){return m.default(_.default(n.prototype),"off",this).call(this,e,t)}},{key:"emit",value:function(e){for(var t,r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];return this.eventHistory.set(e,i),(t=m.default(_.default(n.prototype),"emit",this)).call.apply(t,[this,e].concat(i))}},{key:"addListener",value:function(e,t){return m.default(_.default(n.prototype),"addListener",this).call(this,e,t)}},{key:"removeListener",value:function(e,t){return m.default(_.default(n.prototype),"removeListener",this).call(this,e,t)}},{key:"addListenerWithReplay",value:function(e,t){var n=this.eventHistory.get(e);return void 0!==n&&t.apply(void 0,p.default(n)),this.addListener(e,t)}},{key:"onWithReplay",value:function(e,t){return this.addListenerWithReplay(e,t)}}]),n}(x);t.ReplayEventEmitter=M},6355:(e,t,n)=>{e.exports=n(6822)},7106:(e,t,n)=>{"use strict";var r=n(9706),i=n(2556),o=n(3770),s=n(951),a=n(2311),u=n(9585),c=n(1945),l=n(8028);e.exports=function(e){return new Promise((function(t,n){var d=e.data,f=e.headers,p=e.responseType;r.isFormData(d)&&delete f["Content-Type"];var h=new XMLHttpRequest;if(e.auth){var y=e.auth.username||"",v=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";f.Authorization="Basic "+btoa(y+":"+v)}var m=a(e.baseURL,e.url);function g(){if(h){var r="getAllResponseHeaders"in h?u(h.getAllResponseHeaders()):null,o={data:p&&"text"!==p&&"json"!==p?h.response:h.responseText,status:h.status,statusText:h.statusText,headers:r,config:e,request:h};i(t,n,o),h=null}}if(h.open(e.method.toUpperCase(),s(m,e.params,e.paramsSerializer),!0),h.timeout=e.timeout,"onloadend"in h?h.onloadend=g:h.onreadystatechange=function(){h&&4===h.readyState&&(0!==h.status||h.responseURL&&0===h.responseURL.indexOf("file:"))&&setTimeout(g)},h.onabort=function(){h&&(n(l("Request aborted",e,"ECONNABORTED",h)),h=null)},h.onerror=function(){n(l("Network Error",e,null,h)),h=null},h.ontimeout=function(){var t="timeout of "+e.timeout+"ms exceeded";e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),n(l(t,e,e.transitional&&e.transitional.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",h)),h=null},r.isStandardBrowserEnv()){var b=(e.withCredentials||c(m))&&e.xsrfCookieName?o.read(e.xsrfCookieName):void 0;b&&(f[e.xsrfHeaderName]=b)}"setRequestHeader"in h&&r.forEach(f,(function(e,t){void 0===d&&"content-type"===t.toLowerCase()?delete f[t]:h.setRequestHeader(t,e)})),r.isUndefined(e.withCredentials)||(h.withCredentials=!!e.withCredentials),p&&"json"!==p&&(h.responseType=e.responseType),"function"==typeof e.onDownloadProgress&&h.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&h.upload&&h.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function(e){h&&(h.abort(),n(e),h=null)})),d||(d=null),h.send(d)}))}},6822:(e,t,n)=>{"use strict";var r=n(9706),i=n(7684),o=n(4763),s=n(2046);function a(e){var t=new o(e),n=i(o.prototype.request,t);return r.extend(n,o.prototype,t),r.extend(n,t),n}var u=a(n(8967));u.Axios=o,u.create=function(e){return a(s(u.defaults,e))},u.Cancel=n(9679),u.CancelToken=n(7694),u.isCancel=n(9709),u.all=function(e){return Promise.all(e)},u.spread=n(6321),u.isAxiosError=n(2770),e.exports=u,e.exports.default=u},9679:e=>{"use strict";function t(e){this.message=e}t.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},t.prototype.__CANCEL__=!0,e.exports=t},7694:(e,t,n)=>{"use strict";var r=n(9679);function i(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var n=this;e((function(e){n.reason||(n.reason=new r(e),t(n.reason))}))}i.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},i.source=function(){var e;return{token:new i((function(t){e=t})),cancel:e}},e.exports=i},9709:e=>{"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},4763:(e,t,n)=>{"use strict";var r=n(9706),i=n(951),o=n(4302),s=n(9779),a=n(2046),u=n(694),c=u.validators;function l(e){this.defaults=e,this.interceptors={request:new o,response:new o}}l.prototype.request=function(e){"string"==typeof e?(e=arguments[1]||{}).url=arguments[0]:e=e||{},(e=a(this.defaults,e)).method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var t=e.transitional;void 0!==t&&u.assertOptions(t,{silentJSONParsing:c.transitional(c.boolean,"1.0.0"),forcedJSONParsing:c.transitional(c.boolean,"1.0.0"),clarifyTimeoutError:c.transitional(c.boolean,"1.0.0")},!1);var n=[],r=!0;this.interceptors.request.forEach((function(t){"function"==typeof t.runWhen&&!1===t.runWhen(e)||(r=r&&t.synchronous,n.unshift(t.fulfilled,t.rejected))}));var i,o=[];if(this.interceptors.response.forEach((function(e){o.push(e.fulfilled,e.rejected)})),!r){var l=[s,void 0];for(Array.prototype.unshift.apply(l,n),l=l.concat(o),i=Promise.resolve(e);l.length;)i=i.then(l.shift(),l.shift());return i}for(var d=e;n.length;){var f=n.shift(),p=n.shift();try{d=f(d)}catch(e){p(e);break}}try{i=s(d)}catch(e){return Promise.reject(e)}for(;o.length;)i=i.then(o.shift(),o.shift());return i},l.prototype.getUri=function(e){return e=a(this.defaults,e),i(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},r.forEach(["delete","get","head","options"],(function(e){l.prototype[e]=function(t,n){return this.request(a(n||{},{method:e,url:t,data:(n||{}).data}))}})),r.forEach(["post","put","patch"],(function(e){l.prototype[e]=function(t,n,r){return this.request(a(r||{},{method:e,url:t,data:n}))}})),e.exports=l},4302:(e,t,n)=>{"use strict";var r=n(9706);function i(){this.handlers=[]}i.prototype.use=function(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1},i.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},i.prototype.forEach=function(e){r.forEach(this.handlers,(function(t){null!==t&&e(t)}))},e.exports=i},2311:(e,t,n)=>{"use strict";var r=n(3569),i=n(3534);e.exports=function(e,t){return e&&!r(t)?i(e,t):t}},8028:(e,t,n)=>{"use strict";var r=n(5702);e.exports=function(e,t,n,i,o){var s=new Error(e);return r(s,t,n,i,o)}},9779:(e,t,n)=>{"use strict";var r=n(9706),i=n(6522),o=n(9709),s=n(8967);function a(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(e){return a(e),e.headers=e.headers||{},e.data=i.call(e,e.data,e.headers,e.transformRequest),e.headers=r.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),r.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||s.adapter)(e).then((function(t){return a(e),t.data=i.call(e,t.data,t.headers,e.transformResponse),t}),(function(t){return o(t)||(a(e),t&&t.response&&(t.response.data=i.call(e,t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}},5702:e=>{"use strict";e.exports=function(e,t,n,r,i){return e.config=t,n&&(e.code=n),e.request=r,e.response=i,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e}},2046:(e,t,n)=>{"use strict";var r=n(9706);e.exports=function(e,t){t=t||{};var n={},i=["url","method","data"],o=["headers","auth","proxy","params"],s=["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","timeoutMessage","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","decompress","maxContentLength","maxBodyLength","maxRedirects","transport","httpAgent","httpsAgent","cancelToken","socketPath","responseEncoding"],a=["validateStatus"];function u(e,t){return r.isPlainObject(e)&&r.isPlainObject(t)?r.merge(e,t):r.isPlainObject(t)?r.merge({},t):r.isArray(t)?t.slice():t}function c(i){r.isUndefined(t[i])?r.isUndefined(e[i])||(n[i]=u(void 0,e[i])):n[i]=u(e[i],t[i])}r.forEach(i,(function(e){r.isUndefined(t[e])||(n[e]=u(void 0,t[e]))})),r.forEach(o,c),r.forEach(s,(function(i){r.isUndefined(t[i])?r.isUndefined(e[i])||(n[i]=u(void 0,e[i])):n[i]=u(void 0,t[i])})),r.forEach(a,(function(r){r in t?n[r]=u(e[r],t[r]):r in e&&(n[r]=u(void 0,e[r]))}));var l=i.concat(o).concat(s).concat(a),d=Object.keys(e).concat(Object.keys(t)).filter((function(e){return-1===l.indexOf(e)}));return r.forEach(d,c),n}},2556:(e,t,n)=>{"use strict";var r=n(8028);e.exports=function(e,t,n){var i=n.config.validateStatus;n.status&&i&&!i(n.status)?t(r("Request failed with status code "+n.status,n.config,null,n.request,n)):e(n)}},6522:(e,t,n)=>{"use strict";var r=n(9706),i=n(8967);e.exports=function(e,t,n){var o=this||i;return r.forEach(n,(function(n){e=n.call(o,e,t)})),e}},8967:(e,t,n)=>{"use strict";var r=n(9706),i=n(9386),o=n(5702),s={"Content-Type":"application/x-www-form-urlencoded"};function a(e,t){!r.isUndefined(e)&&r.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var u,c={transitional:{silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},adapter:(("undefined"!=typeof XMLHttpRequest||"undefined"!=typeof process&&"[object process]"===Object.prototype.toString.call(process))&&(u=n(7106)),u),transformRequest:[function(e,t){return i(t,"Accept"),i(t,"Content-Type"),r.isFormData(e)||r.isArrayBuffer(e)||r.isBuffer(e)||r.isStream(e)||r.isFile(e)||r.isBlob(e)?e:r.isArrayBufferView(e)?e.buffer:r.isURLSearchParams(e)?(a(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):r.isObject(e)||t&&"application/json"===t["Content-Type"]?(a(t,"application/json"),function(e,t,n){if(r.isString(e))try{return(t||JSON.parse)(e),r.trim(e)}catch(e){if("SyntaxError"!==e.name)throw e}return(n||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){var t=this.transitional,n=t&&t.silentJSONParsing,i=t&&t.forcedJSONParsing,s=!n&&"json"===this.responseType;if(s||i&&r.isString(e)&&e.length)try{return JSON.parse(e)}catch(e){if(s){if("SyntaxError"===e.name)throw o(e,this,"E_JSON_PARSE");throw e}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(e){return e>=200&&e<300}};c.headers={common:{Accept:"application/json, text/plain, */*"}},r.forEach(["delete","get","head"],(function(e){c.headers[e]={}})),r.forEach(["post","put","patch"],(function(e){c.headers[e]=r.merge(s)})),e.exports=c},7684:e=>{"use strict";e.exports=function(e,t){return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return e.apply(t,n)}}},951:(e,t,n)=>{"use strict";var r=n(9706);function i(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,n){if(!t)return e;var o;if(n)o=n(t);else if(r.isURLSearchParams(t))o=t.toString();else{var s=[];r.forEach(t,(function(e,t){null!=e&&(r.isArray(e)?t+="[]":e=[e],r.forEach(e,(function(e){r.isDate(e)?e=e.toISOString():r.isObject(e)&&(e=JSON.stringify(e)),s.push(i(t)+"="+i(e))})))})),o=s.join("&")}if(o){var a=e.indexOf("#");-1!==a&&(e=e.slice(0,a)),e+=(-1===e.indexOf("?")?"?":"&")+o}return e}},3534:e=>{"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},3770:(e,t,n)=>{"use strict";var r=n(9706);e.exports=r.isStandardBrowserEnv()?{write:function(e,t,n,i,o,s){var a=[];a.push(e+"="+encodeURIComponent(t)),r.isNumber(n)&&a.push("expires="+new Date(n).toGMTString()),r.isString(i)&&a.push("path="+i),r.isString(o)&&a.push("domain="+o),!0===s&&a.push("secure"),document.cookie=a.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},3569:e=>{"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},2770:e=>{"use strict";e.exports=function(e){return"object"==typeof e&&!0===e.isAxiosError}},1945:(e,t,n)=>{"use strict";var r=n(9706);e.exports=r.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function i(e){var r=e;return t&&(n.setAttribute("href",r),r=n.href),n.setAttribute("href",r),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return e=i(window.location.href),function(t){var n=r.isString(t)?i(t):t;return n.protocol===e.protocol&&n.host===e.host}}():function(){return!0}},9386:(e,t,n)=>{"use strict";var r=n(9706);e.exports=function(e,t){r.forEach(e,(function(n,r){r!==t&&r.toUpperCase()===t.toUpperCase()&&(e[t]=n,delete e[r])}))}},9585:(e,t,n)=>{"use strict";var r=n(9706),i=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,n,o,s={};return e?(r.forEach(e.split("\n"),(function(e){if(o=e.indexOf(":"),t=r.trim(e.substr(0,o)).toLowerCase(),n=r.trim(e.substr(o+1)),t){if(s[t]&&i.indexOf(t)>=0)return;s[t]="set-cookie"===t?(s[t]?s[t]:[]).concat([n]):s[t]?s[t]+", "+n:n}})),s):s}},6321:e=>{"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},694:(e,t,n)=>{"use strict";var r=n(9843),i={};["object","boolean","number","function","string","symbol"].forEach((function(e,t){i[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}}));var o={},s=r.version.split(".");function a(e,t){for(var n=t?t.split("."):s,r=e.split("."),i=0;i<3;i++){if(n[i]>r[i])return!0;if(n[i]<r[i])return!1}return!1}i.transitional=function(e,t,n){var i=t&&a(t);return function(s,a,u){if(!1===e)throw new Error(function(e,t){return"[Axios v"+r.version+"] Transitional option '"+e+"'"+t+(n?". "+n:"")}(a," has been removed in "+t));return i&&!o[a]&&(o[a]=!0),!e||e(s,a,u)}},e.exports={isOlderVersion:a,assertOptions:function(e,t,n){if("object"!=typeof e)throw new TypeError("options must be an object");for(var r=Object.keys(e),i=r.length;i-- >0;){var o=r[i],s=t[o];if(s){var a=e[o],u=void 0===a||s(a,o,e);if(!0!==u)throw new TypeError("option "+o+" must be "+u)}else if(!0!==n)throw Error("Unknown option "+o)}},validators:i}},9706:(e,t,n)=>{"use strict";var r=n(7684),i=Object.prototype.toString;function o(e){return"[object Array]"===i.call(e)}function s(e){return void 0===e}function a(e){return null!==e&&"object"==typeof e}function u(e){if("[object Object]"!==i.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function c(e){return"[object Function]"===i.call(e)}function l(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),o(e))for(var n=0,r=e.length;n<r;n++)t.call(null,e[n],n,e);else for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.call(null,e[i],i,e)}e.exports={isArray:o,isArrayBuffer:function(e){return"[object ArrayBuffer]"===i.call(e)},isBuffer:function(e){return null!==e&&!s(e)&&null!==e.constructor&&!s(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:a,isPlainObject:u,isUndefined:s,isDate:function(e){return"[object Date]"===i.call(e)},isFile:function(e){return"[object File]"===i.call(e)},isBlob:function(e){return"[object Blob]"===i.call(e)},isFunction:c,isStream:function(e){return a(e)&&c(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)},forEach:l,merge:function e(){var t={};function n(n,r){u(t[r])&&u(n)?t[r]=e(t[r],n):u(n)?t[r]=e({},n):o(n)?t[r]=n.slice():t[r]=n}for(var r=0,i=arguments.length;r<i;r++)l(arguments[r],n);return t},extend:function(e,t,n){return l(t,(function(t,i){e[i]=n&&"function"==typeof t?r(t,n):t})),e},trim:function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},stripBOM:function(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e}}},2084:(e,t,n)=>{var r=n(8312),i=n(1314),o=n(824),s=r.TypeError;e.exports=function(e){if(i(e))return e;throw s(o(e)+" is not a function")}},2437:(e,t,n)=>{var r=n(8312),i=n(901),o=n(824),s=r.TypeError;e.exports=function(e){if(i(e))return e;throw s(o(e)+" is not a constructor")}},5364:(e,t,n)=>{var r=n(8312),i=n(1314),o=r.String,s=r.TypeError;e.exports=function(e){if("object"==typeof e||i(e))return e;throw s("Can't set "+o(e)+" as a prototype")}},6916:(e,t,n)=>{var r=n(9644),i=n(9581),o=n(1424).f,s=r("unscopables"),a=Array.prototype;null==a[s]&&o(a,s,{configurable:!0,value:i(null)}),e.exports=function(e){a[s][e]=!0}},9568:(e,t,n)=>{"use strict";var r=n(2042).charAt;e.exports=function(e,t,n){return t+(n?r(e,t).length:1)}},3871:(e,t,n)=>{var r=n(8312),i=n(3657),o=r.TypeError;e.exports=function(e,t){if(i(t,e))return e;throw o("Incorrect invocation")}},4949:(e,t,n)=>{var r=n(8312),i=n(4055),o=r.String,s=r.TypeError;e.exports=function(e){if(i(e))return e;throw s(o(e)+" is not an object")}},1678:e=>{e.exports="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView},3765:(e,t,n)=>{var r=n(2374);e.exports=r((function(){if("function"==typeof ArrayBuffer){var e=new ArrayBuffer(8);Object.isExtensible(e)&&Object.defineProperty(e,"a",{value:8})}}))},3978:(e,t,n)=>{"use strict";var r,i,o,s=n(1678),a=n(4490),u=n(8312),c=n(1314),l=n(4055),d=n(3431),f=n(18),p=n(824),h=n(3647),y=n(5686),v=n(1424).f,m=n(3657),g=n(6192),b=n(2711),_=n(9644),w=n(5834),k=u.Int8Array,x=k&&k.prototype,S=u.Uint8ClampedArray,E=S&&S.prototype,T=k&&g(k),O=x&&g(x),I=Object.prototype,C=u.TypeError,R=_("toStringTag"),A=w("TYPED_ARRAY_TAG"),P=w("TYPED_ARRAY_CONSTRUCTOR"),N=s&&!!b&&"Opera"!==f(u.opera),L=!1,M={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},j={BigInt64Array:8,BigUint64Array:8},D=function(e){if(!l(e))return!1;var t=f(e);return d(M,t)||d(j,t)};for(r in M)(o=(i=u[r])&&i.prototype)?h(o,P,i):N=!1;for(r in j)(o=(i=u[r])&&i.prototype)&&h(o,P,i);if((!N||!c(T)||T===Function.prototype)&&(T=function(){throw C("Incorrect invocation")},N))for(r in M)u[r]&&b(u[r],T);if((!N||!O||O===I)&&(O=T.prototype,N))for(r in M)u[r]&&b(u[r].prototype,O);if(N&&g(E)!==O&&b(E,O),a&&!d(O,R))for(r in L=!0,v(O,R,{get:function(){return l(this)?this[A]:void 0}}),M)u[r]&&h(u[r],A,r);e.exports={NATIVE_ARRAY_BUFFER_VIEWS:N,TYPED_ARRAY_CONSTRUCTOR:P,TYPED_ARRAY_TAG:L&&A,aTypedArray:function(e){if(D(e))return e;throw C("Target is not a typed array")},aTypedArrayConstructor:function(e){if(c(e)&&(!b||m(T,e)))return e;throw C(p(e)+" is not a typed array constructor")},exportTypedArrayMethod:function(e,t,n,r){if(a){if(n)for(var i in M){var o=u[i];if(o&&d(o.prototype,e))try{delete o.prototype[e]}catch(n){try{o.prototype[e]=t}catch(e){}}}O[e]&&!n||y(O,e,n?t:N&&x[e]||t,r)}},exportTypedArrayStaticMethod:function(e,t,n){var r,i;if(a){if(b){if(n)for(r in M)if((i=u[r])&&d(i,e))try{delete i[e]}catch(e){}if(T[e]&&!n)return;try{return y(T,e,n?t:N&&T[e]||t)}catch(e){}}for(r in M)!(i=u[r])||i[e]&&!n||y(i,e,t)}},isView:function(e){if(!l(e))return!1;var t=f(e);return"DataView"===t||d(M,t)||d(j,t)},isTypedArray:D,TypedArray:T,TypedArrayPrototype:O}},1782:(e,t,n)=>{"use strict";var r=n(8312),i=n(286),o=n(4490),s=n(1678),a=n(8977),u=n(3647),c=n(1813),l=n(2374),d=n(3871),f=n(3855),p=n(4104),h=n(8695),y=n(2514),v=n(6192),m=n(2711),g=n(8618).f,b=n(1424).f,_=n(6228),w=n(6430),k=n(737),x=n(5168),S=a.PROPER,E=a.CONFIGURABLE,T=x.get,O=x.set,I="ArrayBuffer",C="DataView",R="Wrong index",A=r.ArrayBuffer,P=A,N=P&&P.prototype,L=r.DataView,M=L&&L.prototype,j=Object.prototype,D=r.Array,B=r.RangeError,U=i(_),F=i([].reverse),H=y.pack,G=y.unpack,W=function(e){return[255&e]},q=function(e){return[255&e,e>>8&255]},V=function(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]},z=function(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]},Y=function(e){return H(e,23,4)},K=function(e){return H(e,52,8)},$=function(e,t){b(e.prototype,t,{get:function(){return T(this)[t]}})},X=function(e,t,n,r){var i=h(n),o=T(e);if(i+t>o.byteLength)throw B(R);var s=T(o.buffer).bytes,a=i+o.byteOffset,u=w(s,a,a+t);return r?u:F(u)},J=function(e,t,n,r,i,o){var s=h(n),a=T(e);if(s+t>a.byteLength)throw B(R);for(var u=T(a.buffer).bytes,c=s+a.byteOffset,l=r(+i),d=0;d<t;d++)u[c+d]=l[o?d:t-d-1]};if(s){var Z=S&&A.name!==I;if(l((function(){A(1)}))&&l((function(){new A(-1)}))&&!l((function(){return new A,new A(1.5),new A(NaN),Z&&!E})))Z&&E&&u(A,"name",I);else{(P=function(e){return d(this,N),new A(h(e))}).prototype=N;for(var Q,ee=g(A),te=0;ee.length>te;)(Q=ee[te++])in P||u(P,Q,A[Q]);N.constructor=P}m&&v(M)!==j&&m(M,j);var ne=new L(new P(2)),re=i(M.setInt8);ne.setInt8(0,2147483648),ne.setInt8(1,2147483649),!ne.getInt8(0)&&ne.getInt8(1)||c(M,{setInt8:function(e,t){re(this,e,t<<24>>24)},setUint8:function(e,t){re(this,e,t<<24>>24)}},{unsafe:!0})}else N=(P=function(e){d(this,N);var t=h(e);O(this,{bytes:U(D(t),0),byteLength:t}),o||(this.byteLength=t)}).prototype,M=(L=function(e,t,n){d(this,M),d(e,N);var r=T(e).byteLength,i=f(t);if(i<0||i>r)throw B("Wrong offset");if(i+(n=void 0===n?r-i:p(n))>r)throw B("Wrong length");O(this,{buffer:e,byteLength:n,byteOffset:i}),o||(this.buffer=e,this.byteLength=n,this.byteOffset=i)}).prototype,o&&($(P,"byteLength"),$(L,"buffer"),$(L,"byteLength"),$(L,"byteOffset")),c(M,{getInt8:function(e){return X(this,1,e)[0]<<24>>24},getUint8:function(e){return X(this,1,e)[0]},getInt16:function(e){var t=X(this,2,e,arguments.length>1?arguments[1]:void 0);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=X(this,2,e,arguments.length>1?arguments[1]:void 0);return t[1]<<8|t[0]},getInt32:function(e){return z(X(this,4,e,arguments.length>1?arguments[1]:void 0))},getUint32:function(e){return z(X(this,4,e,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(e){return G(X(this,4,e,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(e){return G(X(this,8,e,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(e,t){J(this,1,e,W,t)},setUint8:function(e,t){J(this,1,e,W,t)},setInt16:function(e,t){J(this,2,e,q,t,arguments.length>2?arguments[2]:void 0)},setUint16:function(e,t){J(this,2,e,q,t,arguments.length>2?arguments[2]:void 0)},setInt32:function(e,t){J(this,4,e,V,t,arguments.length>2?arguments[2]:void 0)},setUint32:function(e,t){J(this,4,e,V,t,arguments.length>2?arguments[2]:void 0)},setFloat32:function(e,t){J(this,4,e,Y,t,arguments.length>2?arguments[2]:void 0)},setFloat64:function(e,t){J(this,8,e,K,t,arguments.length>2?arguments[2]:void 0)}});k(P,I),k(L,C),e.exports={ArrayBuffer:P,DataView:L}},3086:(e,t,n)=>{"use strict";var r=n(3922),i=n(1092),o=n(8996),s=Math.min;e.exports=[].copyWithin||function(e,t){var n=r(this),a=o(n),u=i(e,a),c=i(t,a),l=arguments.length>2?arguments[2]:void 0,d=s((void 0===l?a:i(l,a))-c,a-u),f=1;for(c<u&&u<c+d&&(f=-1,c+=d-1,u+=d-1);d-- >0;)c in n?n[u]=n[c]:delete n[u],u+=f,c+=f;return n}},6228:(e,t,n)=>{"use strict";var r=n(3922),i=n(1092),o=n(8996);e.exports=function(e){for(var t=r(this),n=o(t),s=arguments.length,a=i(s>1?arguments[1]:void 0,n),u=s>2?arguments[2]:void 0,c=void 0===u?n:i(u,n);c>a;)t[a++]=e;return t}},9810:(e,t,n)=>{"use strict";var r=n(2213).forEach,i=n(7639)("forEach");e.exports=i?[].forEach:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}},4190:(e,t,n)=>{var r=n(8996);e.exports=function(e,t){for(var n=0,i=r(t),o=new e(i);i>n;)o[n]=t[n++];return o}},4070:(e,t,n)=>{"use strict";var r=n(8312),i=n(386),o=n(9961),s=n(3922),a=n(6311),u=n(7259),c=n(901),l=n(8996),d=n(7982),f=n(1354),p=n(2143),h=r.Array;e.exports=function(e){var t=s(e),n=c(this),r=arguments.length,y=r>1?arguments[1]:void 0,v=void 0!==y;v&&(y=i(y,r>2?arguments[2]:void 0));var m,g,b,_,w,k,x=p(t),S=0;if(!x||this==h&&u(x))for(m=l(t),g=n?new this(m):h(m);m>S;S++)k=v?y(t[S],S):t[S],d(g,S,k);else for(w=(_=f(t,x)).next,g=n?new this:[];!(b=o(w,_)).done;S++)k=v?a(_,y,[b.value,S],!0):b.value,d(g,S,k);return g.length=S,g}},4013:(e,t,n)=>{var r=n(981),i=n(1092),o=n(8996),s=function(e){return function(t,n,s){var a,u=r(t),c=o(u),l=i(s,c);if(e&&n!=n){for(;c>l;)if((a=u[l++])!=a)return!0}else for(;c>l;l++)if((e||l in u)&&u[l]===n)return e||l||0;return!e&&-1}};e.exports={includes:s(!0),indexOf:s(!1)}},2213:(e,t,n)=>{var r=n(386),i=n(286),o=n(712),s=n(3922),a=n(8996),u=n(9458),c=i([].push),l=function(e){var t=1==e,n=2==e,i=3==e,l=4==e,d=6==e,f=7==e,p=5==e||d;return function(h,y,v,m){for(var g,b,_=s(h),w=o(_),k=r(y,v),x=a(w),S=0,E=m||u,T=t?E(h,x):n||f?E(h,0):void 0;x>S;S++)if((p||S in w)&&(b=k(g=w[S],S,_),e))if(t)T[S]=b;else if(b)switch(e){case 3:return!0;case 5:return g;case 6:return S;case 2:c(T,g)}else switch(e){case 4:return!1;case 7:c(T,g)}return d?-1:i||l?l:T}};e.exports={forEach:l(0),map:l(1),filter:l(2),some:l(3),every:l(4),find:l(5),findIndex:l(6),filterReject:l(7)}},2264:(e,t,n)=>{"use strict";var r=n(9084),i=n(981),o=n(3855),s=n(8996),a=n(7639),u=Math.min,c=[].lastIndexOf,l=!!c&&1/[1].lastIndexOf(1,-0)<0,d=a("lastIndexOf"),f=l||!d;e.exports=f?function(e){if(l)return r(c,this,arguments)||0;var t=i(this),n=s(t),a=n-1;for(arguments.length>1&&(a=u(a,o(arguments[1]))),a<0&&(a=n+a);a>=0;a--)if(a in t&&t[a]===e)return a||0;return-1}:c},3934:(e,t,n)=>{var r=n(2374),i=n(9644),o=n(8351),s=i("species");e.exports=function(e){return o>=51||!r((function(){var t=[];return(t.constructor={})[s]=function(){return{foo:1}},1!==t[e](Boolean).foo}))}},7639:(e,t,n)=>{"use strict";var r=n(2374);e.exports=function(e,t){var n=[][e];return!!n&&r((function(){n.call(null,t||function(){return 1},1)}))}},9364:(e,t,n)=>{var r=n(8312),i=n(2084),o=n(3922),s=n(712),a=n(8996),u=r.TypeError,c=function(e){return function(t,n,r,c){i(n);var l=o(t),d=s(l),f=a(l),p=e?f-1:0,h=e?-1:1;if(r<2)for(;;){if(p in d){c=d[p],p+=h;break}if(p+=h,e?p<0:f<=p)throw u("Reduce of empty array with no initial value")}for(;e?p>=0:f>p;p+=h)p in d&&(c=n(c,d[p],p,l));return c}};e.exports={left:c(!1),right:c(!0)}},6430:(e,t,n)=>{var r=n(8312),i=n(1092),o=n(8996),s=n(7982),a=r.Array,u=Math.max;e.exports=function(e,t,n){for(var r=o(e),c=i(t,r),l=i(void 0===n?r:n,r),d=a(u(l-c,0)),f=0;c<l;c++,f++)s(d,f,e[c]);return d.length=f,d}},2808:(e,t,n)=>{var r=n(286);e.exports=r([].slice)},3800:(e,t,n)=>{var r=n(6430),i=Math.floor,o=function(e,t){var n=e.length,u=i(n/2);return n<8?s(e,t):a(e,o(r(e,0,u),t),o(r(e,u),t),t)},s=function(e,t){for(var n,r,i=e.length,o=1;o<i;){for(r=o,n=e[o];r&&t(e[r-1],n)>0;)e[r]=e[--r];r!==o++&&(e[r]=n)}return e},a=function(e,t,n,r){for(var i=t.length,o=n.length,s=0,a=0;s<i||a<o;)e[s+a]=s<i&&a<o?r(t[s],n[a])<=0?t[s++]:n[a++]:s<i?t[s++]:n[a++];return e};e.exports=o},3188:(e,t,n)=>{var r=n(8312),i=n(4359),o=n(901),s=n(4055),a=n(9644)("species"),u=r.Array;e.exports=function(e){var t;return i(e)&&(t=e.constructor,(o(t)&&(t===u||i(t.prototype))||s(t)&&null===(t=t[a]))&&(t=void 0)),void 0===t?u:t}},9458:(e,t,n)=>{var r=n(3188);e.exports=function(e,t){return new(r(e))(0===t?0:t)}},6311:(e,t,n)=>{var r=n(4949),i=n(8379);e.exports=function(e,t,n,o){try{return o?t(r(n)[0],n[1]):t(n)}catch(t){i(e,"throw",t)}}},2425:(e,t,n)=>{var r=n(9644)("iterator"),i=!1;try{var o=0,s={next:function(){return{done:!!o++}},return:function(){i=!0}};s[r]=function(){return this},Array.from(s,(function(){throw 2}))}catch(e){}e.exports=function(e,t){if(!t&&!i)return!1;var n=!1;try{var o={};o[r]=function(){return{next:function(){return{done:n=!0}}}},e(o)}catch(e){}return n}},5830:(e,t,n)=>{var r=n(286),i=r({}.toString),o=r("".slice);e.exports=function(e){return o(i(e),8,-1)}},18:(e,t,n)=>{var r=n(8312),i=n(9677),o=n(1314),s=n(5830),a=n(9644)("toStringTag"),u=r.Object,c="Arguments"==s(function(){return arguments}());e.exports=i?s:function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=u(e),a))?n:c?s(t):"Object"==(r=s(t))&&o(t.callee)?"Arguments":r}},8907:(e,t,n)=>{"use strict";var r=n(1424).f,i=n(9581),o=n(1813),s=n(386),a=n(3871),u=n(1544),c=n(5946),l=n(1311),d=n(4490),f=n(557).fastKey,p=n(5168),h=p.set,y=p.getterFor;e.exports={getConstructor:function(e,t,n,c){var l=e((function(e,r){a(e,p),h(e,{type:t,index:i(null),first:void 0,last:void 0,size:0}),d||(e.size=0),null!=r&&u(r,e[c],{that:e,AS_ENTRIES:n})})),p=l.prototype,v=y(t),m=function(e,t,n){var r,i,o=v(e),s=g(e,t);return s?s.value=n:(o.last=s={index:i=f(t,!0),key:t,value:n,previous:r=o.last,next:void 0,removed:!1},o.first||(o.first=s),r&&(r.next=s),d?o.size++:e.size++,"F"!==i&&(o.index[i]=s)),e},g=function(e,t){var n,r=v(e),i=f(t);if("F"!==i)return r.index[i];for(n=r.first;n;n=n.next)if(n.key==t)return n};return o(p,{clear:function(){for(var e=v(this),t=e.index,n=e.first;n;)n.removed=!0,n.previous&&(n.previous=n.previous.next=void 0),delete t[n.index],n=n.next;e.first=e.last=void 0,d?e.size=0:this.size=0},delete:function(e){var t=this,n=v(t),r=g(t,e);if(r){var i=r.next,o=r.previous;delete n.index[r.index],r.removed=!0,o&&(o.next=i),i&&(i.previous=o),n.first==r&&(n.first=i),n.last==r&&(n.last=o),d?n.size--:t.size--}return!!r},forEach:function(e){for(var t,n=v(this),r=s(e,arguments.length>1?arguments[1]:void 0);t=t?t.next:n.first;)for(r(t.value,t.key,this);t&&t.removed;)t=t.previous},has:function(e){return!!g(this,e)}}),o(p,n?{get:function(e){var t=g(this,e);return t&&t.value},set:function(e,t){return m(this,0===e?0:e,t)}}:{add:function(e){return m(this,e=0===e?0:e,e)}}),d&&r(p,"size",{get:function(){return v(this).size}}),l},setStrong:function(e,t,n){var r=t+" Iterator",i=y(t),o=y(r);c(e,t,(function(e,t){h(this,{type:r,target:e,state:i(e),kind:t,last:void 0})}),(function(){for(var e=o(this),t=e.kind,n=e.last;n&&n.removed;)n=n.previous;return e.target&&(e.last=n=n?n.next:e.state.first)?"keys"==t?{value:n.key,done:!1}:"values"==t?{value:n.value,done:!1}:{value:[n.key,n.value],done:!1}:(e.target=void 0,{value:void 0,done:!0})}),n?"entries":"values",!n,!0),l(t)}}},7638:(e,t,n)=>{"use strict";var r=n(2176),i=n(8312),o=n(286),s=n(8503),a=n(5686),u=n(557),c=n(1544),l=n(3871),d=n(1314),f=n(4055),p=n(2374),h=n(2425),y=n(737),v=n(5673);e.exports=function(e,t,n){var m=-1!==e.indexOf("Map"),g=-1!==e.indexOf("Weak"),b=m?"set":"add",_=i[e],w=_&&_.prototype,k=_,x={},S=function(e){var t=o(w[e]);a(w,e,"add"==e?function(e){return t(this,0===e?0:e),this}:"delete"==e?function(e){return!(g&&!f(e))&&t(this,0===e?0:e)}:"get"==e?function(e){return g&&!f(e)?void 0:t(this,0===e?0:e)}:"has"==e?function(e){return!(g&&!f(e))&&t(this,0===e?0:e)}:function(e,n){return t(this,0===e?0:e,n),this})};if(s(e,!d(_)||!(g||w.forEach&&!p((function(){(new _).entries().next()})))))k=n.getConstructor(t,e,m,b),u.enable();else if(s(e,!0)){var E=new k,T=E[b](g?{}:-0,1)!=E,O=p((function(){E.has(1)})),I=h((function(e){new _(e)})),C=!g&&p((function(){for(var e=new _,t=5;t--;)e[b](t,t);return!e.has(-0)}));I||((k=t((function(e,t){l(e,w);var n=v(new _,e,k);return null!=t&&c(t,n[b],{that:n,AS_ENTRIES:m}),n}))).prototype=w,w.constructor=k),(O||C)&&(S("delete"),S("has"),m&&S("get")),(C||T)&&S(b),g&&w.clear&&delete w.clear}return x[e]=k,r({global:!0,constructor:!0,forced:k!=_},x),y(k,e),g||n.setStrong(k,e,m),k}},9144:(e,t,n)=>{var r=n(3431),i=n(713),o=n(6653),s=n(1424);e.exports=function(e,t,n){for(var a=i(t),u=s.f,c=o.f,l=0;l<a.length;l++){var d=a[l];r(e,d)||n&&r(n,d)||u(e,d,c(t,d))}}},454:(e,t,n)=>{var r=n(9644)("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[r]=!1,"/./"[e](t)}catch(e){}}return!1}},4870:(e,t,n)=>{var r=n(2374);e.exports=!r((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}))},8600:(e,t,n)=>{"use strict";var r=n(8846).IteratorPrototype,i=n(9581),o=n(6923),s=n(737),a=n(5050),u=function(){return this};e.exports=function(e,t,n,c){var l=t+" Iterator";return e.prototype=i(r,{next:o(+!c,n)}),s(e,l,!1,!0),a[l]=u,e}},3647:(e,t,n)=>{var r=n(4490),i=n(1424),o=n(6923);e.exports=r?function(e,t,n){return i.f(e,t,o(1,n))}:function(e,t,n){return e[t]=n,e}},6923:e=>{e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},7982:(e,t,n)=>{"use strict";var r=n(3553),i=n(1424),o=n(6923);e.exports=function(e,t,n){var s=r(t);s in e?i.f(e,s,o(0,n)):e[s]=n}},8132:(e,t,n)=>{var r=n(8210),i=n(1424);e.exports=function(e,t,n){return n.get&&r(n.get,t,{getter:!0}),n.set&&r(n.set,t,{setter:!0}),i.f(e,t,n)}},5686:(e,t,n)=>{var r=n(1314),i=n(3647),o=n(8210),s=n(3237);e.exports=function(e,t,n,a){a||(a={});var u=a.enumerable,c=void 0!==a.name?a.name:t;return r(n)&&o(n,c,a),a.global?u?e[t]=n:s(t,n):(a.unsafe?e[t]&&(u=!0):delete e[t],u?e[t]=n:i(e,t,n)),e}},1813:(e,t,n)=>{var r=n(5686);e.exports=function(e,t,n){for(var i in t)r(e,i,t[i],n);return e}},3237:(e,t,n)=>{var r=n(8312),i=Object.defineProperty;e.exports=function(e,t){try{i(r,e,{value:t,configurable:!0,writable:!0})}catch(n){r[e]=t}return t}},5946:(e,t,n)=>{"use strict";var r=n(2176),i=n(9961),o=n(6985),s=n(8977),a=n(1314),u=n(8600),c=n(6192),l=n(2711),d=n(737),f=n(3647),p=n(5686),h=n(9644),y=n(5050),v=n(8846),m=s.PROPER,g=s.CONFIGURABLE,b=v.IteratorPrototype,_=v.BUGGY_SAFARI_ITERATORS,w=h("iterator"),k="keys",x="values",S="entries",E=function(){return this};e.exports=function(e,t,n,s,h,v,T){u(n,t,s);var O,I,C,R=function(e){if(e===h&&M)return M;if(!_&&e in N)return N[e];switch(e){case k:case x:case S:return function(){return new n(this,e)}}return function(){return new n(this)}},A=t+" Iterator",P=!1,N=e.prototype,L=N[w]||N["@@iterator"]||h&&N[h],M=!_&&L||R(h),j="Array"==t&&N.entries||L;if(j&&(O=c(j.call(new e)))!==Object.prototype&&O.next&&(o||c(O)===b||(l?l(O,b):a(O[w])||p(O,w,E)),d(O,A,!0,!0),o&&(y[A]=E)),m&&h==x&&L&&L.name!==x&&(!o&&g?f(N,"name",x):(P=!0,M=function(){return i(L,this)})),h)if(I={values:R(x),keys:v?M:R(k),entries:R(S)},T)for(C in I)(_||P||!(C in N))&&p(N,C,I[C]);else r({target:t,proto:!0,forced:_||P},I);return o&&!T||N[w]===M||p(N,w,M,{name:h}),y[t]=M,I}},6247:(e,t,n)=>{var r=n(1940),i=n(3431),o=n(5145),s=n(1424).f;e.exports=function(e){var t=r.Symbol||(r.Symbol={});i(t,e)||s(t,e,{value:o.f(e)})}},4490:(e,t,n)=>{var r=n(2374);e.exports=!r((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},371:(e,t,n)=>{var r=n(8312),i=n(4055),o=r.document,s=i(o)&&i(o.createElement);e.exports=function(e){return s?o.createElement(e):{}}},2763:e=>{e.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},6274:(e,t,n)=>{var r=n(371)("span").classList,i=r&&r.constructor&&r.constructor.prototype;e.exports=i===Object.prototype?void 0:i},9648:(e,t,n)=>{var r=n(7061).match(/firefox\/(\d+)/i);e.exports=!!r&&+r[1]},4010:e=>{e.exports="object"==typeof window&&"object"!=typeof Deno},6415:(e,t,n)=>{var r=n(7061);e.exports=/MSIE|Trident/.test(r)},8190:(e,t,n)=>{var r=n(7061),i=n(8312);e.exports=/ipad|iphone|ipod/i.test(r)&&void 0!==i.Pebble},5751:(e,t,n)=>{var r=n(7061);e.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(r)},3968:(e,t,n)=>{var r=n(5830),i=n(8312);e.exports="process"==r(i.process)},8065:(e,t,n)=>{var r=n(7061);e.exports=/web0s(?!.*chrome)/i.test(r)},7061:(e,t,n)=>{var r=n(6854);e.exports=r("navigator","userAgent")||""},8351:(e,t,n)=>{var r,i,o=n(8312),s=n(7061),a=o.process,u=o.Deno,c=a&&a.versions||u&&u.version,l=c&&c.v8;l&&(i=(r=l.split("."))[0]>0&&r[0]<4?1:+(r[0]+r[1])),!i&&s&&(!(r=s.match(/Edge\/(\d+)/))||r[1]>=74)&&(r=s.match(/Chrome\/(\d+)/))&&(i=+r[1]),e.exports=i},5579:(e,t,n)=>{var r=n(7061).match(/AppleWebKit\/(\d+)\./);e.exports=!!r&&+r[1]},6189:e=>{e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},2176:(e,t,n)=>{var r=n(8312),i=n(6653).f,o=n(3647),s=n(5686),a=n(3237),u=n(9144),c=n(8503);e.exports=function(e,t){var n,l,d,f,p,h=e.target,y=e.global,v=e.stat;if(n=y?r:v?r[h]||a(h,{}):(r[h]||{}).prototype)for(l in t){if(f=t[l],d=e.dontCallGetSet?(p=i(n,l))&&p.value:n[l],!c(y?l:h+(v?".":"#")+l,e.forced)&&void 0!==d){if(typeof f==typeof d)continue;u(f,d)}(e.sham||d&&d.sham)&&o(f,"sham",!0),s(n,l,f,e)}}},2374:e=>{e.exports=function(e){try{return!!e()}catch(e){return!0}}},5329:(e,t,n)=>{"use strict";n(6564);var r=n(286),i=n(5686),o=n(6911),s=n(2374),a=n(9644),u=n(3647),c=a("species"),l=RegExp.prototype;e.exports=function(e,t,n,d){var f=a(e),p=!s((function(){var t={};return t[f]=function(){return 7},7!=""[e](t)})),h=p&&!s((function(){var t=!1,n=/a/;return"split"===e&&((n={}).constructor={},n.constructor[c]=function(){return n},n.flags="",n[f]=/./[f]),n.exec=function(){return t=!0,null},n[f](""),!t}));if(!p||!h||n){var y=r(/./[f]),v=t(f,""[e],(function(e,t,n,i,s){var a=r(e),u=t.exec;return u===o||u===l.exec?p&&!s?{done:!0,value:y(t,n,i)}:{done:!0,value:a(n,t,i)}:{done:!1}}));i(String.prototype,e,v[0]),i(l,f,v[1])}d&&u(l[f],"sham",!0)}},3802:(e,t,n)=>{var r=n(2374);e.exports=!r((function(){return Object.isExtensible(Object.preventExtensions({}))}))},9084:(e,t,n)=>{var r=n(4025),i=Function.prototype,o=i.apply,s=i.call;e.exports="object"==typeof Reflect&&Reflect.apply||(r?s.bind(o):function(){return s.apply(o,arguments)})},386:(e,t,n)=>{var r=n(286),i=n(2084),o=n(4025),s=r(r.bind);e.exports=function(e,t){return i(e),void 0===t?e:o?s(e,t):function(){return e.apply(t,arguments)}}},4025:(e,t,n)=>{var r=n(2374);e.exports=!r((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")}))},1713:(e,t,n)=>{"use strict";var r=n(8312),i=n(286),o=n(2084),s=n(4055),a=n(3431),u=n(2808),c=n(4025),l=r.Function,d=i([].concat),f=i([].join),p={},h=function(e,t,n){if(!a(p,t)){for(var r=[],i=0;i<t;i++)r[i]="a["+i+"]";p[t]=l("C,a","return new C("+f(r,",")+")")}return p[t](e,n)};e.exports=c?l.bind:function(e){var t=o(this),n=t.prototype,r=u(arguments,1),i=function(){var n=d(r,u(arguments));return this instanceof i?h(t,n.length,n):t.apply(e,n)};return s(n)&&(i.prototype=n),i}},9961:(e,t,n)=>{var r=n(4025),i=Function.prototype.call;e.exports=r?i.bind(i):function(){return i.apply(i,arguments)}},8977:(e,t,n)=>{var r=n(4490),i=n(3431),o=Function.prototype,s=r&&Object.getOwnPropertyDescriptor,a=i(o,"name"),u=a&&"something"===function(){}.name,c=a&&(!r||r&&s(o,"name").configurable);e.exports={EXISTS:a,PROPER:u,CONFIGURABLE:c}},286:(e,t,n)=>{var r=n(4025),i=Function.prototype,o=i.bind,s=i.call,a=r&&o.bind(s,s);e.exports=r?function(e){return e&&a(e)}:function(e){return e&&function(){return s.apply(e,arguments)}}},6854:(e,t,n)=>{var r=n(8312),i=n(1314),o=function(e){return i(e)?e:void 0};e.exports=function(e,t){return arguments.length<2?o(r[e]):r[e]&&r[e][t]}},2143:(e,t,n)=>{var r=n(18),i=n(4355),o=n(5050),s=n(9644)("iterator");e.exports=function(e){if(null!=e)return i(e,s)||i(e,"@@iterator")||o[r(e)]}},1354:(e,t,n)=>{var r=n(8312),i=n(9961),o=n(2084),s=n(4949),a=n(824),u=n(2143),c=r.TypeError;e.exports=function(e,t){var n=arguments.length<2?u(e):t;if(o(n))return s(i(n,e));throw c(a(e)+" is not iterable")}},4355:(e,t,n)=>{var r=n(2084);e.exports=function(e,t){var n=e[t];return null==n?void 0:r(n)}},5614:(e,t,n)=>{var r=n(286),i=n(3922),o=Math.floor,s=r("".charAt),a=r("".replace),u=r("".slice),c=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,l=/\$([$&'`]|\d{1,2})/g;e.exports=function(e,t,n,r,d,f){var p=n+e.length,h=r.length,y=l;return void 0!==d&&(d=i(d),y=c),a(f,y,(function(i,a){var c;switch(s(a,0)){case"$":return"$";case"&":return e;case"`":return u(t,0,n);case"'":return u(t,p);case"<":c=d[u(a,1,-1)];break;default:var l=+a;if(0===l)return i;if(l>h){var f=o(l/10);return 0===f?i:f<=h?void 0===r[f-1]?s(a,1):r[f-1]+s(a,1):i}c=r[l-1]}return void 0===c?"":c}))}},8312:(e,t,n)=>{var r=function(e){return e&&e.Math==Math&&e};e.exports=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof n.g&&n.g)||function(){return this}()||Function("return this")()},3431:(e,t,n)=>{var r=n(286),i=n(3922),o=r({}.hasOwnProperty);e.exports=Object.hasOwn||function(e,t){return o(i(e),t)}},2032:e=>{e.exports={}},8384:(e,t,n)=>{var r=n(8312);e.exports=function(e,t){var n=r.console;n&&n.error&&(1==arguments.length?n.error(e):n.error(e,t))}},1111:(e,t,n)=>{var r=n(6854);e.exports=r("document","documentElement")},749:(e,t,n)=>{var r=n(4490),i=n(2374),o=n(371);e.exports=!r&&!i((function(){return 7!=Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a}))},2514:(e,t,n)=>{var r=n(8312).Array,i=Math.abs,o=Math.pow,s=Math.floor,a=Math.log,u=Math.LN2;e.exports={pack:function(e,t,n){var c,l,d,f=r(n),p=8*n-t-1,h=(1<<p)-1,y=h>>1,v=23===t?o(2,-24)-o(2,-77):0,m=e<0||0===e&&1/e<0?1:0,g=0;for((e=i(e))!=e||e===1/0?(l=e!=e?1:0,c=h):(c=s(a(e)/u),e*(d=o(2,-c))<1&&(c--,d*=2),(e+=c+y>=1?v/d:v*o(2,1-y))*d>=2&&(c++,d/=2),c+y>=h?(l=0,c=h):c+y>=1?(l=(e*d-1)*o(2,t),c+=y):(l=e*o(2,y-1)*o(2,t),c=0));t>=8;)f[g++]=255&l,l/=256,t-=8;for(c=c<<t|l,p+=t;p>0;)f[g++]=255&c,c/=256,p-=8;return f[--g]|=128*m,f},unpack:function(e,t){var n,r=e.length,i=8*r-t-1,s=(1<<i)-1,a=s>>1,u=i-7,c=r-1,l=e[c--],d=127&l;for(l>>=7;u>0;)d=256*d+e[c--],u-=8;for(n=d&(1<<-u)-1,d>>=-u,u+=t;u>0;)n=256*n+e[c--],u-=8;if(0===d)d=1-a;else{if(d===s)return n?NaN:l?-1/0:1/0;n+=o(2,t),d-=a}return(l?-1:1)*n*o(2,d-t)}}},712:(e,t,n)=>{var r=n(8312),i=n(286),o=n(2374),s=n(5830),a=r.Object,u=i("".split);e.exports=o((function(){return!a("z").propertyIsEnumerable(0)}))?function(e){return"String"==s(e)?u(e,""):a(e)}:a},5673:(e,t,n)=>{var r=n(1314),i=n(4055),o=n(2711);e.exports=function(e,t,n){var s,a;return o&&r(s=t.constructor)&&s!==n&&i(a=s.prototype)&&a!==n.prototype&&o(e,a),e}},5951:(e,t,n)=>{var r=n(286),i=n(1314),o=n(1799),s=r(Function.toString);i(o.inspectSource)||(o.inspectSource=function(e){return s(e)}),e.exports=o.inspectSource},557:(e,t,n)=>{var r=n(2176),i=n(286),o=n(2032),s=n(4055),a=n(3431),u=n(1424).f,c=n(8618),l=n(8830),d=n(9813),f=n(5834),p=n(3802),h=!1,y=f("meta"),v=0,m=function(e){u(e,y,{value:{objectID:"O"+v++,weakData:{}}})},g=e.exports={enable:function(){g.enable=function(){},h=!0;var e=c.f,t=i([].splice),n={};n[y]=1,e(n).length&&(c.f=function(n){for(var r=e(n),i=0,o=r.length;i<o;i++)if(r[i]===y){t(r,i,1);break}return r},r({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:l.f}))},fastKey:function(e,t){if(!s(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!a(e,y)){if(!d(e))return"F";if(!t)return"E";m(e)}return e[y].objectID},getWeakData:function(e,t){if(!a(e,y)){if(!d(e))return!0;if(!t)return!1;m(e)}return e[y].weakData},onFreeze:function(e){return p&&h&&d(e)&&!a(e,y)&&m(e),e}};o[y]=!0},5168:(e,t,n)=>{var r,i,o,s=n(5151),a=n(8312),u=n(286),c=n(4055),l=n(3647),d=n(3431),f=n(1799),p=n(5440),h=n(2032),y="Object already initialized",v=a.TypeError,m=a.WeakMap;if(s||f.state){var g=f.state||(f.state=new m),b=u(g.get),_=u(g.has),w=u(g.set);r=function(e,t){if(_(g,e))throw new v(y);return t.facade=e,w(g,e,t),t},i=function(e){return b(g,e)||{}},o=function(e){return _(g,e)}}else{var k=p("state");h[k]=!0,r=function(e,t){if(d(e,k))throw new v(y);return t.facade=e,l(e,k,t),t},i=function(e){return d(e,k)?e[k]:{}},o=function(e){return d(e,k)}}e.exports={set:r,get:i,has:o,enforce:function(e){return o(e)?i(e):r(e,{})},getterFor:function(e){return function(t){var n;if(!c(t)||(n=i(t)).type!==e)throw v("Incompatible receiver, "+e+" required");return n}}}},7259:(e,t,n)=>{var r=n(9644),i=n(5050),o=r("iterator"),s=Array.prototype;e.exports=function(e){return void 0!==e&&(i.Array===e||s[o]===e)}},4359:(e,t,n)=>{var r=n(5830);e.exports=Array.isArray||function(e){return"Array"==r(e)}},1314:e=>{e.exports=function(e){return"function"==typeof e}},901:(e,t,n)=>{var r=n(286),i=n(2374),o=n(1314),s=n(18),a=n(6854),u=n(5951),c=function(){},l=[],d=a("Reflect","construct"),f=/^\s*(?:class|function)\b/,p=r(f.exec),h=!f.exec(c),y=function(e){if(!o(e))return!1;try{return d(c,l,e),!0}catch(e){return!1}},v=function(e){if(!o(e))return!1;switch(s(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return h||!!p(f,u(e))}catch(e){return!0}};v.sham=!0,e.exports=!d||i((function(){var e;return y(y.call)||!y(Object)||!y((function(){e=!0}))||e}))?v:y},8503:(e,t,n)=>{var r=n(2374),i=n(1314),o=/#|\.prototype\./,s=function(e,t){var n=u[a(e)];return n==l||n!=c&&(i(t)?r(t):!!t)},a=s.normalize=function(e){return String(e).replace(o,".").toLowerCase()},u=s.data={},c=s.NATIVE="N",l=s.POLYFILL="P";e.exports=s},112:(e,t,n)=>{var r=n(4055),i=Math.floor;e.exports=Number.isInteger||function(e){return!r(e)&&isFinite(e)&&i(e)===e}},4055:(e,t,n)=>{var r=n(1314);e.exports=function(e){return"object"==typeof e?null!==e:r(e)}},6985:e=>{e.exports=!1},3595:(e,t,n)=>{var r=n(4055),i=n(5830),o=n(9644)("match");e.exports=function(e){var t;return r(e)&&(void 0!==(t=e[o])?!!t:"RegExp"==i(e))}},8723:(e,t,n)=>{var r=n(8312),i=n(6854),o=n(1314),s=n(3657),a=n(392),u=r.Object;e.exports=a?function(e){return"symbol"==typeof e}:function(e){var t=i("Symbol");return o(t)&&s(t.prototype,u(e))}},1544:(e,t,n)=>{var r=n(8312),i=n(386),o=n(9961),s=n(4949),a=n(824),u=n(7259),c=n(8996),l=n(3657),d=n(1354),f=n(2143),p=n(8379),h=r.TypeError,y=function(e,t){this.stopped=e,this.result=t},v=y.prototype;e.exports=function(e,t,n){var r,m,g,b,_,w,k,x=n&&n.that,S=!(!n||!n.AS_ENTRIES),E=!(!n||!n.IS_ITERATOR),T=!(!n||!n.INTERRUPTED),O=i(t,x),I=function(e){return r&&p(r,"normal",e),new y(!0,e)},C=function(e){return S?(s(e),T?O(e[0],e[1],I):O(e[0],e[1])):T?O(e,I):O(e)};if(E)r=e;else{if(!(m=f(e)))throw h(a(e)+" is not iterable");if(u(m)){for(g=0,b=c(e);b>g;g++)if((_=C(e[g]))&&l(v,_))return _;return new y(!1)}r=d(e,m)}for(w=r.next;!(k=o(w,r)).done;){try{_=C(k.value)}catch(e){p(r,"throw",e)}if("object"==typeof _&&_&&l(v,_))return _}return new y(!1)}},8379:(e,t,n)=>{var r=n(9961),i=n(4949),o=n(4355);e.exports=function(e,t,n){var s,a;i(e);try{if(!(s=o(e,"return"))){if("throw"===t)throw n;return n}s=r(s,e)}catch(e){a=!0,s=e}if("throw"===t)throw n;if(a)throw s;return i(s),n}},8846:(e,t,n)=>{"use strict";var r,i,o,s=n(2374),a=n(1314),u=n(9581),c=n(6192),l=n(5686),d=n(9644),f=n(6985),p=d("iterator"),h=!1;[].keys&&("next"in(o=[].keys())?(i=c(c(o)))!==Object.prototype&&(r=i):h=!0),null==r||s((function(){var e={};return r[p].call(e)!==e}))?r={}:f&&(r=u(r)),a(r[p])||l(r,p,(function(){return this})),e.exports={IteratorPrototype:r,BUGGY_SAFARI_ITERATORS:h}},5050:e=>{e.exports={}},8996:(e,t,n)=>{var r=n(4104);e.exports=function(e){return r(e.length)}},8210:(e,t,n)=>{var r=n(2374),i=n(1314),o=n(3431),s=n(4490),a=n(8977).CONFIGURABLE,u=n(5951),c=n(5168),l=c.enforce,d=c.get,f=Object.defineProperty,p=s&&!r((function(){return 8!==f((function(){}),"length",{value:8}).length})),h=String(String).split("String"),y=e.exports=function(e,t,n){"Symbol("===String(t).slice(0,7)&&(t="["+String(t).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),n&&n.getter&&(t="get "+t),n&&n.setter&&(t="set "+t),(!o(e,"name")||a&&e.name!==t)&&f(e,"name",{value:t,configurable:!0}),p&&n&&o(n,"arity")&&e.length!==n.arity&&f(e,"length",{value:n.arity});try{n&&o(n,"constructor")&&n.constructor?s&&f(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch(e){}var r=l(e);return o(r,"source")||(r.source=h.join("string"==typeof t?t:"")),e};Function.prototype.toString=y((function(){return i(this)&&d(this).source||u(this)}),"toString")},3403:e=>{var t=Math.ceil,n=Math.floor;e.exports=Math.trunc||function(e){var r=+e;return(r>0?n:t)(r)}},8726:(e,t,n)=>{var r,i,o,s,a,u,c,l,d=n(8312),f=n(386),p=n(6653).f,h=n(7072).set,y=n(5751),v=n(8190),m=n(8065),g=n(3968),b=d.MutationObserver||d.WebKitMutationObserver,_=d.document,w=d.process,k=d.Promise,x=p(d,"queueMicrotask"),S=x&&x.value;S||(r=function(){var e,t;for(g&&(e=w.domain)&&e.exit();i;){t=i.fn,i=i.next;try{t()}catch(e){throw i?s():o=void 0,e}}o=void 0,e&&e.enter()},y||g||m||!b||!_?!v&&k&&k.resolve?((c=k.resolve(void 0)).constructor=k,l=f(c.then,c),s=function(){l(r)}):g?s=function(){w.nextTick(r)}:(h=f(h,d),s=function(){h(r)}):(a=!0,u=_.createTextNode(""),new b(r).observe(u,{characterData:!0}),s=function(){u.data=a=!a})),e.exports=S||function(e){var t={fn:e,next:void 0};o&&(o.next=t),i||(i=t,s()),o=t}},1420:(e,t,n)=>{var r=n(6591);e.exports=r&&!!Symbol.for&&!!Symbol.keyFor},6591:(e,t,n)=>{var r=n(8351),i=n(2374);e.exports=!!Object.getOwnPropertySymbols&&!i((function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&r&&r<41}))},9130:(e,t,n)=>{var r=n(2374),i=n(9644),o=n(6985),s=i("iterator");e.exports=!r((function(){var e=new URL("b?a=1&b=2&c=3","http://a"),t=e.searchParams,n="";return e.pathname="c%20d",t.forEach((function(e,r){t.delete("b"),n+=r+e})),o&&!e.toJSON||!t.sort||"http://a/c%20d?a=1&c=3"!==e.href||"3"!==t.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!t[s]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("http://тест").host||"#%D0%B1"!==new URL("http://a#б").hash||"a1c3"!==n||"x"!==new URL("http://x",void 0).host}))},5151:(e,t,n)=>{var r=n(8312),i=n(1314),o=n(5951),s=r.WeakMap;e.exports=i(s)&&/native code/.test(o(s))},2574:(e,t,n)=>{"use strict";var r=n(2084),i=function(e){var t,n;this.promise=new e((function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=r})),this.resolve=r(t),this.reject=r(n)};e.exports.f=function(e){return new i(e)}},9417:(e,t,n)=>{var r=n(8312),i=n(3595),o=r.TypeError;e.exports=function(e){if(i(e))throw o("The method doesn't accept regular expressions");return e}},3991:(e,t,n)=>{"use strict";var r=n(4490),i=n(286),o=n(9961),s=n(2374),a=n(765),u=n(8781),c=n(3214),l=n(3922),d=n(712),f=Object.assign,p=Object.defineProperty,h=i([].concat);e.exports=!f||s((function(){if(r&&1!==f({b:1},f(p({},"a",{enumerable:!0,get:function(){p(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},n=Symbol(),i="abcdefghijklmnopqrst";return e[n]=7,i.split("").forEach((function(e){t[e]=e})),7!=f({},e)[n]||a(f({},t)).join("")!=i}))?function(e,t){for(var n=l(e),i=arguments.length,s=1,f=u.f,p=c.f;i>s;)for(var y,v=d(arguments[s++]),m=f?h(a(v),f(v)):a(v),g=m.length,b=0;g>b;)y=m[b++],r&&!o(p,v,y)||(n[y]=v[y]);return n}:f},9581:(e,t,n)=>{var r,i=n(4949),o=n(3004),s=n(6189),a=n(2032),u=n(1111),c=n(371),l=n(5440),d=l("IE_PROTO"),f=function(){},p=function(e){return"<script>"+e+"</"+"script>"},h=function(e){e.write(p("")),e.close();var t=e.parentWindow.Object;return e=null,t},y=function(){try{r=new ActiveXObject("htmlfile")}catch(e){}var e,t;y="undefined"!=typeof document?document.domain&&r?h(r):((t=c("iframe")).style.display="none",u.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(p("document.F=Object")),e.close(),e.F):h(r);for(var n=s.length;n--;)delete y.prototype[s[n]];return y()};a[d]=!0,e.exports=Object.create||function(e,t){var n;return null!==e?(f.prototype=i(e),n=new f,f.prototype=null,n[d]=e):n=y(),void 0===t?n:o.f(n,t)}},3004:(e,t,n)=>{var r=n(4490),i=n(9268),o=n(1424),s=n(4949),a=n(981),u=n(765);t.f=r&&!i?Object.defineProperties:function(e,t){s(e);for(var n,r=a(t),i=u(t),c=i.length,l=0;c>l;)o.f(e,n=i[l++],r[n]);return e}},1424:(e,t,n)=>{var r=n(8312),i=n(4490),o=n(749),s=n(9268),a=n(4949),u=n(3553),c=r.TypeError,l=Object.defineProperty,d=Object.getOwnPropertyDescriptor,f="enumerable",p="configurable",h="writable";t.f=i?s?function(e,t,n){if(a(e),t=u(t),a(n),"function"==typeof e&&"prototype"===t&&"value"in n&&h in n&&!n.writable){var r=d(e,t);r&&r.writable&&(e[t]=n.value,n={configurable:p in n?n.configurable:r.configurable,enumerable:f in n?n.enumerable:r.enumerable,writable:!1})}return l(e,t,n)}:l:function(e,t,n){if(a(e),t=u(t),a(n),o)try{return l(e,t,n)}catch(e){}if("get"in n||"set"in n)throw c("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},6653:(e,t,n)=>{var r=n(4490),i=n(9961),o=n(3214),s=n(6923),a=n(981),u=n(3553),c=n(3431),l=n(749),d=Object.getOwnPropertyDescriptor;t.f=r?d:function(e,t){if(e=a(e),t=u(t),l)try{return d(e,t)}catch(e){}if(c(e,t))return s(!i(o.f,e,t),e[t])}},8830:(e,t,n)=>{var r=n(5830),i=n(981),o=n(8618).f,s=n(6430),a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return a&&"Window"==r(e)?function(e){try{return o(e)}catch(e){return s(a)}}(e):o(i(e))}},8618:(e,t,n)=>{var r=n(4604),i=n(6189).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,i)}},8781:(e,t)=>{t.f=Object.getOwnPropertySymbols},6192:(e,t,n)=>{var r=n(8312),i=n(3431),o=n(1314),s=n(3922),a=n(5440),u=n(4870),c=a("IE_PROTO"),l=r.Object,d=l.prototype;e.exports=u?l.getPrototypeOf:function(e){var t=s(e);if(i(t,c))return t[c];var n=t.constructor;return o(n)&&t instanceof n?n.prototype:t instanceof l?d:null}},9813:(e,t,n)=>{var r=n(2374),i=n(4055),o=n(5830),s=n(3765),a=Object.isExtensible,u=r((function(){a(1)}));e.exports=u||s?function(e){return!!i(e)&&((!s||"ArrayBuffer"!=o(e))&&(!a||a(e)))}:a},3657:(e,t,n)=>{var r=n(286);e.exports=r({}.isPrototypeOf)},4604:(e,t,n)=>{var r=n(286),i=n(3431),o=n(981),s=n(4013).indexOf,a=n(2032),u=r([].push);e.exports=function(e,t){var n,r=o(e),c=0,l=[];for(n in r)!i(a,n)&&i(r,n)&&u(l,n);for(;t.length>c;)i(r,n=t[c++])&&(~s(l,n)||u(l,n));return l}},765:(e,t,n)=>{var r=n(4604),i=n(6189);e.exports=Object.keys||function(e){return r(e,i)}},3214:(e,t)=>{"use strict";var n={}.propertyIsEnumerable,r=Object.getOwnPropertyDescriptor,i=r&&!n.call({1:2},1);t.f=i?function(e){var t=r(this,e);return!!t&&t.enumerable}:n},2711:(e,t,n)=>{var r=n(286),i=n(4949),o=n(5364);e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{(e=r(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(n,[]),t=n instanceof Array}catch(e){}return function(n,r){return i(n),o(r),t?e(n,r):n.__proto__=r,n}}():void 0)},8545:(e,t,n)=>{var r=n(4490),i=n(286),o=n(765),s=n(981),a=i(n(3214).f),u=i([].push),c=function(e){return function(t){for(var n,i=s(t),c=o(i),l=c.length,d=0,f=[];l>d;)n=c[d++],r&&!a(i,n)||u(f,e?[n,i[n]]:i[n]);return f}};e.exports={entries:c(!0),values:c(!1)}},8327:(e,t,n)=>{"use strict";var r=n(9677),i=n(18);e.exports=r?{}.toString:function(){return"[object "+i(this)+"]"}},3115:(e,t,n)=>{var r=n(8312),i=n(9961),o=n(1314),s=n(4055),a=r.TypeError;e.exports=function(e,t){var n,r;if("string"===t&&o(n=e.toString)&&!s(r=i(n,e)))return r;if(o(n=e.valueOf)&&!s(r=i(n,e)))return r;if("string"!==t&&o(n=e.toString)&&!s(r=i(n,e)))return r;throw a("Can't convert object to primitive value")}},713:(e,t,n)=>{var r=n(6854),i=n(286),o=n(8618),s=n(8781),a=n(4949),u=i([].concat);e.exports=r("Reflect","ownKeys")||function(e){var t=o.f(a(e)),n=s.f;return n?u(t,n(e)):t}},1940:(e,t,n)=>{var r=n(8312);e.exports=r},5353:e=>{e.exports=function(e){try{return{error:!1,value:e()}}catch(e){return{error:!0,value:e}}}},3600:(e,t,n)=>{var r=n(8312),i=n(5247),o=n(1314),s=n(8503),a=n(5951),u=n(9644),c=n(4010),l=n(6985),d=n(8351),f=i&&i.prototype,p=u("species"),h=!1,y=o(r.PromiseRejectionEvent),v=s("Promise",(function(){var e=a(i),t=e!==String(i);if(!t&&66===d)return!0;if(l&&(!f.catch||!f.finally))return!0;if(d>=51&&/native code/.test(e))return!1;var n=new i((function(e){e(1)})),r=function(e){e((function(){}),(function(){}))};return(n.constructor={})[p]=r,!(h=n.then((function(){}))instanceof r)||!t&&c&&!y}));e.exports={CONSTRUCTOR:v,REJECTION_EVENT:y,SUBCLASSING:h}},5247:(e,t,n)=>{var r=n(8312);e.exports=r.Promise},9086:(e,t,n)=>{var r=n(4949),i=n(4055),o=n(2574);e.exports=function(e,t){if(r(e),i(t)&&t.constructor===e)return t;var n=o.f(e);return(0,n.resolve)(t),n.promise}},8303:(e,t,n)=>{var r=n(5247),i=n(2425),o=n(3600).CONSTRUCTOR;e.exports=o||!i((function(e){r.all(e).then(void 0,(function(){}))}))},3807:e=>{var t=function(){this.head=null,this.tail=null};t.prototype={add:function(e){var t={item:e,next:null};this.head?this.tail.next=t:this.head=t,this.tail=t},get:function(){var e=this.head;if(e)return this.head=e.next,this.tail===e&&(this.tail=null),e.item}},e.exports=t},3666:(e,t,n)=>{var r=n(8312),i=n(9961),o=n(4949),s=n(1314),a=n(5830),u=n(6911),c=r.TypeError;e.exports=function(e,t){var n=e.exec;if(s(n)){var r=i(n,e,t);return null!==r&&o(r),r}if("RegExp"===a(e))return i(u,e,t);throw c("RegExp#exec called on incompatible receiver")}},6911:(e,t,n)=>{"use strict";var r,i,o=n(9961),s=n(286),a=n(4640),u=n(8066),c=n(1486),l=n(9307),d=n(9581),f=n(5168).get,p=n(3636),h=n(9533),y=l("native-string-replace",String.prototype.replace),v=RegExp.prototype.exec,m=v,g=s("".charAt),b=s("".indexOf),_=s("".replace),w=s("".slice),k=(i=/b*/g,o(v,r=/a/,"a"),o(v,i,"a"),0!==r.lastIndex||0!==i.lastIndex),x=c.BROKEN_CARET,S=void 0!==/()??/.exec("")[1];(k||S||x||p||h)&&(m=function(e){var t,n,r,i,s,c,l,p=this,h=f(p),E=a(e),T=h.raw;if(T)return T.lastIndex=p.lastIndex,t=o(m,T,E),p.lastIndex=T.lastIndex,t;var O=h.groups,I=x&&p.sticky,C=o(u,p),R=p.source,A=0,P=E;if(I&&(C=_(C,"y",""),-1===b(C,"g")&&(C+="g"),P=w(E,p.lastIndex),p.lastIndex>0&&(!p.multiline||p.multiline&&"\n"!==g(E,p.lastIndex-1))&&(R="(?: "+R+")",P=" "+P,A++),n=new RegExp("^(?:"+R+")",C)),S&&(n=new RegExp("^"+R+"$(?!\\s)",C)),k&&(r=p.lastIndex),i=o(v,I?n:p,P),I?i?(i.input=w(i.input,A),i[0]=w(i[0],A),i.index=p.lastIndex,p.lastIndex+=i[0].length):p.lastIndex=0:k&&i&&(p.lastIndex=p.global?i.index+i[0].length:r),S&&i&&i.length>1&&o(y,i[0],n,(function(){for(s=1;s<arguments.length-2;s++)void 0===arguments[s]&&(i[s]=void 0)})),i&&O)for(i.groups=c=d(null),s=0;s<O.length;s++)c[(l=O[s])[0]]=i[l[1]];return i}),e.exports=m},8066:(e,t,n)=>{"use strict";var r=n(4949);e.exports=function(){var e=r(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},2494:(e,t,n)=>{var r=n(9961),i=n(3431),o=n(3657),s=n(8066),a=RegExp.prototype;e.exports=function(e){var t=e.flags;return void 0!==t||"flags"in a||i(e,"flags")||!o(a,e)?t:r(s,e)}},1486:(e,t,n)=>{var r=n(2374),i=n(8312).RegExp,o=r((function(){var e=i("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),s=o||r((function(){return!i("a","y").sticky})),a=o||r((function(){var e=i("^r","gy");return e.lastIndex=2,null!=e.exec("str")}));e.exports={BROKEN_CARET:a,MISSED_STICKY:s,UNSUPPORTED_Y:o}},3636:(e,t,n)=>{var r=n(2374),i=n(8312).RegExp;e.exports=r((function(){var e=i(".","s");return!(e.dotAll&&e.exec("\n")&&"s"===e.flags)}))},9533:(e,t,n)=>{var r=n(2374),i=n(8312).RegExp;e.exports=r((function(){var e=i("(?<a>b)","g");return"b"!==e.exec("b").groups.a||"bc"!=="b".replace(e,"$<a>c")}))},7618:(e,t,n)=>{var r=n(8312).TypeError;e.exports=function(e){if(null==e)throw r("Can't call method on "+e);return e}},9058:e=>{e.exports=Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}},1311:(e,t,n)=>{"use strict";var r=n(6854),i=n(1424),o=n(9644),s=n(4490),a=o("species");e.exports=function(e){var t=r(e),n=i.f;s&&t&&!t[a]&&n(t,a,{configurable:!0,get:function(){return this}})}},737:(e,t,n)=>{var r=n(1424).f,i=n(3431),o=n(9644)("toStringTag");e.exports=function(e,t,n){e&&!n&&(e=e.prototype),e&&!i(e,o)&&r(e,o,{configurable:!0,value:t})}},5440:(e,t,n)=>{var r=n(9307),i=n(5834),o=r("keys");e.exports=function(e){return o[e]||(o[e]=i(e))}},1799:(e,t,n)=>{var r=n(8312),i=n(3237),o="__core-js_shared__",s=r[o]||i(o,{});e.exports=s},9307:(e,t,n)=>{var r=n(6985),i=n(1799);(e.exports=function(e,t){return i[e]||(i[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.22.7",mode:r?"pure":"global",copyright:"© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.22.7/LICENSE",source:"https://github.com/zloirock/core-js"})},3110:(e,t,n)=>{var r=n(4949),i=n(2437),o=n(9644)("species");e.exports=function(e,t){var n,s=r(e).constructor;return void 0===s||null==(n=r(s)[o])?t:i(n)}},2042:(e,t,n)=>{var r=n(286),i=n(3855),o=n(4640),s=n(7618),a=r("".charAt),u=r("".charCodeAt),c=r("".slice),l=function(e){return function(t,n){var r,l,d=o(s(t)),f=i(n),p=d.length;return f<0||f>=p?e?"":void 0:(r=u(d,f))<55296||r>56319||f+1===p||(l=u(d,f+1))<56320||l>57343?e?a(d,f):r:e?c(d,f,f+2):l-56320+(r-55296<<10)+65536}};e.exports={codeAt:l(!1),charAt:l(!0)}},7393:(e,t,n)=>{"use strict";var r=n(8312),i=n(286),o=2147483647,s=/[^\0-\u007E]/,a=/[.\u3002\uFF0E\uFF61]/g,u="Overflow: input needs wider integers to process",c=r.RangeError,l=i(a.exec),d=Math.floor,f=String.fromCharCode,p=i("".charCodeAt),h=i([].join),y=i([].push),v=i("".replace),m=i("".split),g=i("".toLowerCase),b=function(e){return e+22+75*(e<26)},_=function(e,t,n){var r=0;for(e=n?d(e/700):e>>1,e+=d(e/t);e>455;)e=d(e/35),r+=36;return d(r+36*e/(e+38))},w=function(e){var t=[];e=function(e){for(var t=[],n=0,r=e.length;n<r;){var i=p(e,n++);if(i>=55296&&i<=56319&&n<r){var o=p(e,n++);56320==(64512&o)?y(t,((1023&i)<<10)+(1023&o)+65536):(y(t,i),n--)}else y(t,i)}return t}(e);var n,r,i=e.length,s=128,a=0,l=72;for(n=0;n<e.length;n++)(r=e[n])<128&&y(t,f(r));var v=t.length,m=v;for(v&&y(t,"-");m<i;){var g=o;for(n=0;n<e.length;n++)(r=e[n])>=s&&r<g&&(g=r);var w=m+1;if(g-s>d((o-a)/w))throw c(u);for(a+=(g-s)*w,s=g,n=0;n<e.length;n++){if((r=e[n])<s&&++a>o)throw c(u);if(r==s){for(var k=a,x=36;;){var S=x<=l?1:x>=l+26?26:x-l;if(k<S)break;var E=k-S,T=36-S;y(t,f(b(S+E%T))),k=d(E/T),x+=36}y(t,f(b(k))),l=_(a,w,m==v),a=0,m++}}a++,s++}return h(t,"")};e.exports=function(e){var t,n,r=[],i=m(v(g(e),a,"."),".");for(t=0;t<i.length;t++)n=i[t],y(r,l(s,n)?"xn--"+w(n):n);return h(r,".")}},3385:(e,t,n)=>{var r=n(286),i=n(7618),o=n(4640),s=n(3620),a=r("".replace),u="["+s+"]",c=RegExp("^"+u+u+"*"),l=RegExp(u+u+"*$"),d=function(e){return function(t){var n=o(i(t));return 1&e&&(n=a(n,c,"")),2&e&&(n=a(n,l,"")),n}};e.exports={start:d(1),end:d(2),trim:d(3)}},8597:(e,t,n)=>{var r=n(9961),i=n(6854),o=n(9644),s=n(5686);e.exports=function(){var e=i("Symbol"),t=e&&e.prototype,n=t&&t.valueOf,a=o("toPrimitive");t&&!t[a]&&s(t,a,(function(e){return r(n,this)}),{arity:1})}},7072:(e,t,n)=>{var r,i,o,s,a=n(8312),u=n(9084),c=n(386),l=n(1314),d=n(3431),f=n(2374),p=n(1111),h=n(2808),y=n(371),v=n(1058),m=n(5751),g=n(3968),b=a.setImmediate,_=a.clearImmediate,w=a.process,k=a.Dispatch,x=a.Function,S=a.MessageChannel,E=a.String,T=0,O={},I="onreadystatechange";try{r=a.location}catch(e){}var C=function(e){if(d(O,e)){var t=O[e];delete O[e],t()}},R=function(e){return function(){C(e)}},A=function(e){C(e.data)},P=function(e){a.postMessage(E(e),r.protocol+"//"+r.host)};b&&_||(b=function(e){v(arguments.length,1);var t=l(e)?e:x(e),n=h(arguments,1);return O[++T]=function(){u(t,void 0,n)},i(T),T},_=function(e){delete O[e]},g?i=function(e){w.nextTick(R(e))}:k&&k.now?i=function(e){k.now(R(e))}:S&&!m?(s=(o=new S).port2,o.port1.onmessage=A,i=c(s.postMessage,s)):a.addEventListener&&l(a.postMessage)&&!a.importScripts&&r&&"file:"!==r.protocol&&!f(P)?(i=P,a.addEventListener("message",A,!1)):i=I in y("script")?function(e){p.appendChild(y("script")).onreadystatechange=function(){p.removeChild(this),C(e)}}:function(e){setTimeout(R(e),0)}),e.exports={set:b,clear:_}},3648:(e,t,n)=>{var r=n(286);e.exports=r(1..valueOf)},1092:(e,t,n)=>{var r=n(3855),i=Math.max,o=Math.min;e.exports=function(e,t){var n=r(e);return n<0?i(n+t,0):o(n,t)}},8695:(e,t,n)=>{var r=n(8312),i=n(3855),o=n(4104),s=r.RangeError;e.exports=function(e){if(void 0===e)return 0;var t=i(e),n=o(t);if(t!==n)throw s("Wrong length or index");return n}},981:(e,t,n)=>{var r=n(712),i=n(7618);e.exports=function(e){return r(i(e))}},3855:(e,t,n)=>{var r=n(3403);e.exports=function(e){var t=+e;return t!=t||0===t?0:r(t)}},4104:(e,t,n)=>{var r=n(3855),i=Math.min;e.exports=function(e){return e>0?i(r(e),9007199254740991):0}},3922:(e,t,n)=>{var r=n(8312),i=n(7618),o=r.Object;e.exports=function(e){return o(i(e))}},378:(e,t,n)=>{var r=n(8312),i=n(3287),o=r.RangeError;e.exports=function(e,t){var n=i(e);if(n%t)throw o("Wrong offset");return n}},3287:(e,t,n)=>{var r=n(8312),i=n(3855),o=r.RangeError;e.exports=function(e){var t=i(e);if(t<0)throw o("The argument can't be less than 0");return t}},5141:(e,t,n)=>{var r=n(8312),i=n(9961),o=n(4055),s=n(8723),a=n(4355),u=n(3115),c=n(9644),l=r.TypeError,d=c("toPrimitive");e.exports=function(e,t){if(!o(e)||s(e))return e;var n,r=a(e,d);if(r){if(void 0===t&&(t="default"),n=i(r,e,t),!o(n)||s(n))return n;throw l("Can't convert object to primitive value")}return void 0===t&&(t="number"),u(e,t)}},3553:(e,t,n)=>{var r=n(5141),i=n(8723);e.exports=function(e){var t=r(e,"string");return i(t)?t:t+""}},9677:(e,t,n)=>{var r={};r[n(9644)("toStringTag")]="z",e.exports="[object z]"===String(r)},4640:(e,t,n)=>{var r=n(8312),i=n(18),o=r.String;e.exports=function(e){if("Symbol"===i(e))throw TypeError("Cannot convert a Symbol value to a string");return o(e)}},824:(e,t,n)=>{var r=n(8312).String;e.exports=function(e){try{return r(e)}catch(e){return"Object"}}},9052:(e,t,n)=>{"use strict";var r=n(2176),i=n(8312),o=n(9961),s=n(4490),a=n(4470),u=n(3978),c=n(1782),l=n(3871),d=n(6923),f=n(3647),p=n(112),h=n(4104),y=n(8695),v=n(378),m=n(3553),g=n(3431),b=n(18),_=n(4055),w=n(8723),k=n(9581),x=n(3657),S=n(2711),E=n(8618).f,T=n(7662),O=n(2213).forEach,I=n(1311),C=n(1424),R=n(6653),A=n(5168),P=n(5673),N=A.get,L=A.set,M=C.f,j=R.f,D=Math.round,B=i.RangeError,U=c.ArrayBuffer,F=U.prototype,H=c.DataView,G=u.NATIVE_ARRAY_BUFFER_VIEWS,W=u.TYPED_ARRAY_CONSTRUCTOR,q=u.TYPED_ARRAY_TAG,V=u.TypedArray,z=u.TypedArrayPrototype,Y=u.aTypedArrayConstructor,K=u.isTypedArray,$="BYTES_PER_ELEMENT",X="Wrong length",J=function(e,t){Y(e);for(var n=0,r=t.length,i=new e(r);r>n;)i[n]=t[n++];return i},Z=function(e,t){M(e,t,{get:function(){return N(this)[t]}})},Q=function(e){var t;return x(F,e)||"ArrayBuffer"==(t=b(e))||"SharedArrayBuffer"==t},ee=function(e,t){return K(e)&&!w(t)&&t in e&&p(+t)&&t>=0},te=function(e,t){return t=m(t),ee(e,t)?d(2,e[t]):j(e,t)},ne=function(e,t,n){return t=m(t),!(ee(e,t)&&_(n)&&g(n,"value"))||g(n,"get")||g(n,"set")||n.configurable||g(n,"writable")&&!n.writable||g(n,"enumerable")&&!n.enumerable?M(e,t,n):(e[t]=n.value,e)};s?(G||(R.f=te,C.f=ne,Z(z,"buffer"),Z(z,"byteOffset"),Z(z,"byteLength"),Z(z,"length")),r({target:"Object",stat:!0,forced:!G},{getOwnPropertyDescriptor:te,defineProperty:ne}),e.exports=function(e,t,n){var s=e.match(/\d+$/)[0]/8,u=e+(n?"Clamped":"")+"Array",c="get"+e,d="set"+e,p=i[u],m=p,g=m&&m.prototype,b={},w=function(e,t){M(e,t,{get:function(){return function(e,t){var n=N(e);return n.view[c](t*s+n.byteOffset,!0)}(this,t)},set:function(e){return function(e,t,r){var i=N(e);n&&(r=(r=D(r))<0?0:r>255?255:255&r),i.view[d](t*s+i.byteOffset,r,!0)}(this,t,e)},enumerable:!0})};G?a&&(m=t((function(e,t,n,r){return l(e,g),P(_(t)?Q(t)?void 0!==r?new p(t,v(n,s),r):void 0!==n?new p(t,v(n,s)):new p(t):K(t)?J(m,t):o(T,m,t):new p(y(t)),e,m)})),S&&S(m,V),O(E(p),(function(e){e in m||f(m,e,p[e])})),m.prototype=g):(m=t((function(e,t,n,r){l(e,g);var i,a,u,c=0,d=0;if(_(t)){if(!Q(t))return K(t)?J(m,t):o(T,m,t);i=t,d=v(n,s);var f=t.byteLength;if(void 0===r){if(f%s)throw B(X);if((a=f-d)<0)throw B(X)}else if((a=h(r)*s)+d>f)throw B(X);u=a/s}else u=y(t),i=new U(a=u*s);for(L(e,{buffer:i,byteOffset:d,byteLength:a,length:u,view:new H(i)});c<u;)w(e,c++)})),S&&S(m,V),g=m.prototype=k(z)),g.constructor!==m&&f(g,"constructor",m),f(g,W,m),q&&f(g,q,u);var x=m!=p;b[u]=m,r({global:!0,constructor:!0,forced:x,sham:!G},b),$ in m||f(m,$,s),$ in g||f(g,$,s),I(u)}):e.exports=function(){}},4470:(e,t,n)=>{var r=n(8312),i=n(2374),o=n(2425),s=n(3978).NATIVE_ARRAY_BUFFER_VIEWS,a=r.ArrayBuffer,u=r.Int8Array;e.exports=!s||!i((function(){u(1)}))||!i((function(){new u(-1)}))||!o((function(e){new u,new u(null),new u(1.5),new u(e)}),!0)||i((function(){return 1!==new u(new a(2),1,void 0).length}))},8076:(e,t,n)=>{var r=n(4190),i=n(8656);e.exports=function(e,t){return r(i(e),t)}},7662:(e,t,n)=>{var r=n(386),i=n(9961),o=n(2437),s=n(3922),a=n(8996),u=n(1354),c=n(2143),l=n(7259),d=n(3978).aTypedArrayConstructor;e.exports=function(e){var t,n,f,p,h,y,v=o(this),m=s(e),g=arguments.length,b=g>1?arguments[1]:void 0,_=void 0!==b,w=c(m);if(w&&!l(w))for(y=(h=u(m,w)).next,m=[];!(p=i(y,h)).done;)m.push(p.value);for(_&&g>2&&(b=r(b,arguments[2])),n=a(m),f=new(d(v))(n),t=0;n>t;t++)f[t]=_?b(m[t],t):m[t];return f}},8656:(e,t,n)=>{var r=n(3978),i=n(3110),o=r.TYPED_ARRAY_CONSTRUCTOR,s=r.aTypedArrayConstructor;e.exports=function(e){return s(i(e,e[o]))}},5834:(e,t,n)=>{var r=n(286),i=0,o=Math.random(),s=r(1..toString);e.exports=function(e){return"Symbol("+(void 0===e?"":e)+")_"+s(++i+o,36)}},392:(e,t,n)=>{var r=n(6591);e.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},9268:(e,t,n)=>{var r=n(4490),i=n(2374);e.exports=r&&i((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},1058:(e,t,n)=>{var r=n(8312).TypeError;e.exports=function(e,t){if(e<t)throw r("Not enough arguments");return e}},5145:(e,t,n)=>{var r=n(9644);t.f=r},9644:(e,t,n)=>{var r=n(8312),i=n(9307),o=n(3431),s=n(5834),a=n(6591),u=n(392),c=i("wks"),l=r.Symbol,d=l&&l.for,f=u?l:l&&l.withoutSetter||s;e.exports=function(e){if(!o(c,e)||!a&&"string"!=typeof c[e]){var t="Symbol."+e;a&&o(l,e)?c[e]=l[e]:c[e]=u&&d?d(t):f(t)}return c[e]}},3620:e=>{e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},8437:(e,t,n)=>{"use strict";var r=n(2176),i=n(8312),o=n(1782),s=n(1311),a="ArrayBuffer",u=o.ArrayBuffer;r({global:!0,constructor:!0,forced:i.ArrayBuffer!==u},{ArrayBuffer:u}),s(a)},6294:(e,t,n)=>{"use strict";var r=n(2176),i=n(8312),o=n(2374),s=n(4359),a=n(4055),u=n(3922),c=n(8996),l=n(7982),d=n(9458),f=n(3934),p=n(9644),h=n(8351),y=p("isConcatSpreadable"),v=9007199254740991,m="Maximum allowed index exceeded",g=i.TypeError,b=h>=51||!o((function(){var e=[];return e[y]=!1,e.concat()[0]!==e})),_=f("concat"),w=function(e){if(!a(e))return!1;var t=e[y];return void 0!==t?!!t:s(e)};r({target:"Array",proto:!0,arity:1,forced:!b||!_},{concat:function(e){var t,n,r,i,o,s=u(this),a=d(s,0),f=0;for(t=-1,r=arguments.length;t<r;t++)if(w(o=-1===t?s:arguments[t])){if(f+(i=c(o))>v)throw g(m);for(n=0;n<i;n++,f++)n in o&&l(a,f,o[n])}else{if(f>=v)throw g(m);l(a,f++,o)}return a.length=f,a}})},8505:(e,t,n)=>{"use strict";var r=n(2176),i=n(2213).filter;r({target:"Array",proto:!0,forced:!n(3934)("filter")},{filter:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},8362:(e,t,n)=>{"use strict";var r=n(2176),i=n(2213).find,o=n(6916),s="find",a=!0;s in[]&&Array(1).find((function(){a=!1})),r({target:"Array",proto:!0,forced:a},{find:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),o(s)},2893:(e,t,n)=>{var r=n(2176),i=n(4070);r({target:"Array",stat:!0,forced:!n(2425)((function(e){Array.from(e)}))},{from:i})},1022:(e,t,n)=>{"use strict";var r=n(2176),i=n(4013).includes,o=n(2374),s=n(6916);r({target:"Array",proto:!0,forced:o((function(){return!Array(1).includes()}))},{includes:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),s("includes")},7583:(e,t,n)=>{"use strict";var r=n(981),i=n(6916),o=n(5050),s=n(5168),a=n(1424).f,u=n(5946),c=n(6985),l=n(4490),d="Array Iterator",f=s.set,p=s.getterFor(d);e.exports=u(Array,"Array",(function(e,t){f(this,{type:d,target:r(e),index:0,kind:t})}),(function(){var e=p(this),t=e.target,n=e.kind,r=e.index++;return!t||r>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:r,done:!1}:"values"==n?{value:t[r],done:!1}:{value:[r,t[r]],done:!1}}),"values");var h=o.Arguments=o.Array;if(i("keys"),i("values"),i("entries"),!c&&l&&"values"!==h.name)try{a(h,"name",{value:"values"})}catch(e){}},1117:(e,t,n)=>{"use strict";var r=n(2176),i=n(286),o=n(712),s=n(981),a=n(7639),u=i([].join),c=o!=Object,l=a("join",",");r({target:"Array",proto:!0,forced:c||!l},{join:function(e){return u(s(this),void 0===e?",":e)}})},7039:(e,t,n)=>{"use strict";var r=n(2176),i=n(2213).map;r({target:"Array",proto:!0,forced:!n(3934)("map")},{map:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},4465:(e,t,n)=>{"use strict";var r=n(2176),i=n(9364).left,o=n(7639),s=n(8351),a=n(3968);r({target:"Array",proto:!0,forced:!o("reduce")||!a&&s>79&&s<83},{reduce:function(e){var t=arguments.length;return i(this,e,t,t>1?arguments[1]:void 0)}})},7472:(e,t,n)=>{"use strict";var r=n(2176),i=n(8312),o=n(4359),s=n(901),a=n(4055),u=n(1092),c=n(8996),l=n(981),d=n(7982),f=n(9644),p=n(3934),h=n(2808),y=p("slice"),v=f("species"),m=i.Array,g=Math.max;r({target:"Array",proto:!0,forced:!y},{slice:function(e,t){var n,r,i,f=l(this),p=c(f),y=u(e,p),b=u(void 0===t?p:t,p);if(o(f)&&(n=f.constructor,(s(n)&&(n===m||o(n.prototype))||a(n)&&null===(n=n[v]))&&(n=void 0),n===m||void 0===n))return h(f,y,b);for(r=new(void 0===n?m:n)(g(b-y,0)),i=0;y<b;y++,i++)y in f&&d(r,i,f[y]);return r.length=i,r}})},2671:(e,t,n)=>{"use strict";var r=n(2176),i=n(286),o=n(2084),s=n(3922),a=n(8996),u=n(4640),c=n(2374),l=n(3800),d=n(7639),f=n(9648),p=n(6415),h=n(8351),y=n(5579),v=[],m=i(v.sort),g=i(v.push),b=c((function(){v.sort(void 0)})),_=c((function(){v.sort(null)})),w=d("sort"),k=!c((function(){if(h)return h<70;if(!(f&&f>3)){if(p)return!0;if(y)return y<603;var e,t,n,r,i="";for(e=65;e<76;e++){switch(t=String.fromCharCode(e),e){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(r=0;r<47;r++)v.push({k:t+r,v:n})}for(v.sort((function(e,t){return t.v-e.v})),r=0;r<v.length;r++)t=v[r].k.charAt(0),i.charAt(i.length-1)!==t&&(i+=t);return"DGBEFHACIJK"!==i}}));r({target:"Array",proto:!0,forced:b||!_||!w||!k},{sort:function(e){void 0!==e&&o(e);var t=s(this);if(k)return void 0===e?m(t):m(t,e);var n,r,i=[],c=a(t);for(r=0;r<c;r++)r in t&&g(i,t[r]);for(l(i,function(e){return function(t,n){return void 0===n?-1:void 0===t?1:void 0!==e?+e(t,n)||0:u(t)>u(n)?1:-1}}(e)),n=i.length,r=0;r<n;)t[r]=i[r++];for(;r<c;)delete t[r++];return t}})},5073:(e,t,n)=>{"use strict";var r=n(2176),i=n(8312),o=n(1092),s=n(3855),a=n(8996),u=n(3922),c=n(9458),l=n(7982),d=n(3934)("splice"),f=i.TypeError,p=Math.max,h=Math.min,y=9007199254740991,v="Maximum allowed length exceeded";r({target:"Array",proto:!0,forced:!d},{splice:function(e,t){var n,r,i,d,m,g,b=u(this),_=a(b),w=o(e,_),k=arguments.length;if(0===k?n=r=0:1===k?(n=0,r=_-w):(n=k-2,r=h(p(s(t),0),_-w)),_+n-r>y)throw f(v);for(i=c(b,r),d=0;d<r;d++)(m=w+d)in b&&l(i,d,b[m]);if(i.length=r,n<r){for(d=w;d<_-r;d++)g=d+n,(m=d+r)in b?b[g]=b[m]:delete b[g];for(d=_;d>_-r+n;d--)delete b[d-1]}else if(n>r)for(d=_-r;d>w;d--)g=d+n-1,(m=d+r-1)in b?b[g]=b[m]:delete b[g];for(d=0;d<n;d++)b[d+w]=arguments[d+2];return b.length=_-r+n,i}})},5324:(e,t,n)=>{var r=n(4490),i=n(8977).EXISTS,o=n(286),s=n(1424).f,a=Function.prototype,u=o(a.toString),c=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,l=o(c.exec);r&&!i&&s(a,"name",{configurable:!0,get:function(){try{return l(c,u(this))[1]}catch(e){return""}}})},3454:(e,t,n)=>{var r=n(2176),i=n(6854),o=n(9084),s=n(9961),a=n(286),u=n(2374),c=n(4359),l=n(1314),d=n(4055),f=n(8723),p=n(2808),h=n(6591),y=i("JSON","stringify"),v=a(/./.exec),m=a("".charAt),g=a("".charCodeAt),b=a("".replace),_=a(1..toString),w=/[\uD800-\uDFFF]/g,k=/^[\uD800-\uDBFF]$/,x=/^[\uDC00-\uDFFF]$/,S=!h||u((function(){var e=i("Symbol")();return"[null]"!=y([e])||"{}"!=y({a:e})||"{}"!=y(Object(e))})),E=u((function(){return'"\\udf06\\ud834"'!==y("\udf06\ud834")||'"\\udead"'!==y("\udead")})),T=function(e,t){var n=p(arguments),r=t;if((d(t)||void 0!==e)&&!f(e))return c(t)||(t=function(e,t){if(l(r)&&(t=s(r,this,e,t)),!f(t))return t}),n[1]=t,o(y,null,n)},O=function(e,t,n){var r=m(n,t-1),i=m(n,t+1);return v(k,e)&&!v(x,i)||v(x,e)&&!v(k,r)?"\\u"+_(g(e,0),16):e};y&&r({target:"JSON",stat:!0,arity:3,forced:S||E},{stringify:function(e,t,n){var r=p(arguments),i=o(S?T:y,null,r);return E&&"string"==typeof i?b(i,w,O):i}})},458:(e,t,n)=>{"use strict";n(7638)("Map",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),n(8907))},2905:(e,t,n)=>{n(458)},5607:(e,t,n)=>{"use strict";var r=n(4490),i=n(8312),o=n(286),s=n(8503),a=n(5686),u=n(3431),c=n(5673),l=n(3657),d=n(8723),f=n(5141),p=n(2374),h=n(8618).f,y=n(6653).f,v=n(1424).f,m=n(3648),g=n(3385).trim,b="Number",_=i.Number,w=_.prototype,k=i.TypeError,x=o("".slice),S=o("".charCodeAt),E=function(e){var t=f(e,"number");return"bigint"==typeof t?t:T(t)},T=function(e){var t,n,r,i,o,s,a,u,c=f(e,"number");if(d(c))throw k("Cannot convert a Symbol value to a number");if("string"==typeof c&&c.length>2)if(c=g(c),43===(t=S(c,0))||45===t){if(88===(n=S(c,2))||120===n)return NaN}else if(48===t){switch(S(c,1)){case 66:case 98:r=2,i=49;break;case 79:case 111:r=8,i=55;break;default:return+c}for(s=(o=x(c,2)).length,a=0;a<s;a++)if((u=S(o,a))<48||u>i)return NaN;return parseInt(o,r)}return+c};if(s(b,!_(" 0o1")||!_("0b1")||_("+0x1"))){for(var O,I=function(e){var t=arguments.length<1?0:_(E(e)),n=this;return l(w,n)&&p((function(){m(n)}))?c(Object(t),n,I):t},C=r?h(_):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),R=0;C.length>R;R++)u(_,O=C[R])&&!u(I,O)&&v(I,O,y(_,O));I.prototype=w,w.constructor=I,a(i,b,I,{constructor:!0})}},3708:(e,t,n)=>{n(2176)({target:"Number",stat:!0},{isInteger:n(112)})},806:(e,t,n)=>{var r=n(2176),i=n(3991);r({target:"Object",stat:!0,arity:2,forced:Object.assign!==i},{assign:i})},6781:(e,t,n)=>{var r=n(2176),i=n(8545).entries;r({target:"Object",stat:!0},{entries:function(e){return i(e)}})},7913:(e,t,n)=>{var r=n(2176),i=n(2374),o=n(981),s=n(6653).f,a=n(4490),u=i((function(){s(1)}));r({target:"Object",stat:!0,forced:!a||u,sham:!a},{getOwnPropertyDescriptor:function(e,t){return s(o(e),t)}})},6023:(e,t,n)=>{var r=n(2176),i=n(4490),o=n(713),s=n(981),a=n(6653),u=n(7982);r({target:"Object",stat:!0,sham:!i},{getOwnPropertyDescriptors:function(e){for(var t,n,r=s(e),i=a.f,c=o(r),l={},d=0;c.length>d;)void 0!==(n=i(r,t=c[d++]))&&u(l,t,n);return l}})},4776:(e,t,n)=>{var r=n(2176),i=n(6591),o=n(2374),s=n(8781),a=n(3922);r({target:"Object",stat:!0,forced:!i||o((function(){s.f(1)}))},{getOwnPropertySymbols:function(e){var t=s.f;return t?t(a(e)):[]}})},8330:(e,t,n)=>{var r=n(2176),i=n(3922),o=n(765);r({target:"Object",stat:!0,forced:n(2374)((function(){o(1)}))},{keys:function(e){return o(i(e))}})},1825:(e,t,n)=>{var r=n(9677),i=n(5686),o=n(8327);r||i(Object.prototype,"toString",o,{unsafe:!0})},9618:(e,t,n)=>{"use strict";var r=n(2176),i=n(9961),o=n(2084),s=n(2574),a=n(5353),u=n(1544);r({target:"Promise",stat:!0,forced:n(8303)},{all:function(e){var t=this,n=s.f(t),r=n.resolve,c=n.reject,l=a((function(){var n=o(t.resolve),s=[],a=0,l=1;u(e,(function(e){var o=a++,u=!1;l++,i(n,t,e).then((function(e){u||(u=!0,s[o]=e,--l||r(s))}),c)})),--l||r(s)}));return l.error&&c(l.value),n.promise}})},7529:(e,t,n)=>{"use strict";var r=n(2176),i=n(6985),o=n(3600).CONSTRUCTOR,s=n(5247),a=n(6854),u=n(1314),c=n(5686),l=s&&s.prototype;if(r({target:"Promise",proto:!0,forced:o,real:!0},{catch:function(e){return this.then(void 0,e)}}),!i&&u(s)){var d=a("Promise").prototype.catch;l.catch!==d&&c(l,"catch",d,{unsafe:!0})}},4343:(e,t,n)=>{"use strict";var r,i,o,s=n(2176),a=n(6985),u=n(3968),c=n(8312),l=n(9961),d=n(5686),f=n(2711),p=n(737),h=n(1311),y=n(2084),v=n(1314),m=n(4055),g=n(3871),b=n(3110),_=n(7072).set,w=n(8726),k=n(8384),x=n(5353),S=n(3807),E=n(5168),T=n(5247),O=n(3600),I=n(2574),C="Promise",R=O.CONSTRUCTOR,A=O.REJECTION_EVENT,P=O.SUBCLASSING,N=E.getterFor(C),L=E.set,M=T&&T.prototype,j=T,D=M,B=c.TypeError,U=c.document,F=c.process,H=I.f,G=H,W=!!(U&&U.createEvent&&c.dispatchEvent),q="unhandledrejection",V=function(e){var t;return!(!m(e)||!v(t=e.then))&&t},z=function(e,t){var n,r,i,o=t.value,s=1==t.state,a=s?e.ok:e.fail,u=e.resolve,c=e.reject,d=e.domain;try{a?(s||(2===t.rejection&&J(t),t.rejection=1),!0===a?n=o:(d&&d.enter(),n=a(o),d&&(d.exit(),i=!0)),n===e.promise?c(B("Promise-chain cycle")):(r=V(n))?l(r,n,u,c):u(n)):c(o)}catch(e){d&&!i&&d.exit(),c(e)}},Y=function(e,t){e.notified||(e.notified=!0,w((function(){for(var n,r=e.reactions;n=r.get();)z(n,e);e.notified=!1,t&&!e.rejection&&$(e)})))},K=function(e,t,n){var r,i;W?((r=U.createEvent("Event")).promise=t,r.reason=n,r.initEvent(e,!1,!0),c.dispatchEvent(r)):r={promise:t,reason:n},!A&&(i=c["on"+e])?i(r):e===q&&k("Unhandled promise rejection",n)},$=function(e){l(_,c,(function(){var t,n=e.facade,r=e.value;if(X(e)&&(t=x((function(){u?F.emit("unhandledRejection",r,n):K(q,n,r)})),e.rejection=u||X(e)?2:1,t.error))throw t.value}))},X=function(e){return 1!==e.rejection&&!e.parent},J=function(e){l(_,c,(function(){var t=e.facade;u?F.emit("rejectionHandled",t):K("rejectionhandled",t,e.value)}))},Z=function(e,t,n){return function(r){e(t,r,n)}},Q=function(e,t,n){e.done||(e.done=!0,n&&(e=n),e.value=t,e.state=2,Y(e,!0))},ee=function(e,t,n){if(!e.done){e.done=!0,n&&(e=n);try{if(e.facade===t)throw B("Promise can't be resolved itself");var r=V(t);r?w((function(){var n={done:!1};try{l(r,t,Z(ee,n,e),Z(Q,n,e))}catch(t){Q(n,t,e)}})):(e.value=t,e.state=1,Y(e,!1))}catch(t){Q({done:!1},t,e)}}};if(R&&(D=(j=function(e){g(this,D),y(e),l(r,this);var t=N(this);try{e(Z(ee,t),Z(Q,t))}catch(e){Q(t,e)}}).prototype,(r=function(e){L(this,{type:C,done:!1,notified:!1,parent:!1,reactions:new S,rejection:!1,state:0,value:void 0})}).prototype=d(D,"then",(function(e,t){var n=N(this),r=H(b(this,j));return n.parent=!0,r.ok=!v(e)||e,r.fail=v(t)&&t,r.domain=u?F.domain:void 0,0==n.state?n.reactions.add(r):w((function(){z(r,n)})),r.promise})),i=function(){var e=new r,t=N(e);this.promise=e,this.resolve=Z(ee,t),this.reject=Z(Q,t)},I.f=H=function(e){return e===j||undefined===e?new i(e):G(e)},!a&&v(T)&&M!==Object.prototype)){o=M.then,P||d(M,"then",(function(e,t){var n=this;return new j((function(e,t){l(o,n,e,t)})).then(e,t)}),{unsafe:!0});try{delete M.constructor}catch(e){}f&&f(M,D)}s({global:!0,constructor:!0,wrap:!0,forced:R},{Promise:j}),p(j,C,!1,!0),h(C)},5648:(e,t,n)=>{n(4343),n(9618),n(7529),n(4301),n(2704),n(8590)},4301:(e,t,n)=>{"use strict";var r=n(2176),i=n(9961),o=n(2084),s=n(2574),a=n(5353),u=n(1544);r({target:"Promise",stat:!0,forced:n(8303)},{race:function(e){var t=this,n=s.f(t),r=n.reject,c=a((function(){var s=o(t.resolve);u(e,(function(e){i(s,t,e).then(n.resolve,r)}))}));return c.error&&r(c.value),n.promise}})},2704:(e,t,n)=>{"use strict";var r=n(2176),i=n(9961),o=n(2574);r({target:"Promise",stat:!0,forced:n(3600).CONSTRUCTOR},{reject:function(e){var t=o.f(this);return i(t.reject,void 0,e),t.promise}})},8590:(e,t,n)=>{"use strict";var r=n(2176),i=n(6854),o=n(6985),s=n(5247),a=n(3600).CONSTRUCTOR,u=n(9086),c=i("Promise"),l=o&&!a;r({target:"Promise",stat:!0,forced:o||a},{resolve:function(e){return u(l&&this===c?s:this,e)}})},5664:(e,t,n)=>{var r=n(2176),i=n(6854),o=n(9084),s=n(1713),a=n(2437),u=n(4949),c=n(4055),l=n(9581),d=n(2374),f=i("Reflect","construct"),p=Object.prototype,h=[].push,y=d((function(){function e(){}return!(f((function(){}),[],e)instanceof e)})),v=!d((function(){f((function(){}))})),m=y||v;r({target:"Reflect",stat:!0,forced:m,sham:m},{construct:function(e,t){a(e),u(t);var n=arguments.length<3?e:a(arguments[2]);if(v&&!y)return f(e,t,n);if(e==n){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var r=[null];return o(h,r,t),new(o(s,e,r))}var i=n.prototype,d=l(c(i)?i:p),m=o(e,d,t);return c(m)?m:d}})},6564:(e,t,n)=>{"use strict";var r=n(2176),i=n(6911);r({target:"RegExp",proto:!0,forced:/./.exec!==i},{exec:i})},770:(e,t,n)=>{"use strict";var r=n(8977).PROPER,i=n(5686),o=n(4949),s=n(4640),a=n(2374),u=n(2494),c="toString",l=RegExp.prototype.toString,d=a((function(){return"/a/b"!=l.call({source:"a",flags:"b"})})),f=r&&l.name!=c;(d||f)&&i(RegExp.prototype,c,(function(){var e=o(this);return"/"+s(e.source)+"/"+s(u(e))}),{unsafe:!0})},4741:(e,t,n)=>{"use strict";n(7638)("Set",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),n(8907))},8270:(e,t,n)=>{n(4741)},4519:(e,t,n)=>{"use strict";var r=n(2176),i=n(286),o=n(9417),s=n(7618),a=n(4640),u=n(454),c=i("".indexOf);r({target:"String",proto:!0,forced:!u("includes")},{includes:function(e){return!!~c(a(s(this)),a(o(e)),arguments.length>1?arguments[1]:void 0)}})},8389:(e,t,n)=>{"use strict";var r=n(2042).charAt,i=n(4640),o=n(5168),s=n(5946),a="String Iterator",u=o.set,c=o.getterFor(a);s(String,"String",(function(e){u(this,{type:a,string:i(e),index:0})}),(function(){var e,t=c(this),n=t.string,i=t.index;return i>=n.length?{value:void 0,done:!0}:(e=r(n,i),t.index+=e.length,{value:e,done:!1})}))},6912:(e,t,n)=>{"use strict";var r=n(9961),i=n(5329),o=n(4949),s=n(4104),a=n(4640),u=n(7618),c=n(4355),l=n(9568),d=n(3666);i("match",(function(e,t,n){return[function(t){var n=u(this),i=null==t?void 0:c(t,e);return i?r(i,t,n):new RegExp(t)[e](a(n))},function(e){var r=o(this),i=a(e),u=n(t,r,i);if(u.done)return u.value;if(!r.global)return d(r,i);var c=r.unicode;r.lastIndex=0;for(var f,p=[],h=0;null!==(f=d(r,i));){var y=a(f[0]);p[h]=y,""===y&&(r.lastIndex=l(i,s(r.lastIndex),c)),h++}return 0===h?null:p}]}))},5169:(e,t,n)=>{"use strict";var r=n(9084),i=n(9961),o=n(286),s=n(5329),a=n(2374),u=n(4949),c=n(1314),l=n(3855),d=n(4104),f=n(4640),p=n(7618),h=n(9568),y=n(4355),v=n(5614),m=n(3666),g=n(9644)("replace"),b=Math.max,_=Math.min,w=o([].concat),k=o([].push),x=o("".indexOf),S=o("".slice),E="$0"==="a".replace(/./,"$0"),T=!!/./[g]&&""===/./[g]("a","$0");s("replace",(function(e,t,n){var o=T?"$":"$0";return[function(e,n){var r=p(this),o=null==e?void 0:y(e,g);return o?i(o,e,r,n):i(t,f(r),e,n)},function(e,i){var s=u(this),a=f(e);if("string"==typeof i&&-1===x(i,o)&&-1===x(i,"$<")){var p=n(t,s,a,i);if(p.done)return p.value}var y=c(i);y||(i=f(i));var g=s.global;if(g){var E=s.unicode;s.lastIndex=0}for(var T=[];;){var O=m(s,a);if(null===O)break;if(k(T,O),!g)break;""===f(O[0])&&(s.lastIndex=h(a,d(s.lastIndex),E))}for(var I,C="",R=0,A=0;A<T.length;A++){for(var P=f((O=T[A])[0]),N=b(_(l(O.index),a.length),0),L=[],M=1;M<O.length;M++)k(L,void 0===(I=O[M])?I:String(I));var j=O.groups;if(y){var D=w([P],L,N,a);void 0!==j&&k(D,j);var B=f(r(i,void 0,D))}else B=v(P,a,N,L,j,i);N>=R&&(C+=S(a,R,N)+B,R=N+P.length)}return C+S(a,R)}]}),!!a((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}))||!E||T)},2849:(e,t,n)=>{"use strict";var r=n(9961),i=n(5329),o=n(4949),s=n(7618),a=n(9058),u=n(4640),c=n(4355),l=n(3666);i("search",(function(e,t,n){return[function(t){var n=s(this),i=null==t?void 0:c(t,e);return i?r(i,t,n):new RegExp(t)[e](u(n))},function(e){var r=o(this),i=u(e),s=n(t,r,i);if(s.done)return s.value;var c=r.lastIndex;a(c,0)||(r.lastIndex=0);var d=l(r,i);return a(r.lastIndex,c)||(r.lastIndex=c),null===d?-1:d.index}]}))},740:(e,t,n)=>{"use strict";var r=n(9084),i=n(9961),o=n(286),s=n(5329),a=n(3595),u=n(4949),c=n(7618),l=n(3110),d=n(9568),f=n(4104),p=n(4640),h=n(4355),y=n(6430),v=n(3666),m=n(6911),g=n(1486),b=n(2374),_=g.UNSUPPORTED_Y,w=4294967295,k=Math.min,x=[].push,S=o(/./.exec),E=o(x),T=o("".slice);s("split",(function(e,t,n){var o;return o="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,n){var o=p(c(this)),s=void 0===n?w:n>>>0;if(0===s)return[];if(void 0===e)return[o];if(!a(e))return i(t,o,e,s);for(var u,l,d,f=[],h=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),v=0,g=new RegExp(e.source,h+"g");(u=i(m,g,o))&&!((l=g.lastIndex)>v&&(E(f,T(o,v,u.index)),u.length>1&&u.index<o.length&&r(x,f,y(u,1)),d=u[0].length,v=l,f.length>=s));)g.lastIndex===u.index&&g.lastIndex++;return v===o.length?!d&&S(g,"")||E(f,""):E(f,T(o,v)),f.length>s?y(f,0,s):f}:"0".split(void 0,0).length?function(e,n){return void 0===e&&0===n?[]:i(t,this,e,n)}:t,[function(t,n){var r=c(this),s=null==t?void 0:h(t,e);return s?i(s,t,r,n):i(o,p(r),t,n)},function(e,r){var i=u(this),s=p(e),a=n(o,i,s,r,o!==t);if(a.done)return a.value;var c=l(i,RegExp),h=i.unicode,y=(i.ignoreCase?"i":"")+(i.multiline?"m":"")+(i.unicode?"u":"")+(_?"g":"y"),m=new c(_?"^(?:"+i.source+")":i,y),g=void 0===r?w:r>>>0;if(0===g)return[];if(0===s.length)return null===v(m,s)?[s]:[];for(var b=0,x=0,S=[];x<s.length;){m.lastIndex=_?0:x;var O,I=v(m,_?T(s,x):s);if(null===I||(O=k(f(m.lastIndex+(_?x:0)),s.length))===b)x=d(s,x,h);else{if(E(S,T(s,b,x)),S.length===g)return S;for(var C=1;C<=I.length-1;C++)if(E(S,I[C]),S.length===g)return S;x=b=O}}return E(S,T(s,b)),S}]}),!!b((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var n="ab".split(e);return 2!==n.length||"a"!==n[0]||"b"!==n[1]})),_)},6571:(e,t,n)=>{"use strict";var r,i=n(2176),o=n(286),s=n(6653).f,a=n(4104),u=n(4640),c=n(9417),l=n(7618),d=n(454),f=n(6985),p=o("".startsWith),h=o("".slice),y=Math.min,v=d("startsWith");i({target:"String",proto:!0,forced:!!(f||v||(r=s(String.prototype,"startsWith"),!r||r.writable))&&!v},{startsWith:function(e){var t=u(l(this));c(e);var n=a(y(arguments.length>1?arguments[1]:void 0,t.length)),r=u(e);return p?p(t,r,n):h(t,n,n+r.length)===r}})},4933:(e,t,n)=>{"use strict";var r=n(2176),i=n(8312),o=n(9961),s=n(286),a=n(6985),u=n(4490),c=n(6591),l=n(2374),d=n(3431),f=n(3657),p=n(4949),h=n(981),y=n(3553),v=n(4640),m=n(6923),g=n(9581),b=n(765),_=n(8618),w=n(8830),k=n(8781),x=n(6653),S=n(1424),E=n(3004),T=n(3214),O=n(5686),I=n(9307),C=n(5440),R=n(2032),A=n(5834),P=n(9644),N=n(5145),L=n(6247),M=n(8597),j=n(737),D=n(5168),B=n(2213).forEach,U=C("hidden"),F="Symbol",H=D.set,G=D.getterFor(F),W=Object.prototype,q=i.Symbol,V=q&&q.prototype,z=i.TypeError,Y=i.QObject,K=x.f,$=S.f,X=w.f,J=T.f,Z=s([].push),Q=I("symbols"),ee=I("op-symbols"),te=I("wks"),ne=!Y||!Y.prototype||!Y.prototype.findChild,re=u&&l((function(){return 7!=g($({},"a",{get:function(){return $(this,"a",{value:7}).a}})).a}))?function(e,t,n){var r=K(W,t);r&&delete W[t],$(e,t,n),r&&e!==W&&$(W,t,r)}:$,ie=function(e,t){var n=Q[e]=g(V);return H(n,{type:F,tag:e,description:t}),u||(n.description=t),n},oe=function(e,t,n){e===W&&oe(ee,t,n),p(e);var r=y(t);return p(n),d(Q,r)?(n.enumerable?(d(e,U)&&e[U][r]&&(e[U][r]=!1),n=g(n,{enumerable:m(0,!1)})):(d(e,U)||$(e,U,m(1,{})),e[U][r]=!0),re(e,r,n)):$(e,r,n)},se=function(e,t){p(e);var n=h(t),r=b(n).concat(le(n));return B(r,(function(t){u&&!o(ae,n,t)||oe(e,t,n[t])})),e},ae=function(e){var t=y(e),n=o(J,this,t);return!(this===W&&d(Q,t)&&!d(ee,t))&&(!(n||!d(this,t)||!d(Q,t)||d(this,U)&&this[U][t])||n)},ue=function(e,t){var n=h(e),r=y(t);if(n!==W||!d(Q,r)||d(ee,r)){var i=K(n,r);return!i||!d(Q,r)||d(n,U)&&n[U][r]||(i.enumerable=!0),i}},ce=function(e){var t=X(h(e)),n=[];return B(t,(function(e){d(Q,e)||d(R,e)||Z(n,e)})),n},le=function(e){var t=e===W,n=X(t?ee:h(e)),r=[];return B(n,(function(e){!d(Q,e)||t&&!d(W,e)||Z(r,Q[e])})),r};c||(O(V=(q=function(){if(f(V,this))throw z("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?v(arguments[0]):void 0,t=A(e),n=function(e){this===W&&o(n,ee,e),d(this,U)&&d(this[U],t)&&(this[U][t]=!1),re(this,t,m(1,e))};return u&&ne&&re(W,t,{configurable:!0,set:n}),ie(t,e)}).prototype,"toString",(function(){return G(this).tag})),O(q,"withoutSetter",(function(e){return ie(A(e),e)})),T.f=ae,S.f=oe,E.f=se,x.f=ue,_.f=w.f=ce,k.f=le,N.f=function(e){return ie(P(e),e)},u&&($(V,"description",{configurable:!0,get:function(){return G(this).description}}),a||O(W,"propertyIsEnumerable",ae,{unsafe:!0}))),r({global:!0,constructor:!0,wrap:!0,forced:!c,sham:!c},{Symbol:q}),B(b(te),(function(e){L(e)})),r({target:F,stat:!0,forced:!c},{useSetter:function(){ne=!0},useSimple:function(){ne=!1}}),r({target:"Object",stat:!0,forced:!c,sham:!u},{create:function(e,t){return void 0===t?g(e):se(g(e),t)},defineProperty:oe,defineProperties:se,getOwnPropertyDescriptor:ue}),r({target:"Object",stat:!0,forced:!c},{getOwnPropertyNames:ce}),M(),j(q,F),R[U]=!0},711:(e,t,n)=>{"use strict";var r=n(2176),i=n(4490),o=n(8312),s=n(286),a=n(3431),u=n(1314),c=n(3657),l=n(4640),d=n(1424).f,f=n(9144),p=o.Symbol,h=p&&p.prototype;if(i&&u(p)&&(!("description"in h)||void 0!==p().description)){var y={},v=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:l(arguments[0]),t=c(h,this)?new p(e):void 0===e?p():p(e);return""===e&&(y[t]=!0),t};f(v,p),v.prototype=h,h.constructor=v;var m="Symbol(test)"==String(p("test")),g=s(h.toString),b=s(h.valueOf),_=/^Symbol\((.*)\)[^)]+$/,w=s("".replace),k=s("".slice);d(h,"description",{configurable:!0,get:function(){var e=b(this),t=g(e);if(a(y,e))return"";var n=m?k(t,7,-1):w(t,_,"$1");return""===n?void 0:n}}),r({global:!0,constructor:!0,forced:!0},{Symbol:v})}},4914:(e,t,n)=>{var r=n(2176),i=n(6854),o=n(3431),s=n(4640),a=n(9307),u=n(1420),c=a("string-to-symbol-registry"),l=a("symbol-to-string-registry");r({target:"Symbol",stat:!0,forced:!u},{for:function(e){var t=s(e);if(o(c,t))return c[t];var n=i("Symbol")(t);return c[t]=n,l[n]=t,n}})},6909:(e,t,n)=>{n(6247)("iterator")},5857:(e,t,n)=>{n(4933),n(4914),n(9440),n(3454),n(4776)},9440:(e,t,n)=>{var r=n(2176),i=n(3431),o=n(8723),s=n(824),a=n(9307),u=n(1420),c=a("symbol-to-string-registry");r({target:"Symbol",stat:!0,forced:!u},{keyFor:function(e){if(!o(e))throw TypeError(s(e)+" is not a symbol");if(i(c,e))return c[e]}})},2171:(e,t,n)=>{"use strict";var r=n(286),i=n(3978),o=r(n(3086)),s=i.aTypedArray;(0,i.exportTypedArrayMethod)("copyWithin",(function(e,t){return o(s(this),e,t,arguments.length>2?arguments[2]:void 0)}))},1186:(e,t,n)=>{"use strict";var r=n(3978),i=n(2213).every,o=r.aTypedArray;(0,r.exportTypedArrayMethod)("every",(function(e){return i(o(this),e,arguments.length>1?arguments[1]:void 0)}))},9423:(e,t,n)=>{"use strict";var r=n(3978),i=n(9961),o=n(6228),s=r.aTypedArray;(0,r.exportTypedArrayMethod)("fill",(function(e){var t=arguments.length;return i(o,s(this),e,t>1?arguments[1]:void 0,t>2?arguments[2]:void 0)}))},7675:(e,t,n)=>{"use strict";var r=n(3978),i=n(2213).filter,o=n(8076),s=r.aTypedArray;(0,r.exportTypedArrayMethod)("filter",(function(e){var t=i(s(this),e,arguments.length>1?arguments[1]:void 0);return o(this,t)}))},9477:(e,t,n)=>{"use strict";var r=n(3978),i=n(2213).findIndex,o=r.aTypedArray;(0,r.exportTypedArrayMethod)("findIndex",(function(e){return i(o(this),e,arguments.length>1?arguments[1]:void 0)}))},9514:(e,t,n)=>{"use strict";var r=n(3978),i=n(2213).find,o=r.aTypedArray;(0,r.exportTypedArrayMethod)("find",(function(e){return i(o(this),e,arguments.length>1?arguments[1]:void 0)}))},9934:(e,t,n)=>{"use strict";var r=n(3978),i=n(2213).forEach,o=r.aTypedArray;(0,r.exportTypedArrayMethod)("forEach",(function(e){i(o(this),e,arguments.length>1?arguments[1]:void 0)}))},8513:(e,t,n)=>{"use strict";var r=n(3978),i=n(4013).includes,o=r.aTypedArray;(0,r.exportTypedArrayMethod)("includes",(function(e){return i(o(this),e,arguments.length>1?arguments[1]:void 0)}))},9272:(e,t,n)=>{"use strict";var r=n(3978),i=n(4013).indexOf,o=r.aTypedArray;(0,r.exportTypedArrayMethod)("indexOf",(function(e){return i(o(this),e,arguments.length>1?arguments[1]:void 0)}))},2946:(e,t,n)=>{"use strict";var r=n(8312),i=n(2374),o=n(286),s=n(3978),a=n(7583),u=n(9644)("iterator"),c=r.Uint8Array,l=o(a.values),d=o(a.keys),f=o(a.entries),p=s.aTypedArray,h=s.exportTypedArrayMethod,y=c&&c.prototype,v=!i((function(){y[u].call([1])})),m=!!y&&y.values&&y[u]===y.values&&"values"===y.values.name,g=function(){return l(p(this))};h("entries",(function(){return f(p(this))}),v),h("keys",(function(){return d(p(this))}),v),h("values",g,v||!m,{name:"values"}),h(u,g,v||!m,{name:"values"})},6994:(e,t,n)=>{"use strict";var r=n(3978),i=n(286),o=r.aTypedArray,s=r.exportTypedArrayMethod,a=i([].join);s("join",(function(e){return a(o(this),e)}))},9566:(e,t,n)=>{"use strict";var r=n(3978),i=n(9084),o=n(2264),s=r.aTypedArray;(0,r.exportTypedArrayMethod)("lastIndexOf",(function(e){var t=arguments.length;return i(o,s(this),t>1?[e,arguments[1]]:[e])}))},5360:(e,t,n)=>{"use strict";var r=n(3978),i=n(2213).map,o=n(8656),s=r.aTypedArray;(0,r.exportTypedArrayMethod)("map",(function(e){return i(s(this),e,arguments.length>1?arguments[1]:void 0,(function(e,t){return new(o(e))(t)}))}))},4123:(e,t,n)=>{"use strict";var r=n(3978),i=n(9364).right,o=r.aTypedArray;(0,r.exportTypedArrayMethod)("reduceRight",(function(e){var t=arguments.length;return i(o(this),e,t,t>1?arguments[1]:void 0)}))},5132:(e,t,n)=>{"use strict";var r=n(3978),i=n(9364).left,o=r.aTypedArray;(0,r.exportTypedArrayMethod)("reduce",(function(e){var t=arguments.length;return i(o(this),e,t,t>1?arguments[1]:void 0)}))},1024:(e,t,n)=>{"use strict";var r=n(3978),i=r.aTypedArray,o=r.exportTypedArrayMethod,s=Math.floor;o("reverse",(function(){for(var e,t=this,n=i(t).length,r=s(n/2),o=0;o<r;)e=t[o],t[o++]=t[--n],t[n]=e;return t}))},3957:(e,t,n)=>{"use strict";var r=n(8312),i=n(9961),o=n(3978),s=n(8996),a=n(378),u=n(3922),c=n(2374),l=r.RangeError,d=r.Int8Array,f=d&&d.prototype,p=f&&f.set,h=o.aTypedArray,y=o.exportTypedArrayMethod,v=!c((function(){var e=new Uint8ClampedArray(2);return i(p,e,{length:1,0:3},1),3!==e[1]})),m=v&&o.NATIVE_ARRAY_BUFFER_VIEWS&&c((function(){var e=new d(2);return e.set(1),e.set("2",1),0!==e[0]||2!==e[1]}));y("set",(function(e){h(this);var t=a(arguments.length>1?arguments[1]:void 0,1),n=u(e);if(v)return i(p,this,n,t);var r=this.length,o=s(n),c=0;if(o+t>r)throw l("Wrong length");for(;c<o;)this[t+c]=n[c++]}),!v||m)},4255:(e,t,n)=>{"use strict";var r=n(3978),i=n(8656),o=n(2374),s=n(2808),a=r.aTypedArray;(0,r.exportTypedArrayMethod)("slice",(function(e,t){for(var n=s(a(this),e,t),r=i(this),o=0,u=n.length,c=new r(u);u>o;)c[o]=n[o++];return c}),o((function(){new Int8Array(1).slice()})))},1697:(e,t,n)=>{"use strict";var r=n(3978),i=n(2213).some,o=r.aTypedArray;(0,r.exportTypedArrayMethod)("some",(function(e){return i(o(this),e,arguments.length>1?arguments[1]:void 0)}))},7114:(e,t,n)=>{"use strict";var r=n(8312),i=n(286),o=n(2374),s=n(2084),a=n(3800),u=n(3978),c=n(9648),l=n(6415),d=n(8351),f=n(5579),p=u.aTypedArray,h=u.exportTypedArrayMethod,y=r.Uint16Array,v=y&&i(y.prototype.sort),m=!(!v||o((function(){v(new y(2),null)}))&&o((function(){v(new y(2),{})}))),g=!!v&&!o((function(){if(d)return d<74;if(c)return c<67;if(l)return!0;if(f)return f<602;var e,t,n=new y(516),r=Array(516);for(e=0;e<516;e++)t=e%4,n[e]=515-e,r[e]=e-2*t+3;for(v(n,(function(e,t){return(e/4|0)-(t/4|0)})),e=0;e<516;e++)if(n[e]!==r[e])return!0}));h("sort",(function(e){return void 0!==e&&s(e),g?v(this,e):a(p(this),function(e){return function(t,n){return void 0!==e?+e(t,n)||0:n!=n?-1:t!=t?1:0===t&&0===n?1/t>0&&1/n<0?1:-1:t>n}}(e))}),!g||m)},1761:(e,t,n)=>{"use strict";var r=n(3978),i=n(4104),o=n(1092),s=n(8656),a=r.aTypedArray;(0,r.exportTypedArrayMethod)("subarray",(function(e,t){var n=a(this),r=n.length,u=o(e,r);return new(s(n))(n.buffer,n.byteOffset+u*n.BYTES_PER_ELEMENT,i((void 0===t?r:o(t,r))-u))}))},6163:(e,t,n)=>{"use strict";var r=n(8312),i=n(9084),o=n(3978),s=n(2374),a=n(2808),u=r.Int8Array,c=o.aTypedArray,l=o.exportTypedArrayMethod,d=[].toLocaleString,f=!!u&&s((function(){d.call(new u(1))}));l("toLocaleString",(function(){return i(d,f?a(c(this)):c(this),a(arguments))}),s((function(){return[1,2].toLocaleString()!=new u([1,2]).toLocaleString()}))||!s((function(){u.prototype.toLocaleString.call([1,2])})))},4362:(e,t,n)=>{"use strict";var r=n(3978).exportTypedArrayMethod,i=n(2374),o=n(8312),s=n(286),a=o.Uint8Array,u=a&&a.prototype||{},c=[].toString,l=s([].join);i((function(){c.call({})}))&&(c=function(){return l(this)});var d=u.toString!=c;r("toString",c,d)},6607:(e,t,n)=>{n(9052)("Uint8",(function(e){return function(t,n,r){return e(this,t,n,r)}}))},6029:(e,t,n)=>{var r=n(8312),i=n(2763),o=n(6274),s=n(9810),a=n(3647),u=function(e){if(e&&e.forEach!==s)try{a(e,"forEach",s)}catch(t){e.forEach=s}};for(var c in i)i[c]&&u(r[c]&&r[c].prototype);u(o)},2502:(e,t,n)=>{var r=n(8312),i=n(2763),o=n(6274),s=n(7583),a=n(3647),u=n(9644),c=u("iterator"),l=u("toStringTag"),d=s.values,f=function(e,t){if(e){if(e[c]!==d)try{a(e,c,d)}catch(t){e[c]=d}if(e[l]||a(e,l,t),i[t])for(var n in s)if(e[n]!==s[n])try{a(e,n,s[n])}catch(t){e[n]=s[n]}}};for(var p in i)f(r[p]&&r[p].prototype,p);f(o,"DOMTokenList")},2636:(e,t,n)=>{"use strict";n(7583);var r=n(2176),i=n(8312),o=n(9961),s=n(286),a=n(4490),u=n(9130),c=n(5686),l=n(1813),d=n(737),f=n(8600),p=n(5168),h=n(3871),y=n(1314),v=n(3431),m=n(386),g=n(18),b=n(4949),_=n(4055),w=n(4640),k=n(9581),x=n(6923),S=n(1354),E=n(2143),T=n(1058),O=n(9644),I=n(3800),C=O("iterator"),R="URLSearchParams",A="URLSearchParamsIterator",P=p.set,N=p.getterFor(R),L=p.getterFor(A),M=Object.getOwnPropertyDescriptor,j=function(e){if(!a)return i[e];var t=M(i,e);return t&&t.value},D=j("fetch"),B=j("Request"),U=j("Headers"),F=B&&B.prototype,H=U&&U.prototype,G=i.RegExp,W=i.TypeError,q=i.decodeURIComponent,V=i.encodeURIComponent,z=s("".charAt),Y=s([].join),K=s([].push),$=s("".replace),X=s([].shift),J=s([].splice),Z=s("".split),Q=s("".slice),ee=/\+/g,te=Array(4),ne=function(e){return te[e-1]||(te[e-1]=G("((?:%[\\da-f]{2}){"+e+"})","gi"))},re=function(e){try{return q(e)}catch(t){return e}},ie=function(e){var t=$(e,ee," "),n=4;try{return q(t)}catch(e){for(;n;)t=$(t,ne(n--),re);return t}},oe=/[!'()~]|%20/g,se={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},ae=function(e){return se[e]},ue=function(e){return $(V(e),oe,ae)},ce=f((function(e,t){P(this,{type:A,iterator:S(N(e).entries),kind:t})}),"Iterator",(function(){var e=L(this),t=e.kind,n=e.iterator.next(),r=n.value;return n.done||(n.value="keys"===t?r.key:"values"===t?r.value:[r.key,r.value]),n}),!0),le=function(e){this.entries=[],this.url=null,void 0!==e&&(_(e)?this.parseObject(e):this.parseQuery("string"==typeof e?"?"===z(e,0)?Q(e,1):e:w(e)))};le.prototype={type:R,bindURL:function(e){this.url=e,this.update()},parseObject:function(e){var t,n,r,i,s,a,u,c=E(e);if(c)for(n=(t=S(e,c)).next;!(r=o(n,t)).done;){if(s=(i=S(b(r.value))).next,(a=o(s,i)).done||(u=o(s,i)).done||!o(s,i).done)throw W("Expected sequence with length 2");K(this.entries,{key:w(a.value),value:w(u.value)})}else for(var l in e)v(e,l)&&K(this.entries,{key:l,value:w(e[l])})},parseQuery:function(e){if(e)for(var t,n,r=Z(e,"&"),i=0;i<r.length;)(t=r[i++]).length&&(n=Z(t,"="),K(this.entries,{key:ie(X(n)),value:ie(Y(n,"="))}))},serialize:function(){for(var e,t=this.entries,n=[],r=0;r<t.length;)e=t[r++],K(n,ue(e.key)+"="+ue(e.value));return Y(n,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var de=function(){h(this,fe);var e=arguments.length>0?arguments[0]:void 0;P(this,new le(e))},fe=de.prototype;if(l(fe,{append:function(e,t){T(arguments.length,2);var n=N(this);K(n.entries,{key:w(e),value:w(t)}),n.updateURL()},delete:function(e){T(arguments.length,1);for(var t=N(this),n=t.entries,r=w(e),i=0;i<n.length;)n[i].key===r?J(n,i,1):i++;t.updateURL()},get:function(e){T(arguments.length,1);for(var t=N(this).entries,n=w(e),r=0;r<t.length;r++)if(t[r].key===n)return t[r].value;return null},getAll:function(e){T(arguments.length,1);for(var t=N(this).entries,n=w(e),r=[],i=0;i<t.length;i++)t[i].key===n&&K(r,t[i].value);return r},has:function(e){T(arguments.length,1);for(var t=N(this).entries,n=w(e),r=0;r<t.length;)if(t[r++].key===n)return!0;return!1},set:function(e,t){T(arguments.length,1);for(var n,r=N(this),i=r.entries,o=!1,s=w(e),a=w(t),u=0;u<i.length;u++)(n=i[u]).key===s&&(o?J(i,u--,1):(o=!0,n.value=a));o||K(i,{key:s,value:a}),r.updateURL()},sort:function(){var e=N(this);I(e.entries,(function(e,t){return e.key>t.key?1:-1})),e.updateURL()},forEach:function(e){for(var t,n=N(this).entries,r=m(e,arguments.length>1?arguments[1]:void 0),i=0;i<n.length;)r((t=n[i++]).value,t.key,this)},keys:function(){return new ce(this,"keys")},values:function(){return new ce(this,"values")},entries:function(){return new ce(this,"entries")}},{enumerable:!0}),c(fe,C,fe.entries,{name:"entries"}),c(fe,"toString",(function(){return N(this).serialize()}),{enumerable:!0}),d(de,R),r({global:!0,constructor:!0,forced:!u},{URLSearchParams:de}),!u&&y(U)){var pe=s(H.has),he=s(H.set),ye=function(e){if(_(e)){var t,n=e.body;if(g(n)===R)return t=e.headers?new U(e.headers):new U,pe(t,"content-type")||he(t,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),k(e,{body:x(0,w(n)),headers:x(0,t)})}return e};if(y(D)&&r({global:!0,enumerable:!0,dontCallGetSet:!0,forced:!0},{fetch:function(e){return D(e,arguments.length>1?ye(arguments[1]):{})}}),y(B)){var ve=function(e){return h(this,F),new B(e,arguments.length>1?ye(arguments[1]):{})};F.constructor=ve,ve.prototype=F,r({global:!0,constructor:!0,dontCallGetSet:!0,forced:!0},{Request:ve})}}e.exports={URLSearchParams:de,getState:N}},6577:(e,t,n)=>{"use strict";n(8389);var r,i=n(2176),o=n(4490),s=n(9130),a=n(8312),u=n(386),c=n(286),l=n(5686),d=n(8132),f=n(3871),p=n(3431),h=n(3991),y=n(4070),v=n(6430),m=n(2042).codeAt,g=n(7393),b=n(4640),_=n(737),w=n(1058),k=n(2636),x=n(5168),S=x.set,E=x.getterFor("URL"),T=k.URLSearchParams,O=k.getState,I=a.URL,C=a.TypeError,R=a.parseInt,A=Math.floor,P=Math.pow,N=c("".charAt),L=c(/./.exec),M=c([].join),j=c(1..toString),D=c([].pop),B=c([].push),U=c("".replace),F=c([].shift),H=c("".split),G=c("".slice),W=c("".toLowerCase),q=c([].unshift),V="Invalid scheme",z="Invalid host",Y="Invalid port",K=/[a-z]/i,$=/[\d+-.a-z]/i,X=/\d/,J=/^0x/i,Z=/^[0-7]+$/,Q=/^\d+$/,ee=/^[\da-f]+$/i,te=/[\0\t\n\r #%/:<>?@[\\\]^|]/,ne=/[\0\t\n\r #/:<>?@[\\\]^|]/,re=/^[\u0000-\u0020]+|[\u0000-\u0020]+$/g,ie=/[\t\n\r]/g,oe=function(e){var t,n,r,i;if("number"==typeof e){for(t=[],n=0;n<4;n++)q(t,e%256),e=A(e/256);return M(t,".")}if("object"==typeof e){for(t="",r=function(e){for(var t=null,n=1,r=null,i=0,o=0;o<8;o++)0!==e[o]?(i>n&&(t=r,n=i),r=null,i=0):(null===r&&(r=o),++i);return i>n&&(t=r,n=i),t}(e),n=0;n<8;n++)i&&0===e[n]||(i&&(i=!1),r===n?(t+=n?":":"::",i=!0):(t+=j(e[n],16),n<7&&(t+=":")));return"["+t+"]"}return e},se={},ae=h({},se,{" ":1,'"':1,"<":1,">":1,"`":1}),ue=h({},ae,{"#":1,"?":1,"{":1,"}":1}),ce=h({},ue,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),le=function(e,t){var n=m(e,0);return n>32&&n<127&&!p(t,e)?e:encodeURIComponent(e)},de={ftp:21,file:null,http:80,https:443,ws:80,wss:443},fe=function(e,t){var n;return 2==e.length&&L(K,N(e,0))&&(":"==(n=N(e,1))||!t&&"|"==n)},pe=function(e){var t;return e.length>1&&fe(G(e,0,2))&&(2==e.length||"/"===(t=N(e,2))||"\\"===t||"?"===t||"#"===t)},he=function(e){return"."===e||"%2e"===W(e)},ye={},ve={},me={},ge={},be={},_e={},we={},ke={},xe={},Se={},Ee={},Te={},Oe={},Ie={},Ce={},Re={},Ae={},Pe={},Ne={},Le={},Me={},je=function(e,t,n){var r,i,o,s=b(e);if(t){if(i=this.parse(s))throw C(i);this.searchParams=null}else{if(void 0!==n&&(r=new je(n,!0)),i=this.parse(s,null,r))throw C(i);(o=O(new T)).bindURL(this),this.searchParams=o}};je.prototype={type:"URL",parse:function(e,t,n){var i,o,s,a,u,c=this,l=t||ye,d=0,f="",h=!1,m=!1,g=!1;for(e=b(e),t||(c.scheme="",c.username="",c.password="",c.host=null,c.port=null,c.path=[],c.query=null,c.fragment=null,c.cannotBeABaseURL=!1,e=U(e,re,"")),e=U(e,ie,""),i=y(e);d<=i.length;){switch(o=i[d],l){case ye:if(!o||!L(K,o)){if(t)return V;l=me;continue}f+=W(o),l=ve;break;case ve:if(o&&(L($,o)||"+"==o||"-"==o||"."==o))f+=W(o);else{if(":"!=o){if(t)return V;f="",l=me,d=0;continue}if(t&&(c.isSpecial()!=p(de,f)||"file"==f&&(c.includesCredentials()||null!==c.port)||"file"==c.scheme&&!c.host))return;if(c.scheme=f,t)return void(c.isSpecial()&&de[c.scheme]==c.port&&(c.port=null));f="","file"==c.scheme?l=Ie:c.isSpecial()&&n&&n.scheme==c.scheme?l=ge:c.isSpecial()?l=ke:"/"==i[d+1]?(l=be,d++):(c.cannotBeABaseURL=!0,B(c.path,""),l=Ne)}break;case me:if(!n||n.cannotBeABaseURL&&"#"!=o)return V;if(n.cannotBeABaseURL&&"#"==o){c.scheme=n.scheme,c.path=v(n.path),c.query=n.query,c.fragment="",c.cannotBeABaseURL=!0,l=Me;break}l="file"==n.scheme?Ie:_e;continue;case ge:if("/"!=o||"/"!=i[d+1]){l=_e;continue}l=xe,d++;break;case be:if("/"==o){l=Se;break}l=Pe;continue;case _e:if(c.scheme=n.scheme,o==r)c.username=n.username,c.password=n.password,c.host=n.host,c.port=n.port,c.path=v(n.path),c.query=n.query;else if("/"==o||"\\"==o&&c.isSpecial())l=we;else if("?"==o)c.username=n.username,c.password=n.password,c.host=n.host,c.port=n.port,c.path=v(n.path),c.query="",l=Le;else{if("#"!=o){c.username=n.username,c.password=n.password,c.host=n.host,c.port=n.port,c.path=v(n.path),c.path.length--,l=Pe;continue}c.username=n.username,c.password=n.password,c.host=n.host,c.port=n.port,c.path=v(n.path),c.query=n.query,c.fragment="",l=Me}break;case we:if(!c.isSpecial()||"/"!=o&&"\\"!=o){if("/"!=o){c.username=n.username,c.password=n.password,c.host=n.host,c.port=n.port,l=Pe;continue}l=Se}else l=xe;break;case ke:if(l=xe,"/"!=o||"/"!=N(f,d+1))continue;d++;break;case xe:if("/"!=o&&"\\"!=o){l=Se;continue}break;case Se:if("@"==o){h&&(f="%40"+f),h=!0,s=y(f);for(var _=0;_<s.length;_++){var w=s[_];if(":"!=w||g){var k=le(w,ce);g?c.password+=k:c.username+=k}else g=!0}f=""}else if(o==r||"/"==o||"?"==o||"#"==o||"\\"==o&&c.isSpecial()){if(h&&""==f)return"Invalid authority";d-=y(f).length+1,f="",l=Ee}else f+=o;break;case Ee:case Te:if(t&&"file"==c.scheme){l=Re;continue}if(":"!=o||m){if(o==r||"/"==o||"?"==o||"#"==o||"\\"==o&&c.isSpecial()){if(c.isSpecial()&&""==f)return z;if(t&&""==f&&(c.includesCredentials()||null!==c.port))return;if(a=c.parseHost(f))return a;if(f="",l=Ae,t)return;continue}"["==o?m=!0:"]"==o&&(m=!1),f+=o}else{if(""==f)return z;if(a=c.parseHost(f))return a;if(f="",l=Oe,t==Te)return}break;case Oe:if(!L(X,o)){if(o==r||"/"==o||"?"==o||"#"==o||"\\"==o&&c.isSpecial()||t){if(""!=f){var x=R(f,10);if(x>65535)return Y;c.port=c.isSpecial()&&x===de[c.scheme]?null:x,f=""}if(t)return;l=Ae;continue}return Y}f+=o;break;case Ie:if(c.scheme="file","/"==o||"\\"==o)l=Ce;else{if(!n||"file"!=n.scheme){l=Pe;continue}if(o==r)c.host=n.host,c.path=v(n.path),c.query=n.query;else if("?"==o)c.host=n.host,c.path=v(n.path),c.query="",l=Le;else{if("#"!=o){pe(M(v(i,d),""))||(c.host=n.host,c.path=v(n.path),c.shortenPath()),l=Pe;continue}c.host=n.host,c.path=v(n.path),c.query=n.query,c.fragment="",l=Me}}break;case Ce:if("/"==o||"\\"==o){l=Re;break}n&&"file"==n.scheme&&!pe(M(v(i,d),""))&&(fe(n.path[0],!0)?B(c.path,n.path[0]):c.host=n.host),l=Pe;continue;case Re:if(o==r||"/"==o||"\\"==o||"?"==o||"#"==o){if(!t&&fe(f))l=Pe;else if(""==f){if(c.host="",t)return;l=Ae}else{if(a=c.parseHost(f))return a;if("localhost"==c.host&&(c.host=""),t)return;f="",l=Ae}continue}f+=o;break;case Ae:if(c.isSpecial()){if(l=Pe,"/"!=o&&"\\"!=o)continue}else if(t||"?"!=o)if(t||"#"!=o){if(o!=r&&(l=Pe,"/"!=o))continue}else c.fragment="",l=Me;else c.query="",l=Le;break;case Pe:if(o==r||"/"==o||"\\"==o&&c.isSpecial()||!t&&("?"==o||"#"==o)){if(".."===(u=W(u=f))||"%2e."===u||".%2e"===u||"%2e%2e"===u?(c.shortenPath(),"/"==o||"\\"==o&&c.isSpecial()||B(c.path,"")):he(f)?"/"==o||"\\"==o&&c.isSpecial()||B(c.path,""):("file"==c.scheme&&!c.path.length&&fe(f)&&(c.host&&(c.host=""),f=N(f,0)+":"),B(c.path,f)),f="","file"==c.scheme&&(o==r||"?"==o||"#"==o))for(;c.path.length>1&&""===c.path[0];)F(c.path);"?"==o?(c.query="",l=Le):"#"==o&&(c.fragment="",l=Me)}else f+=le(o,ue);break;case Ne:"?"==o?(c.query="",l=Le):"#"==o?(c.fragment="",l=Me):o!=r&&(c.path[0]+=le(o,se));break;case Le:t||"#"!=o?o!=r&&("'"==o&&c.isSpecial()?c.query+="%27":c.query+="#"==o?"%23":le(o,se)):(c.fragment="",l=Me);break;case Me:o!=r&&(c.fragment+=le(o,ae))}d++}},parseHost:function(e){var t,n,r;if("["==N(e,0)){if("]"!=N(e,e.length-1))return z;if(t=function(e){var t,n,r,i,o,s,a,u=[0,0,0,0,0,0,0,0],c=0,l=null,d=0,f=function(){return N(e,d)};if(":"==f()){if(":"!=N(e,1))return;d+=2,l=++c}for(;f();){if(8==c)return;if(":"!=f()){for(t=n=0;n<4&&L(ee,f());)t=16*t+R(f(),16),d++,n++;if("."==f()){if(0==n)return;if(d-=n,c>6)return;for(r=0;f();){if(i=null,r>0){if(!("."==f()&&r<4))return;d++}if(!L(X,f()))return;for(;L(X,f());){if(o=R(f(),10),null===i)i=o;else{if(0==i)return;i=10*i+o}if(i>255)return;d++}u[c]=256*u[c]+i,2!=++r&&4!=r||c++}if(4!=r)return;break}if(":"==f()){if(d++,!f())return}else if(f())return;u[c++]=t}else{if(null!==l)return;d++,l=++c}}if(null!==l)for(s=c-l,c=7;0!=c&&s>0;)a=u[c],u[c--]=u[l+s-1],u[l+--s]=a;else if(8!=c)return;return u}(G(e,1,-1)),!t)return z;this.host=t}else if(this.isSpecial()){if(e=g(e),L(te,e))return z;if(t=function(e){var t,n,r,i,o,s,a,u=H(e,".");if(u.length&&""==u[u.length-1]&&u.length--,(t=u.length)>4)return e;for(n=[],r=0;r<t;r++){if(""==(i=u[r]))return e;if(o=10,i.length>1&&"0"==N(i,0)&&(o=L(J,i)?16:8,i=G(i,8==o?1:2)),""===i)s=0;else{if(!L(10==o?Q:8==o?Z:ee,i))return e;s=R(i,o)}B(n,s)}for(r=0;r<t;r++)if(s=n[r],r==t-1){if(s>=P(256,5-t))return null}else if(s>255)return null;for(a=D(n),r=0;r<n.length;r++)a+=n[r]*P(256,3-r);return a}(e),null===t)return z;this.host=t}else{if(L(ne,e))return z;for(t="",n=y(e),r=0;r<n.length;r++)t+=le(n[r],se);this.host=t}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||"file"==this.scheme},includesCredentials:function(){return""!=this.username||""!=this.password},isSpecial:function(){return p(de,this.scheme)},shortenPath:function(){var e=this.path,t=e.length;!t||"file"==this.scheme&&1==t&&fe(e[0],!0)||e.length--},serialize:function(){var e=this,t=e.scheme,n=e.username,r=e.password,i=e.host,o=e.port,s=e.path,a=e.query,u=e.fragment,c=t+":";return null!==i?(c+="//",e.includesCredentials()&&(c+=n+(r?":"+r:"")+"@"),c+=oe(i),null!==o&&(c+=":"+o)):"file"==t&&(c+="//"),c+=e.cannotBeABaseURL?s[0]:s.length?"/"+M(s,"/"):"",null!==a&&(c+="?"+a),null!==u&&(c+="#"+u),c},setHref:function(e){var t=this.parse(e);if(t)throw C(t);this.searchParams.update()},getOrigin:function(){var e=this.scheme,t=this.port;if("blob"==e)try{return new De(e.path[0]).origin}catch(e){return"null"}return"file"!=e&&this.isSpecial()?e+"://"+oe(this.host)+(null!==t?":"+t:""):"null"},getProtocol:function(){return this.scheme+":"},setProtocol:function(e){this.parse(b(e)+":",ye)},getUsername:function(){return this.username},setUsername:function(e){var t=y(b(e));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var n=0;n<t.length;n++)this.username+=le(t[n],ce)}},getPassword:function(){return this.password},setPassword:function(e){var t=y(b(e));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var n=0;n<t.length;n++)this.password+=le(t[n],ce)}},getHost:function(){var e=this.host,t=this.port;return null===e?"":null===t?oe(e):oe(e)+":"+t},setHost:function(e){this.cannotBeABaseURL||this.parse(e,Ee)},getHostname:function(){var e=this.host;return null===e?"":oe(e)},setHostname:function(e){this.cannotBeABaseURL||this.parse(e,Te)},getPort:function(){var e=this.port;return null===e?"":b(e)},setPort:function(e){this.cannotHaveUsernamePasswordPort()||(""==(e=b(e))?this.port=null:this.parse(e,Oe))},getPathname:function(){var e=this.path;return this.cannotBeABaseURL?e[0]:e.length?"/"+M(e,"/"):""},setPathname:function(e){this.cannotBeABaseURL||(this.path=[],this.parse(e,Ae))},getSearch:function(){var e=this.query;return e?"?"+e:""},setSearch:function(e){""==(e=b(e))?this.query=null:("?"==N(e,0)&&(e=G(e,1)),this.query="",this.parse(e,Le)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var e=this.fragment;return e?"#"+e:""},setHash:function(e){""!=(e=b(e))?("#"==N(e,0)&&(e=G(e,1)),this.fragment="",this.parse(e,Me)):this.fragment=null},update:function(){this.query=this.searchParams.serialize()||null}};var De=function(e){var t=f(this,Be),n=w(arguments.length,1)>1?arguments[1]:void 0,r=S(t,new je(e,!1,n));o||(t.href=r.serialize(),t.origin=r.getOrigin(),t.protocol=r.getProtocol(),t.username=r.getUsername(),t.password=r.getPassword(),t.host=r.getHost(),t.hostname=r.getHostname(),t.port=r.getPort(),t.pathname=r.getPathname(),t.search=r.getSearch(),t.searchParams=r.getSearchParams(),t.hash=r.getHash())},Be=De.prototype,Ue=function(e,t){return{get:function(){return E(this)[e]()},set:t&&function(e){return E(this)[t](e)},configurable:!0,enumerable:!0}};if(o&&(d(Be,"href",Ue("serialize","setHref")),d(Be,"origin",Ue("getOrigin")),d(Be,"protocol",Ue("getProtocol","setProtocol")),d(Be,"username",Ue("getUsername","setUsername")),d(Be,"password",Ue("getPassword","setPassword")),d(Be,"host",Ue("getHost","setHost")),d(Be,"hostname",Ue("getHostname","setHostname")),d(Be,"port",Ue("getPort","setPort")),d(Be,"pathname",Ue("getPathname","setPathname")),d(Be,"search",Ue("getSearch","setSearch")),d(Be,"searchParams",Ue("getSearchParams")),d(Be,"hash",Ue("getHash","setHash"))),l(Be,"toJSON",(function(){return E(this).serialize()}),{enumerable:!0}),l(Be,"toString",(function(){return E(this).serialize()}),{enumerable:!0}),I){var Fe=I.createObjectURL,He=I.revokeObjectURL;Fe&&l(De,"createObjectURL",u(Fe,I)),He&&l(De,"revokeObjectURL",u(He,I))}_(De,"URL"),i({global:!0,constructor:!0,forced:!s,sham:!o},{URL:De})},4912:(e,t,n)=>{n(6577)},6297:(e,t,n)=>{"use strict";var r=n(2024),i={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},o={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},s={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},a={};function u(e){return r.isMemo(e)?s:a[e.$$typeof]||i}a[r.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},a[r.Memo]=s;var c=Object.defineProperty,l=Object.getOwnPropertyNames,d=Object.getOwnPropertySymbols,f=Object.getOwnPropertyDescriptor,p=Object.getPrototypeOf,h=Object.prototype;e.exports=function e(t,n,r){if("string"!=typeof n){if(h){var i=p(n);i&&i!==h&&e(t,i,r)}var s=l(n);d&&(s=s.concat(d(n)));for(var a=u(t),y=u(n),v=0;v<s.length;++v){var m=s[v];if(!(o[m]||r&&r[m]||y&&y[m]||a&&a[m])){var g=f(n,m);try{c(t,m,g)}catch(e){}}}}return t}},528:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=["weeks","years","months","days","hours","minutes","seconds"],r=t.pattern=new RegExp("P(?:(\\d+(?:[\\.,]\\d+)?W)|(\\d+(?:[\\.,]\\d+)?Y)?(\\d+(?:[\\.,]\\d+)?M)?(\\d+(?:[\\.,]\\d+)?D)?(?:T(\\d+(?:[\\.,]\\d+)?H)?(\\d+(?:[\\.,]\\d+)?M)?(\\d+(?:[\\.,]\\d+)?S)?)?)"),i=t.parse=function(e){return e.match(r).slice(1).reduce((function(e,t,r){return e[n[r]]=parseFloat(t)||0,e}),{})},o=t.end=function(e,t){var n=t?t.getTime():Date.now(),r=new Date(n);return r.setFullYear(r.getFullYear()+e.years),r.setMonth(r.getMonth()+e.months),r.setDate(r.getDate()+e.days),r.setHours(r.getHours()+e.hours),r.setMinutes(r.getMinutes()+e.minutes),r.setMilliseconds(r.getMilliseconds()+1e3*e.seconds),r.setDate(r.getDate()+7*e.weeks),r},s=t.toSeconds=function(e,t){var n=t?t.getTime():Date.now(),r=new Date(n);return(o(e,r).getTime()-r.getTime())/1e3};t.default={end:o,toSeconds:s,pattern:r,parse:i}},3143:e=>{e.exports=window.FormData},1994:function(e){var t;t=function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.i=function(e){return e},n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=5)}([function(e,t,n){"use strict";e.exports=function(e,t){var n,r,i;for(n=1;n<arguments.length;n++)for(i in r=arguments[n])r.hasOwnProperty(i)&&(e[i]=r[i]);return e}},function(e,t,n){"use strict";var r=n(0);e.exports={build:function(e,t){var n,i,o,s=t.plugins;for(n=0,i=s.length;n<i;n++)(o=s[n]).methods&&r(e,o.methods),o.properties&&Object.defineProperties(e,o.properties)},hook:function(e,t,n){var r,i,o,s,a=e.config.plugins,u=[e.context];for(n&&(u=u.concat(n)),r=0,i=a.length;r<i;r++)s=a[r],(o=a[r][t])&&o.apply(s,u)}}},function(e,t,n){"use strict";function r(e){if(0===e.length)return e;var t,n,r=e.split(/[_-]/);if(1===r.length&&r[0][0].toLowerCase()===r[0][0])return e;for(n=r[0].toLowerCase(),t=1;t<r.length;t++)n=n+r[t].charAt(0).toUpperCase()+r[t].substring(1).toLowerCase();return n}r.prepended=function(e,t){return e+(t=r(t))[0].toUpperCase()+t.substring(1)},e.exports=r},function(e,t,n){"use strict";var r=n(0),i=n(2);function o(e,t){e=e||{},this.options=e,this.defaults=t.defaults,this.states=[],this.transitions=[],this.map={},this.lifecycle=this.configureLifecycle(),this.init=this.configureInitTransition(e.init),this.data=this.configureData(e.data),this.methods=this.configureMethods(e.methods),this.map[this.defaults.wildcard]={},this.configureTransitions(e.transitions||[]),this.plugins=this.configurePlugins(e.plugins,t.plugin)}r(o.prototype,{addState:function(e){this.map[e]||(this.states.push(e),this.addStateLifecycleNames(e),this.map[e]={})},addStateLifecycleNames:function(e){this.lifecycle.onEnter[e]=i.prepended("onEnter",e),this.lifecycle.onLeave[e]=i.prepended("onLeave",e),this.lifecycle.on[e]=i.prepended("on",e)},addTransition:function(e){this.transitions.indexOf(e)<0&&(this.transitions.push(e),this.addTransitionLifecycleNames(e))},addTransitionLifecycleNames:function(e){this.lifecycle.onBefore[e]=i.prepended("onBefore",e),this.lifecycle.onAfter[e]=i.prepended("onAfter",e),this.lifecycle.on[e]=i.prepended("on",e)},mapTransition:function(e){var t=e.name,n=e.from,r=e.to;return this.addState(n),"function"!=typeof r&&this.addState(r),this.addTransition(t),this.map[n][t]=e,e},configureLifecycle:function(){return{onBefore:{transition:"onBeforeTransition"},onAfter:{transition:"onAfterTransition"},onEnter:{state:"onEnterState"},onLeave:{state:"onLeaveState"},on:{transition:"onTransition"}}},configureInitTransition:function(e){return"string"==typeof e?this.mapTransition(r({},this.defaults.init,{to:e,active:!0})):"object"==typeof e?this.mapTransition(r({},this.defaults.init,e,{active:!0})):(this.addState(this.defaults.init.from),this.defaults.init)},configureData:function(e){return"function"==typeof e?e:"object"==typeof e?function(){return e}:function(){return{}}},configureMethods:function(e){return e||{}},configurePlugins:function(e,t){var n,r,i;for(n=0,r=(e=e||[]).length;n<r;n++)"function"==typeof(i=e[n])&&(e[n]=i=i()),i.configure&&i.configure(this);return e},configureTransitions:function(e){var t,n,r,i,o,s=this.defaults.wildcard;for(n=0;n<e.length;n++)for(r=e[n],i=Array.isArray(r.from)?r.from:[r.from||s],o=r.to||s,t=0;t<i.length;t++)this.mapTransition({name:r.name,from:i[t],to:o})},transitionFor:function(e,t){var n=this.defaults.wildcard;return this.map[e][t]||this.map[n][t]},transitionsFor:function(e){var t=this.defaults.wildcard;return Object.keys(this.map[e]).concat(Object.keys(this.map[t]))},allStates:function(){return this.states},allTransitions:function(){return this.transitions}}),e.exports=o},function(e,t,n){var r=n(0),i=n(6),o=n(1),s=[null,[]];function a(e,t){this.context=e,this.config=t,this.state=t.init.from,this.observers=[e]}r(a.prototype,{init:function(e){if(r(this.context,this.config.data.apply(this.context,e)),o.hook(this,"init"),this.config.init.active)return this.fire(this.config.init.name,[])},is:function(e){return Array.isArray(e)?e.indexOf(this.state)>=0:this.state===e},isPending:function(){return this.pending},can:function(e){return!this.isPending()&&!!this.seek(e)},cannot:function(e){return!this.can(e)},allStates:function(){return this.config.allStates()},allTransitions:function(){return this.config.allTransitions()},transitions:function(){return this.config.transitionsFor(this.state)},seek:function(e,t){var n=this.config.defaults.wildcard,r=this.config.transitionFor(this.state,e),i=r&&r.to;return"function"==typeof i?i.apply(this.context,t):i===n?this.state:i},fire:function(e,t){return this.transit(e,this.state,this.seek(e,t),t)},transit:function(e,t,n,r){var i=this.config.lifecycle,o=this.config.options.observeUnchangedState||t!==n;return n?this.isPending()?this.context.onPendingTransition(e,t,n):(this.config.addState(n),this.beginTransit(),r.unshift({transition:e,from:t,to:n,fsm:this.context}),this.observeEvents([this.observersForEvent(i.onBefore.transition),this.observersForEvent(i.onBefore[e]),o?this.observersForEvent(i.onLeave.state):s,o?this.observersForEvent(i.onLeave[t]):s,this.observersForEvent(i.on.transition),o?["doTransit",[this]]:s,o?this.observersForEvent(i.onEnter.state):s,o?this.observersForEvent(i.onEnter[n]):s,o?this.observersForEvent(i.on[n]):s,this.observersForEvent(i.onAfter.transition),this.observersForEvent(i.onAfter[e]),this.observersForEvent(i.on[e])],r)):this.context.onInvalidTransition(e,t,n)},beginTransit:function(){this.pending=!0},endTransit:function(e){return this.pending=!1,e},failTransit:function(e){throw this.pending=!1,e},doTransit:function(e){this.state=e.to},observe:function(e){if(2===e.length){var t={};t[e[0]]=e[1],this.observers.push(t)}else this.observers.push(e[0])},observersForEvent:function(e){for(var t,n=0,r=this.observers.length,i=[];n<r;n++)(t=this.observers[n])[e]&&i.push(t);return[e,i,!0]},observeEvents:function(e,t,n,r){if(0===e.length)return this.endTransit(void 0===r||r);var i=e[0][0],s=e[0][1],a=e[0][2];if(t[0].event=i,i&&a&&i!==n&&o.hook(this,"lifecycle",t),0===s.length)return e.shift(),this.observeEvents(e,t,i,r);var u=s.shift(),c=u[i].apply(u,t);return c&&"function"==typeof c.then?c.then(this.observeEvents.bind(this,e,t,i)).catch(this.failTransit.bind(this)):!1===c?this.endTransit(!1):this.observeEvents(e,t,i,c)},onInvalidTransition:function(e,t,n){throw new i("transition is invalid in current state",e,t,n,this.state)},onPendingTransition:function(e,t,n){throw new i("transition is invalid while previous transition is still in progress",e,t,n,this.state)}}),e.exports=a},function(e,t,n){"use strict";var r=n(0),i=n(2),o=n(1),s=n(3),a=n(4),u={is:function(e){return this._fsm.is(e)},can:function(e){return this._fsm.can(e)},cannot:function(e){return this._fsm.cannot(e)},observe:function(){return this._fsm.observe(arguments)},transitions:function(){return this._fsm.transitions()},allTransitions:function(){return this._fsm.allTransitions()},allStates:function(){return this._fsm.allStates()},onInvalidTransition:function(e,t,n){return this._fsm.onInvalidTransition(e,t,n)},onPendingTransition:function(e,t,n){return this._fsm.onPendingTransition(e,t,n)}},c={state:{configurable:!1,enumerable:!0,get:function(){return this._fsm.state},set:function(e){throw Error("use transitions to change state")}}};function l(e){return d(this||{},e)}function d(e,t){return f(e,new s(t,l)),e._fsm(),e}function f(e,t){if("object"!=typeof e||Array.isArray(e))throw Error("StateMachine can only be applied to objects");o.build(e,t),Object.defineProperties(e,c),r(e,u),r(e,t.methods),t.allTransitions().forEach((function(t){e[i(t)]=function(){return this._fsm.fire(t,[].slice.call(arguments))}})),e._fsm=function(){this._fsm=new a(this,t),this._fsm.init(arguments)}}l.version="3.0.1",l.factory=function(){var e,t;"function"==typeof arguments[0]?(e=arguments[0],t=arguments[1]||{}):(e=function(){this._fsm.apply(this,arguments)},t=arguments[0]||{});var n=new s(t,l);return f(e.prototype,n),e.prototype._fsm.config=n,e},l.apply=d,l.defaults={wildcard:"*",init:{name:"init",from:"none"}},e.exports=l},function(e,t,n){"use strict";e.exports=function(e,t,n,r,i){this.message=e,this.transition=t,this.from=n,this.to=r,this.current=i}}])},e.exports=t()},1419:(e,t,n)=>{e=n.nmd(e);var r="__lodash_hash_undefined__",i=9007199254740991,o="[object Arguments]",s="[object Array]",a="[object Boolean]",u="[object Date]",c="[object Error]",l="[object Function]",d="[object Map]",f="[object Number]",p="[object Object]",h="[object Promise]",y="[object RegExp]",v="[object Set]",m="[object String]",g="[object Symbol]",b="[object WeakMap]",_="[object ArrayBuffer]",w="[object DataView]",k=/^\[object .+?Constructor\]$/,x=/^(?:0|[1-9]\d*)$/,S={};S["[object Float32Array]"]=S["[object Float64Array]"]=S["[object Int8Array]"]=S["[object Int16Array]"]=S["[object Int32Array]"]=S["[object Uint8Array]"]=S["[object Uint8ClampedArray]"]=S["[object Uint16Array]"]=S["[object Uint32Array]"]=!0,S[o]=S[s]=S[_]=S[a]=S[w]=S[u]=S[c]=S[l]=S[d]=S[f]=S[p]=S[y]=S[v]=S[m]=S[b]=!1;var E="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,T="object"==typeof self&&self&&self.Object===Object&&self,O=E||T||Function("return this")(),I=t&&!t.nodeType&&t,C=I&&e&&!e.nodeType&&e,R=C&&C.exports===I,A=R&&E.process,P=function(){try{return A&&A.binding&&A.binding("util")}catch(e){}}(),N=P&&P.isTypedArray;function L(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}function M(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}function j(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}var D,B,U,F=Array.prototype,H=Function.prototype,G=Object.prototype,W=O["__core-js_shared__"],q=H.toString,V=G.hasOwnProperty,z=(D=/[^.]+$/.exec(W&&W.keys&&W.keys.IE_PROTO||""))?"Symbol(src)_1."+D:"",Y=G.toString,K=RegExp("^"+q.call(V).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),$=R?O.Buffer:void 0,X=O.Symbol,J=O.Uint8Array,Z=G.propertyIsEnumerable,Q=F.splice,ee=X?X.toStringTag:void 0,te=Object.getOwnPropertySymbols,ne=$?$.isBuffer:void 0,re=(B=Object.keys,U=Object,function(e){return B(U(e))}),ie=Pe(O,"DataView"),oe=Pe(O,"Map"),se=Pe(O,"Promise"),ae=Pe(O,"Set"),ue=Pe(O,"WeakMap"),ce=Pe(Object,"create"),le=je(ie),de=je(oe),fe=je(se),pe=je(ae),he=je(ue),ye=X?X.prototype:void 0,ve=ye?ye.valueOf:void 0;function me(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function ge(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function be(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function _e(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new be;++t<n;)this.add(e[t])}function we(e){var t=this.__data__=new ge(e);this.size=t.size}function ke(e,t){var n=Ue(e),r=!n&&Be(e),i=!n&&!r&&Fe(e),o=!n&&!r&&!i&&Ve(e),s=n||r||i||o,a=s?function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}(e.length,String):[],u=a.length;for(var c in e)!t&&!V.call(e,c)||s&&("length"==c||i&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||Me(c,u))||a.push(c);return a}function xe(e,t){for(var n=e.length;n--;)if(De(e[n][0],t))return n;return-1}function Se(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":ee&&ee in Object(e)?function(e){var t=V.call(e,ee),n=e[ee];try{e[ee]=void 0;var r=!0}catch(e){}var i=Y.call(e);r&&(t?e[ee]=n:delete e[ee]);return i}(e):function(e){return Y.call(e)}(e)}function Ee(e){return qe(e)&&Se(e)==o}function Te(e,t,n,r,i){return e===t||(null==e||null==t||!qe(e)&&!qe(t)?e!=e&&t!=t:function(e,t,n,r,i,l){var h=Ue(e),b=Ue(t),k=h?s:Le(e),x=b?s:Le(t),S=(k=k==o?p:k)==p,E=(x=x==o?p:x)==p,T=k==x;if(T&&Fe(e)){if(!Fe(t))return!1;h=!0,S=!1}if(T&&!S)return l||(l=new we),h||Ve(e)?Ce(e,t,n,r,i,l):function(e,t,n,r,i,o,s){switch(n){case w:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case _:return!(e.byteLength!=t.byteLength||!o(new J(e),new J(t)));case a:case u:case f:return De(+e,+t);case c:return e.name==t.name&&e.message==t.message;case y:case m:return e==t+"";case d:var l=M;case v:var p=1&r;if(l||(l=j),e.size!=t.size&&!p)return!1;var h=s.get(e);if(h)return h==t;r|=2,s.set(e,t);var b=Ce(l(e),l(t),r,i,o,s);return s.delete(e),b;case g:if(ve)return ve.call(e)==ve.call(t)}return!1}(e,t,k,n,r,i,l);if(!(1&n)){var O=S&&V.call(e,"__wrapped__"),I=E&&V.call(t,"__wrapped__");if(O||I){var C=O?e.value():e,R=I?t.value():t;return l||(l=new we),i(C,R,n,r,l)}}if(!T)return!1;return l||(l=new we),function(e,t,n,r,i,o){var s=1&n,a=Re(e),u=a.length,c=Re(t).length;if(u!=c&&!s)return!1;var l=u;for(;l--;){var d=a[l];if(!(s?d in t:V.call(t,d)))return!1}var f=o.get(e);if(f&&o.get(t))return f==t;var p=!0;o.set(e,t),o.set(t,e);var h=s;for(;++l<u;){var y=e[d=a[l]],v=t[d];if(r)var m=s?r(v,y,d,t,e,o):r(y,v,d,e,t,o);if(!(void 0===m?y===v||i(y,v,n,r,o):m)){p=!1;break}h||(h="constructor"==d)}if(p&&!h){var g=e.constructor,b=t.constructor;g==b||!("constructor"in e)||!("constructor"in t)||"function"==typeof g&&g instanceof g&&"function"==typeof b&&b instanceof b||(p=!1)}return o.delete(e),o.delete(t),p}(e,t,n,r,i,l)}(e,t,n,r,Te,i))}function Oe(e){return!(!We(e)||function(e){return!!z&&z in e}(e))&&(He(e)?K:k).test(je(e))}function Ie(e){if(n=(t=e)&&t.constructor,r="function"==typeof n&&n.prototype||G,t!==r)return re(e);var t,n,r,i=[];for(var o in Object(e))V.call(e,o)&&"constructor"!=o&&i.push(o);return i}function Ce(e,t,n,r,i,o){var s=1&n,a=e.length,u=t.length;if(a!=u&&!(s&&u>a))return!1;var c=o.get(e);if(c&&o.get(t))return c==t;var l=-1,d=!0,f=2&n?new _e:void 0;for(o.set(e,t),o.set(t,e);++l<a;){var p=e[l],h=t[l];if(r)var y=s?r(h,p,l,t,e,o):r(p,h,l,e,t,o);if(void 0!==y){if(y)continue;d=!1;break}if(f){if(!L(t,(function(e,t){if(s=t,!f.has(s)&&(p===e||i(p,e,n,r,o)))return f.push(t);var s}))){d=!1;break}}else if(p!==h&&!i(p,h,n,r,o)){d=!1;break}}return o.delete(e),o.delete(t),d}function Re(e){return function(e,t,n){var r=t(e);return Ue(e)?r:function(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}(r,n(e))}(e,ze,Ne)}function Ae(e,t){var n,r,i=e.__data__;return("string"==(r=typeof(n=t))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?i["string"==typeof t?"string":"hash"]:i.map}function Pe(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return Oe(n)?n:void 0}me.prototype.clear=function(){this.__data__=ce?ce(null):{},this.size=0},me.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},me.prototype.get=function(e){var t=this.__data__;if(ce){var n=t[e];return n===r?void 0:n}return V.call(t,e)?t[e]:void 0},me.prototype.has=function(e){var t=this.__data__;return ce?void 0!==t[e]:V.call(t,e)},me.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=ce&&void 0===t?r:t,this},ge.prototype.clear=function(){this.__data__=[],this.size=0},ge.prototype.delete=function(e){var t=this.__data__,n=xe(t,e);return!(n<0)&&(n==t.length-1?t.pop():Q.call(t,n,1),--this.size,!0)},ge.prototype.get=function(e){var t=this.__data__,n=xe(t,e);return n<0?void 0:t[n][1]},ge.prototype.has=function(e){return xe(this.__data__,e)>-1},ge.prototype.set=function(e,t){var n=this.__data__,r=xe(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this},be.prototype.clear=function(){this.size=0,this.__data__={hash:new me,map:new(oe||ge),string:new me}},be.prototype.delete=function(e){var t=Ae(this,e).delete(e);return this.size-=t?1:0,t},be.prototype.get=function(e){return Ae(this,e).get(e)},be.prototype.has=function(e){return Ae(this,e).has(e)},be.prototype.set=function(e,t){var n=Ae(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this},_e.prototype.add=_e.prototype.push=function(e){return this.__data__.set(e,r),this},_e.prototype.has=function(e){return this.__data__.has(e)},we.prototype.clear=function(){this.__data__=new ge,this.size=0},we.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},we.prototype.get=function(e){return this.__data__.get(e)},we.prototype.has=function(e){return this.__data__.has(e)},we.prototype.set=function(e,t){var n=this.__data__;if(n instanceof ge){var r=n.__data__;if(!oe||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new be(r)}return n.set(e,t),this.size=n.size,this};var Ne=te?function(e){return null==e?[]:(e=Object(e),function(e,t){for(var n=-1,r=null==e?0:e.length,i=0,o=[];++n<r;){var s=e[n];t(s,n,e)&&(o[i++]=s)}return o}(te(e),(function(t){return Z.call(e,t)})))}:function(){return[]},Le=Se;function Me(e,t){return!!(t=null==t?i:t)&&("number"==typeof e||x.test(e))&&e>-1&&e%1==0&&e<t}function je(e){if(null!=e){try{return q.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function De(e,t){return e===t||e!=e&&t!=t}(ie&&Le(new ie(new ArrayBuffer(1)))!=w||oe&&Le(new oe)!=d||se&&Le(se.resolve())!=h||ae&&Le(new ae)!=v||ue&&Le(new ue)!=b)&&(Le=function(e){var t=Se(e),n=t==p?e.constructor:void 0,r=n?je(n):"";if(r)switch(r){case le:return w;case de:return d;case fe:return h;case pe:return v;case he:return b}return t});var Be=Ee(function(){return arguments}())?Ee:function(e){return qe(e)&&V.call(e,"callee")&&!Z.call(e,"callee")},Ue=Array.isArray;var Fe=ne||function(){return!1};function He(e){if(!We(e))return!1;var t=Se(e);return t==l||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}function Ge(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=i}function We(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function qe(e){return null!=e&&"object"==typeof e}var Ve=N?function(e){return function(t){return e(t)}}(N):function(e){return qe(e)&&Ge(e.length)&&!!S[Se(e)]};function ze(e){return null!=(t=e)&&Ge(t.length)&&!He(t)?ke(e):Ie(e);var t}e.exports=function(e,t){return Te(e,t)}},1144:function(e,t,n){var r,i;!function(o,s){"use strict";r=function(){var e=function(){},t="undefined",n=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),r=["trace","debug","info","warn","error"];function i(e,t){var n=e[t];if("function"==typeof n.bind)return n.bind(e);try{return Function.prototype.bind.call(n,e)}catch(t){return function(){return Function.prototype.apply.apply(n,[e,arguments])}}}function o(){console.log&&(console.log.apply||Function.prototype.apply.apply(console.log,[console,arguments])),console.trace}function s(r){return"debug"===r&&(r="log"),typeof console!==t&&("trace"===r&&n?o:void 0!==console[r]?i(console,r):void 0!==console.log?i(console,"log"):e)}function a(t,n){for(var i=0;i<r.length;i++){var o=r[i];this[o]=i<t?e:this.methodFactory(o,t,n)}this.log=this.debug}function u(e,n,r){return function(){typeof console!==t&&(a.call(this,n,r),this[e].apply(this,arguments))}}function c(e,t,n){return s(e)||u.apply(this,arguments)}function l(e,n,i){var o,s=this;n=null==n?"WARN":n;var u="loglevel";function l(e){var n=(r[e]||"silent").toUpperCase();if(typeof window!==t&&u){try{return void(window.localStorage[u]=n)}catch(e){}try{window.document.cookie=encodeURIComponent(u)+"="+n+";"}catch(e){}}}function d(){var e;if(typeof window!==t&&u){try{e=window.localStorage[u]}catch(e){}if(typeof e===t)try{var n=window.document.cookie,r=n.indexOf(encodeURIComponent(u)+"=");-1!==r&&(e=/^([^;]+)/.exec(n.slice(r))[1])}catch(e){}return void 0===s.levels[e]&&(e=void 0),e}}function f(){if(typeof window!==t&&u){try{return void window.localStorage.removeItem(u)}catch(e){}try{window.document.cookie=encodeURIComponent(u)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch(e){}}}"string"==typeof e?u+=":"+e:"symbol"==typeof e&&(u=void 0),s.name=e,s.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},s.methodFactory=i||c,s.getLevel=function(){return o},s.setLevel=function(n,r){if("string"==typeof n&&void 0!==s.levels[n.toUpperCase()]&&(n=s.levels[n.toUpperCase()]),!("number"==typeof n&&n>=0&&n<=s.levels.SILENT))throw"log.setLevel() called with invalid level: "+n;if(o=n,!1!==r&&l(n),a.call(s,n,e),typeof console===t&&n<s.levels.SILENT)return"No console available for logging"},s.setDefaultLevel=function(e){n=e,d()||s.setLevel(e,!1)},s.resetLevel=function(){s.setLevel(n,!1),f()},s.enableAll=function(e){s.setLevel(s.levels.TRACE,e)},s.disableAll=function(e){s.setLevel(s.levels.SILENT,e)};var p=d();null==p&&(p=n),s.setLevel(p,!1)}var d=new l,f={};d.getLogger=function(e){if("symbol"!=typeof e&&"string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=f[e];return t||(t=f[e]=new l(e,d.getLevel(),d.methodFactory)),t};var p=typeof window!==t?window.log:void 0;return d.noConflict=function(){return typeof window!==t&&window.log===d&&(window.log=p),d},d.getLoggers=function(){return f},d.default=d,d},void 0===(i="function"==typeof r?r.call(t,n,t,e):r)||(e.exports=i)}()},259:function(e,t,n){var r;e=n.nmd(e),function(){"use strict";var i={function:!0,object:!0},o=i[typeof window]&&window||this,s=i[typeof t]&&t,a=i.object&&e&&!e.nodeType&&e,u=s&&a&&"object"==typeof n.g&&n.g;!u||u.global!==u&&u.window!==u&&u.self!==u||(o=u);var c=Math.pow(2,53)-1,l=/\bOpera/,d=Object.prototype,f=d.hasOwnProperty,p=d.toString;function h(e){return(e=String(e)).charAt(0).toUpperCase()+e.slice(1)}function y(e){return e=_(e),/^(?:webOS|i(?:OS|P))/.test(e)?e:h(e)}function v(e,t){for(var n in e)f.call(e,n)&&t(e[n],n,e)}function m(e){return null==e?h(e):p.call(e).slice(8,-1)}function g(e){return String(e).replace(/([ -])(?!$)/g,"$1?")}function b(e,t){var n=null;return function(e,t){var n=-1,r=e?e.length:0;if("number"==typeof r&&r>-1&&r<=c)for(;++n<r;)t(e[n],n,e);else v(e,t)}(e,(function(r,i){n=t(n,r,i,e)})),n}function _(e){return String(e).replace(/^ +| +$/g,"")}var w=function e(t){var n=o,r=t&&"object"==typeof t&&"String"!=m(t);r&&(n=t,t=null);var i=n.navigator||{},s=i.userAgent||"";t||(t=s);var a,u,c,d,f,h=r?!!i.likeChrome:/\bChrome\b/.test(t)&&!/internal|\n/i.test(p.toString()),w="Object",k=r?w:"ScriptBridgingProxyObject",x=r?w:"Environment",S=r&&n.java?"JavaPackage":m(n.java),E=r?w:"RuntimeObject",T=/\bJava/.test(S)&&n.java,O=T&&m(n.environment)==x,I=T?"a":"α",C=T?"b":"β",R=n.document||{},A=n.operamini||n.opera,P=l.test(P=r&&A?A["[[Class]]"]:m(A))?P:A=null,N=t,L=[],M=null,j=t==s,D=j&&A&&"function"==typeof A.version&&A.version(),B=b([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"],(function(e,n){return e||RegExp("\\b"+(n.pattern||g(n))+"\\b","i").exec(t)&&(n.label||n)})),U=function(e){return b(e,(function(e,n){return e||RegExp("\\b"+(n.pattern||g(n))+"\\b","i").exec(t)&&(n.label||n)}))}(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"(?:Edge|Edg|EdgA|EdgiOS)"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Vivaldi","Waterfox","WebPositive",{label:"Yandex Browser",pattern:"YaBrowser"},{label:"UC Browser",pattern:"UCBrowser"},"Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chromium","Chrome",{label:"Chrome",pattern:"(?:HeadlessChrome)"},{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),F=W([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),H=function(e){return b(e,(function(e,n,r){return e||(n[F]||n[/^[a-z]+(?: +[a-z]+\b)*/i.exec(F)]||RegExp("\\b"+g(r)+"(?:\\b|\\w*\\d)","i").exec(t))&&r}))}({Apple:{iPad:1,iPhone:1,iPod:1},Alcatel:{},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},Huawei:{},Lenovo:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Oppo:{},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1},Xiaomi:{Mi:1,Redmi:1}}),G=function(e){return b(e,(function(e,n){var r=n.pattern||g(n);return!e&&(e=RegExp("\\b"+r+"(?:/[\\d.]+|[ \\w.]*)","i").exec(t))&&(e=function(e,t,n){var r={"10.0":"10",6.4:"10 Technical Preview",6.3:"8.1",6.2:"8",6.1:"Server 2008 R2 / 7","6.0":"Server 2008 / Vista",5.2:"Server 2003 / XP 64-bit",5.1:"XP",5.01:"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};return t&&n&&/^Win/i.test(e)&&!/^Windows Phone /i.test(e)&&(r=r[/[\d.]+$/.exec(e)])&&(e="Windows "+r),e=String(e),t&&n&&(e=e.replace(RegExp(t,"i"),n)),y(e.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])}(e,r,n.label||n)),e}))}(["Windows Phone","KaiOS","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian",{label:"DragonFly BSD",pattern:"DragonFly"},"Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "]);function W(e){return b(e,(function(e,n){var r=n.pattern||g(n);return!e&&(e=RegExp("\\b"+r+" *\\d+[.\\w_]*","i").exec(t)||RegExp("\\b"+r+" *\\w+-[\\w]*","i").exec(t)||RegExp("\\b"+r+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(t))&&((e=String(n.label&&!RegExp(r,"i").test(n.label)?n.label:e).split("/"))[1]&&!/[\d.]+/.test(e[0])&&(e[0]+=" "+e[1]),n=n.label||n,e=y(e[0].replace(RegExp(r,"i"),n).replace(RegExp("; *(?:"+n+"[_-])?","i")," ").replace(RegExp("("+n+")[-_.]?(\\w)","i"),"$1 $2"))),e}))}function q(e){return b(e,(function(e,n){return e||(RegExp(n+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(t)||0)[1]||null}))}if(B&&(B=[B]),/\bAndroid\b/.test(G)&&!F&&(a=/\bAndroid[^;]*;(.*?)(?:Build|\) AppleWebKit)\b/i.exec(t))&&(F=_(a[1]).replace(/^[a-z]{2}-[a-z]{2};\s*/i,"")||null),H&&!F?F=W([H]):H&&F&&(F=F.replace(RegExp("^("+g(H)+")[-_.\\s]","i"),H+" ").replace(RegExp("^("+g(H)+")[-_.]?(\\w)","i"),H+" $2")),(a=/\bGoogle TV\b/.exec(F))&&(F=a[0]),/\bSimulator\b/i.test(t)&&(F=(F?F+" ":"")+"Simulator"),"Opera Mini"==U&&/\bOPiOS\b/.test(t)&&L.push("running in Turbo/Uncompressed mode"),"IE"==U&&/\blike iPhone OS\b/.test(t)?(H=(a=e(t.replace(/like iPhone OS/,""))).manufacturer,F=a.product):/^iP/.test(F)?(U||(U="Safari"),G="iOS"+((a=/ OS ([\d_]+)/i.exec(t))?" "+a[1].replace(/_/g,"."):"")):"Konqueror"==U&&/^Linux\b/i.test(G)?G="Kubuntu":H&&"Google"!=H&&(/Chrome/.test(U)&&!/\bMobile Safari\b/i.test(t)||/\bVita\b/.test(F))||/\bAndroid\b/.test(G)&&/^Chrome/.test(U)&&/\bVersion\//i.test(t)?(U="Android Browser",G=/\bAndroid\b/.test(G)?G:"Android"):"Silk"==U?(/\bMobi/i.test(t)||(G="Android",L.unshift("desktop mode")),/Accelerated *= *true/i.test(t)&&L.unshift("accelerated")):"UC Browser"==U&&/\bUCWEB\b/.test(t)?L.push("speed mode"):"PaleMoon"==U&&(a=/\bFirefox\/([\d.]+)\b/.exec(t))?L.push("identifying as Firefox "+a[1]):"Firefox"==U&&(a=/\b(Mobile|Tablet|TV)\b/i.exec(t))?(G||(G="Firefox OS"),F||(F=a[1])):!U||(a=!/\bMinefield\b/i.test(t)&&/\b(?:Firefox|Safari)\b/.exec(U))?(U&&!F&&/[\/,]|^[^(]+?\)/.test(t.slice(t.indexOf(a+"/")+8))&&(U=null),(a=F||H||G)&&(F||H||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(G))&&(U=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(G)?G:a)+" Browser")):"Electron"==U&&(a=(/\bChrome\/([\d.]+)\b/.exec(t)||0)[1])&&L.push("Chromium "+a),D||(D=q(["(?:Cloud9|CriOS|CrMo|Edge|Edg|EdgA|EdgiOS|FxiOS|HeadlessChrome|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$)|UCBrowser|YaBrowser)","Version",g(U),"(?:Firefox|Minefield|NetFront)"])),(a=("iCab"==B&&parseFloat(D)>3?"WebKit":/\bOpera\b/.test(U)&&(/\bOPR\b/.test(t)?"Blink":"Presto"))||/\b(?:Midori|Nook|Safari)\b/i.test(t)&&!/^(?:Trident|EdgeHTML)$/.test(B)&&"WebKit"||!B&&/\bMSIE\b/i.test(t)&&("Mac OS"==G?"Tasman":"Trident")||"WebKit"==B&&/\bPlayStation\b(?! Vita\b)/i.test(U)&&"NetFront")&&(B=[a]),"IE"==U&&(a=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(t)||0)[1])?(U+=" Mobile",G="Windows Phone "+(/\+$/.test(a)?a:a+".x"),L.unshift("desktop mode")):/\bWPDesktop\b/i.test(t)?(U="IE Mobile",G="Windows Phone 8.x",L.unshift("desktop mode"),D||(D=(/\brv:([\d.]+)/.exec(t)||0)[1])):"IE"!=U&&"Trident"==B&&(a=/\brv:([\d.]+)/.exec(t))&&(U&&L.push("identifying as "+U+(D?" "+D:"")),U="IE",D=a[1]),j){if(d="global",f=null!=(c=n)?typeof c[d]:"number",/^(?:boolean|number|string|undefined)$/.test(f)||"object"==f&&!c[d])m(a=n.runtime)==k?(U="Adobe AIR",G=a.flash.system.Capabilities.os):m(a=n.phantom)==E?(U="PhantomJS",D=(a=a.version||null)&&a.major+"."+a.minor+"."+a.patch):"number"==typeof R.documentMode&&(a=/\bTrident\/(\d+)/i.exec(t))?(D=[D,R.documentMode],(a=+a[1]+4)!=D[1]&&(L.push("IE "+D[1]+" mode"),B&&(B[1]=""),D[1]=a),D="IE"==U?String(D[1].toFixed(1)):D[0]):"number"==typeof R.documentMode&&/^(?:Chrome|Firefox)\b/.test(U)&&(L.push("masking as "+U+" "+D),U="IE",D="11.0",B=["Trident"],G="Windows");else if(T&&(N=(a=T.lang.System).getProperty("os.arch"),G=G||a.getProperty("os.name")+" "+a.getProperty("os.version")),O){try{D=n.require("ringo/engine").version.join("."),U="RingoJS"}catch(e){(a=n.system)&&a.global.system==n.system&&(U="Narwhal",G||(G=a[0].os||null))}U||(U="Rhino")}else"object"==typeof n.process&&!n.process.browser&&(a=n.process)&&("object"==typeof a.versions&&("string"==typeof a.versions.electron?(L.push("Node "+a.versions.node),U="Electron",D=a.versions.electron):"string"==typeof a.versions.nw&&(L.push("Chromium "+D,"Node "+a.versions.node),U="NW.js",D=a.versions.nw)),U||(U="Node.js",N=a.arch,G=a.platform,D=(D=/[\d.]+/.exec(a.version))?D[0]:null));G=G&&y(G)}if(D&&(a=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(D)||/(?:alpha|beta)(?: ?\d)?/i.exec(t+";"+(j&&i.appMinorVersion))||/\bMinefield\b/i.test(t)&&"a")&&(M=/b/i.test(a)?"beta":"alpha",D=D.replace(RegExp(a+"\\+?$"),"")+("beta"==M?C:I)+(/\d+\+?/.exec(a)||"")),"Fennec"==U||"Firefox"==U&&/\b(?:Android|Firefox OS|KaiOS)\b/.test(G))U="Firefox Mobile";else if("Maxthon"==U&&D)D=D.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(F))"Xbox 360"==F&&(G=null),"Xbox 360"==F&&/\bIEMobile\b/.test(t)&&L.unshift("mobile mode");else if(!/^(?:Chrome|IE|Opera)$/.test(U)&&(!U||F||/Browser|Mobi/.test(U))||"Windows CE"!=G&&!/Mobi/i.test(t))if("IE"==U&&j)try{null===n.external&&L.unshift("platform preview")}catch(e){L.unshift("embedded")}else(/\bBlackBerry\b/.test(F)||/\bBB10\b/.test(t))&&(a=(RegExp(F.replace(/ +/g," *")+"/([.\\d]+)","i").exec(t)||0)[1]||D)?(G=((a=[a,/BB10/.test(t)])[1]?(F=null,H="BlackBerry"):"Device Software")+" "+a[0],D=null):this!=v&&"Wii"!=F&&(j&&A||/Opera/.test(U)&&/\b(?:MSIE|Firefox)\b/i.test(t)||"Firefox"==U&&/\bOS X (?:\d+\.){2,}/.test(G)||"IE"==U&&(G&&!/^Win/.test(G)&&D>5.5||/\bWindows XP\b/.test(G)&&D>8||8==D&&!/\bTrident\b/.test(t)))&&!l.test(a=e.call(v,t.replace(l,"")+";"))&&a.name&&(a="ing as "+a.name+((a=a.version)?" "+a:""),l.test(U)?(/\bIE\b/.test(a)&&"Mac OS"==G&&(G=null),a="identify"+a):(a="mask"+a,U=P?y(P.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(a)&&(G=null),j||(D=null)),B=["Presto"],L.push(a));else U+=" Mobile";(a=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(t)||0)[1])&&(a=[parseFloat(a.replace(/\.(\d)$/,".0$1")),a],"Safari"==U&&"+"==a[1].slice(-1)?(U="WebKit Nightly",M="alpha",D=a[1].slice(0,-1)):D!=a[1]&&D!=(a[2]=(/\bSafari\/([\d.]+\+?)/i.exec(t)||0)[1])||(D=null),a[1]=(/\b(?:Headless)?Chrome\/([\d.]+)/i.exec(t)||0)[1],537.36==a[0]&&537.36==a[2]&&parseFloat(a[1])>=28&&"WebKit"==B&&(B=["Blink"]),j&&(h||a[1])?(B&&(B[1]="like Chrome"),a=a[1]||((a=a[0])<530?1:a<532?2:a<532.05?3:a<533?4:a<534.03?5:a<534.07?6:a<534.1?7:a<534.13?8:a<534.16?9:a<534.24?10:a<534.3?11:a<535.01?12:a<535.02?"13+":a<535.07?15:a<535.11?16:a<535.19?17:a<536.05?18:a<536.1?19:a<537.01?20:a<537.11?"21+":a<537.13?23:a<537.18?24:a<537.24?25:a<537.36?26:"Blink"!=B?"27":"28")):(B&&(B[1]="like Safari"),a=(a=a[0])<400?1:a<500?2:a<526?3:a<533?4:a<534?"4+":a<535?5:a<537?6:a<538?7:a<601?8:a<602?9:a<604?10:a<606?11:a<608?12:"12"),B&&(B[1]+=" "+(a+="number"==typeof a?".x":/[.+]/.test(a)?"":"+")),"Safari"==U&&(!D||parseInt(D)>45)?D=a:"Chrome"==U&&/\bHeadlessChrome/i.test(t)&&L.unshift("headless")),"Opera"==U&&(a=/\bzbov|zvav$/.exec(G))?(U+=" ",L.unshift("desktop mode"),"zvav"==a?(U+="Mini",D=null):U+="Mobile",G=G.replace(RegExp(" *"+a+"$"),"")):"Safari"==U&&/\bChrome\b/.exec(B&&B[1])?(L.unshift("desktop mode"),U="Chrome Mobile",D=null,/\bOS X\b/.test(G)?(H="Apple",G="iOS 4.3+"):G=null):/\bSRWare Iron\b/.test(U)&&!D&&(D=q("Chrome")),D&&0==D.indexOf(a=/[\d.]+$/.exec(G))&&t.indexOf("/"+a+"-")>-1&&(G=_(G.replace(a,""))),G&&-1!=G.indexOf(U)&&!RegExp(U+" OS").test(G)&&(G=G.replace(RegExp(" *"+g(U)+" *"),"")),B&&!/\b(?:Avant|Nook)\b/.test(U)&&(/Browser|Lunascape|Maxthon/.test(U)||"Safari"!=U&&/^iOS/.test(G)&&/\bSafari\b/.test(B[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|SRWare Iron|Vivaldi|Web)/.test(U)&&B[1])&&(a=B[B.length-1])&&L.push(a),L.length&&(L=["("+L.join("; ")+")"]),H&&F&&F.indexOf(H)<0&&L.push("on "+H),F&&L.push((/^on /.test(L[L.length-1])?"":"on ")+F),G&&(a=/ ([\d.+]+)$/.exec(G),u=a&&"/"==G.charAt(G.length-a[0].length-1),G={architecture:32,family:a&&!u?G.replace(a[0],""):G,version:a?a[1]:null,toString:function(){var e=this.version;return this.family+(e&&!u?" "+e:"")+(64==this.architecture?" 64-bit":"")}}),(a=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(N))&&!/\bi686\b/i.test(N)?(G&&(G.architecture=64,G.family=G.family.replace(RegExp(" *"+a),"")),U&&(/\bWOW64\b/i.test(t)||j&&/\w(?:86|32)$/.test(i.cpuClass||i.platform)&&!/\bWin64; x64\b/i.test(t))&&L.unshift("32-bit")):G&&/^OS X/.test(G.family)&&"Chrome"==U&&parseFloat(D)>=39&&(G.architecture=64),t||(t=null);var V={};return V.description=t,V.layout=B&&B[0],V.manufacturer=H,V.name=U,V.prerelease=M,V.product=F,V.ua=t,V.version=U&&D,V.os=G||{architecture:null,family:null,version:null,toString:function(){return"null"}},V.parse=e,V.toString=function(){return this.description||""},V.version&&L.unshift(D),V.name&&L.unshift(U),G&&U&&(G!=String(G).split(" ")[0]||G!=U.split(" ")[0]&&!F)&&L.push(F?"("+G+")":"on "+G),L.length&&(V.description=L.join(" ")),V}();o.platform=w,void 0===(r=function(){return w}.call(t,n,t,e))||(e.exports=r)}.call(this)},6606:(e,t,n)=>{"use strict";n.r(t),n.d(t,{Children:()=>F,Component:()=>s.wA,Fragment:()=>s.HY,PureComponent:()=>L,StrictMode:()=>_e,Suspense:()=>W,SuspenseList:()=>z,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:()=>de,cloneElement:()=>ye,createContext:()=>s.kr,createElement:()=>s.az,createFactory:()=>pe,createPortal:()=>X,createRef:()=>s.Vf,default:()=>we,findDOMNode:()=>me,flushSync:()=>be,forwardRef:()=>B,hydrate:()=>ne,isValidElement:()=>he,lazy:()=>V,memo:()=>M,render:()=>te,unmountComponentAtNode:()=>ve,unstable_batchedUpdates:()=>ge,useCallback:()=>k,useContext:()=>x,useDebugValue:()=>S,useEffect:()=>m,useErrorBoundary:()=>E,useImperativeHandle:()=>_,useLayoutEffect:()=>g,useMemo:()=>w,useReducer:()=>v,useRef:()=>b,useState:()=>y,version:()=>fe});var r,i,o,s=n(3931),a=0,u=[],c=s.YM.__b,l=s.YM.__r,d=s.YM.diffed,f=s.YM.__c,p=s.YM.unmount;function h(e,t){s.YM.__h&&s.YM.__h(i,e,a||t),a=0;var n=i.__H||(i.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({}),n.__[e]}function y(e){return a=1,v(A,e)}function v(e,t,n){var o=h(r++,2);return o.t=e,o.__c||(o.__=[n?n(t):A(void 0,t),function(e){var t=o.t(o.__[0],e);o.__[0]!==t&&(o.__=[t,o.__[1]],o.__c.setState({}))}],o.__c=i),o.__}function m(e,t){var n=h(r++,3);!s.YM.__s&&R(n.__H,t)&&(n.__=e,n.__H=t,i.__H.__h.push(n))}function g(e,t){var n=h(r++,4);!s.YM.__s&&R(n.__H,t)&&(n.__=e,n.__H=t,i.__h.push(n))}function b(e){return a=5,w((function(){return{current:e}}),[])}function _(e,t,n){a=6,g((function(){return"function"==typeof e?(e(t()),function(){return e(null)}):e?(e.current=t(),function(){return e.current=null}):void 0}),null==n?n:n.concat(e))}function w(e,t){var n=h(r++,7);return R(n.__H,t)&&(n.__=e(),n.__H=t,n.__h=e),n.__}function k(e,t){return a=8,w((function(){return e}),t)}function x(e){var t=i.context[e.__c],n=h(r++,9);return n.c=e,t?(null==n.__&&(n.__=!0,t.sub(i)),t.props.value):e.__}function S(e,t){s.YM.useDebugValue&&s.YM.useDebugValue(t?t(e):e)}function E(e){var t=h(r++,10),n=y();return t.__=e,i.componentDidCatch||(i.componentDidCatch=function(e){t.__&&t.__(e),n[1](e)}),[n[0],function(){n[1](void 0)}]}function T(){for(var e;e=u.shift();)if(e.__P)try{e.__H.__h.forEach(I),e.__H.__h.forEach(C),e.__H.__h=[]}catch(t){e.__H.__h=[],s.YM.__e(t,e.__v)}}s.YM.__b=function(e){i=null,c&&c(e)},s.YM.__r=function(e){l&&l(e),r=0;var t=(i=e.__c).__H;t&&(t.__h.forEach(I),t.__h.forEach(C),t.__h=[])},s.YM.diffed=function(e){d&&d(e);var t=e.__c;t&&t.__H&&t.__H.__h.length&&(1!==u.push(t)&&o===s.YM.requestAnimationFrame||((o=s.YM.requestAnimationFrame)||function(e){var t,n=function(){clearTimeout(r),O&&cancelAnimationFrame(t),setTimeout(e)},r=setTimeout(n,100);O&&(t=requestAnimationFrame(n))})(T)),i=null},s.YM.__c=function(e,t){t.some((function(e){try{e.__h.forEach(I),e.__h=e.__h.filter((function(e){return!e.__||C(e)}))}catch(n){t.some((function(e){e.__h&&(e.__h=[])})),t=[],s.YM.__e(n,e.__v)}})),f&&f(e,t)},s.YM.unmount=function(e){p&&p(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach((function(e){try{I(e)}catch(e){t=e}})),t&&s.YM.__e(t,n.__v))};var O="function"==typeof requestAnimationFrame;function I(e){var t=i,n=e.__c;"function"==typeof n&&(e.__c=void 0,n()),i=t}function C(e){var t=i;e.__c=e.__(),i=t}function R(e,t){return!e||e.length!==t.length||t.some((function(t,n){return t!==e[n]}))}function A(e,t){return"function"==typeof t?t(e):t}function P(e,t){for(var n in t)e[n]=t[n];return e}function N(e,t){for(var n in e)if("__source"!==n&&!(n in t))return!0;for(var r in t)if("__source"!==r&&e[r]!==t[r])return!0;return!1}function L(e){this.props=e}function M(e,t){function n(e){var n=this.props.ref,r=n==e.ref;return!r&&n&&(n.call?n(null):n.current=null),t?!t(this.props,e)||!r:N(this.props,e)}function r(t){return this.shouldComponentUpdate=n,(0,s.az)(e,t)}return r.displayName="Memo("+(e.displayName||e.name)+")",r.prototype.isReactComponent=!0,r.__f=!0,r}(L.prototype=new s.wA).isPureReactComponent=!0,L.prototype.shouldComponentUpdate=function(e,t){return N(this.props,e)||N(this.state,t)};var j=s.YM.__b;s.YM.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),j&&j(e)};var D="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.forward_ref")||3911;function B(e){function t(t){var n=P({},t);return delete n.ref,e(n,t.ref||null)}return t.$$typeof=D,t.render=t,t.prototype.isReactComponent=t.__f=!0,t.displayName="ForwardRef("+(e.displayName||e.name)+")",t}var U=function(e,t){return null==e?null:(0,s.bR)((0,s.bR)(e).map(t))},F={map:U,forEach:U,count:function(e){return e?(0,s.bR)(e).length:0},only:function(e){var t=(0,s.bR)(e);if(1!==t.length)throw"Children.only";return t[0]},toArray:s.bR},H=s.YM.__e;s.YM.__e=function(e,t,n,r){if(e.then)for(var i,o=t;o=o.__;)if((i=o.__c)&&i.__c)return null==t.__e&&(t.__e=n.__e,t.__k=n.__k),i.__c(e,t);H(e,t,n,r)};var G=s.YM.unmount;function W(){this.__u=0,this.t=null,this.__b=null}function q(e){var t=e.__.__c;return t&&t.__e&&t.__e(e)}function V(e){var t,n,r;function i(i){if(t||(t=e()).then((function(e){n=e.default||e}),(function(e){r=e})),r)throw r;if(!n)throw t;return(0,s.az)(n,i)}return i.displayName="Lazy",i.__f=!0,i}function z(){this.u=null,this.o=null}s.YM.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&!0===e.__h&&(e.type=null),G&&G(e)},(W.prototype=new s.wA).__c=function(e,t){var n=t.__c,r=this;null==r.t&&(r.t=[]),r.t.push(n);var i=q(r.__v),o=!1,s=function(){o||(o=!0,n.__R=null,i?i(a):a())};n.__R=s;var a=function(){if(!--r.__u){if(r.state.__e){var e=r.state.__e;r.__v.__k[0]=function e(t,n,r){return t&&(t.__v=null,t.__k=t.__k&&t.__k.map((function(t){return e(t,n,r)})),t.__c&&t.__c.__P===n&&(t.__e&&r.insertBefore(t.__e,t.__d),t.__c.__e=!0,t.__c.__P=r)),t}(e,e.__c.__P,e.__c.__O)}var t;for(r.setState({__e:r.__b=null});t=r.t.pop();)t.forceUpdate()}},u=!0===t.__h;r.__u++||u||r.setState({__e:r.__b=r.__v.__k[0]}),e.then(s,s)},W.prototype.componentWillUnmount=function(){this.t=[]},W.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),r=this.__v.__k[0].__c;this.__v.__k[0]=function e(t,n,r){return t&&(t.__c&&t.__c.__H&&(t.__c.__H.__.forEach((function(e){"function"==typeof e.__c&&e.__c()})),t.__c.__H=null),null!=(t=P({},t)).__c&&(t.__c.__P===r&&(t.__c.__P=n),t.__c=null),t.__k=t.__k&&t.__k.map((function(t){return e(t,n,r)}))),t}(this.__b,n,r.__O=r.__P)}this.__b=null}var i=t.__e&&(0,s.az)(s.HY,null,e.fallback);return i&&(i.__h=null),[(0,s.az)(s.HY,null,t.__e?null:e.children),i]};var Y=function(e,t,n){if(++n[1]===n[0]&&e.o.delete(t),e.props.revealOrder&&("t"!==e.props.revealOrder[0]||!e.o.size))for(n=e.u;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;e.u=n=n[2]}};function K(e){return this.getChildContext=function(){return e.context},e.children}function $(e){var t=this,n=e.i;t.componentWillUnmount=function(){(0,s.sY)(null,t.l),t.l=null,t.i=null},t.i&&t.i!==n&&t.componentWillUnmount(),e.__v?(t.l||(t.i=n,t.l={nodeType:1,parentNode:n,childNodes:[],appendChild:function(e){this.childNodes.push(e),t.i.appendChild(e)},insertBefore:function(e,n){this.childNodes.push(e),t.i.appendChild(e)},removeChild:function(e){this.childNodes.splice(this.childNodes.indexOf(e)>>>1,1),t.i.removeChild(e)}}),(0,s.sY)((0,s.az)(K,{context:t.context},e.__v),t.l)):t.l&&t.componentWillUnmount()}function X(e,t){var n=(0,s.az)($,{__v:e,i:t});return n.containerInfo=t,n}(z.prototype=new s.wA).__e=function(e){var t=this,n=q(t.__v),r=t.o.get(e);return r[0]++,function(i){var o=function(){t.props.revealOrder?(r.push(i),Y(t,e,r)):i()};n?n(o):o()}},z.prototype.render=function(e){this.u=null,this.o=new Map;var t=(0,s.bR)(e.children);e.revealOrder&&"b"===e.revealOrder[0]&&t.reverse();for(var n=t.length;n--;)this.o.set(t[n],this.u=[1,0,this.u]);return e.children},z.prototype.componentDidUpdate=z.prototype.componentDidMount=function(){var e=this;this.o.forEach((function(t,n){Y(e,n,t)}))};var J="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,Z=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|marker(?!H|W|U)|overline|paint|stop|strikethrough|stroke|text(?!L)|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,Q="undefined"!=typeof document,ee=function(e){return("undefined"!=typeof Symbol&&"symbol"==typeof Symbol()?/fil|che|rad/i:/fil|che|ra/i).test(e)};function te(e,t,n){return null==t.__k&&(t.textContent=""),(0,s.sY)(e,t),"function"==typeof n&&n(),e?e.__c:null}function ne(e,t,n){return(0,s.ZB)(e,t),"function"==typeof n&&n(),e?e.__c:null}s.wA.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach((function(e){Object.defineProperty(s.wA.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})}));var re=s.YM.event;function ie(){}function oe(){return this.cancelBubble}function se(){return this.defaultPrevented}s.YM.event=function(e){return re&&(e=re(e)),e.persist=ie,e.isPropagationStopped=oe,e.isDefaultPrevented=se,e.nativeEvent=e};var ae,ue={configurable:!0,get:function(){return this.class}},ce=s.YM.vnode;s.YM.vnode=function(e){var t=e.type,n=e.props,r=n;if("string"==typeof t){var i=-1===t.indexOf("-");for(var o in r={},n){var a=n[o];Q&&"children"===o&&"noscript"===t||"value"===o&&"defaultValue"in n&&null==a||("defaultValue"===o&&"value"in n&&null==n.value?o="value":"download"===o&&!0===a?a="":/ondoubleclick/i.test(o)?o="ondblclick":/^onchange(textarea|input)/i.test(o+t)&&!ee(n.type)?o="oninput":/^onfocus$/i.test(o)?o="onfocusin":/^onblur$/i.test(o)?o="onfocusout":/^on(Ani|Tra|Tou|BeforeInp|Compo)/.test(o)?o=o.toLowerCase():i&&Z.test(o)?o=o.replace(/[A-Z0-9]/,"-$&").toLowerCase():null===a&&(a=void 0),r[o]=a)}"select"==t&&r.multiple&&Array.isArray(r.value)&&(r.value=(0,s.bR)(n.children).forEach((function(e){e.props.selected=-1!=r.value.indexOf(e.props.value)}))),"select"==t&&null!=r.defaultValue&&(r.value=(0,s.bR)(n.children).forEach((function(e){e.props.selected=r.multiple?-1!=r.defaultValue.indexOf(e.props.value):r.defaultValue==e.props.value}))),e.props=r,n.class!=n.className&&(ue.enumerable="className"in n,null!=n.className&&(r.class=n.className),Object.defineProperty(r,"className",ue))}e.$$typeof=J,ce&&ce(e)};var le=s.YM.__r;s.YM.__r=function(e){le&&le(e),ae=e.__c};var de={ReactCurrentDispatcher:{current:{readContext:function(e){return ae.__n[e.__c].props.value}}}},fe="17.0.2";function pe(e){return s.az.bind(null,e)}function he(e){return!!e&&e.$$typeof===J}function ye(e){return he(e)?s.Tm.apply(null,arguments):e}function ve(e){return!!e.__k&&((0,s.sY)(null,e),!0)}function me(e){return e&&(e.base||1===e.nodeType&&e)||null}var ge=function(e,t){return e(t)},be=function(e,t){return e(t)},_e=s.HY;const we={useState:y,useReducer:v,useEffect:m,useLayoutEffect:g,useRef:b,useImperativeHandle:_,useMemo:w,useCallback:k,useContext:x,useDebugValue:S,version:"17.0.2",Children:F,render:te,hydrate:ne,unmountComponentAtNode:ve,createPortal:X,createElement:s.az,createContext:s.kr,createFactory:pe,cloneElement:ye,createRef:s.Vf,Fragment:s.HY,isValidElement:he,findDOMNode:me,Component:s.wA,PureComponent:L,memo:M,forwardRef:B,flushSync:be,unstable_batchedUpdates:ge,StrictMode:s.HY,Suspense:W,SuspenseList:z,lazy:V,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:de}},3931:(e,t,n)=>{"use strict";n.d(t,{HY:()=>g,Tm:()=>F,Vf:()=>m,YM:()=>i,ZB:()=>U,az:()=>y,bR:()=>T,h:()=>y,kr:()=>H,sY:()=>B,wA:()=>b});var r,i,o,s,a,u,c,l={},d=[],f=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function p(e,t){for(var n in t)e[n]=t[n];return e}function h(e){var t=e.parentNode;t&&t.removeChild(e)}function y(e,t,n){var i,o,s,a={};for(s in t)"key"==s?i=t[s]:"ref"==s?o=t[s]:a[s]=t[s];if(arguments.length>2&&(a.children=arguments.length>3?r.call(arguments,2):n),"function"==typeof e&&null!=e.defaultProps)for(s in e.defaultProps)void 0===a[s]&&(a[s]=e.defaultProps[s]);return v(e,a,i,o,null)}function v(e,t,n,r,s){var a={type:e,props:t,key:n,ref:r,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:null==s?++o:s};return null==s&&null!=i.vnode&&i.vnode(a),a}function m(){return{current:null}}function g(e){return e.children}function b(e,t){this.props=e,this.context=t}function _(e,t){if(null==t)return e.__?_(e.__,e.__.__k.indexOf(e)+1):null;for(var n;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e)return n.__e;return"function"==typeof e.type?_(e):null}function w(e){var t,n;if(null!=(e=e.__)&&null!=e.__c){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e){e.__e=e.__c.base=n.__e;break}return w(e)}}function k(e){(!e.__d&&(e.__d=!0)&&s.push(e)&&!x.__r++||u!==i.debounceRendering)&&((u=i.debounceRendering)||a)(x)}function x(){for(var e;x.__r=s.length;)e=s.sort((function(e,t){return e.__v.__b-t.__v.__b})),s=[],e.some((function(e){var t,n,r,i,o,s;e.__d&&(o=(i=(t=e).__v).__e,(s=t.__P)&&(n=[],(r=p({},i)).__v=i.__v+1,P(s,i,r,t.__n,void 0!==s.ownerSVGElement,null!=i.__h?[o]:null,n,null==o?_(i):o,i.__h),N(n,i),i.__e!=o&&w(i)))}))}function S(e,t,n,r,i,o,s,a,u,c){var f,p,h,y,m,b,w,k=r&&r.__k||d,x=k.length;for(n.__k=[],f=0;f<t.length;f++)if(null!=(y=n.__k[f]=null==(y=t[f])||"boolean"==typeof y?null:"string"==typeof y||"number"==typeof y||"bigint"==typeof y?v(null,y,null,null,y):Array.isArray(y)?v(g,{children:y},null,null,null):y.__b>0?v(y.type,y.props,y.key,null,y.__v):y)){if(y.__=n,y.__b=n.__b+1,null===(h=k[f])||h&&y.key==h.key&&y.type===h.type)k[f]=void 0;else for(p=0;p<x;p++){if((h=k[p])&&y.key==h.key&&y.type===h.type){k[p]=void 0;break}h=null}P(e,y,h=h||l,i,o,s,a,u,c),m=y.__e,(p=y.ref)&&h.ref!=p&&(w||(w=[]),h.ref&&w.push(h.ref,null,y),w.push(p,y.__c||m,y)),null!=m?(null==b&&(b=m),"function"==typeof y.type&&y.__k===h.__k?y.__d=u=E(y,u,e):u=O(e,y,h,k,m,u),"function"==typeof n.type&&(n.__d=u)):u&&h.__e==u&&u.parentNode!=e&&(u=_(h))}for(n.__e=b,f=x;f--;)null!=k[f]&&("function"==typeof n.type&&null!=k[f].__e&&k[f].__e==n.__d&&(n.__d=_(r,f+1)),j(k[f],k[f]));if(w)for(f=0;f<w.length;f++)M(w[f],w[++f],w[++f])}function E(e,t,n){for(var r,i=e.__k,o=0;i&&o<i.length;o++)(r=i[o])&&(r.__=e,t="function"==typeof r.type?E(r,t,n):O(n,r,r,i,r.__e,t));return t}function T(e,t){return t=t||[],null==e||"boolean"==typeof e||(Array.isArray(e)?e.some((function(e){T(e,t)})):t.push(e)),t}function O(e,t,n,r,i,o){var s,a,u;if(void 0!==t.__d)s=t.__d,t.__d=void 0;else if(null==n||i!=o||null==i.parentNode)e:if(null==o||o.parentNode!==e)e.appendChild(i),s=null;else{for(a=o,u=0;(a=a.nextSibling)&&u<r.length;u+=2)if(a==i)break e;e.insertBefore(i,o),s=o}return void 0!==s?s:i.nextSibling}function I(e,t,n){"-"===t[0]?e.setProperty(t,n):e[t]=null==n?"":"number"!=typeof n||f.test(t)?n:n+"px"}function C(e,t,n,r,i){var o;e:if("style"===t)if("string"==typeof n)e.style.cssText=n;else{if("string"==typeof r&&(e.style.cssText=r=""),r)for(t in r)n&&t in n||I(e.style,t,"");if(n)for(t in n)r&&n[t]===r[t]||I(e.style,t,n[t])}else if("o"===t[0]&&"n"===t[1])o=t!==(t=t.replace(/Capture$/,"")),t=t.toLowerCase()in e?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+o]=n,n?r||e.addEventListener(t,o?A:R,o):e.removeEventListener(t,o?A:R,o);else if("dangerouslySetInnerHTML"!==t){if(i)t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if("href"!==t&&"list"!==t&&"form"!==t&&"tabIndex"!==t&&"download"!==t&&t in e)try{e[t]=null==n?"":n;break e}catch(e){}"function"==typeof n||(null!=n&&(!1!==n||"a"===t[0]&&"r"===t[1])?e.setAttribute(t,n):e.removeAttribute(t))}}function R(e){this.l[e.type+!1](i.event?i.event(e):e)}function A(e){this.l[e.type+!0](i.event?i.event(e):e)}function P(e,t,n,r,o,s,a,u,c){var l,d,f,h,y,v,m,_,w,k,x,E=t.type;if(void 0!==t.constructor)return null;null!=n.__h&&(c=n.__h,u=t.__e=n.__e,t.__h=null,s=[u]),(l=i.__b)&&l(t);try{e:if("function"==typeof E){if(_=t.props,w=(l=E.contextType)&&r[l.__c],k=l?w?w.props.value:l.__:r,n.__c?m=(d=t.__c=n.__c).__=d.__E:("prototype"in E&&E.prototype.render?t.__c=d=new E(_,k):(t.__c=d=new b(_,k),d.constructor=E,d.render=D),w&&w.sub(d),d.props=_,d.state||(d.state={}),d.context=k,d.__n=r,f=d.__d=!0,d.__h=[]),null==d.__s&&(d.__s=d.state),null!=E.getDerivedStateFromProps&&(d.__s==d.state&&(d.__s=p({},d.__s)),p(d.__s,E.getDerivedStateFromProps(_,d.__s))),h=d.props,y=d.state,f)null==E.getDerivedStateFromProps&&null!=d.componentWillMount&&d.componentWillMount(),null!=d.componentDidMount&&d.__h.push(d.componentDidMount);else{if(null==E.getDerivedStateFromProps&&_!==h&&null!=d.componentWillReceiveProps&&d.componentWillReceiveProps(_,k),!d.__e&&null!=d.shouldComponentUpdate&&!1===d.shouldComponentUpdate(_,d.__s,k)||t.__v===n.__v){d.props=_,d.state=d.__s,t.__v!==n.__v&&(d.__d=!1),d.__v=t,t.__e=n.__e,t.__k=n.__k,t.__k.forEach((function(e){e&&(e.__=t)})),d.__h.length&&a.push(d);break e}null!=d.componentWillUpdate&&d.componentWillUpdate(_,d.__s,k),null!=d.componentDidUpdate&&d.__h.push((function(){d.componentDidUpdate(h,y,v)}))}d.context=k,d.props=_,d.state=d.__s,(l=i.__r)&&l(t),d.__d=!1,d.__v=t,d.__P=e,l=d.render(d.props,d.state,d.context),d.state=d.__s,null!=d.getChildContext&&(r=p(p({},r),d.getChildContext())),f||null==d.getSnapshotBeforeUpdate||(v=d.getSnapshotBeforeUpdate(h,y)),x=null!=l&&l.type===g&&null==l.key?l.props.children:l,S(e,Array.isArray(x)?x:[x],t,n,r,o,s,a,u,c),d.base=t.__e,t.__h=null,d.__h.length&&a.push(d),m&&(d.__E=d.__=null),d.__e=!1}else null==s&&t.__v===n.__v?(t.__k=n.__k,t.__e=n.__e):t.__e=L(n.__e,t,n,r,o,s,a,c);(l=i.diffed)&&l(t)}catch(e){t.__v=null,(c||null!=s)&&(t.__e=u,t.__h=!!c,s[s.indexOf(u)]=null),i.__e(e,t,n)}}function N(e,t){i.__c&&i.__c(t,e),e.some((function(t){try{e=t.__h,t.__h=[],e.some((function(e){e.call(t)}))}catch(e){i.__e(e,t.__v)}}))}function L(e,t,n,i,o,s,a,u){var c,d,f,p=n.props,y=t.props,v=t.type,m=0;if("svg"===v&&(o=!0),null!=s)for(;m<s.length;m++)if((c=s[m])&&"setAttribute"in c==!!v&&(v?c.localName===v:3===c.nodeType)){e=c,s[m]=null;break}if(null==e){if(null===v)return document.createTextNode(y);e=o?document.createElementNS("http://www.w3.org/2000/svg",v):document.createElement(v,y.is&&y),s=null,u=!1}if(null===v)p===y||u&&e.data===y||(e.data=y);else{if(s=s&&r.call(e.childNodes),d=(p=n.props||l).dangerouslySetInnerHTML,f=y.dangerouslySetInnerHTML,!u){if(null!=s)for(p={},m=0;m<e.attributes.length;m++)p[e.attributes[m].name]=e.attributes[m].value;(f||d)&&(f&&(d&&f.__html==d.__html||f.__html===e.innerHTML)||(e.innerHTML=f&&f.__html||""))}if(function(e,t,n,r,i){var o;for(o in n)"children"===o||"key"===o||o in t||C(e,o,null,n[o],r);for(o in t)i&&"function"!=typeof t[o]||"children"===o||"key"===o||"value"===o||"checked"===o||n[o]===t[o]||C(e,o,t[o],n[o],r)}(e,y,p,o,u),f)t.__k=[];else if(m=t.props.children,S(e,Array.isArray(m)?m:[m],t,n,i,o&&"foreignObject"!==v,s,a,s?s[0]:n.__k&&_(n,0),u),null!=s)for(m=s.length;m--;)null!=s[m]&&h(s[m]);u||("value"in y&&void 0!==(m=y.value)&&(m!==e.value||"progress"===v&&!m||"option"===v&&m!==p.value)&&C(e,"value",m,p.value,!1),"checked"in y&&void 0!==(m=y.checked)&&m!==e.checked&&C(e,"checked",m,p.checked,!1))}return e}function M(e,t,n){try{"function"==typeof e?e(t):e.current=t}catch(e){i.__e(e,n)}}function j(e,t,n){var r,o;if(i.unmount&&i.unmount(e),(r=e.ref)&&(r.current&&r.current!==e.__e||M(r,null,t)),null!=(r=e.__c)){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(e){i.__e(e,t)}r.base=r.__P=null}if(r=e.__k)for(o=0;o<r.length;o++)r[o]&&j(r[o],t,"function"!=typeof e.type);n||null==e.__e||h(e.__e),e.__e=e.__d=void 0}function D(e,t,n){return this.constructor(e,n)}function B(e,t,n){var o,s,a;i.__&&i.__(e,t),s=(o="function"==typeof n)?null:n&&n.__k||t.__k,a=[],P(t,e=(!o&&n||t).__k=y(g,null,[e]),s||l,l,void 0!==t.ownerSVGElement,!o&&n?[n]:s?null:t.firstChild?r.call(t.childNodes):null,a,!o&&n?n:s?s.__e:t.firstChild,o),N(a,e)}function U(e,t){B(e,t,U)}function F(e,t,n){var i,o,s,a=p({},e.props);for(s in t)"key"==s?i=t[s]:"ref"==s?o=t[s]:a[s]=t[s];return arguments.length>2&&(a.children=arguments.length>3?r.call(arguments,2):n),v(e.type,a,i||e.key,o||e.ref,null)}function H(e,t){var n={__c:t="__cC"+c++,__:e,Consumer:function(e,t){return e.children(t)},Provider:function(e){var n,r;return this.getChildContext||(n=[],(r={})[t]=this,this.getChildContext=function(){return r},this.shouldComponentUpdate=function(e){this.props.value!==e.value&&n.some(k)},this.sub=function(e){n.push(e);var t=e.componentWillUnmount;e.componentWillUnmount=function(){n.splice(n.indexOf(e),1),t&&t.call(e)}}),e.children}};return n.Provider.__=n.Consumer.contextType=n}r=d.slice,i={__e:function(e,t,n,r){for(var i,o,s;t=t.__;)if((i=t.__c)&&!i.__)try{if((o=i.constructor)&&null!=o.getDerivedStateFromError&&(i.setState(o.getDerivedStateFromError(e)),s=i.__d),null!=i.componentDidCatch&&(i.componentDidCatch(e,r||{}),s=i.__d),s)return i.__E=i}catch(t){e=t}throw e}},o=0,b.prototype.setState=function(e,t){var n;n=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=p({},this.state),"function"==typeof e&&(e=e(p({},n),this.props)),e&&p(n,e),null!=e&&this.__v&&(t&&this.__h.push(t),k(this))},b.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),k(this))},b.prototype.render=g,s=[],a="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,x.__r=0,c=0},8909:(e,t)=>{"use strict";var n=60103,r=60106,i=60107,o=60108,s=60114,a=60109,u=60110,c=60112,l=60113,d=60120,f=60115,p=60116,h=60121,y=60122,v=60117,m=60129,g=60131;if("function"==typeof Symbol&&Symbol.for){var b=Symbol.for;n=b("react.element"),r=b("react.portal"),i=b("react.fragment"),o=b("react.strict_mode"),s=b("react.profiler"),a=b("react.provider"),u=b("react.context"),c=b("react.forward_ref"),l=b("react.suspense"),d=b("react.suspense_list"),f=b("react.memo"),p=b("react.lazy"),h=b("react.block"),y=b("react.server.block"),v=b("react.fundamental"),m=b("react.debug_trace_mode"),g=b("react.legacy_hidden")}function _(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case n:switch(e=e.type){case i:case s:case o:case l:case d:return e;default:switch(e=e&&e.$$typeof){case u:case c:case p:case f:case a:return e;default:return t}}case r:return t}}}var w=a,k=n,x=c,S=i,E=p,T=f,O=r,I=s,C=o,R=l;t.ContextConsumer=u,t.ContextProvider=w,t.Element=k,t.ForwardRef=x,t.Fragment=S,t.Lazy=E,t.Memo=T,t.Portal=O,t.Profiler=I,t.StrictMode=C,t.Suspense=R,t.isAsyncMode=function(){return!1},t.isConcurrentMode=function(){return!1},t.isContextConsumer=function(e){return _(e)===u},t.isContextProvider=function(e){return _(e)===a},t.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===n},t.isForwardRef=function(e){return _(e)===c},t.isFragment=function(e){return _(e)===i},t.isLazy=function(e){return _(e)===p},t.isMemo=function(e){return _(e)===f},t.isPortal=function(e){return _(e)===r},t.isProfiler=function(e){return _(e)===s},t.isStrictMode=function(e){return _(e)===o},t.isSuspense=function(e){return _(e)===l},t.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===i||e===s||e===m||e===o||e===l||e===d||e===g||"object"==typeof e&&null!==e&&(e.$$typeof===p||e.$$typeof===f||e.$$typeof===a||e.$$typeof===u||e.$$typeof===c||e.$$typeof===v||e.$$typeof===h||e[0]===y)},t.typeOf=_},2024:(e,t,n)=>{"use strict";e.exports=n(8909)},4808:(e,t,n)=>{"use strict";n.d(t,{zt:()=>l,$j:()=>W});var r=n(6606),i=r.default.createContext(null);var o=function(e){e()},s=function(){return o};var a={notify:function(){},get:function(){return[]}};function u(e,t){var n,r=a;function i(){u.onStateChange&&u.onStateChange()}function o(){n||(n=t?t.addNestedSub(i):e.subscribe(i),r=function(){var e=s(),t=null,n=null;return{clear:function(){t=null,n=null},notify:function(){e((function(){for(var e=t;e;)e.callback(),e=e.next}))},get:function(){for(var e=[],n=t;n;)e.push(n),n=n.next;return e},subscribe:function(e){var r=!0,i=n={callback:e,next:null,prev:n};return i.prev?i.prev.next=i:t=i,function(){r&&null!==t&&(r=!1,i.next?i.next.prev=i.prev:n=i.prev,i.prev?i.prev.next=i.next:t=i.next)}}}}())}var u={addNestedSub:function(e){return o(),r.subscribe(e)},notifyNestedSubs:function(){r.notify()},handleChangeWrapper:i,isSubscribed:function(){return Boolean(n)},trySubscribe:o,tryUnsubscribe:function(){n&&(n(),n=void 0,r.clear(),r=a)},getListeners:function(){return r}};return u}var c="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement?r.useLayoutEffect:r.useEffect;const l=function(e){var t=e.store,n=e.context,o=e.children,s=(0,r.useMemo)((function(){var e=u(t);return{store:t,subscription:e}}),[t]),a=(0,r.useMemo)((function(){return t.getState()}),[t]);c((function(){var e=s.subscription;return e.onStateChange=e.notifyNestedSubs,e.trySubscribe(),a!==t.getState()&&e.notifyNestedSubs(),function(){e.tryUnsubscribe(),e.onStateChange=null}}),[s,a]);var l=n||i;return r.default.createElement(l.Provider,{value:s},o)};function d(){return d=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},d.apply(this,arguments)}function f(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}var p=n(6297),h=n.n(p),y=n(2024),v=["getDisplayName","methodName","renderCountProp","shouldHandleStateChanges","storeKey","withRef","forwardRef","context"],m=["reactReduxForwardedRef"],g=[],b=[null,null];function _(e,t){var n=e[1];return[t.payload,n+1]}function w(e,t,n){c((function(){return e.apply(void 0,t)}),n)}function k(e,t,n,r,i,o,s){e.current=r,t.current=i,n.current=!1,o.current&&(o.current=null,s())}function x(e,t,n,r,i,o,s,a,u,c){if(e){var l=!1,d=null,f=function(){if(!l){var e,n,f=t.getState();try{e=r(f,i.current)}catch(e){n=e,d=e}n||(d=null),e===o.current?s.current||u():(o.current=e,a.current=e,s.current=!0,c({type:"STORE_UPDATED",payload:{error:n}}))}};n.onStateChange=f,n.trySubscribe(),f();return function(){if(l=!0,n.tryUnsubscribe(),n.onStateChange=null,d)throw d}}}var S=function(){return[null,0]};function E(e,t){void 0===t&&(t={});var n=t,o=n.getDisplayName,s=void 0===o?function(e){return"ConnectAdvanced("+e+")"}:o,a=n.methodName,c=void 0===a?"connectAdvanced":a,l=n.renderCountProp,p=void 0===l?void 0:l,E=n.shouldHandleStateChanges,T=void 0===E||E,O=n.storeKey,I=void 0===O?"store":O,C=(n.withRef,n.forwardRef),R=void 0!==C&&C,A=n.context,P=void 0===A?i:A,N=f(n,v),L=P;return function(t){var n=t.displayName||t.name||"Component",i=s(n),o=d({},N,{getDisplayName:s,methodName:c,renderCountProp:p,shouldHandleStateChanges:T,storeKey:I,displayName:i,wrappedComponentName:n,WrappedComponent:t}),a=N.pure;var l=a?r.useMemo:function(e){return e()};function v(n){var i=(0,r.useMemo)((function(){var e=n.reactReduxForwardedRef,t=f(n,m);return[n.context,e,t]}),[n]),s=i[0],a=i[1],c=i[2],p=(0,r.useMemo)((function(){return s&&s.Consumer&&(0,y.isContextConsumer)(r.default.createElement(s.Consumer,null))?s:L}),[s,L]),h=(0,r.useContext)(p),v=Boolean(n.store)&&Boolean(n.store.getState)&&Boolean(n.store.dispatch);Boolean(h)&&Boolean(h.store);var E=v?n.store:h.store,O=(0,r.useMemo)((function(){return function(t){return e(t.dispatch,o)}(E)}),[E]),I=(0,r.useMemo)((function(){if(!T)return b;var e=u(E,v?null:h.subscription),t=e.notifyNestedSubs.bind(e);return[e,t]}),[E,v,h]),C=I[0],R=I[1],A=(0,r.useMemo)((function(){return v?h:d({},h,{subscription:C})}),[v,h,C]),P=(0,r.useReducer)(_,g,S),N=P[0][0],M=P[1];if(N&&N.error)throw N.error;var j=(0,r.useRef)(),D=(0,r.useRef)(c),B=(0,r.useRef)(),U=(0,r.useRef)(!1),F=l((function(){return B.current&&c===D.current?B.current:O(E.getState(),c)}),[E,N,c]);w(k,[D,j,U,c,F,B,R]),w(x,[T,E,C,O,D,j,U,B,R,M],[E,C,O]);var H=(0,r.useMemo)((function(){return r.default.createElement(t,d({},F,{ref:a}))}),[a,t,F]);return(0,r.useMemo)((function(){return T?r.default.createElement(p.Provider,{value:A},H):H}),[p,H,A])}var E=a?r.default.memo(v):v;if(E.WrappedComponent=t,E.displayName=v.displayName=i,R){var O=r.default.forwardRef((function(e,t){return r.default.createElement(E,d({},e,{reactReduxForwardedRef:t}))}));return O.displayName=i,O.WrappedComponent=t,h()(O,t)}return h()(E,t)}}function T(e,t){return e===t?0!==e||0!==t||1/e==1/t:e!=e&&t!=t}function O(e,t){if(T(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(var i=0;i<n.length;i++)if(!Object.prototype.hasOwnProperty.call(t,n[i])||!T(e[n[i]],t[n[i]]))return!1;return!0}function I(e){return function(t,n){var r=e(t,n);function i(){return r}return i.dependsOnOwnProps=!1,i}}function C(e){return null!==e.dependsOnOwnProps&&void 0!==e.dependsOnOwnProps?Boolean(e.dependsOnOwnProps):1!==e.length}function R(e,t){return function(t,n){n.displayName;var r=function(e,t){return r.dependsOnOwnProps?r.mapToProps(e,t):r.mapToProps(e)};return r.dependsOnOwnProps=!0,r.mapToProps=function(t,n){r.mapToProps=e,r.dependsOnOwnProps=C(e);var i=r(t,n);return"function"==typeof i&&(r.mapToProps=i,r.dependsOnOwnProps=C(i),i=r(t,n)),i},r}}const A=[function(e){return"function"==typeof e?R(e):void 0},function(e){return e?void 0:I((function(e){return{dispatch:e}}))},function(e){return e&&"object"==typeof e?I((function(t){return function(e,t){var n={},r=function(r){var i=e[r];"function"==typeof i&&(n[r]=function(){return t(i.apply(void 0,arguments))})};for(var i in e)r(i);return n}(e,t)})):void 0}];const P=[function(e){return"function"==typeof e?R(e):void 0},function(e){return e?void 0:I((function(){return{}}))}];function N(e,t,n){return d({},n,e,t)}const L=[function(e){return"function"==typeof e?function(e){return function(t,n){n.displayName;var r,i=n.pure,o=n.areMergedPropsEqual,s=!1;return function(t,n,a){var u=e(t,n,a);return s?i&&o(u,r)||(r=u):(s=!0,r=u),r}}}(e):void 0},function(e){return e?void 0:function(){return N}}];var M=["initMapStateToProps","initMapDispatchToProps","initMergeProps"];function j(e,t,n,r){return function(i,o){return n(e(i,o),t(r,o),o)}}function D(e,t,n,r,i){var o,s,a,u,c,l=i.areStatesEqual,d=i.areOwnPropsEqual,f=i.areStatePropsEqual,p=!1;function h(i,p){var h,y,v=!d(p,s),m=!l(i,o);return o=i,s=p,v&&m?(a=e(o,s),t.dependsOnOwnProps&&(u=t(r,s)),c=n(a,u,s)):v?(e.dependsOnOwnProps&&(a=e(o,s)),t.dependsOnOwnProps&&(u=t(r,s)),c=n(a,u,s)):m?(h=e(o,s),y=!f(h,a),a=h,y&&(c=n(a,u,s)),c):c}return function(i,l){return p?h(i,l):(a=e(o=i,s=l),u=t(r,s),c=n(a,u,s),p=!0,c)}}function B(e,t){var n=t.initMapStateToProps,r=t.initMapDispatchToProps,i=t.initMergeProps,o=f(t,M),s=n(e,o),a=r(e,o),u=i(e,o);return(o.pure?D:j)(s,a,u,e,o)}var U=["pure","areStatesEqual","areOwnPropsEqual","areStatePropsEqual","areMergedPropsEqual"];function F(e,t,n){for(var r=t.length-1;r>=0;r--){var i=t[r](e);if(i)return i}return function(t,r){throw new Error("Invalid value of type "+typeof e+" for "+n+" argument when connecting component "+r.wrappedComponentName+".")}}function H(e,t){return e===t}function G(e){var t=void 0===e?{}:e,n=t.connectHOC,r=void 0===n?E:n,i=t.mapStateToPropsFactories,o=void 0===i?P:i,s=t.mapDispatchToPropsFactories,a=void 0===s?A:s,u=t.mergePropsFactories,c=void 0===u?L:u,l=t.selectorFactory,p=void 0===l?B:l;return function(e,t,n,i){void 0===i&&(i={});var s=i,u=s.pure,l=void 0===u||u,h=s.areStatesEqual,y=void 0===h?H:h,v=s.areOwnPropsEqual,m=void 0===v?O:v,g=s.areStatePropsEqual,b=void 0===g?O:g,_=s.areMergedPropsEqual,w=void 0===_?O:_,k=f(s,U),x=F(e,o,"mapStateToProps"),S=F(t,a,"mapDispatchToProps"),E=F(n,c,"mergeProps");return r(p,d({methodName:"connect",getDisplayName:function(e){return"Connect("+e+")"},shouldHandleStateChanges:Boolean(e),initMapStateToProps:x,initMapDispatchToProps:S,initMergeProps:E,pure:l,areStatesEqual:y,areOwnPropsEqual:m,areStatePropsEqual:b,areMergedPropsEqual:w},k))}}const W=G();var q;q=r.unstable_batchedUpdates,o=q},5885:function(e,t,n){!function(e){"use strict";function t(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}function r(e,t){Object.defineProperty(this,"kind",{value:e,enumerable:!0}),t&&t.length&&Object.defineProperty(this,"path",{value:t,enumerable:!0})}function i(e,t,n){i.super_.call(this,"E",e),Object.defineProperty(this,"lhs",{value:t,enumerable:!0}),Object.defineProperty(this,"rhs",{value:n,enumerable:!0})}function o(e,t){o.super_.call(this,"N",e),Object.defineProperty(this,"rhs",{value:t,enumerable:!0})}function s(e,t){s.super_.call(this,"D",e),Object.defineProperty(this,"lhs",{value:t,enumerable:!0})}function a(e,t,n){a.super_.call(this,"A",e),Object.defineProperty(this,"index",{value:t,enumerable:!0}),Object.defineProperty(this,"item",{value:n,enumerable:!0})}function u(e,t,n){var r=e.slice((n||t)+1||e.length);return e.length=t<0?e.length+t:t,e.push.apply(e,r),e}function c(e){var t=void 0===e?"undefined":R(e);return"object"!==t?t:e===Math?"math":null===e?"null":Array.isArray(e)?"array":"[object Date]"===Object.prototype.toString.call(e)?"date":"function"==typeof e.toString&&/^\/.*\//.test(e.toString())?"regexp":"object"}function l(e,t,n,r,d,f,p){p=p||[];var h=(d=d||[]).slice(0);if(void 0!==f){if(r){if("function"==typeof r&&r(h,f))return;if("object"===(void 0===r?"undefined":R(r))){if(r.prefilter&&r.prefilter(h,f))return;if(r.normalize){var y=r.normalize(h,f,e,t);y&&(e=y[0],t=y[1])}}}h.push(f)}"regexp"===c(e)&&"regexp"===c(t)&&(e=e.toString(),t=t.toString());var v=void 0===e?"undefined":R(e),m=void 0===t?"undefined":R(t),g="undefined"!==v||p&&p[p.length-1].lhs&&p[p.length-1].lhs.hasOwnProperty(f),b="undefined"!==m||p&&p[p.length-1].rhs&&p[p.length-1].rhs.hasOwnProperty(f);if(!g&&b)n(new o(h,t));else if(!b&&g)n(new s(h,e));else if(c(e)!==c(t))n(new i(h,e,t));else if("date"===c(e)&&e-t!=0)n(new i(h,e,t));else if("object"===v&&null!==e&&null!==t)if(p.filter((function(t){return t.lhs===e})).length)e!==t&&n(new i(h,e,t));else{if(p.push({lhs:e,rhs:t}),Array.isArray(e)){var _;for(e.length,_=0;_<e.length;_++)_>=t.length?n(new a(h,_,new s(void 0,e[_]))):l(e[_],t[_],n,r,h,_,p);for(;_<t.length;)n(new a(h,_,new o(void 0,t[_++])))}else{var w=Object.keys(e),k=Object.keys(t);w.forEach((function(i,o){var s=k.indexOf(i);s>=0?(l(e[i],t[i],n,r,h,i,p),k=u(k,s)):l(e[i],void 0,n,r,h,i,p)})),k.forEach((function(e){l(void 0,t[e],n,r,h,e,p)}))}p.length=p.length-1}else e!==t&&("number"===v&&isNaN(e)&&isNaN(t)||n(new i(h,e,t)))}function d(e,t,n,r){return r=r||[],l(e,t,(function(e){e&&r.push(e)}),n),r.length?r:void 0}function f(e,t,n){if(n.path&&n.path.length){var r,i=e[t],o=n.path.length-1;for(r=0;r<o;r++)i=i[n.path[r]];switch(n.kind){case"A":f(i[n.path[r]],n.index,n.item);break;case"D":delete i[n.path[r]];break;case"E":case"N":i[n.path[r]]=n.rhs}}else switch(n.kind){case"A":f(e[t],n.index,n.item);break;case"D":e=u(e,t);break;case"E":case"N":e[t]=n.rhs}return e}function p(e,t,n){if(e&&t&&n&&n.kind){for(var r=e,i=-1,o=n.path?n.path.length-1:0;++i<o;)void 0===r[n.path[i]]&&(r[n.path[i]]="number"==typeof n.path[i]?[]:{}),r=r[n.path[i]];switch(n.kind){case"A":f(n.path?r[n.path[i]]:r,n.index,n.item);break;case"D":delete r[n.path[i]];break;case"E":case"N":r[n.path[i]]=n.rhs}}}function h(e,t,n){if(n.path&&n.path.length){var r,i=e[t],o=n.path.length-1;for(r=0;r<o;r++)i=i[n.path[r]];switch(n.kind){case"A":h(i[n.path[r]],n.index,n.item);break;case"D":case"E":i[n.path[r]]=n.lhs;break;case"N":delete i[n.path[r]]}}else switch(n.kind){case"A":h(e[t],n.index,n.item);break;case"D":case"E":e[t]=n.lhs;break;case"N":e=u(e,t)}return e}function y(e,t,n){if(e&&t&&n&&n.kind){var r,i,o=e;for(i=n.path.length-1,r=0;r<i;r++)void 0===o[n.path[r]]&&(o[n.path[r]]={}),o=o[n.path[r]];switch(n.kind){case"A":h(o[n.path[r]],n.index,n.item);break;case"D":case"E":o[n.path[r]]=n.lhs;break;case"N":delete o[n.path[r]]}}}function v(e,t,n){e&&t&&l(e,t,(function(r){n&&!n(e,t,r)||p(e,t,r)}))}function m(e){return"color: "+N[e].color+"; font-weight: bold"}function g(e){var t=e.kind,n=e.path,r=e.lhs,i=e.rhs,o=e.index,s=e.item;switch(t){case"E":return[n.join("."),r,"→",i];case"N":return[n.join("."),i];case"D":return[n.join(".")];case"A":return[n.join(".")+"["+o+"]",s];default:return[]}}function b(e,t,n,r){var i=d(e,t);try{r?n.groupCollapsed("diff"):n.group("diff")}catch(e){n.log("diff")}i?i.forEach((function(e){var t=e.kind,r=g(e);n.log.apply(n,["%c "+N[t].text,m(t)].concat(A(r)))})):n.log("—— no diff ——");try{n.groupEnd()}catch(e){n.log("—— diff end —— ")}}function _(e,t,n,r){switch(void 0===e?"undefined":R(e)){case"object":return"function"==typeof e[r]?e[r].apply(e,A(n)):e[r];case"function":return e(t);default:return e}}function w(e){var t=e.timestamp,n=e.duration;return function(e,r,i){var o=["action"];return o.push("%c"+String(e.type)),t&&o.push("%c@ "+r),n&&o.push("%c(in "+i.toFixed(2)+" ms)"),o.join(" ")}}function k(e,t){var n=t.logger,r=t.actionTransformer,i=t.titleFormatter,o=void 0===i?w(t):i,s=t.collapsed,a=t.colors,u=t.level,c=t.diff,l=void 0===t.titleFormatter;e.forEach((function(i,d){var f=i.started,p=i.startedTime,h=i.action,y=i.prevState,v=i.error,m=i.took,g=i.nextState,w=e[d+1];w&&(g=w.prevState,m=w.started-f);var k=r(h),x="function"==typeof s?s((function(){return g}),h,i):s,S=I(p),E=a.title?"color: "+a.title(k)+";":"",T=["color: gray; font-weight: lighter;"];T.push(E),t.timestamp&&T.push("color: gray; font-weight: lighter;"),t.duration&&T.push("color: gray; font-weight: lighter;");var O=o(k,S,m);try{x?a.title&&l?n.groupCollapsed.apply(n,["%c "+O].concat(T)):n.groupCollapsed(O):a.title&&l?n.group.apply(n,["%c "+O].concat(T)):n.group(O)}catch(e){n.log(O)}var C=_(u,k,[y],"prevState"),R=_(u,k,[k],"action"),A=_(u,k,[v,y],"error"),P=_(u,k,[g],"nextState");if(C)if(a.prevState){var N="color: "+a.prevState(y)+"; font-weight: bold";n[C]("%c prev state",N,y)}else n[C]("prev state",y);if(R)if(a.action){var L="color: "+a.action(k)+"; font-weight: bold";n[R]("%c action    ",L,k)}else n[R]("action    ",k);if(v&&A)if(a.error){var M="color: "+a.error(v,y)+"; font-weight: bold;";n[A]("%c error     ",M,v)}else n[A]("error     ",v);if(P)if(a.nextState){var j="color: "+a.nextState(g)+"; font-weight: bold";n[P]("%c next state",j,g)}else n[P]("next state",g);c&&b(y,g,n,x);try{n.groupEnd()}catch(e){n.log("—— log end ——")}}))}function x(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object.assign({},L,e),n=t.logger,r=t.stateTransformer,i=t.errorTransformer,o=t.predicate,s=t.logErrors,a=t.diffPredicate;if(void 0===n)return function(){return function(e){return function(t){return e(t)}}};if(e.getState&&e.dispatch)return function(){return function(e){return function(t){return e(t)}}};var u=[];return function(e){var n=e.getState;return function(e){return function(c){if("function"==typeof o&&!o(n,c))return e(c);var l={};u.push(l),l.started=C.now(),l.startedTime=new Date,l.prevState=r(n()),l.action=c;var d=void 0;if(s)try{d=e(c)}catch(e){l.error=i(e)}else d=e(c);l.took=C.now()-l.started,l.nextState=r(n());var f=t.diff&&"function"==typeof a?a(n,c):t.diff;if(k(u,Object.assign({},t,{diff:f})),u.length=0,l.error)throw l.error;return d}}}}var S,E,T=function(e,t){return new Array(t+1).join(e)},O=function(e,t){return T("0",t-e.toString().length)+e},I=function(e){return O(e.getHours(),2)+":"+O(e.getMinutes(),2)+":"+O(e.getSeconds(),2)+"."+O(e.getMilliseconds(),3)},C="undefined"!=typeof performance&&null!==performance&&"function"==typeof performance.now?performance:Date,R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},A=function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)},P=[];S="object"===(void 0===n.g?"undefined":R(n.g))&&n.g?n.g:"undefined"!=typeof window?window:{},(E=S.DeepDiff)&&P.push((function(){void 0!==E&&S.DeepDiff===d&&(S.DeepDiff=E,E=void 0)})),t(i,r),t(o,r),t(s,r),t(a,r),Object.defineProperties(d,{diff:{value:d,enumerable:!0},observableDiff:{value:l,enumerable:!0},applyDiff:{value:v,enumerable:!0},applyChange:{value:p,enumerable:!0},revertChange:{value:y,enumerable:!0},isConflict:{value:function(){return void 0!==E},enumerable:!0},noConflict:{value:function(){return P&&(P.forEach((function(e){e()})),P=null),d},enumerable:!0}});var N={E:{color:"#2196F3",text:"CHANGED:"},N:{color:"#4CAF50",text:"ADDED:"},D:{color:"#F44336",text:"DELETED:"},A:{color:"#2196F3",text:"ARRAY:"}},L={level:"log",logger:console,logErrors:!0,collapsed:void 0,predicate:void 0,duration:!1,timestamp:!0,stateTransformer:function(e){return e},actionTransformer:function(e){return e},errorTransformer:function(e){return e},colors:{title:function(){return"inherit"},prevState:function(){return"#9E9E9E"},action:function(){return"#03A9F4"},nextState:function(){return"#4CAF50"},error:function(){return"#F20404"}},diff:!1,diffPredicate:void 0,transformer:void 0},M=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.dispatch,n=e.getState;return"function"==typeof t||"function"==typeof n?x()({dispatch:t,getState:n}):void 0};e.defaults=L,e.createLogger=x,e.logger=M,e.default=M,Object.defineProperty(e,"__esModule",{value:!0})}(t)},9e3:(e,t)=>{"use strict";function n(e){return function(t){var n=t.dispatch,r=t.getState;return function(t){return function(i){return"function"==typeof i?i(n,r,e):t(i)}}}}var r=n();r.withExtraArgument=n,t.Z=r},8420:function(e,t,n){var r;r=function(e){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}return n.m=e,n.c=t,n.p="",n(0)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(2),a=c(s),u=c(n(1));function c(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.getStyleString=function(){if(n.props.children instanceof Array){var e=n.props.children.filter((function(e){return!(0,s.isValidElement)(e)&&"string"==typeof e}));if(e.length>1)throw new Error("Multiple style objects as direct descedents of a Style component are not supported ("+e.length+" style objects detected): \n\n"+e[0]);return e[0]}return"string"!=typeof n.props.children||(0,s.isValidElement)(n.props.children)?null:n.props.children},n.getRootElement=function(){if(n.props.children instanceof Array){var e=n.props.children.filter((function(e){return(0,s.isValidElement)(e)}));return e[0]}return(0,s.isValidElement)(n.props.children)?n.props.children:null},n.getRootSelectors=function(e){var t=[];return e.props.id&&t.push("#"+e.props.id),e.props.className&&e.props.className.trim().split(/\s+/g).forEach((function(e){return t.push(e)})),t.length||"function"==typeof e.type||t.push(e.type),t},n.processCSSText=function(e,t,r){return e.replace(/\s*\/\/(?![^\(]*\)).*|\s*\/\*.*\*\//g,"").replace(/\s\s+/g," ").split("}").map((function(e){var i=/.*:.*;/g,o=/\s*@/g,s=/\s*(([0-9][0-9]?|100)\s*%)|\s*(to|from)\s*$/g;return e.split("{").map((function(e){if(e.trim().length){if(e.match(i))return n.escapeTextContentForBrowser(e.replace(/lsquo|rsquo/g,"").replace(/content\s*:\s*['"](.*)['"]\s*;/,"content: lsquo;$1rsquo;;").replace(/['"]/g,"")).replace(/lsquo;|rsquo;/g,"'").replace(/$/g,"\n");var a=e;return t&&!/:target/gi.test(a)?a.match(o)||a.match(s)?a:n.scopeSelector(t,a,r):a}})).join("{\n")})).join("}\n")},n.escaper=function(e){return{">":"&gt;","<":"&lt;",'"':"&quot;","'":"&#x27;"}[e]},n.escapeTextContentForBrowser=function(e){return(""+e).replace(/[><"']/g,n.escaper)},n.scopeSelector=function(e,t,n){for(var r=[],i=t.split(/,(?![^\(|\[]*\)|\])/g),o=0;o<i.length;o++){var s=void 0,a=void 0;if(n.length&&n.some((function(e){return t.match(e)}))){a=i[o];var u=n.map((function(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}));a=a.replace(new RegExp("("+u.join("|")+")"),"$1"+e),s=e+" "+i[o],r.push(a,s)}else s=e+" "+i[o],r.push(s)}return r.join(", ")},n.getScopeClassName=function(e,t){var r=e;return t&&(n.pepper="",n.traverseObjectToGeneratePepper(t),r+=n.pepper),"_"+(0,u.default)(r)},n.traverseObjectToGeneratePepper=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!(t>32||n.pepper.length>1e4))for(var r in e){var o=/^[_\$]|type|ref|^value$/.test(r);e[r]&&"object"===i(e[r])&&!o?n.traverseObjectToGeneratePepper(e[r],t+1):e[r]&&!o&&"function"!=typeof e[r]&&(n.pepper+=e[r])}},n.isVoidElement=function(e){return["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"].some((function(t){return e===t}))},n.addCSSTextToHead=function(e){if(e.length){var t=(0,u.default)(e);window._reactiveStyle.cssTextHashesAddedToHead.some((function(e){return e===t}))||(window._reactiveStyle.el.innerHTML+=e,window._reactiveStyle.cssTextHashesAddedToHead.push(t))}},n.createStyleElement=function(e,t){return a.default.createElement("style",{type:"text/css",key:t,ref:function(e){return n._style=e},dangerouslySetInnerHTML:{__html:e||""}})},n.getNewChildrenForCloneElement=function(e,t,r){return[n.createStyleElement(e,r)].concat(t.props.children)},n.scopeClassNameCache={},n.scopedCSSTextCache={},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"render",value:function(){if(!this.props.children)return this.createStyleElement();var e=this.getStyleString(),t=this.getRootElement();if(!e&&t)return t.props.children;if(e&&!t)return this.createStyleElement(this.processCSSText(e),this.getScopeClassName(e,t));var n=t.props.className?t.props.className+" ":"",i=void 0,o=void 0,a=n+(t.props.id?t.props.id:"")+e;return this.scopeClassNameCache[a]?(i=this.scopeClassNameCache[a],o=this.scopedCSSTextCache[i]):(i=this.getScopeClassName(e,t),o=this.processCSSText(e,"."+i,this.getRootSelectors(t)),this.scopeClassNameCache[a]=i,this.scopedCSSTextCache[i]=o),(0,s.cloneElement)(t,r({},t.props,{className:""+n+i}),this.getNewChildrenForCloneElement(o,t,i))}}]),t}(s.Component);l.it=function(e,t){return a.default.createElement(l,null,e,t)},t.default=l},function(e,t){"use strict";var n=65521;e.exports=function(e){for(var t=1,r=0,i=0,o=e.length,s=-4&o;i<s;){for(var a=Math.min(i+4096,s);i<a;i+=4)r+=(t+=e.charCodeAt(i))+(t+=e.charCodeAt(i+1))+(t+=e.charCodeAt(i+2))+(t+=e.charCodeAt(i+3));t%=n,r%=n}for(;i<o;i++)r+=t+=e.charCodeAt(i);return(t%=n)|(r%=n)<<16}},function(t,n){t.exports=e}])},e.exports=r(n(6606))},4948:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r}),e=n.hmd(e);const r=function(e){var t,n=e.Symbol;return"function"==typeof n?n.observable?t=n.observable:(t=n("observable"),n.observable=t):t="@@observable",t}("undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==n.g?n.g:e)},6724:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(8330),n(5857),n(8505),n(7913),n(6029),n(6023),n(5664);var r=n(5341),i=n(9516),o=n(2281),s=n(5206),a=n(5895),u=n(1167),c=n(1559),l=n(7322);n(7039),n(1825),n(5648);var d=n(3879),f=n(4492),p=n(321),h=n(3821);n(1117);var y=n(2771);n(5324),n(6294),n(1022),n(2893),n(8389);var v=n(1144);n(7472),n(711),n(6909);var m=n(2013);n(7583),n(2905),n(2502),n(806),n(6564),n(6912);var g=n(4051);n(5169);var b=n(4755),_=n(555);n(5607);var w=n(259);function k(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function x(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(n){if("default"!==n){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})}})),t.default=e,Object.freeze(t)}var S=k(r),E=k(i),T=k(o),O=k(s),I=k(a),C=k(u),R=k(c),A=k(l),P=k(d),N=k(f),L=k(y),M=x(v),j=k(m),D=x(b),B=k(_),U=x(w);function F(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":N.default(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}function H(e,t){if("object"===("undefined"==typeof Reflect?"undefined":N.default(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function G(){}function W(){W.init.call(this)}function q(e){return void 0===e._maxListeners?W.defaultMaxListeners:e._maxListeners}function V(e,t,n){if(t)e.call(n);else for(var r=e.length,i=Q(e,r),o=0;o<r;++o)i[o].call(n)}function z(e,t,n,r){if(t)e.call(n,r);else for(var i=e.length,o=Q(e,i),s=0;s<i;++s)o[s].call(n,r)}function Y(e,t,n,r,i){if(t)e.call(n,r,i);else for(var o=e.length,s=Q(e,o),a=0;a<o;++a)s[a].call(n,r,i)}function K(e,t,n,r,i,o){if(t)e.call(n,r,i,o);else for(var s=e.length,a=Q(e,s),u=0;u<s;++u)a[u].call(n,r,i,o)}function $(e,t,n,r){if(t)e.apply(n,r);else for(var i=e.length,o=Q(e,i),s=0;s<i;++s)o[s].apply(n,r)}function X(e,t,n,r){var i,o,s;if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');if((o=e._events)?(o.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),s=o[t]):(o=e._events=new G,e._eventsCount=0),s){if("function"==typeof s?s=o[t]=r?[n,s]:[s,n]:r?s.unshift(n):s.push(n),!s.warned&&(i=q(e))&&i>0&&s.length>i){s.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=e,a.type=t,a.count=s.length,console.warn}}else s=o[t]=n,++e._eventsCount;return e}function J(e,t,n){var r=!1;function i(){e.removeListener(t,i),r||(r=!0,n.apply(e,arguments))}return i.listener=n,i}function Z(e){var t=this._events;if(t){var n=t[e];if("function"==typeof n)return 1;if(n)return n.length}return 0}function Q(e,t){for(var n=new Array(t);t--;)n[t]=e[t];return n}G.prototype=Object.create(null),W.EventEmitter=W,W.usingDomains=!1,W.prototype.domain=void 0,W.prototype._events=void 0,W.prototype._maxListeners=void 0,W.defaultMaxListeners=10,W.init=function(){this.domain=null,W.usingDomains&&undefined.active,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new G,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},W.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},W.prototype.getMaxListeners=function(){return q(this)},W.prototype.emit=function(e){var t,n,r,i,o,s,a,u="error"===e;if(s=this._events)u=u&&null==s.error;else if(!u)return!1;if(a=this.domain,u){if(t=arguments[1],!a){if(t instanceof Error)throw t;var c=new Error('Uncaught, unspecified "error" event. ('+t+")");throw c.context=t,c}return t||(t=new Error('Uncaught, unspecified "error" event')),t.domainEmitter=this,t.domain=a,t.domainThrown=!1,a.emit("error",t),!1}if(!(n=s[e]))return!1;var l="function"==typeof n;switch(r=arguments.length){case 1:V(n,l,this);break;case 2:z(n,l,this,arguments[1]);break;case 3:Y(n,l,this,arguments[1],arguments[2]);break;case 4:K(n,l,this,arguments[1],arguments[2],arguments[3]);break;default:for(i=new Array(r-1),o=1;o<r;o++)i[o-1]=arguments[o];$(n,l,this,i)}return!0},W.prototype.addListener=function(e,t){return X(this,e,t,!1)},W.prototype.on=W.prototype.addListener,W.prototype.prependListener=function(e,t){return X(this,e,t,!0)},W.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,J(this,e,t)),this},W.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,J(this,e,t)),this},W.prototype.removeListener=function(e,t){var n,r,i,o,s;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if(!(r=this._events))return this;if(!(n=r[e]))return this;if(n===t||n.listener&&n.listener===t)0==--this._eventsCount?this._events=new G:(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,o=n.length;o-- >0;)if(n[o]===t||n[o].listener&&n[o].listener===t){s=n[o].listener,i=o;break}if(i<0)return this;if(1===n.length){if(n[0]=void 0,0==--this._eventsCount)return this._events=new G,this;delete r[e]}else!function(e,t){for(var n=t,r=n+1,i=e.length;r<i;n+=1,r+=1)e[n]=e[r];e.pop()}(n,i);r.removeListener&&this.emit("removeListener",e,s||t)}return this},W.prototype.off=function(e,t){return this.removeListener(e,t)},W.prototype.removeAllListeners=function(e){var t,n;if(!(n=this._events))return this;if(!n.removeListener)return 0===arguments.length?(this._events=new G,this._eventsCount=0):n[e]&&(0==--this._eventsCount?this._events=new G:delete n[e]),this;if(0===arguments.length){for(var r,i=Object.keys(n),o=0;o<i.length;++o)"removeListener"!==(r=i[o])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=new G,this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(t)do{this.removeListener(e,t[t.length-1])}while(t[0]);return this},W.prototype.listeners=function(e){var t,n=this._events;return n&&(t=n[e])?"function"==typeof t?[t.listener||t]:function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(t):[]},W.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):Z.call(e,t)},W.prototype.listenerCount=Z,W.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};var ee=function(){function e(t){E.default(this,e),this.base=t,this.args=new Array,this.paths=new Array}return T.default(e,[{key:"pathSegment",value:function(e){return this.paths.push(encodeURIComponent(e)),this}},{key:"queryParam",value:function(e,t){return void 0!==t&&this.args.push(encodeURIComponent(e)+"="+encodeURIComponent(t)),this}},{key:"build",value:function(){var e=this.base;return this.paths.length&&(e+="/"+this.paths.join("/")),this.args.length&&(e+="?"+this.args.join("&")),e}}]),e}();function te(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R.default(e);if(t){var i=R.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return C.default(this,n)}}var ne=function(e){I.default(n,e);var t=te(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return E.default(this,n),(r=t.call(this)).name=r.constructor.name,r.message="".concat(e," (status: ").concat(i,", code: ").concat(o,")"),r.status=i,r.code=o,r}return n}(L.default(Error)),re=function(e){I.default(n,e);var t=te(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3?arguments[3]:void 0;return E.default(this,n),(r=t.call(this,e,i,o)).body=s,r}return n}(ne);function ie(e){return JSON.parse(JSON.stringify(e))}function oe(e){if(!(void 0===e||se(e)))throw new ne("Invalid pageSize parameter. Expected a positive integer, was '".concat(e,"'."),400,20007)}function se(e){return function(e){return!isNaN(parseInt(e))&&isFinite(e)}(e)&&e>0}var ae=M.getLogger("twilio-sync");function ue(e,t){return["".concat((new Date).toISOString()," Sync ").concat(e,":")].concat(Array.from(t))}var ce=function(e){ae.setLevel(e)},le=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];ae.trace.apply(null,ue("T",t))},de=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];ae.debug.apply(null,ue("D",t))},fe=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];ae.warn.apply(null,ue("W",t))},pe=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];ae.error.apply(null,ue("E",t))},he="/v4/Subscriptions",ye="/v3/Maps",ve="/v3/Lists",me="/v3/Documents",ge="/v3/Streams",be="/v3/Insights";function _e(e,t,n){return e&&void 0!==e[t]?e[t]:n}var we=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};E.default(this,e);var n=t.region||"us1",r="https://cds.".concat(n,".twilio.com"),i=t.cdsUri||r;this.settings={subscriptionsUri:i+he,documentsUri:i+me,listsUri:i+ve,mapsUri:i+ye,streamsUri:i+ge,insightsUri:i+be,sessionStorageEnabled:_e(t.Sync,"enableSessionStorage",!0),productId:t.productId}}return T.default(e,[{key:"subscriptionsUri",get:function(){return this.settings.subscriptionsUri}},{key:"documentsUri",get:function(){return this.settings.documentsUri}},{key:"listsUri",get:function(){return this.settings.listsUri}},{key:"mapsUri",get:function(){return this.settings.mapsUri}},{key:"streamsUri",get:function(){return this.settings.streamsUri}},{key:"insightsUri",get:function(){return this.settings.insightsUri}},{key:"backoffConfig",get:function(){return this.settings.backoffConfig||{}}},{key:"sessionStorageEnabled",get:function(){return this.settings.sessionStorageEnabled}},{key:"productId",get:function(){return this.settings.productId}}]),e}();function ke(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return xe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return xe(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function xe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Se=function(){function e(t){E.default(this,e),this.localObject=t,this.pendingCorrelationId=null,this.pendingAction=null,this.established=!1,this.retryCount=0}return T.default(e,[{key:"sid",get:function(){return this.localObject.sid}},{key:"type",get:function(){return this.localObject.type}},{key:"lastEventId",get:function(){return this.localObject.lastEventId}},{key:"indexName",get:function(){return this.localObject.indexName}},{key:"queryString",get:function(){return this.localObject.queryString}},{key:"isEstablished",get:function(){return this.established}},{key:"update",value:function(e,t){this.localObject._update(e,t)}},{key:"updatePending",value:function(e,t){this.pendingAction=e,this.pendingCorrelationId=t}},{key:"reset",value:function(){this.updatePending(null,null),this.retryCount=0,this.established=!1,this.setSubscriptionState("none")}},{key:"markAsFailed",value:function(e){this.rejectedWithError=e.error,this.updatePending(null,null),this.localObject.reportFailure(new ne("Failed to subscribe on service events: ".concat(e.error.message),e.error.status,e.error.code))}},{key:"complete",value:function(e){this.updatePending(null,null),this.established=!0,this.localObject._advanceLastEventId(e)}},{key:"setSubscriptionState",value:function(e){this.localObject._setSubscriptionState(e)}}]),e}(),Ee=function(){function e(t){var n=this;E.default(this,e),A.default(this,"isConnected",!1),A.default(this,"maxBatchSize",100),A.default(this,"subscriptionTtlTimer",null),A.default(this,"pendingPokeReason",null),this.services=t,this.subscriptions=new Map,this.persisted=new Map,this.latestPokeResponseArrivalTimestampByCorrelationId=new Map;this.backoff=g.Backoff.exponential(Object.assign({randomisationFactor:.2,initialDelay:100,maxDelay:12e4},this.services.config.backoffConfig)),this.backoff.on("ready",(function(){var e=n.getSubscriptionUpdateBatch(),t=e.action,r=e.subscriptions;t?n.applyNewSubscriptionUpdateBatch(t,r):(n.backoff.reset(),de("All subscriptions resolved."))}))}var t;return T.default(e,[{key:"getSubscriptionUpdateBatch",value:function(){function e(e,t,n,r){var i,o=[],s=ke(e);try{for(s.s();!(i=s.n()).done;){var a=j.default(i.value,2),u=a[0],c=a[1];if(!t.get(u)&&n!==c.pendingAction&&!c.rejectedWithError&&(o.push(c),r&&o.length>=r))break}}catch(e){s.e(e)}finally{s.f()}return o}var t=e(this.subscriptions,this.persisted,"establish",this.maxBatchSize);if(t.length>0)return{action:"establish",subscriptions:t};var n=e(this.persisted,this.subscriptions,"cancel",this.maxBatchSize);return n.length>0?{action:"cancel",subscriptions:n}:{action:null,subscriptions:null}}},{key:"persist",value:function(){this.backoff.backoff()}},{key:"applyNewSubscriptionUpdateBatch",value:(t=S.default(P.default.mark((function e(t,n){var r,i,o,s,a,u,c,l,d,f,p,y,v=this;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isConnected){e.next=4;break}return de("Twilsock connection (required for subscription) not ready; waiting…"),this.backoff.reset(),e.abrupt("return");case 4:n=this.processLocalActions(t,n),r=(new Date).getTime(),i=ke(n);try{for(i.s();!(o=i.n()).done;)s=o.value,this.recordActionAttemptOn(s,t,r)}catch(e){i.e(e)}finally{i.f()}return a=this.pendingPokeReason,this.pendingPokeReason=null,e.prev=10,e.next=13,this.request(t,r,a,n);case 13:u=e.sent,c=u.body.max_batch_size,!isNaN(parseInt(c))&&isFinite(c)&&c>0&&(this.maxBatchSize=c),this.subscriptionTtlTimer||(l=u.body.ttl_in_s,!isNaN(parseFloat(l))&&isFinite(l)&&l>0&&(this.subscriptionTtlTimer=setTimeout((function(){return v.onSubscriptionTtlElapsed()}),1e3*l))),"establish"===t&&(d=u.body.estimated_delivery_in_ms,!isNaN(parseFloat(d))&&isFinite(d)&&d>0?setTimeout((function(){return v.verifyPokeDelivery(r,d,n)}),d):pe("Invalid timeout: ".concat(d)),n.filter((function(e){return e.pendingCorrelationId===r})).forEach((function(e){return e.setSubscriptionState("response_in_flight")}))),this.backoff.reset(),e.next=26;break;case 21:e.prev=21,e.t0=e.catch(10),f=ke(n);try{for(f.s();!(p=f.n()).done;)y=p.value,this.recordActionFailureOn(y,t)}catch(e){f.e(e)}finally{f.f()}e.t0 instanceof h.TransportUnavailableError?(de("Twilsock connection (required for subscription) not ready (c:".concat(r,"); waiting…")),this.backoff.reset()):(de("Failed an attempt to ".concat(t," subscriptions (c:").concat(r,"); retrying"),e.t0),this.persist());case 26:case"end":return e.stop()}}),e,this,[[10,21]])}))),function(e,n){return t.apply(this,arguments)})},{key:"verifyPokeDelivery",value:function(e,t,n){var r=this,i=this.latestPokeResponseArrivalTimestampByCorrelationId.get(e),o=i?(new Date).getTime()-i:t;o>=t?(n.filter((function(t){return t.pendingCorrelationId===e})).forEach((function(e){e.updatePending(null,null),e.retryCount++,r.persisted.delete(e.sid)})),this.persist(),this.latestPokeResponseArrivalTimestampByCorrelationId.delete(e)):setTimeout((function(){return r.verifyPokeDelivery(e,t,n)}),t-o)}},{key:"processLocalActions",value:function(e,t){return"cancel"===e?t.filter((function(e){return!e.rejectedWithError})):t}},{key:"recordActionAttemptOn",value:function(e,t,n){if(e.setSubscriptionState("request_in_flight"),"establish"===t)this.persisted.set(e.sid,e),e.updatePending(t,n);else{var r=this.persisted.get(e.sid);r&&r.updatePending(t,n)}}},{key:"recordActionFailureOn",value:function(e,t){e.setSubscriptionState("none"),e.updatePending(null,null),"establish"===t&&this.persisted.delete(e.sid)}},{key:"request",value:function(e,t,n,r){var i=r.map((function(t){return{object_sid:t.sid,object_type:t.type,last_event_id:"establish"===e?t.lastEventId:void 0,index_name:"establish"===e?t.indexName:void 0,query_string:"establish"===e?t.queryString:void 0}})),o=r.filter((function(e){return e.retryCount>0})).length;de("Attempting '".concat(e,"' request (c:").concat(t,"):"),i);var s={event_protocol_version:4,action:e,correlation_id:t,retried_requests:o,ttl_in_s:-1,requests:i};return"ttl"===n&&(s.reason=n),this.services.network.post(this.services.config.subscriptionsUri,s)}},{key:"add",value:function(e,t){de("Establishing intent to subscribe to ".concat(e));var n=this.subscriptions.get(e);n&&t&&n.lastEventId===t.lastEventId||(this.persisted.delete(e),this.subscriptions.set(e,new Se(t)),this.persist())}},{key:"remove",value:function(e){de("Establishing intent to unsubscribe from ".concat(e)),this.subscriptions.delete(e)&&this.persist()}},{key:"acceptMessage",value:function(e,t){le("Subscriptions received",e);var n=e.event_type,r=void 0!==e.events?e.events:[e.event],i=e.correlation_id;i&&this.latestPokeResponseArrivalTimestampByCorrelationId.set(i,(new Date).getTime());var o,s=ke(r);try{for(s.s();!(o=s.n()).done;){var a=o.value,u=void 0;switch(e.event_type){case"subscription_established":this.applySubscriptionEstablishedMessage(a,i);break;case"subscription_canceled":this.applySubscriptionCancelledMessage(a,i);break;case"subscription_failed":this.applySubscriptionFailedMessage(a,i);break;case(u=n.match(/^(?:map|list|document|stream|live_query)_/)||{}).input:var c=void 0;switch(u[0]){case"map_":c=a.map_sid;break;case"list_":c=a.list_sid;break;case"document_":c=a.document_sid;break;case"stream_":c=a.stream_sid;break;case"live_query_":c=a.query_id,t=!1,!0===e.strictly_ordered&&(t=!0);break;default:c=void 0}this.applyEventToSubscribedEntity(c,a,n,t);break;default:de("Dropping unknown message type ".concat(n))}}}catch(e){s.e(e)}finally{s.f()}}},{key:"applySubscriptionEstablishedMessage",value:function(e,t){var n=e.object_sid,r=this.persisted.get(e.object_sid);r&&r.pendingCorrelationId===t?"interrupted"===e.replay_status?(de("Event Replay for subscription to ".concat(n," (c:").concat(t,") interrupted; continuing eagerly.")),r.updatePending(null,null),this.persisted.delete(r.sid),this.backoff.reset()):"completed"===e.replay_status&&(de("Event Replay for subscription to ".concat(n," (c:").concat(t,") completed. Subscription is ready.")),r.complete(e.last_event_id),this.persisted.set(e.object_sid,r),r.setSubscriptionState("established"),this.backoff.reset()):de("Late message for ".concat(e.object_sid," (c:").concat(t,") dropped.")),this.persist()}},{key:"applySubscriptionCancelledMessage",value:function(e,t){var n=this.persisted.get(e.object_sid);n&&n.pendingCorrelationId===t?(n.updatePending(null,null),n.setSubscriptionState("none"),this.persisted.delete(e.object_sid)):de("Late message for ".concat(e.object_sid," (c:").concat(t,") dropped.")),this.persist()}},{key:"applySubscriptionFailedMessage",value:function(e,t){var n=e.object_sid,r=this.subscriptions.get(n),i=this.persisted.get(n);r&&i?i.pendingCorrelationId===t&&(pe("Failed to subscribe on ".concat(i.sid),e.error),i.markAsFailed(e),i.setSubscriptionState("none")):!r&&i&&(this.persisted.delete(n),i.setSubscriptionState("none")),this.persist()}},{key:"applyEventToSubscribedEntity",value:function(e,t,n,r){if(e){var i;r=r||(i=this.persisted.get(e))&&i.isEstablished;var o=this.subscriptions.get(e);o?(t.type=n,o.update(t,r)):de("Message dropped for SID '".concat(e,"', for which there is no subscription."))}}},{key:"onConnectionStateChanged",value:function(e){this.isConnected=e,e&&this.poke("reconnect")}},{key:"onSubscriptionTtlElapsed",value:function(){this.isConnected&&this.poke("ttl")}},{key:"poke",value:function(e){de("Triggering event replay for all subscriptions, reason=".concat(e)),this.pendingPokeReason=e,this.subscriptionTtlTimer&&(clearTimeout(this.subscriptionTtlTimer),this.subscriptionTtlTimer=null);var t,n=[],r=ke(this.persisted.values());try{for(r.s();!(t=r.n()).done;){var i=t.value;i.reset(),i.rejectedWithError&&n.push(i)}}catch(e){r.e(e)}finally{r.f()}this.persisted.clear();for(var o=0,s=n;o<s.length;o++){var a=s[o];this.persisted.set(a.sid,a)}this.persist()}},{key:"shutdown",value:function(){this.backoff.reset(),this.subscriptions.clear()}}]),e}();function Te(e){if(e.body&&e.body.message)return e.body.message;switch(e.status){case 429:return"Throttled by server";case 404:return"Not found from server";default:return"Error from server"}}function Oe(e){return e.body?e.body.code:0}function Ie(e){return 409===e.status?new re(Te(e),e.status,Oe(e),e.body):e.status?new ne(Te(e),e.status,Oe(e)):e instanceof h.TransportUnavailableError?e:new ne(e.message,0,0)}var Ce=function(){function e(t,n,r){E.default(this,e),this.clientInfo=t,this.config=n,this.transport=r}return T.default(e,[{key:"createHeaders",value:function(){return{"Content-Type":"application/json","Twilio-Sync-Client-Info":JSON.stringify(this.clientInfo),"Twilio-Request-Id":"RQ"+D.v4().replace(/-/g,"")}}},{key:"backoffConfig",value:function(){return Object.assign({min:4e3,max:6e4,maxAttemptsTime:9e4,randomness:.2},this.config.backoffConfig)}},{key:"executeWithRetry",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return new Promise((function(r,i){var o=[502,503,504];n&&o.push(429);var s=new g.Retrier(t.backoffConfig());s.on("attempt",(function(){e().then((function(e){return s.succeeded(e)})).catch((function(e){if(o.includes(e.status)){var t=parseInt(e.headers?e.headers["Retry-After"]:null);s.failed(Ie(e),isNaN(t)?null:1e3*t)}else"Twilsock disconnected"===e.message?s.failed(Ie(e)):(s.removeAllListeners(),s.cancel(),i(Ie(e)))}))})),s.on("succeeded",(function(e){r(e)})),s.on("cancelled",(function(e){return i(Ie(e))})),s.on("failed",(function(e){return i(Ie(e))})),s.start()}))}},{key:"get",value:function(e){var t=this,n=this.createHeaders();return de("GET",e,"ID:",n["Twilio-Request-Id"]),this.executeWithRetry((function(){return t.transport.get(e,n,t.config.productId)}),!0)}},{key:"post",value:function(e,t,n){var r=this,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=this.createHeaders();return null!=n&&(o["If-Match"]=n),de("POST",e,"ID:",o["Twilio-Request-Id"]),this.executeWithRetry((function(){return r.transport.post(e,o,t,r.config.productId)}),i)}},{key:"put",value:function(e,t,n){var r=this,i=this.createHeaders();return null!=n&&(i["If-Match"]=n),de("PUT",e,"ID:",i["Twilio-Request-Id"]),this.executeWithRetry((function(){return r.transport.put(e,i,t,r.config.productId)}),!1)}},{key:"delete",value:function(e){var t=this,n=this.createHeaders();return de("DELETE",e,"ID:",n["Twilio-Request-Id"]),this.executeWithRetry((function(){return t.transport.delete(e,n,t.config.productId)}),!1)}}]),e}(),Re=function(){function e(t,n){E.default(this,e),this.config=t,this.storageId=null;try{this.storage=n||sessionStorage}catch(e){}}return T.default(e,[{key:"storageKey",value:function(e,t){return"".concat(this.storageId,"::").concat(e,"::").concat(t)}},{key:"isReady",get:function(){return this.config.sessionStorageEnabled&&!!this.storageId}},{key:"updateStorageId",value:function(e){this.storageId=e}},{key:"store",value:function(e,t,n){return this.isReady?this._store(this.storageKey(e,t),n):null}},{key:"read",value:function(e,t){return this.isReady?this._read(this.storageKey(e,t)):null}},{key:"remove",value:function(e,t,n){if(!this.isReady)return null;try{this.storage.removeItem(this.storageKey(e,t)),n&&this.storage.removeItem(this.storageKey(e,n))}catch(e){}}},{key:"update",value:function(e,t,n,r){if(!this.isReady)return null;this._apply(this.storageKey(e,t),r),n&&this._apply(this.storageKey(e,n),r)}},{key:"_store",value:function(e,t){try{this.storage.setItem(e,JSON.stringify(t))}catch(e){}}},{key:"_read",value:function(e){try{var t=this.storage.getItem(e);if(t)return JSON.parse(t)}catch(e){}return null}},{key:"_apply",value:function(e,t){var n=this._read(e);if(!n)return!1;this._store(e,Object.assign(n,t))}}]),e}();function Ae(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Pe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Pe(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function Pe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ne=function(){function e(t,n){E.default(this,e),this.services=t,this.removalHandler=n,this.subscriptionState="none",this._attachedListeners=new Map}return T.default(e,[{key:"_advanceLastEventId",value:function(e,t){}},{key:"reportFailure",value:function(e){404===e.status?this.onRemoved(!1):this.broadcastEventToListeners("failure",e)}},{key:"_subscribe",value:function(){this.services.router._subscribe(this.sid,this)}},{key:"_unsubscribe",value:function(){this.services.router._unsubscribe(this.sid)}},{key:"_setSubscriptionState",value:function(e){this.subscriptionState=e,this.broadcastEventToListeners("_subscriptionStateChanged",e)}},{key:"close",value:function(){this._unsubscribe(),null!=this.removalHandler&&this.removalHandler(this.type,this.sid,this.uniqueName)}},{key:"attach",value:function(e){var t=e.listenerUuid;this._attachedListeners.get(t)||(this._attachedListeners.size||this._subscribe(),this._attachedListeners.set(t,e))}},{key:"detach",value:function(e){this._attachedListeners.delete(e),this._attachedListeners.size||this.close()}},{key:"broadcastEventToListeners",value:function(e,t){var n,r=Ae(this._attachedListeners.values());try{for(r.s();!(n=r.n()).done;){n.value.emit(e,t)}}catch(e){r.e(e)}finally{r.f()}}}]),e}(),Le=function(){function e(t){E.default(this,e),A.default(this,"queuedRequests",[]),A.default(this,"isRequestInFlight",!1),this.inputMergingFunction=t}return T.default(e,[{key:"add",value:function(e,t){var n=this,r=new Promise((function(r,i){return n.queuedRequests.push({input:e,requestFunction:t,resolve:r,reject:i})}));return this.wakeupQueue(),r}},{key:"squashAndAdd",value:function(e,t){var n,r=this.queuedRequests;this.queuedRequests=[],r.length>0?(n=r.map((function(e){return e.input})).reduce(this.inputMergingFunction),n=this.inputMergingFunction(n,e)):n=e;var i=this.add(n,t);return r.forEach((function(e){return i.then(e.resolve,e.reject)})),i}},{key:"isEmpty",value:function(){return 0===this.queuedRequests.length&&!this.isRequestInFlight}},{key:"wakeupQueue",value:function(){var e=this;if(0!==this.queuedRequests.length&&!this.isRequestInFlight){var t=this.queuedRequests.shift();this.isRequestInFlight=!0,t.requestFunction(t.input).then(t.resolve,t.reject).then((function(t){e.isRequestInFlight=!1,e.wakeupQueue()}))}}}]),e}(),Me=function(){function e(t){E.default(this,e),A.default(this,"queueByNamespaceKey",new Map),this.inputReducer=t}var t,n,r;return T.default(e,[{key:"add",value:(r=S.default(P.default.mark((function e(t,n,r){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.invokeQueueMethod(t,(function(e){return e.add(n,r)})));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return r.apply(this,arguments)})},{key:"squashAndAdd",value:(n=S.default(P.default.mark((function e(t,n,r){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.invokeQueueMethod(t,(function(e){return e.squashAndAdd(n,r)})));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return n.apply(this,arguments)})},{key:"invokeQueueMethod",value:(t=S.default(P.default.mark((function e(t,n){var r,i;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.queueByNamespaceKey.has(t)||this.queueByNamespaceKey.set(t,new Le(this.inputReducer)),r=this.queueByNamespaceKey.get(t),i=n(r),this.queueByNamespaceKey.get(t).isEmpty()&&this.queueByNamespaceKey.delete(t),e.abrupt("return",i);case 5:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})}]),e}();function je(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R.default(e);if(t){var i=R.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return C.default(this,n)}}var De=function(e){I.default(n,e);var t=je(n);function n(){var e;return E.default(this,n),(e=t.call(this)).closed=!1,e.uuid=b.v4(),e}return T.default(n,[{key:"listenerUuid",get:function(){return this.uuid}},{key:"close",value:function(){this.removeAllListeners(),this.closed=!0}},{key:"ensureNotClosed",value:function(){if(this.closed)throw new Error("Invalid operation on closed object")}}]),n}(W);function Be(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R.default(e);if(t){var i=R.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return C.default(this,n)}}var Ue=function(e){I.default(d,e);var t,n,r,i,o,s,a,u,c,l=Be(d);function d(e,t,n){var r;E.default(this,d),r=l.call(this,e,n),A.default(O.default(r),"isDeleted",!1);return r.updateMergingQueue=new Le((function(e,t){return"number"==typeof t.ttl?{ttl:t.ttl}:e})),r.descriptor=t,r.descriptor.data=r.descriptor.data||{},r.descriptor.date_updated=new Date(r.descriptor.date_updated),r}return T.default(d,[{key:"uri",get:function(){return this.descriptor.url}},{key:"revision",get:function(){return this.descriptor.revision}},{key:"lastEventId",get:function(){return this.descriptor.last_event_id}},{key:"dateExpires",get:function(){return this.descriptor.date_expires}},{key:"type",get:function(){return"document"}},{key:"indexName",get:function(){}},{key:"queryString",get:function(){}},{key:"sid",get:function(){return this.descriptor.sid}},{key:"data",get:function(){return this.descriptor.data}},{key:"dateUpdated",get:function(){return this.descriptor.date_updated}},{key:"uniqueName",get:function(){return this.descriptor.unique_name||null}},{key:"_update",value:function(e){switch(e.date_created=new Date(e.date_created),e.type){case"document_updated":if(e.id<=this.lastEventId){le("Document update skipped, current:",this.lastEventId,", remote:",e.id);break}var t=void 0!==this.descriptor.data?ie(this.descriptor.data):null;this.descriptor.last_event_id=e.id,this.descriptor.revision=e.document_revision,this.descriptor.date_updated=e.date_created,this.descriptor.data=e.document_data,this.broadcastEventToListeners("updated",{data:e.document_data,isLocal:!1,previousData:t}),this.services.storage.update(this.type,this.sid,this.uniqueName,{last_event_id:e.id,revision:e.document_revision,date_updated:e.date_created,data:e.document_data});break;case"document_removed":this.onRemoved(!1)}}},{key:"set",value:(c=S.default(P.default.mark((function e(t,n){var r,i=this;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n||{},e.abrupt("return",this.updateMergingQueue.squashAndAdd(r,(function(e){return i._setUnconditionally(t,e.ttl)})));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t){return c.apply(this,arguments)})},{key:"mutate",value:(u=S.default(P.default.mark((function e(t,n){var r,i=this;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n||{},e.abrupt("return",this.updateMergingQueue.add(r,(function(e){return i._setWithIfMatch(t,e.ttl)})));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t){return u.apply(this,arguments)})},{key:"update",value:(a=S.default(P.default.mark((function e(t,n){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.mutate((function(e){return Object.assign(e,t)}),n));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return a.apply(this,arguments)})},{key:"setTtl",value:(s=S.default(P.default.mark((function e(t){var n;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._postUpdateToServer({ttl:t});case 2:n=e.sent,this.descriptor.date_expires=n.date_expires;case 4:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"_setUnconditionally",value:(o=S.default(P.default.mark((function e(t,n){var r;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._postUpdateToServer({data:t,revision:void 0,ttl:n});case 2:return r=e.sent,this._handleSuccessfulUpdateResult(r),e.abrupt("return",this.descriptor.data);case 5:case"end":return e.stop()}}),e,this)}))),function(e,t){return o.apply(this,arguments)})},{key:"_setWithIfMatch",value:(i=S.default(P.default.mark((function e(t,n){var r,i,o;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=t(ie(this.descriptor.data)))){e.next=22;break}return i=this.revision,e.prev=3,e.next=6,this._postUpdateToServer({data:r,revision:i,ttl:n});case 6:return o=e.sent,this._handleSuccessfulUpdateResult(o),e.abrupt("return",this.descriptor.data);case 11:if(e.prev=11,e.t0=e.catch(3),412!==e.t0.status){e.next=19;break}return e.next=16,this._softSync();case 16:return e.abrupt("return",this._setWithIfMatch(t));case 19:throw e.t0;case 20:e.next=23;break;case 22:return e.abrupt("return",this.descriptor.data);case 23:case"end":return e.stop()}}),e,this,[[3,11]])}))),function(e,t){return i.apply(this,arguments)})},{key:"_handleSuccessfulUpdateResult",value:function(e){if(!(e.last_event_id<=this.descriptor.last_event_id)){var t=void 0!==this.descriptor.data?ie(this.descriptor.data):null;this.descriptor.revision=e.revision,this.descriptor.data=e.data,this.descriptor.last_event_id=e.last_event_id,this.descriptor.date_expires=e.date_expires,this.descriptor.date_updated=new Date(e.date_updated),this.services.storage.update(this.type,this.sid,this.uniqueName,{last_event_id:e.last_event_id,revision:e.revision,date_updated:e.date_updated,data:e.data}),this.broadcastEventToListeners("updated",{data:this.descriptor.data,isLocal:!0,previousData:t})}}},{key:"_postUpdateToServer",value:(r=S.default(P.default.mark((function e(t){var n,r,i;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isDeleted){e.next=17;break}return n={data:t.data},void 0!==t.ttl&&(n.ttl=t.ttl),r=t.revision,e.prev=4,e.next=7,this.services.network.post(this.uri,n,r);case 7:return i=e.sent,e.abrupt("return",{revision:i.body.revision,data:t.data,last_event_id:i.body.last_event_id,date_updated:i.body.date_updated,date_expires:i.body.date_expires});case 11:throw e.prev=11,e.t0=e.catch(4),404===e.t0.status&&this.onRemoved(!1),e.t0;case 15:e.next=18;break;case 17:return e.abrupt("return",Promise.reject(new ne("The Document has been removed",404,54100)));case 18:case"end":return e.stop()}}),e,this,[[4,11]])}))),function(e){return r.apply(this,arguments)})},{key:"_softSync",value:(n=S.default(P.default.mark((function e(){var t=this;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.services.network.get(this.uri).then((function(e){var n={type:"document_updated",id:e.body.last_event_id,document_revision:e.body.revision,document_data:e.body.data,date_created:e.body.date_updated};return t._update(n),t})).catch((function(e){404===e.status?t.onRemoved(!1):pe("Can't get updates for ".concat(t.sid,":"),e)})));case 1:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"onRemoved",value:function(e){if(!this.isDeleted){var t=void 0!==this.descriptor.data?ie(this.descriptor.data):null;this.isDeleted=!0,this._unsubscribe(),this.removalHandler(this.type,this.sid,this.uniqueName),this.broadcastEventToListeners("removed",{isLocal:e,previousData:t})}}},{key:"removeDocument",value:(t=S.default(P.default.mark((function e(){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isDeleted){e.next=6;break}return e.next=3,this.services.network.delete(this.uri);case 3:this.onRemoved(!0),e.next=7;break;case 6:return e.abrupt("return",Promise.reject(new ne("The Document has been removed",404,54100)));case 7:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}],[{key:"type",get:function(){return"document"}}]),d}(Ne),Fe=function(e){I.default(a,e);var t,n,r,i,o,s=Be(a);function a(e){var t;return E.default(this,a),(t=s.call(this)).syncDocumentImpl=e,t.syncDocumentImpl.attach(O.default(t)),t}return T.default(a,[{key:"uri",get:function(){return this.syncDocumentImpl.uri}},{key:"revision",get:function(){return this.syncDocumentImpl.revision}},{key:"lastEventId",get:function(){return this.syncDocumentImpl.lastEventId}},{key:"dateExpires",get:function(){return this.syncDocumentImpl.dateExpires}},{key:"type",get:function(){return Ue.type}},{key:"sid",get:function(){return this.syncDocumentImpl.sid}},{key:"data",get:function(){return this.syncDocumentImpl.data}},{key:"dateUpdated",get:function(){return this.syncDocumentImpl.dateUpdated}},{key:"uniqueName",get:function(){return this.syncDocumentImpl.uniqueName}},{key:"set",value:(o=S.default(P.default.mark((function e(t,n){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.ensureNotClosed(),e.abrupt("return",this.syncDocumentImpl.set(t,n));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t){return o.apply(this,arguments)})},{key:"mutate",value:(i=S.default(P.default.mark((function e(t,n){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.ensureNotClosed(),e.abrupt("return",this.syncDocumentImpl.mutate(t,n));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{key:"update",value:(r=S.default(P.default.mark((function e(t,n){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.ensureNotClosed(),e.abrupt("return",this.syncDocumentImpl.update(t,n));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})},{key:"setTtl",value:(n=S.default(P.default.mark((function e(t){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.ensureNotClosed(),e.abrupt("return",this.syncDocumentImpl.setTtl(t));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"removeDocument",value:(t=S.default(P.default.mark((function e(){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.ensureNotClosed(),e.abrupt("return",this.syncDocumentImpl.removeDocument());case 2:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"close",value:function(){B.default(R.default(a.prototype),"close",this).call(this),this.syncDocumentImpl.detach(this.listenerUuid)}}],[{key:"type",get:function(){return Ue.type}}]),a}(De);A.default(Fe,"removed","removed"),A.default(Fe,"updated","updated"),F([p.validateTypesAsync(p.pureObject,["undefined",p.objectSchema("document metadata",{ttl:[p.nonNegativeInteger,"undefined"]})]),H("design:type",Function),H("design:paramtypes",[Object,Object]),H("design:returntype",Promise)],Fe.prototype,"set",null),F([p.validateTypesAsync("function",["undefined",p.objectSchema("document metadata",{ttl:[p.nonNegativeInteger,"undefined"]})]),H("design:type",Function),H("design:paramtypes",[Function,Object]),H("design:returntype",Promise)],Fe.prototype,"mutate",null),F([p.validateTypesAsync(p.pureObject,["undefined",p.objectSchema("document metadata",{ttl:[p.nonNegativeInteger,"undefined"]})]),H("design:type",Function),H("design:paramtypes",[Object,Object]),H("design:returntype",Promise)],Fe.prototype,"update",null),F([p.validateTypesAsync(p.nonNegativeInteger),H("design:type",Function),H("design:paramtypes",[Number]),H("design:returntype",Promise)],Fe.prototype,"setTtl",null);var He=function(){function e(t){E.default(this,e),this.descriptor=t}return T.default(e,[{key:"uri",get:function(){return this.descriptor.uri}},{key:"revision",get:function(){return this.descriptor.revision}},{key:"lastEventId",get:function(){return this.descriptor.lastEventId}},{key:"dateUpdated",get:function(){return this.descriptor.dateUpdated}},{key:"dateExpires",get:function(){return this.descriptor.dateExpires}},{key:"index",get:function(){return this.descriptor.index}},{key:"data",get:function(){return this.descriptor.data}},{key:"update",value:function(e,t,n,r){return this.descriptor.lastEventId=e,this.descriptor.revision=t,this.descriptor.data=n,this.descriptor.dateUpdated=r,this}},{key:"updateDateExpires",value:function(e){this.descriptor.dateExpires=e}}]),e}(),Ge=function(){function e(t,n,r,i){E.default(this,e),this.prevToken=r,this.nextToken=i,this.items=t,this.source=n}var t,n;return T.default(e,[{key:"hasNextPage",get:function(){return!!this.nextToken}},{key:"hasPrevPage",get:function(){return!!this.prevToken}},{key:"nextPage",value:(n=S.default(P.default.mark((function e(){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.hasNextPage){e.next=2;break}throw new Error("No next page");case 2:return e.abrupt("return",this.source(this.nextToken));case 3:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"prevPage",value:(t=S.default(P.default.mark((function e(){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.hasPrevPage){e.next=2;break}throw new Error("No previous page");case 2:return e.abrupt("return",this.source(this.prevToken));case 3:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}();function We(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return qe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return qe(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function qe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ve=function(){function e(t,n){E.default(this,e),this.balanceFactor=0,this.key=t,this.value=n,this.parent=null,this.left=null,this.right=null}return T.default(e,[{key:"isRoot",get:function(){return null===this.parent}},{key:"isLeaf",get:function(){return null===this.left&&null===this.right}},{key:"isLeftChild",get:function(){return this.parent.left===this}},{key:"update",value:function(e){this.value=e}},{key:"replace",value:function(e,t){e&&(this.left===t?this.left=t:this.right===t&&(this.right=t))}}]),e}(),ze=function(){function e(t,n){E.default(this,e),this.isLessThan=t||function(e,t){return e<t},this.isEqual=n||function(e,t){return e===t},this.root=null,this.count=null}return T.default(e,[{key:"size",get:function(){return this.count}},{key:"clear",value:function(){this.root=null,this.count=0}},{key:"set",value:function(e,t){var n=this.getNode(e);n?n.update(t):this.insert(e,t)}},{key:"insert",value:function(e,t){var n=new Ve(e,t);if(this.count++,this.root){for(var r=this.root;;)if(this.isLessThan(e,r.key)){if(!r.left){r.left=n;break}r=r.left}else{if(!r.right){r.right=n;break}r=r.right}for(n.parent=r,r=n;r.parent;){var i=r.parent,o=i.balanceFactor;if(r.isLeftChild?i.balanceFactor++:i.balanceFactor--,Math.abs(i.balanceFactor)<Math.abs(o))break;if(i.balanceFactor<-1||i.balanceFactor>1){this.rebalance(i);break}r=i}}else this.root=n}},{key:"get",value:function(e){for(var t=this.root;t;){if(this.isEqual(e,t.key))return t.value;t=this.isLessThan(e,t.key)?t.left:t.right}return null}},{key:"delete",value:function(e){var t=this.getNode(e);if(!t||t.key!==e)return null;var n=t.parent,r=t.left,i=t.right;if(!!r!=!!i){var o=r||i;n||o?n&&!o?this.root=o:(n.replace(t,null),this.rebalance(n)):this.root=null}else{for(var s=t.left;s.right;)s=s.right;if(t.left===s)t.isRoot?(this.root=s,s.parent=null):(t.isLeftChild?t.parent.left=s:t.parent.right=s,s.parent=t.parent),s.right=t.right,s.right.parent=s,s.balanceFactor=t.balanceFactor,t={parent:s,isLeftChild:!0};else{var a=s.parent,u=s.left;a.right=u,u&&(u.parent=a),t.isRoot?(this.root=s,s.parent=null):(t.isLeftChild?t.parent.left=s:t.parent.right=s,s.parent=t.parent),s.right=t.right,s.right.parent=s,s.left=t.left,s.left.parent=s,s.balanceFactor=t.balanceFactor,t={parent:a,isLeftChild:!1}}}for(this.count--;t.parent;){var c=t.parent,l=c.balanceFactor;if(t.isLeftChild?c.balanceFactor-=1:c.balanceFactor+=1,Math.abs(c.balanceFactor)>Math.abs(l)){if(!(c.balanceFactor<-1||c.balanceFactor>1))break;if(this.rebalance(c),0!==c.parent.balanceFactor)break;t=c.parent}else t=c}return null}},{key:"getNode",value:function(e){for(var t=this.root;t;){if(this.isEqual(e,t.key))return t;t=this.isLessThan(e,t.key)?t.left:t.right}return null}},{key:"rebalance",value:function(e){e.balanceFactor<0?e.right.balanceFactor>0?(this.rotateRight(e.right),this.rotateLeft(e)):this.rotateLeft(e):e.balanceFactor>0&&(e.left.balanceFactor<0?(this.rotateLeft(e.left),this.rotateRight(e)):this.rotateRight(e))}},{key:"rotateLeft",value:function(e){var t=e.right;e.right=t.left,null!==t.left&&(t.left.parent=e),t.parent=e.parent,null===t.parent?this.root=t:e.isLeftChild?t.parent.left=t:t.parent.right=t,t.left=e,e.parent=t,e.balanceFactor=e.balanceFactor+1-Math.min(t.balanceFactor,0),t.balanceFactor=t.balanceFactor+1-Math.max(e.balanceFactor,0)}},{key:"rotateRight",value:function(e){var t=e.left;e.left=t.right,null!==t.right&&(t.right.parent=e),t.parent=e.parent,null===t.parent?this.root=t:e.isLeftChild?t.parent.left=t:t.parent.right=t,t.right=e,e.parent=t,e.balanceFactor=e.balanceFactor-1-Math.min(t.balanceFactor,0),t.balanceFactor=t.balanceFactor-1-Math.max(e.balanceFactor,0)}},{key:Symbol.iterator,value:P.default.mark((function e(){var t,n,r;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=We(this.getIterator()),e.prev=1,t.s();case 3:if((n=t.n()).done){e.next=9;break}return r=n.value,e.next=7,r;case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),t.e(e.t0);case 14:return e.prev=14,t.f(),e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[1,11,14,17]])}))},{key:"getIterator",value:P.default.mark((function e(){var t,n,r,i=arguments;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=i.length>0&&void 0!==i[0]?i[0]:null,n=this.root;case 2:if(!n){e.next=8;break}if(!this.isEqual(t,n.key)&&(null!==t||n.left)){e.next=5;break}return e.abrupt("break",8);case 5:n=this.isLessThan(t,n.key)||null===t?n.left:n.right,e.next=2;break;case 8:if(n){e.next=10;break}return e.abrupt("return",null);case 10:r=!0;case 11:if(!r){e.next=29;break}return e.next=14,[n.key,n.value];case 14:if(r=!1,!n.right){e.next=21;break}for(n=n.right;n.left;)n=n.left;r=!0,e.next=27;break;case 21:if(!n.parent){e.next=26;break}r=n.parent.left===n,n=n.parent,e.next=27;break;case 26:return e.abrupt("break",37);case 27:e.next=35;break;case 29:if(!n.parent){e.next=34;break}r=n.parent.left===n,n=n.parent,e.next=35;break;case 34:return e.abrupt("break",37);case 35:e.next=11;break;case 37:return e.abrupt("return",null);case 38:case"end":return e.stop()}}),e,this)}))},{key:"getReverseIterator",value:P.default.mark((function e(){var t,n,r,i=arguments;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=i.length>0&&void 0!==i[0]?i[0]:null,n=this.root;case 2:if(!n){e.next=8;break}if(!this.isEqual(t,n.key)&&(null!==t||n.right)){e.next=5;break}return e.abrupt("break",8);case 5:n=this.isLessThan(t,n.key)&&null!==t?n.left:n.right,e.next=2;break;case 8:if(n){e.next=10;break}return e.abrupt("return",null);case 10:r=!0;case 11:if(!r){e.next=29;break}return e.next=14,[n.key,n.value];case 14:if(r=!1,!n.left){e.next=21;break}for(n=n.left;n.right;)n=n.right;r=!0,e.next=27;break;case 21:if(!n.parent){e.next=26;break}r=n.parent.right===n,n=n.parent,e.next=27;break;case 26:return e.abrupt("break",37);case 27:e.next=35;break;case 29:if(!n.parent){e.next=34;break}r=n.parent.right===n,n=n.parent,e.next=35;break;case 34:return e.abrupt("break",37);case 35:e.next=11;break;case 37:return e.abrupt("return",null);case 38:case"end":return e.stop()}}),e,this)}))}]),e}();function Ye(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Ke(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ke(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function Ke(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var $e=function(){function e(t,n){E.default(this,e),this.value=t,this.revision=n||0}return T.default(e,[{key:"isValid",get:function(){return!0}}]),e}(),Xe=function(){function e(t){E.default(this,e),this.revision=t}return T.default(e,[{key:"isValid",get:function(){return!1}}]),e}(),Je=function(){function e(){E.default(this,e),this.items=new ze}return T.default(e,[{key:"store",value:function(e,t,n){var r=this.items.get(e);return r&&r.revision>n?r.isValid?r.value:null:(this.items.set(e,new $e(t,n)),t)}},{key:"delete",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.items.get(e);(!r||r.revision<t||r&&!0===n)&&this.items.set(e,new Xe(t))}},{key:"isKnown",value:function(e,t){var n=this.items.get(e);return n&&n.revision>=t}},{key:"get",value:function(e){var t=this.items.get(e);return t&&t.isValid?t.value:null}},{key:"has",value:function(e){var t=this.items.get(e);return t&&t.isValid}},{key:"forEach",value:function(e){if(this.items){var t,n=Ye(this.items);try{for(n.s();!(t=n.n()).done;){var r=j.default(t.value,2),i=r[0],o=r[1];o.isValid&&e(i,o.value)}}catch(e){n.e(e)}finally{n.f()}}}}]),e}();function Ze(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R.default(e);if(t){var i=R.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return C.default(this,n)}}var Qe=function(e){I.default(v,e);var t,n,r,i,o,s,a,u,c,l,d,f,p,h,y=Ze(v);function v(e,t,n){var r;E.default(this,v);return(r=y.call(this,e,n)).updateMergingQueue=new Me((function(e,t){return"number"==typeof t.ttl?{ttl:t.ttl}:e})),r.cache=new Je,r.descriptor=t,r.descriptor.date_updated=new Date(r.descriptor.date_updated),r}return T.default(v,[{key:"uri",get:function(){return this.descriptor.url}},{key:"revision",get:function(){return this.descriptor.revision}},{key:"lastEventId",get:function(){return this.descriptor.last_event_id}},{key:"links",get:function(){return this.descriptor.links}},{key:"dateExpires",get:function(){return this.descriptor.date_expires}},{key:"type",get:function(){return"list"}},{key:"indexName",get:function(){}},{key:"queryString",get:function(){}},{key:"sid",get:function(){return this.descriptor.sid}},{key:"uniqueName",get:function(){return this.descriptor.unique_name||null}},{key:"dateUpdated",get:function(){return this.descriptor.date_updated}},{key:"_addOrUpdateItemOnServer",value:(h=S.default(P.default.mark((function e(t,n,r,i){var o,s;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o={data:n},void 0!==i&&(o.ttl=i),e.next=4,this.services.network.post(t,o,r);case 4:return(s=e.sent).body.data=n,s.body.date_updated=new Date(s.body.date_updated),e.abrupt("return",s.body);case 8:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r){return h.apply(this,arguments)})},{key:"push",value:(p=S.default(P.default.mark((function e(t,n){var r,i,o;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(n||{}).ttl,e.next=3,this._addOrUpdateItemOnServer(this.links.items,t,void 0,r);case 3:return i=e.sent,o=Number(i.index),this._handleItemMutated(o,i.url,i.last_event_id,i.revision,t,i.date_updated,i.date_expires,!0,!1),e.abrupt("return",this.cache.get(o));case 7:case"end":return e.stop()}}),e,this)}))),function(e,t){return p.apply(this,arguments)})},{key:"set",value:(f=S.default(P.default.mark((function e(t,n,r){var i,o=this;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=r||{},e.abrupt("return",this.updateMergingQueue.squashAndAdd(t,i,(function(e){return o._updateItemUnconditionally(t,n,e.ttl)})));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return f.apply(this,arguments)})},{key:"_updateItemUnconditionally",value:(d=S.default(P.default.mark((function e(t,n,r){var i,o;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get(t);case 2:return i=e.sent,e.next=5,this._addOrUpdateItemOnServer(i.uri,n,void 0,r);case 5:return o=e.sent,this._handleItemMutated(t,o.url,o.last_event_id,o.revision,o.data,o.date_updated,o.date_expires,!1,!1),e.abrupt("return",this.cache.get(t));case 8:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return d.apply(this,arguments)})},{key:"_updateItemWithIfMatch",value:(l=S.default(P.default.mark((function e(t,n,r){var i,o,s,a;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get(t);case 2:if(i=e.sent,!(o=n(ie(i.data)))){e.next=25;break}return s=i.revision,e.prev=6,e.next=9,this._addOrUpdateItemOnServer(i.uri,o,s,r);case 9:return a=e.sent,this._handleItemMutated(t,a.url,a.last_event_id,a.revision,a.data,a.date_updated,a.date_expires,!1,!1),e.abrupt("return",this.cache.get(t));case 14:if(e.prev=14,e.t0=e.catch(6),412!==e.t0.status){e.next=22;break}return e.next=19,this._getItemFromServer(t);case 19:return e.abrupt("return",this._updateItemWithIfMatch(t,n,r));case 22:throw e.t0;case 23:e.next=26;break;case 25:return e.abrupt("return",i);case 26:case"end":return e.stop()}}),e,this,[[6,14]])}))),function(e,t,n){return l.apply(this,arguments)})},{key:"mutate",value:(c=S.default(P.default.mark((function e(t,n,r){var i,o=this;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=r||{},e.abrupt("return",this.updateMergingQueue.add(t,i,(function(e){return o._updateItemWithIfMatch(t,n,e.ttl)})));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return c.apply(this,arguments)})},{key:"update",value:(u=S.default(P.default.mark((function e(t,n,r){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.mutate(t,(function(e){return Object.assign(e,n)}),r));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return u.apply(this,arguments)})},{key:"remove",value:(a=S.default(P.default.mark((function e(t){var n,r,i;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get(t);case 2:return n=e.sent,r=ie(n.data),e.next=6,this.services.network.delete(n.uri);case 6:i=e.sent,this._handleItemRemoved(t,i.body.last_event_id,r,new Date(i.body.date_updated),!1);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"get",value:function(){var e=S.default(P.default.mark((function e(t){var n;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=this.cache.get(t))){e.next=5;break}return e.abrupt("return",n);case 5:return e.abrupt("return",this._getItemFromServer(t));case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_getItemFromServer",value:(s=S.default(P.default.mark((function e(t){var n;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.queryItems({index:t});case 2:if(!((n=e.sent).items.length<1)){e.next=7;break}throw new ne("No item with index ".concat(t," found"),404,54151);case 7:return e.abrupt("return",n.items[0]);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"queryItems",value:function(){var e=S.default(P.default.mark((function e(t){var n,r,i,o,s=this;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=t||{},n=new ee(this.links.items).queryParam("From",t.from).queryParam("PageSize",t.limit).queryParam("Index",t.index).queryParam("PageToken",t.pageToken).queryParam("Order",t.order).build(),e.next=4,this.services.network.get(n);case 4:return r=e.sent,i=r.body.items.map((function(e){return e.date_updated=new Date(e.date_updated),s.cache.get(e.index)?s._handleItemMutated(e.index,e.url,e.last_event_id,e.revision,e.data,e.date_updated,e.date_expires,!1,!0):s.cache.store(Number(e.index),new He({index:Number(e.index),uri:e.url,revision:e.revision,lastEventId:e.last_event_id,dateUpdated:e.date_updated,dateExpires:e.date_expires,data:e.data}),e.last_event_id),s.cache.get(e.index)})),o=r.body.meta,e.abrupt("return",new Ge(i,(function(e){return s.queryItems({pageToken:e})}),o.previous_token,o.next_token));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getItems",value:(o=S.default(P.default.mark((function e(t){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return oe((t=t||{}).pageSize),t.limit=t.pageSize||t.limit||50,t.order=t.order||"asc",e.abrupt("return",this.queryItems(t));case 5:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"getContext",value:(i=S.default(P.default.mark((function e(){var t;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.context){e.next=5;break}return e.next=3,this.services.network.get(this.links.context);case 3:t=e.sent,this._updateContextIfRequired(t.body.data,t.body.last_event_id);case 5:return e.abrupt("return",this.context);case 6:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"setTtl",value:(r=S.default(P.default.mark((function e(t){var n,r;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n={ttl:t},e.next=4,this.services.network.post(this.uri,n);case 4:r=e.sent,this.descriptor.date_expires=r.body.date_expires,e.next=12;break;case 8:throw e.prev=8,e.t0=e.catch(0),404===e.t0.status&&this.onRemoved(!1),e.t0;case 12:case"end":return e.stop()}}),e,this,[[0,8]])}))),function(e){return r.apply(this,arguments)})},{key:"setItemTtl",value:(n=S.default(P.default.mark((function e(t,n){var r,i,o;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get(t);case 2:return r=e.sent,i={ttl:n},e.next=6,this.services.network.post(r.uri,i);case 6:o=e.sent,r.updateDateExpires(o.body.date_expires);case 8:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"removeList",value:(t=S.default(P.default.mark((function e(){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.services.network.delete(this.uri);case 2:this.onRemoved(!0);case 3:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"onRemoved",value:function(e){this._unsubscribe(),this.removalHandler(this.type,this.sid,this.uniqueName),this.broadcastEventToListeners("removed",{isLocal:e})}},{key:"shouldIgnoreEvent",value:function(e,t){return this.cache.isKnown(e,t)}},{key:"_update",value:function(e,t){var n=Number(e.item_index);switch(e.date_created=new Date(e.date_created),e.type){case"list_item_added":case"list_item_updated":this._handleItemMutated(n,e.item_url,e.id,e.item_revision,e.item_data,e.date_created,void 0,"list_item_added"===e.type,!0);break;case"list_item_removed":this._handleItemRemoved(n,e.id,e.item_data,e.date_created,!0);break;case"list_context_updated":this._handleContextUpdate(e.context_data,e.id,e.date_created);break;case"list_removed":this.onRemoved(!1)}t&&this._advanceLastEventId(e.id,e.list_revision)}},{key:"_advanceLastEventId",value:function(e,t){this.lastEventId<e&&(this.descriptor.last_event_id=e,t&&(this.descriptor.revision=t))}},{key:"_updateRootDateUpdated",value:function(e){(!this.descriptor.date_updated||e.getTime()>this.descriptor.date_updated.getTime())&&(this.descriptor.date_updated=e,this.services.storage.update(this.type,this.sid,this.uniqueName,{date_updated:e}))}},{key:"_handleItemMutated",value:function(e,t,n,r,i,o,s,a,u){if(this.shouldIgnoreEvent(e,n))le("Item ".concat(e," update skipped, current: ").concat(this.lastEventId,", remote: ").concat(n));else{this._updateRootDateUpdated(o);var c=this.cache.get(e);if(!c){var l=new He({index:e,uri:t,lastEventId:n,revision:r,data:i,dateUpdated:o,dateExpires:s});return this.cache.store(e,l,n),void this.emitItemMutationEvent(l,u,a)}var d=ie(c.data);c.update(n,r,i,o),this.cache.store(e,c,n),void 0!==s&&c.updateDateExpires(s),this.emitItemMutationEvent(c,u,!1,d)}}},{key:"emitItemMutationEvent",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=n?"itemAdded":"itemUpdated",o={item:e,isLocal:!t};n||(o.previousItemData=r),this.broadcastEventToListeners(i,o)}},{key:"_handleItemRemoved",value:function(e,t,n,r,i){this._updateRootDateUpdated(r),this.cache.delete(e,t),this.broadcastEventToListeners("itemRemoved",{index:e,isLocal:!i,previousItemData:n})}},{key:"_handleContextUpdate",value:function(e,t,n){this._updateRootDateUpdated(n),this._updateContextIfRequired(e,t)&&this.broadcastEventToListeners("contextUpdated",{context:e,isLocal:!1})}},{key:"_updateContextIfRequired",value:function(e,t){return!this.contextEventId||t>this.contextEventId?(this.context=e,this.contextEventId=t,!0):(le("Context update skipped, current:",this.lastEventId,", remote:",t),!1)}}],[{key:"type",get:function(){return"list"}}]),v}(Ne),et=function(e){I.default(p,e);var t,n,r,i,o,s,a,u,c,l,d,f=Ze(p);function p(e){var t;return E.default(this,p),(t=f.call(this)).syncListImpl=e,t.syncListImpl.attach(O.default(t)),t}return T.default(p,[{key:"uri",get:function(){return this.syncListImpl.uri}},{key:"revision",get:function(){return this.syncListImpl.revision}},{key:"lastEventId",get:function(){return this.syncListImpl.lastEventId}},{key:"links",get:function(){return this.syncListImpl.links}},{key:"dateExpires",get:function(){return this.syncListImpl.dateExpires}},{key:"type",get:function(){return Qe.type}},{key:"sid",get:function(){return this.syncListImpl.sid}},{key:"uniqueName",get:function(){return this.syncListImpl.uniqueName}},{key:"dateUpdated",get:function(){return this.syncListImpl.dateUpdated}},{key:"push",value:(d=S.default(P.default.mark((function e(t,n){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.ensureNotClosed(),e.abrupt("return",this.syncListImpl.push(t,n));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t){return d.apply(this,arguments)})},{key:"set",value:(l=S.default(P.default.mark((function e(t,n,r){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.ensureNotClosed(),e.abrupt("return",this.syncListImpl.set(t,n,r));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return l.apply(this,arguments)})},{key:"mutate",value:(c=S.default(P.default.mark((function e(t,n,r){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.ensureNotClosed(),e.abrupt("return",this.syncListImpl.mutate(t,n,r));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return c.apply(this,arguments)})},{key:"update",value:(u=S.default(P.default.mark((function e(t,n,r){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.ensureNotClosed(),e.abrupt("return",this.syncListImpl.update(t,n,r));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return u.apply(this,arguments)})},{key:"remove",value:(a=S.default(P.default.mark((function e(t){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.ensureNotClosed(),e.abrupt("return",this.syncListImpl.remove(t));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"get",value:(s=S.default(P.default.mark((function e(t){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.ensureNotClosed(),e.abrupt("return",this.syncListImpl.get(t));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"getContext",value:(o=S.default(P.default.mark((function e(){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.ensureNotClosed(),e.abrupt("return",this.syncListImpl.getContext());case 2:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"getItems",value:(i=S.default(P.default.mark((function e(t){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.ensureNotClosed(),e.abrupt("return",this.syncListImpl.getItems(t));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"setTtl",value:(r=S.default(P.default.mark((function e(t){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.ensureNotClosed(),e.abrupt("return",this.syncListImpl.setTtl(t));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"setItemTtl",value:(n=S.default(P.default.mark((function e(t,n){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.ensureNotClosed(),e.abrupt("return",this.syncListImpl.setItemTtl(t,n));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"removeList",value:(t=S.default(P.default.mark((function e(){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.ensureNotClosed(),e.abrupt("return",this.syncListImpl.removeList());case 2:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"close",value:function(){B.default(R.default(p.prototype),"close",this).call(this),this.syncListImpl.detach(this.listenerUuid)}}],[{key:"type",get:function(){return Qe.type}}]),p}(De);A.default(et,"itemAdded","itemAdded"),A.default(et,"itemUpdated","itemUpdated"),A.default(et,"itemRemoved","itemRemoved"),A.default(et,"removed","removed"),F([p.validateTypesAsync(p.pureObject,["undefined",p.objectSchema("item metadata",{ttl:[p.nonNegativeInteger,"undefined"]})]),H("design:type",Function),H("design:paramtypes",[Object,Object]),H("design:returntype",Promise)],et.prototype,"push",null),F([p.validateTypesAsync(p.nonNegativeInteger,p.pureObject,["undefined",p.objectSchema("item metadata",{ttl:[p.nonNegativeInteger,"undefined"]})]),H("design:type",Function),H("design:paramtypes",[Number,Object,Object]),H("design:returntype",Promise)],et.prototype,"set",null),F([p.validateTypesAsync(p.nonNegativeInteger,"function",["undefined",p.objectSchema("item metadata",{ttl:[p.nonNegativeInteger,"undefined"]})]),H("design:type",Function),H("design:paramtypes",[Number,Function,Object]),H("design:returntype",Promise)],et.prototype,"mutate",null),F([p.validateTypesAsync(p.nonNegativeInteger,p.pureObject,["undefined",p.objectSchema("item metadata",{ttl:[p.nonNegativeInteger,"undefined"]})]),H("design:type",Function),H("design:paramtypes",[Number,Object,Object]),H("design:returntype",Promise)],et.prototype,"update",null),F([p.validateTypesAsync(p.nonNegativeInteger),H("design:type",Function),H("design:paramtypes",[Number]),H("design:returntype",Promise)],et.prototype,"remove",null),F([p.validateTypesAsync(p.nonNegativeInteger),H("design:type",Function),H("design:paramtypes",[Number]),H("design:returntype",Promise)],et.prototype,"get",null),F([p.validateTypesAsync(["undefined",p.objectSchema("query options",{from:[p.nonNegativeInteger,"undefined"],pageSize:[p.custom((function(e){return[se(e),"a positive integer"]})),"undefined"]})]),H("design:type",Function),H("design:paramtypes",[Object]),H("design:returntype",Promise)],et.prototype,"getItems",null),F([p.validateTypesAsync(p.nonNegativeInteger),H("design:type",Function),H("design:paramtypes",[Number]),H("design:returntype",Promise)],et.prototype,"setTtl",null),F([p.validateTypesAsync(p.nonNegativeInteger,p.nonNegativeInteger),H("design:type",Function),H("design:paramtypes",[Number,Number]),H("design:returntype",Promise)],et.prototype,"setItemTtl",null);var tt=function(){function e(t){E.default(this,e),this.descriptor=t}return T.default(e,[{key:"uri",get:function(){return this.descriptor.url}},{key:"revision",get:function(){return this.descriptor.revision}},{key:"lastEventId",get:function(){return this.descriptor.last_event_id}},{key:"dateExpires",get:function(){return this.descriptor.date_expires}},{key:"key",get:function(){return this.descriptor.key}},{key:"data",get:function(){return this.descriptor.data}},{key:"dateUpdated",get:function(){return this.descriptor.date_updated}},{key:"update",value:function(e,t,n,r){return this.descriptor.last_event_id=e,this.descriptor.revision=t,this.descriptor.data=n,this.descriptor.date_updated=r,this}},{key:"updateDateExpires",value:function(e){this.descriptor.date_expires=e}}]),e}();function nt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R.default(e);if(t){var i=R.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return C.default(this,n)}}var rt=function(e){I.default(h,e);var t,n,r,i,o,s,a,u,c,l,d,f,p=nt(h);function h(e,t,n){var r;E.default(this,h);return(r=p.call(this,e,n)).updateMergingQueue=new Me((function(e,t){return"number"==typeof t.ttl?{ttl:t.ttl}:e})),r.cache=new Je,r.descriptor=t,r.descriptor.date_updated=new Date(r.descriptor.date_updated),t.items&&t.items.forEach((function(e){e.date_updated=new Date(e.date_updated),r.cache.store(e.key,new tt(e),e.last_event_id)})),r}return T.default(h,[{key:"uri",get:function(){return this.descriptor.url}},{key:"links",get:function(){return this.descriptor.links}},{key:"revision",get:function(){return this.descriptor.revision}},{key:"lastEventId",get:function(){return this.descriptor.last_event_id}},{key:"dateExpires",get:function(){return this.descriptor.date_expires}},{key:"type",get:function(){return"map"}},{key:"indexName",get:function(){}},{key:"queryString",get:function(){}},{key:"sid",get:function(){return this.descriptor.sid}},{key:"uniqueName",get:function(){return this.descriptor.unique_name||null}},{key:"dateUpdated",get:function(){return this.descriptor.date_updated}},{key:"set",value:(f=S.default(P.default.mark((function e(t,n,r){var i,o=this;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=r||{},e.abrupt("return",this.updateMergingQueue.squashAndAdd(t,i,(function(e){return o._putItemUnconditionally(t,n,e.ttl)})));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return f.apply(this,arguments)})},{key:"get",value:function(){var e=S.default(P.default.mark((function e(t){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t){e.next=2;break}throw new ne("SyncMapItem key may not be empty",400,54209);case 2:if(!this.cache.has(t)){e.next=6;break}return e.abrupt("return",this.cache.get(t));case 6:return e.abrupt("return",this._getItemFromServer(t));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_getItemFromServer",value:(d=S.default(P.default.mark((function e(t){var n;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.queryItems({key:t});case 2:if(!((n=e.sent).items.length<1)){e.next=7;break}throw new ne("The specified Map Item does not exist",404,54201);case 7:return e.abrupt("return",n.items[0]);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:"mutate",value:(l=S.default(P.default.mark((function e(t,n,r){var i,o=this;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=r||{},e.abrupt("return",this.updateMergingQueue.add(t,i,(function(e){return o._putItemWithIfMatch(t,n,e.ttl)})));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return l.apply(this,arguments)})},{key:"update",value:(c=S.default(P.default.mark((function e(t,n,r){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.mutate(t,(function(e){return Object.assign(e,n)}),r));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return c.apply(this,arguments)})},{key:"_putItemUnconditionally",value:(u=S.default(P.default.mark((function e(t,n,r){var i,o;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._putItemToServer(t,n,void 0,r);case 2:return i=e.sent,o=i.item,this._handleItemMutated(o.key,o.url,o.last_event_id,o.revision,o.data,o.date_updated,o.date_expires,i.added,!1),e.abrupt("return",this.cache.get(o.key));case 6:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return u.apply(this,arguments)})},{key:"_putItemWithIfMatch",value:(a=S.default(P.default.mark((function e(t,n,r){var i,o,s,a,u;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get(t).catch((function(e){if(404===e.status)return new tt({key:t,data:{},last_event_id:-1,revision:"-1",url:null,date_updated:null,date_expires:null});throw e}));case 2:if(i=e.sent,!(o=n(ie(i.data)))){e.next=26;break}return s=i.revision,e.prev=6,e.next=9,this._putItemToServer(t,o,s,r);case 9:return a=e.sent,u=a.item,this._handleItemMutated(u.key,u.url,u.last_event_id,u.revision,u.data,u.date_updated,u.date_expires,a.added,!1),e.abrupt("return",this.cache.get(u.key));case 15:if(e.prev=15,e.t0=e.catch(6),412!==e.t0.status){e.next=23;break}return e.next=20,this._getItemFromServer(t);case 20:return e.abrupt("return",this._putItemWithIfMatch(t,n,r));case 23:throw e.t0;case 24:e.next=27;break;case 26:return e.abrupt("return",i);case 27:case"end":return e.stop()}}),e,this,[[6,15]])}))),function(e,t,n){return a.apply(this,arguments)})},{key:"_putItemToServer",value:(s=S.default(P.default.mark((function e(t,n,r,i){var o,s,a,u,c;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=new ee(this.links.items).pathSegment(t).build(),s={data:n},void 0!==i&&(s.ttl=i),e.prev=3,e.next=6,this.services.network.put(o,s,r);case 6:return a=e.sent,(u=a.body).data=n,u.date_updated=new Date(u.date_updated),c=201===a.status.code,e.abrupt("return",{added:c,item:u});case 14:throw e.prev=14,e.t0=e.catch(3),404===e.t0.status&&this.onRemoved(!1),e.t0;case 18:case"end":return e.stop()}}),e,this,[[3,14]])}))),function(e,t,n,r){return s.apply(this,arguments)})},{key:"remove",value:(o=S.default(P.default.mark((function e(t){var n,r,i;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get(t);case 2:return n=e.sent,r=ie(n.data),e.next=6,this.services.network.delete(n.uri);case 6:i=e.sent,this._handleItemRemoved(t,i.body.last_event_id,r,new Date(i.body.date_updated),!1);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"queryItems",value:function(){var e=S.default(P.default.mark((function e(t){var n,r,i,o,s=this;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=t||{},n=new ee(this.links.items).queryParam("From",t.from).queryParam("PageSize",t.limit).queryParam("Key",t.key).queryParam("PageToken",t.pageToken).queryParam("Order",t.order).build(),e.next=4,this.services.network.get(n);case 4:return r=e.sent,i=r.body.items.map((function(e){return e.date_updated=new Date(e.date_updated),s.cache.get(e.key)?s._handleItemMutated(e.key,e.url,e.last_event_id,e.revision,e.data,e.date_updated,e.date_expires,!1,!0):s.cache.store(e.key,new tt(e),e.last_event_id),s.cache.get(e.key)})),o=r.body.meta,e.abrupt("return",new Ge(i,(function(e){return s.queryItems({pageToken:e})}),o.previous_token,o.next_token));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getItems",value:(i=S.default(P.default.mark((function e(t){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return oe((t=t||{}).pageSize),t.limit=t.pageSize||t.limit||50,t.order=t.order||"asc",e.abrupt("return",this.queryItems(t));case 5:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"shouldIgnoreEvent",value:function(e,t){return this.cache.isKnown(e,t)}},{key:"_update",value:function(e,t){switch(e.date_created=new Date(e.date_created),e.type){case"map_item_added":case"map_item_updated":this._handleItemMutated(e.item_key,e.item_url,e.id,e.item_revision,e.item_data,e.date_created,void 0,"map_item_added"===e.type,!0);break;case"map_item_removed":this._handleItemRemoved(e.item_key,e.id,e.item_data,e.date_created,!0);break;case"map_removed":this.onRemoved(!1)}t&&this._advanceLastEventId(e.id,e.map_revision)}},{key:"_advanceLastEventId",value:function(e,t){this.lastEventId<e&&(this.descriptor.last_event_id=e,t&&(this.descriptor.revision=t))}},{key:"_updateRootDateUpdated",value:function(e){(!this.descriptor.date_updated||e.getTime()>this.descriptor.date_updated.getTime())&&(this.descriptor.date_updated=e,this.services.storage.update(this.type,this.sid,this.uniqueName,{date_updated:e}))}},{key:"_handleItemMutated",value:function(e,t,n,r,i,o,s,a,u){if(this.shouldIgnoreEvent(e,n))le("SyncMapItem ",e," update skipped, current:",this.lastEventId,", remote:",n);else{this._updateRootDateUpdated(o);var c=this.cache.get(e);if(!c){var l=new tt({key:e,url:t,last_event_id:n,revision:r,data:i,date_updated:o,date_expires:s});return this.cache.store(e,l,n),void this.emitItemMutationEvent(l,u,a)}var d=ie(c.data);c.update(n,r,i,o),this.cache.store(e,c,n),void 0!==s&&c.updateDateExpires(s),this.emitItemMutationEvent(c,u,!1,d)}}},{key:"emitItemMutationEvent",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=n?"itemAdded":"itemUpdated",o={item:e,isLocal:!t};n||(o.previousItemData=r),this.broadcastEventToListeners(i,o)}},{key:"_handleItemRemoved",value:function(e,t,n,r,i){this._updateRootDateUpdated(r),this.cache.delete(e,t),this.broadcastEventToListeners("itemRemoved",{key:e,isLocal:!i,previousItemData:n})}},{key:"onRemoved",value:function(e){this._unsubscribe(),this.removalHandler(this.type,this.sid,this.uniqueName),this.broadcastEventToListeners("removed",{isLocal:e})}},{key:"setTtl",value:(r=S.default(P.default.mark((function e(t){var n,r;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n={ttl:t},e.next=4,this.services.network.post(this.uri,n);case 4:r=e.sent,this.descriptor.date_expires=r.body.date_expires,e.next=12;break;case 8:throw e.prev=8,e.t0=e.catch(0),404===e.t0.status&&this.onRemoved(!1),e.t0;case 12:case"end":return e.stop()}}),e,this,[[0,8]])}))),function(e){return r.apply(this,arguments)})},{key:"setItemTtl",value:(n=S.default(P.default.mark((function e(t,n){var r,i,o;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get(t);case 2:return r=e.sent,i={ttl:n},e.next=6,this.services.network.post(r.uri,i);case 6:o=e.sent,r.updateDateExpires(o.body.date_expires);case 8:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"removeMap",value:(t=S.default(P.default.mark((function e(){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.services.network.delete(this.uri);case 2:this.onRemoved(!0);case 3:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}],[{key:"type",get:function(){return"map"}}]),h}(Ne),it=function(e){I.default(d,e);var t,n,r,i,o,s,a,u,c,l=nt(d);function d(e){var t;return E.default(this,d),(t=l.call(this)).syncMapImpl=e,t.syncMapImpl.attach(O.default(t)),t}return T.default(d,[{key:"uri",get:function(){return this.syncMapImpl.uri}},{key:"links",get:function(){return this.syncMapImpl.links}},{key:"revision",get:function(){return this.syncMapImpl.revision}},{key:"lastEventId",get:function(){return this.syncMapImpl.lastEventId}},{key:"dateExpires",get:function(){return this.syncMapImpl.dateExpires}},{key:"type",get:function(){return rt.type}},{key:"sid",get:function(){return this.syncMapImpl.sid}},{key:"uniqueName",get:function(){return this.syncMapImpl.uniqueName}},{key:"dateUpdated",get:function(){return this.syncMapImpl.dateUpdated}},{key:"set",value:(c=S.default(P.default.mark((function e(t,n,r){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.ensureNotClosed(),e.abrupt("return",this.syncMapImpl.set(t,n,r));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return c.apply(this,arguments)})},{key:"get",value:(u=S.default(P.default.mark((function e(t){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.ensureNotClosed(),e.abrupt("return",this.syncMapImpl.get(t));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"mutate",value:(a=S.default(P.default.mark((function e(t,n,r){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.ensureNotClosed(),e.abrupt("return",this.syncMapImpl.mutate(t,n,r));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return a.apply(this,arguments)})},{key:"update",value:(s=S.default(P.default.mark((function e(t,n,r){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.ensureNotClosed(),e.abrupt("return",this.syncMapImpl.update(t,n,r));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return s.apply(this,arguments)})},{key:"remove",value:(o=S.default(P.default.mark((function e(t){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.ensureNotClosed(),e.abrupt("return",this.syncMapImpl.remove(t));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"getItems",value:(i=S.default(P.default.mark((function e(t){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.ensureNotClosed(),e.abrupt("return",this.syncMapImpl.getItems(t));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"setTtl",value:(r=S.default(P.default.mark((function e(t){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.ensureNotClosed(),e.abrupt("return",this.syncMapImpl.setTtl(t));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"setItemTtl",value:(n=S.default(P.default.mark((function e(t,n){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.ensureNotClosed(),e.abrupt("return",this.syncMapImpl.setItemTtl(t,n));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"removeMap",value:(t=S.default(P.default.mark((function e(){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.ensureNotClosed(),e.next=3,this.syncMapImpl.removeMap();case 3:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"close",value:function(){B.default(R.default(d.prototype),"close",this).call(this),this.syncMapImpl.detach(this.listenerUuid)}}],[{key:"type",get:function(){return rt.type}}]),d}(De);function ot(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R.default(e);if(t){var i=R.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return C.default(this,n)}}A.default(it,"itemAdded","itemAdded"),A.default(it,"itemUpdated","itemUpdated"),A.default(it,"itemRemoved","itemRemoved"),A.default(it,"removed","removed"),F([p.validateTypesAsync("string",p.pureObject,["undefined",p.objectSchema("item metadata",{ttl:[p.nonNegativeInteger,"undefined"]})]),H("design:type",Function),H("design:paramtypes",[String,Object,Object]),H("design:returntype",Promise)],it.prototype,"set",null),F([p.validateTypesAsync("string"),H("design:type",Function),H("design:paramtypes",[String]),H("design:returntype",Promise)],it.prototype,"get",null),F([p.validateTypesAsync("string","function",["undefined",p.objectSchema("item metadata",{ttl:[p.nonNegativeInteger,"undefined"]})]),H("design:type",Function),H("design:paramtypes",[String,Function,Object]),H("design:returntype",Promise)],it.prototype,"mutate",null),F([p.validateTypesAsync("string",p.pureObject,["undefined",p.objectSchema("item metadata",{ttl:[p.nonNegativeInteger,"undefined"]})]),H("design:type",Function),H("design:paramtypes",[String,Object,Object]),H("design:returntype",Promise)],it.prototype,"update",null),F([p.validateTypesAsync("string"),H("design:type",Function),H("design:paramtypes",[String]),H("design:returntype",Promise)],it.prototype,"remove",null),F([p.validateTypesAsync(["undefined",p.objectSchema("query options",{from:["string","undefined"],pageSize:[p.custom((function(e){return[se(e),"a positive integer"]})),"undefined"]})]),H("design:type",Function),H("design:paramtypes",[Object]),H("design:returntype",Promise)],it.prototype,"getItems",null),F([p.validateTypesAsync(p.nonNegativeInteger),H("design:type",Function),H("design:paramtypes",[Number]),H("design:returntype",Promise)],it.prototype,"setTtl",null),F([p.validateTypesAsync("string",p.nonNegativeInteger),H("design:type",Function),H("design:paramtypes",[String,Number]),H("design:returntype",Promise)],it.prototype,"setItemTtl",null);var st=function(e){I.default(o,e);var t,n,r,i=ot(o);function o(e,t,n){var r;return E.default(this,o),(r=i.call(this,e,n)).descriptor=t,r}return T.default(o,[{key:"uri",get:function(){return this.descriptor.url}},{key:"links",get:function(){return this.descriptor.links}},{key:"dateExpires",get:function(){return this.descriptor.date_expires}},{key:"type",get:function(){return"stream"}},{key:"lastEventId",get:function(){return null}},{key:"indexName",get:function(){}},{key:"queryString",get:function(){}},{key:"sid",get:function(){return this.descriptor.sid}},{key:"uniqueName",get:function(){return this.descriptor.unique_name||null}},{key:"publishMessage",value:(r=S.default(P.default.mark((function e(t){var n,r,i,o;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={data:t},e.next=3,this.services.network.post(this.links.messages,n);case 3:return r=e.sent,i=r.body,o=this._handleMessagePublished(i.sid,t,!1),e.abrupt("return",o);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"setTtl",value:(n=S.default(P.default.mark((function e(t){var n,r;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n={ttl:t},e.next=4,this.services.network.post(this.uri,n);case 4:r=e.sent,this.descriptor.date_expires=r.body.date_expires,e.next=12;break;case 8:throw e.prev=8,e.t0=e.catch(0),404===e.t0.status&&this.onRemoved(!1),e.t0;case 12:case"end":return e.stop()}}),e,this,[[0,8]])}))),function(e){return n.apply(this,arguments)})},{key:"removeStream",value:(t=S.default(P.default.mark((function e(){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.services.network.delete(this.uri);case 2:this.onRemoved(!0);case 3:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"_update",value:function(e){switch(e.type){case"stream_message_published":this._handleMessagePublished(e.message_sid,e.message_data,!0);break;case"stream_removed":this.onRemoved(!1)}}},{key:"_handleMessagePublished",value:function(e,t,n){var r={sid:e,data:t};return this.broadcastEventToListeners("messagePublished",{message:r,isLocal:!n}),r}},{key:"onRemoved",value:function(e){this._unsubscribe(),this.removalHandler(this.type,this.sid,this.uniqueName),this.broadcastEventToListeners("removed",{isLocal:e})}}],[{key:"type",get:function(){return"stream"}}]),o}(Ne);F([p.validateTypesAsync(p.pureObject),H("design:type",Function),H("design:paramtypes",[Object]),H("design:returntype",Promise)],st.prototype,"publishMessage",null),F([p.validateTypesAsync(p.nonNegativeInteger),H("design:type",Function),H("design:paramtypes",[Number]),H("design:returntype",Promise)],st.prototype,"setTtl",null);var at=function(e){I.default(o,e);var t,n,r,i=ot(o);function o(e){var t;return E.default(this,o),(t=i.call(this)).syncStreamImpl=e,t.syncStreamImpl.attach(O.default(t)),t}return T.default(o,[{key:"uri",get:function(){return this.syncStreamImpl.uri}},{key:"links",get:function(){return this.syncStreamImpl.links}},{key:"dateExpires",get:function(){return this.syncStreamImpl.dateExpires}},{key:"type",get:function(){return st.type}},{key:"lastEventId",get:function(){return null}},{key:"sid",get:function(){return this.syncStreamImpl.sid}},{key:"uniqueName",get:function(){return this.syncStreamImpl.uniqueName}},{key:"publishMessage",value:(r=S.default(P.default.mark((function e(t){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.ensureNotClosed(),e.abrupt("return",this.syncStreamImpl.publishMessage(t));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"setTtl",value:(n=S.default(P.default.mark((function e(t){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.ensureNotClosed(),e.abrupt("return",this.syncStreamImpl.setTtl(t));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"removeStream",value:(t=S.default(P.default.mark((function e(){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.ensureNotClosed(),e.abrupt("return",this.syncStreamImpl.removeStream());case 2:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"close",value:function(){B.default(R.default(o.prototype),"close",this).call(this),this.syncStreamImpl.detach(this.listenerUuid)}}],[{key:"type",get:function(){return st.type}}]),o}(De);A.default(at,"messagePublished","messagePublished"),A.default(at,"removed","removed"),F([p.validateTypesAsync(p.pureObject),H("design:type",Function),H("design:paramtypes",[Object]),H("design:returntype",Promise)],at.prototype,"publishMessage",null),F([p.validateTypesAsync(p.nonNegativeInteger),H("design:type",Function),H("design:paramtypes",[Number]),H("design:returntype",Promise)],at.prototype,"setTtl",null);var ut=function e(t){E.default(this,e),this.sdk="js",this.sdkVer=t,this.os=U.os.family,this.osVer=U.os.version,this.pl=U.name,this.plVer=U.version},ct=function(){function e(){E.default(this,e),this.names=new Map,this.entities=new Map}return T.default(e,[{key:"store",value:function(e){var t=this.entities.get(e.sid);return t||(this.entities.set(e.sid,e),e.uniqueName&&this.names.set(e.type+"::"+e.uniqueName,e.sid),e)}},{key:"getResolved",value:function(e,t){var n=this.names.get(t+"::"+e);return n?this.entities.get(n):null}},{key:"get",value:function(e,t){return this.entities.get(e)||this.getResolved(e,t)||null}},{key:"remove",value:function(e){var t=this.entities.get(e);t&&(this.entities.delete(e),t.uniqueName&&this.names.delete(t.type+"::"+t.uniqueName))}}]),e}();function lt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R.default(e);if(t){var i=R.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return C.default(this,n)}}var dt=function(e){I.default(n,e);var t=lt(n);function n(e,r,i,o){var s;return E.default(this,n),(s=t.call(this,r,i)).descriptor=e,s.cache=new Je,o&&o.forEach((function(e){s.cache.store(e.key,{key:e.key,value:e.data},e.revision)})),s}return T.default(n,[{key:"sid",get:function(){return this.descriptor.sid}},{key:"uniqueName",get:function(){return null}},{key:"type",get:function(){return n.type}},{key:"lastEventId",get:function(){return this.descriptor.last_event_id}},{key:"indexName",get:function(){return this.descriptor.indexName}},{key:"queryString",get:function(){return this.descriptor.queryExpression}},{key:"queryUri",get:function(){return this.descriptor.queryUri}},{key:"liveQueryDescriptor",get:function(){return this.descriptor}},{key:"onRemoved",value:function(){}},{key:"getItems",value:function(){var e={};return this.cache.forEach((function(t,n){e[t]=n.value})),e}},{key:"_update",value:function(e,t){switch(e.type){case"live_query_item_updated":this.handleItemMutated(e.item_key,e.item_data,e.item_revision);break;case"live_query_item_removed":this.handleItemRemoved(e.item_key,e.item_revision);break;case"live_query_updated":this.handleBatchUpdate(e.items)}t&&this._advanceLastEventId(e.last_event_id)}},{key:"handleItemMutated",value:function(e,t,n){if(this.shouldIgnoreEvent(e,n))le("Item ".concat(e," update skipped, revision: ").concat(n));else{var r={key:e,value:t};this.cache.store(e,r,n),this.broadcastEventToListeners("itemUpdated",r)}}},{key:"handleItemRemoved",value:function(e,t){var n=null===t;this.shouldIgnoreEvent(e,t)?le("Item ".concat(e," delete skipped, revision: ").concat(t)):(this.cache.delete(e,t,n),this.broadcastEventToListeners("itemRemoved",{key:e}))}},{key:"handleBatchUpdate",value:function(e){var t=this,n={};for(var r in null!=e&&e.forEach((function(e){n[e.key]={data:e.data,revision:e.revision}})),this.cache.forEach((function(e,r){var i=n[e];null!=i?t.handleItemMutated(e,i.data,i.revision):t.handleItemRemoved(e,null),delete n[e]})),n)this.handleItemMutated(r,n[r].data,n[r].revision)}},{key:"shouldIgnoreEvent",value:function(e,t){return null!=e&&null!=t&&this.cache.isKnown(e,t)}},{key:"_advanceLastEventId",value:function(e,t){this.lastEventId<e&&(this.descriptor.last_event_id=e)}}],[{key:"type",get:function(){return"live_query"}}]),n}(Ne);function ft(e){return pt.apply(this,arguments)}function pt(){return(pt=S.default(P.default.mark((function e(t){var n,r,i,o,s,a;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.network,r=t.queryString,i=t.uri,o=t.type,null!=r){e.next=3;break}throw new ne("Invalid query",400,54507);case 3:return s={query_string:r},o===ht.type&&(s.type=o),e.next=7,n.post(i,s,void 0,!0);case 7:return a=e.sent,e.abrupt("return",a.body);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ht=function(e){I.default(n,e);var t=lt(n);function n(e){var r;return E.default(this,n),(r=t.call(this)).liveQueryImpl=e,r.liveQueryImpl.attach(O.default(r)),r}return T.default(n,[{key:"type",get:function(){return dt.type}},{key:"lastEventId",get:function(){return this.liveQueryImpl.lastEventId}},{key:"sid",get:function(){return this.liveQueryImpl.sid}},{key:"close",value:function(){B.default(R.default(n.prototype),"close",this).call(this),this.liveQueryImpl.detach(this.listenerUuid)}},{key:"getItems",value:function(){return this.ensureNotClosed(),this.liveQueryImpl.getItems()}}],[{key:"type",get:function(){return dt.type}}]),n}(De);A.default(ht,"itemUpdated","itemUpdated"),A.default(ht,"itemRemoved","itemRemoved");var yt=function(e){I.default(i,e);var t,n,r=lt(i);function i(e){var t;return E.default(this,i),t=r.call(this),A.default(O.default(t),"queryExpression",null),A.default(O.default(t),"items",{}),Object.assign(O.default(t),e),t.updateIndexName(e.indexName),t}return T.default(i,[{key:"type",get:function(){return i.type}},{key:"search",value:(n=S.default(P.default.mark((function e(t){var n=this;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.items={},e.abrupt("return",ft({network:this.network,uri:this.queryUri,queryString:t}).then((function(e){n.queryExpression=t,e.items&&e.items.forEach((function(e){n.items[e.key]=e.data})),n.emit("searchResult",n.getItems())})).catch((function(e){throw pe("Error '".concat(e.message,"' while executing query '").concat(t,"'")),n.queryExpression=null,e})));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"subscribe",value:(t=S.default(P.default.mark((function e(){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=this.queryExpression){e.next=2;break}return e.abrupt("return",Promise.reject(new ne("Invalid query",400,54507)));case 2:return e.abrupt("return",this.liveQueryCreator(this.indexName,this.queryExpression));case 3:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"getItems",value:function(){return this.items}},{key:"updateIndexName",value:function(e){this.indexName=e,this.queryUri=this.generateQueryUri(this.indexName)}},{key:"generateQueryUri",value:function(e){return new ee(this.insightsUri).pathSegment(e).pathSegment("Items").build()}}],[{key:"type",get:function(){return"instant_query"}}]),i}(W);A.default(yt,"searchResult","searchResult"),F([p.validateTypesAsync("string"),H("design:type",Function),H("design:paramtypes",[String]),H("design:returntype",Promise)],yt.prototype,"search",null),F([p.validateTypes(p.nonEmptyString),H("design:type",Function),H("design:paramtypes",[String]),H("design:returntype",void 0)],yt.prototype,"updateIndexName",null);function vt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R.default(e);if(t){var i=R.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return C.default(this,n)}}function mt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function gt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?mt(Object(n),!0).forEach((function(t){A.default(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):mt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var bt="data_sync",_t="3.1.0";function wt(e){if(e){if("string"==typeof e)return{id:e,mode:"open_or_create"};var t=e.mode||(e.id?"open_or_create":"create_new");return gt(gt({},e),{},{mode:t})}return{mode:"create_new"}}var kt="com.twilio.rtd.cds.document",xt="com.twilio.rtd.cds.list",St="com.twilio.rtd.cds.map",Et="twilio.sync.event",Tt=function(e){I.default(g,e);var t,n,r,i,o,s,a,u,c,l,d,f,p,y,v,m=vt(g);function g(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(E.default(this,g),t=m.call(this),!e)throw new Error("Sync library needs a valid Twilio token to be passed");n.hasOwnProperty("logLevel")?ce(n.logLevel):ce("silent");var r=n.productId=n.productId||bt;n.clientMetadata=n.clientMetadata||{},n.clientMetadata.hasOwnProperty("type")||(n.clientMetadata.type="sync"),n.clientMetadata.hasOwnProperty("sdk")||(n.clientMetadata.sdk="JS",n.clientMetadata.sdkv=_t);var i=!n.twilsockClient;if(!n.initRegistrations){var o=new h.InitRegistration(r);g.populateInitRegistrations(o),n.initRegistrations=[o]}var s=n.twilsockClient=n.twilsockClient||new h.Twilsock(e,r,n);s.on("tokenAboutToExpire",(function(e){return t.emit("tokenAboutToExpire",e)})),s.on("tokenExpired",(function(){return t.emit("tokenExpired")})),s.on("connectionError",(function(e){return t.emit("connectionError",e)})),s.on("stateChanged",(function(e){t.emit("connectionStateChanged",e),t.services.subscriptions.onConnectionStateChanged("connected"===e)})),s.on("message",(function(e,n){return t._routeMessage(e,n)}));var a=new we(n),u=new Ce(new ut(_t),a,s),c=new Re(a);return t.services={config:a,twilsock:s,network:u,storage:c,router:O.default(t),subscriptions:null},t.services.subscriptions=new Ee(t.services),t.entities=new ct,i&&s.connect(),t}return T.default(g,[{key:"_routeMessage",value:function(e,t){switch(le("Notification type:",e,"content:",t),e){case kt:case xt:case St:this.services.subscriptions.acceptMessage(t,!1);break;case Et:this.services.subscriptions.acceptMessage(t,!0)}}},{key:"_subscribe",value:function(e,t){this.services.subscriptions.add(e,t)}},{key:"_unsubscribe",value:function(e){this.services.subscriptions.remove(e)}},{key:"connectionState",get:function(){return this.services.twilsock.state}},{key:"ensureReady",value:(v=S.default(P.default.mark((function e(){var t;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.services.config.sessionStorageEnabled){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,this.services.twilsock.storageId();case 5:t=e.sent,this.services.storage.updateStorageId(t.id),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),fe("Failed to initialize storage",e.t0);case 12:case"end":return e.stop()}}),e,this,[[2,9]])}))),function(){return v.apply(this,arguments)})},{key:"storeRootInSessionCache",value:function(e,t,n){if(this.services.config.sessionStorageEnabled&&t){var r=ie(n);e!==et.type&&e!==it.type||(r.last_event_id=null,delete r.items),this.services.storage.store(e,t,r)}}},{key:"readRootFromSessionCache",value:function(e,t){return this.services.config.sessionStorageEnabled&&t?this.services.storage.read(e,t):null}},{key:"_get",value:(y=S.default(P.default.mark((function e(t,n){var r,i,o,s=arguments;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=s.length>2&&void 0!==s[2]&&s[2],n){e.next=3;break}throw new ne("Cannot get entity without id",404);case 3:return i=new ee(t).pathSegment(n).queryParam("Include",r?"items":void 0).build(),e.next=6,this.services.network.get(i);case 6:return o=e.sent,e.abrupt("return",o.body);case 8:case"end":return e.stop()}}),e,this)}))),function(e,t){return y.apply(this,arguments)})},{key:"_createDocument",value:function(e,t,n){var r={unique_name:e,data:t||{}};return void 0!==n&&(r.ttl=n),this.services.network.post(this.services.config.documentsUri,r).then((function(e){return e.body.data=r.data,e.body}))}},{key:"_getDocument",value:(p=S.default(P.default.mark((function e(t){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.readRootFromSessionCache(Fe.type,t)||this._get(this.services.config.documentsUri,t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{key:"_createList",value:function(e,t,n,r){var i={unique_name:e,purpose:t,context:n};return void 0!==r&&(i.ttl=r),this.services.network.post(this.services.config.listsUri,i).then((function(e){return e.body}))}},{key:"_getList",value:(f=S.default(P.default.mark((function e(t){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.readRootFromSessionCache(et.type,t)||this._get(this.services.config.listsUri,t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})},{key:"_createMap",value:function(e,t){var n={unique_name:e};return void 0!==t&&(n.ttl=t),this.services.network.post(this.services.config.mapsUri,n).then((function(e){return e.body}))}},{key:"_getMap",value:(d=S.default(P.default.mark((function e(t){var n,r=arguments;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]&&r[1],e.abrupt("return",this.readRootFromSessionCache(it.type,t)||this._get(this.services.config.mapsUri,t,n));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:"_getStream",value:(l=S.default(P.default.mark((function e(t){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.readRootFromSessionCache(at.type,t)||this._get(this.services.config.streamsUri,t,!1));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"_createStream",value:(c=S.default(P.default.mark((function e(t,n){var r,i;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={unique_name:t},void 0!==n&&(r.ttl=n),e.next=4,this.services.network.post(this.services.config.streamsUri,r);case 4:return i=e.sent,e.abrupt("return",i.body);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return c.apply(this,arguments)})},{key:"_getLiveQuery",value:function(e){return this.readRootFromSessionCache(ht.type,e)}},{key:"getCached",value:function(e,t){return e&&this.entities.get(e,t)||null}},{key:"removeFromCacheAndSession",value:function(e,t,n){this.entities.remove(t),this.services.config.sessionStorageEnabled&&this.services.storage.remove(e,t,n)}},{key:"document",value:(u=S.default(P.default.mark((function e(t){var n,r,i,o,s=this;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.ensureReady();case 2:if("create_new"!==(n=wt(t)).mode){e.next=9;break}return e.next=6,this._createDocument(n.id,n.data,n.ttl);case 6:case 17:case 29:r=e.sent,e.next=39;break;case 9:if(!(i=this.getCached(n.id,Fe.type))){e.next=14;break}return e.abrupt("return",new Fe(i));case 14:return e.prev=14,e.next=17,this._getDocument(n.id);case 20:if(e.prev=20,e.t0=e.catch(14),404===e.t0.status&&"open_existing"!==n.mode){e.next=26;break}throw e.t0;case 26:return e.prev=26,e.next=29,this._createDocument(n.id,n.data,n.ttl);case 32:if(e.prev=32,e.t1=e.catch(26),409!==e.t1.status){e.next=38;break}return e.abrupt("return",this.document(t));case 38:throw e.t1;case 39:return this.storeRootInSessionCache(Fe.type,n.id,r),o=new Ue(this.services,r,(function(e,t,n){return s.removeFromCacheAndSession(e,t,n)})),o=this.entities.store(o),e.abrupt("return",new Fe(o));case 43:case"end":return e.stop()}}),e,this,[[14,20],[26,32]])}))),function(e){return u.apply(this,arguments)})},{key:"map",value:(a=S.default(P.default.mark((function e(t){var n,r,i,o,s=this;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.ensureReady();case 2:if("create_new"!==(n=wt(t)).mode){e.next=9;break}return e.next=6,this._createMap(n.id,n.ttl);case 6:case 17:case 29:r=e.sent,e.next=39;break;case 9:if(!(i=this.getCached(n.id,it.type))){e.next=14;break}return e.abrupt("return",new it(i));case 14:return e.prev=14,e.next=17,this._getMap(n.id,n.includeItems);case 20:if(e.prev=20,e.t0=e.catch(14),404===e.t0.status&&"open_existing"!==n.mode){e.next=26;break}throw e.t0;case 26:return e.prev=26,e.next=29,this._createMap(n.id,n.ttl);case 32:if(e.prev=32,e.t1=e.catch(26),409!==e.t1.status){e.next=38;break}return e.abrupt("return",this.map(t));case 38:throw e.t1;case 39:return this.storeRootInSessionCache(it.type,n.id,r),o=new rt(this.services,r,(function(e,t,n){return s.removeFromCacheAndSession(e,t,n)})),o=this.entities.store(o),e.abrupt("return",new it(o));case 43:case"end":return e.stop()}}),e,this,[[14,20],[26,32]])}))),function(e){return a.apply(this,arguments)})},{key:"list",value:(s=S.default(P.default.mark((function e(t){var n,r,i,o,s=this;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.ensureReady();case 2:if("create_new"!==(n=wt(t)).mode){e.next=9;break}return e.next=6,this._createList(n.id,n.purpose,n.context,n.ttl);case 6:case 17:case 29:r=e.sent,e.next=39;break;case 9:if(!(i=this.getCached(n.id,et.type))){e.next=14;break}return e.abrupt("return",new et(i));case 14:return e.prev=14,e.next=17,this._getList(n.id);case 20:if(e.prev=20,e.t0=e.catch(14),404===e.t0.status&&"open_existing"!==n.mode){e.next=26;break}throw e.t0;case 26:return e.prev=26,e.next=29,this._createList(n.id,n.purpose,n.context,n.ttl);case 32:if(e.prev=32,e.t1=e.catch(26),409!==e.t1.status){e.next=38;break}return e.abrupt("return",this.list(t));case 38:throw e.t1;case 39:return this.storeRootInSessionCache(et.type,n.id,r),o=new Qe(this.services,r,(function(e,t,n){return s.removeFromCacheAndSession(e,t,n)})),o=this.entities.store(o),e.abrupt("return",new et(o));case 43:case"end":return e.stop()}}),e,this,[[14,20],[26,32]])}))),function(e){return s.apply(this,arguments)})},{key:"stream",value:(o=S.default(P.default.mark((function e(t){var n,r,i,o,s,a=this;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.ensureReady();case 2:if("create_new"!==(n=wt(t)).mode){e.next=9;break}return e.next=6,this._createStream(n.id,n.ttl);case 6:case 17:case 29:r=e.sent,e.next=39;break;case 9:if(!(i=this.getCached(n.id,at.type))){e.next=14;break}return e.abrupt("return",new at(i));case 14:return e.prev=14,e.next=17,this._getStream(n.id);case 20:if(e.prev=20,e.t0=e.catch(14),404===e.t0.status&&"open_existing"!==n.mode){e.next=26;break}throw e.t0;case 26:return e.prev=26,e.next=29,this._createStream(n.id,n.ttl);case 32:if(e.prev=32,e.t1=e.catch(26),409!==e.t1.status){e.next=38;break}return e.abrupt("return",this.stream(t));case 38:throw e.t1;case 39:return this.storeRootInSessionCache(at.type,n.id,r),o=function(e,t,n){return a.removeFromCacheAndSession(e,t,n)},s=new st(this.services,r,o),s=this.entities.store(s),e.abrupt("return",new at(s));case 44:case"end":return e.stop()}}),e,this,[[14,20],[26,32]])}))),function(e){return o.apply(this,arguments)})},{key:"shutdown",value:(i=S.default(P.default.mark((function e(){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.services.subscriptions.shutdown();case 2:return e.next=4,this.services.twilsock.disconnect();case 4:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"updateToken",value:(r=S.default(P.default.mark((function e(t){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.services.twilsock.updateToken(t).catch((function(e){var t,n=null==e||null===(t=e.reply)||void 0===t?void 0:t.status;if(401===(null==n?void 0:n.code)&&"UNAUTHORIZED"===(null==n?void 0:n.status))throw new ne("Updated token was rejected by server",400,51130);throw e})));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"liveQuery",value:(n=S.default(P.default.mark((function e(t,n){var r,i,o,s,a,u=this;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.ensureReady();case 2:return r=new ee(this.services.config.insightsUri).pathSegment(t).pathSegment("Items").build(),e.next=5,ft({network:this.services.network,uri:r,queryString:n,type:ht.type});case 5:return i=e.sent,(o=this.getCached(i.query_id,ht.type))||((s=this._getLiveQuery(i.query_id))||(s={indexName:t,queryExpression:n,sid:i.query_id,queryUri:r,last_event_id:i.last_event_id}),a=function(e,t,n){return u.removeFromCacheAndSession(e,t,n)},o=new dt(s,this.services,a,i.items)),this.storeRootInSessionCache(ht.type,i.query_id,o.liveQueryDescriptor),o=this.entities.store(o),e.abrupt("return",new ht(o));case 11:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"instantQuery",value:(t=S.default(P.default.mark((function e(t){var n,r=this;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.ensureReady();case 2:return n=function(e,t){return r.liveQuery(e,t)},e.abrupt("return",new yt({indexName:t,network:this.services.network,insightsUri:this.services.config.insightsUri,liveQueryCreator:n}));case 4:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}],[{key:"populateInitRegistrations",value:function(e){e.populateInitRegistrations([Et,kt,xt,St])}},{key:"version",get:function(){return _t}}]),g}(W);A.default(Tt,"connectionStateChanged","connectionStateChanged"),A.default(Tt,"connectionError","connectionError"),A.default(Tt,"tokenAboutToExpire","tokenAboutToExpire"),A.default(Tt,"tokenExpired","tokenExpired"),F([p.validateTypesAsync(["undefined","string",p.objectSchema("open document options",{id:["string","undefined"],mode:[p.literal("open_or_create","open_existing","create_new"),"undefined"],ttl:[p.nonNegativeInteger,"undefined"],data:[p.pureObject,"undefined",p.literal(null)]})]),H("design:type",Function),H("design:paramtypes",[Object]),H("design:returntype",Promise)],Tt.prototype,"document",null),F([p.validateTypesAsync(["undefined","string",p.objectSchema("open map options",{id:["string","undefined"],mode:[p.literal("open_or_create","open_existing","create_new"),"undefined"],ttl:[p.nonNegativeInteger,"undefined"],data:[p.pureObject,"undefined",p.literal(null)],includeItems:["boolean","undefined"]})]),H("design:type",Function),H("design:paramtypes",[Object]),H("design:returntype",Promise)],Tt.prototype,"map",null),F([p.validateTypesAsync(["undefined","string",p.objectSchema("open list options",{id:["string","undefined"],mode:[p.literal("open_or_create","open_existing","create_new"),"undefined"],ttl:[p.nonNegativeInteger,"undefined"],data:[p.pureObject,"undefined",p.literal(null)],purpose:["string","undefined"],context:[p.pureObject,"undefined"],includeItems:["boolean","undefined"]})]),H("design:type",Function),H("design:paramtypes",[Object]),H("design:returntype",Promise)],Tt.prototype,"list",null),F([p.validateTypesAsync(["undefined","string",p.objectSchema("open stream options",{id:["string","undefined"],mode:[p.literal("open_or_create","open_existing","create_new"),"undefined"],ttl:[p.nonNegativeInteger,"undefined"],data:[p.pureObject,"undefined",p.literal(null)]})]),H("design:type",Function),H("design:paramtypes",[Object]),H("design:returntype",Promise)],Tt.prototype,"stream",null),F([p.validateTypesAsync(p.nonEmptyString),H("design:type",Function),H("design:paramtypes",[String]),H("design:returntype",Promise)],Tt.prototype,"updateToken",null),F([p.validateTypesAsync(p.nonEmptyString,"string"),H("design:type",Function),H("design:paramtypes",[String,String]),H("design:returntype",Promise)],Tt.prototype,"liveQuery",null),F([p.validateTypesAsync(p.nonEmptyString),H("design:type",Function),H("design:paramtypes",[String]),H("design:returntype",Promise)],Tt.prototype,"instantQuery",null),t.Client=Tt,t.InsightsItem=function e(){E.default(this,e)},t.InstantQuery=yt,t.LiveQuery=ht,t.Paginator=Ge,t.SyncClient=Tt,t.SyncDocument=Fe,t.SyncList=et,t.SyncListItem=He,t.SyncMap=it,t.SyncMapItem=tt,t.SyncStream=at},3821:(e,t,n)=>{"use strict";var r=void 0!==r?r:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{};Object.defineProperty(t,"__esModule",{value:!0}),n(5664);var i=n(5341),o=n(2281),s=n(5206),a=n(555),u=n(5895),c=n(1167),l=n(1559),d=n(9516),f=n(7322),p=n(3879);n(6294),n(1825),n(770),n(1117),n(7039);var h=n(4492),y=n(321);n(2893),n(8389);var v=n(1144);n(7583),n(8270),n(2502),n(5857),n(711),n(5648);var m=n(1994),g=n(4755);n(6564),n(5169),n(5607),n(6607),n(2171),n(1186),n(9423),n(7675),n(9514),n(9477),n(9934),n(8513),n(9272),n(2946),n(6994),n(9566),n(5360),n(5132),n(4123),n(1024),n(3957),n(4255),n(1697),n(7114),n(1761),n(6163),n(4362),n(740);var b=n(2771);n(8330),n(8505),n(7913),n(6029),n(6023);var _=n(4051);n(2905);var w=n(259);function k(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function x(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(n){if("default"!==n){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})}})),t.default=e,Object.freeze(t)}n(6912),n(2849),n(5073);var S=k(i),E=k(o),T=k(s),O=k(a),I=k(u),C=k(c),R=k(l),A=k(d),P=k(f),N=k(p),L=k(h),M=x(v),j=x(m),D=k(b),B=x(w);function U(){}function F(){F.init.call(this)}function H(e){return void 0===e._maxListeners?F.defaultMaxListeners:e._maxListeners}function G(e,t,n){if(t)e.call(n);else for(var r=e.length,i=X(e,r),o=0;o<r;++o)i[o].call(n)}function W(e,t,n,r){if(t)e.call(n,r);else for(var i=e.length,o=X(e,i),s=0;s<i;++s)o[s].call(n,r)}function q(e,t,n,r,i){if(t)e.call(n,r,i);else for(var o=e.length,s=X(e,o),a=0;a<o;++a)s[a].call(n,r,i)}function V(e,t,n,r,i,o){if(t)e.call(n,r,i,o);else for(var s=e.length,a=X(e,s),u=0;u<s;++u)a[u].call(n,r,i,o)}function z(e,t,n,r){if(t)e.apply(n,r);else for(var i=e.length,o=X(e,i),s=0;s<i;++s)o[s].apply(n,r)}function Y(e,t,n,r){var i,o,s;if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');if((o=e._events)?(o.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),s=o[t]):(o=e._events=new U,e._eventsCount=0),s){if("function"==typeof s?s=o[t]=r?[n,s]:[s,n]:r?s.unshift(n):s.push(n),!s.warned&&(i=H(e))&&i>0&&s.length>i){s.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=e,a.type=t,a.count=s.length,console.warn}}else s=o[t]=n,++e._eventsCount;return e}function K(e,t,n){var r=!1;function i(){e.removeListener(t,i),r||(r=!0,n.apply(e,arguments))}return i.listener=n,i}function $(e){var t=this._events;if(t){var n=t[e];if("function"==typeof n)return 1;if(n)return n.length}return 0}function X(e,t){for(var n=new Array(t);t--;)n[t]=e[t];return n}U.prototype=Object.create(null),F.EventEmitter=F,F.usingDomains=!1,F.prototype.domain=void 0,F.prototype._events=void 0,F.prototype._maxListeners=void 0,F.defaultMaxListeners=10,F.init=function(){this.domain=null,F.usingDomains&&undefined.active,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new U,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},F.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},F.prototype.getMaxListeners=function(){return H(this)},F.prototype.emit=function(e){var t,n,r,i,o,s,a,u="error"===e;if(s=this._events)u=u&&null==s.error;else if(!u)return!1;if(a=this.domain,u){if(t=arguments[1],!a){if(t instanceof Error)throw t;var c=new Error('Uncaught, unspecified "error" event. ('+t+")");throw c.context=t,c}return t||(t=new Error('Uncaught, unspecified "error" event')),t.domainEmitter=this,t.domain=a,t.domainThrown=!1,a.emit("error",t),!1}if(!(n=s[e]))return!1;var l="function"==typeof n;switch(r=arguments.length){case 1:G(n,l,this);break;case 2:W(n,l,this,arguments[1]);break;case 3:q(n,l,this,arguments[1],arguments[2]);break;case 4:V(n,l,this,arguments[1],arguments[2],arguments[3]);break;default:for(i=new Array(r-1),o=1;o<r;o++)i[o-1]=arguments[o];z(n,l,this,i)}return!0},F.prototype.addListener=function(e,t){return Y(this,e,t,!1)},F.prototype.on=F.prototype.addListener,F.prototype.prependListener=function(e,t){return Y(this,e,t,!0)},F.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,K(this,e,t)),this},F.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,K(this,e,t)),this},F.prototype.removeListener=function(e,t){var n,r,i,o,s;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if(!(r=this._events))return this;if(!(n=r[e]))return this;if(n===t||n.listener&&n.listener===t)0==--this._eventsCount?this._events=new U:(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,o=n.length;o-- >0;)if(n[o]===t||n[o].listener&&n[o].listener===t){s=n[o].listener,i=o;break}if(i<0)return this;if(1===n.length){if(n[0]=void 0,0==--this._eventsCount)return this._events=new U,this;delete r[e]}else!function(e,t){for(var n=t,r=n+1,i=e.length;r<i;n+=1,r+=1)e[n]=e[r];e.pop()}(n,i);r.removeListener&&this.emit("removeListener",e,s||t)}return this},F.prototype.off=function(e,t){return this.removeListener(e,t)},F.prototype.removeAllListeners=function(e){var t,n;if(!(n=this._events))return this;if(!n.removeListener)return 0===arguments.length?(this._events=new U,this._eventsCount=0):n[e]&&(0==--this._eventsCount?this._events=new U:delete n[e]),this;if(0===arguments.length){for(var r,i=Object.keys(n),o=0;o<i.length;++o)"removeListener"!==(r=i[o])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=new U,this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(t)do{this.removeListener(e,t[t.length-1])}while(t[0]);return this},F.prototype.listeners=function(e){var t,n=this._events;return n&&(t=n[e])?"function"==typeof t?[t.listener||t]:function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(t):[]},F.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):$.call(e,t)},F.prototype.listenerCount=$,F.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};var J=M.getLogger("twilsock");function Z(e,t){return["".concat((new Date).toISOString()," Twilsock ").concat(e,":")].concat(Array.from(t))}var Q=new(function(){function e(t){A.default(this,e),P.default(this,"prefix",""),this.prefix=null!=t&&t.length>0?" "+t+":":""}return E.default(e,[{key:"setLevel",value:function(e){J.setLevel(e)}},{key:"trace",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];J.trace.apply(null,Z("T",t))}},{key:"debug",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];J.debug.apply(null,Z("D",t))}},{key:"info",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];J.info.apply(null,Z("I",t))}},{key:"warn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];J.warn.apply(null,Z("W",t))}},{key:"error",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];J.error.apply(null,Z("E",t))}}],[{key:"setLevel",value:function(e){J.setLevel(e)}},{key:"trace",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];J.trace.apply(null,Z("T",t))}},{key:"debug",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];J.debug.apply(null,Z("D",t))}},{key:"info",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];J.info.apply(null,Z("I",t))}},{key:"warn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];J.warn.apply(null,Z("W",t))}},{key:"error",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];J.error.apply(null,Z("E",t))}}]),e}())(""),ee="0.12.2",te=function(){function e(t,n,r){A.default(this,e),P.default(this,"confirmedCapabilities",new Set),this.activeGrant=n,this._token=t;var i=r.region||"us1",o="wss://tsock.".concat(i,".twilio.com/v3/wsconnect"),s=r.twilsock||r.Twilsock||{};this.url=s.uri||o,this._continuationToken=r.continuationToken?r.continuationToken:null,this.logLevel=r.logLevel?r.logLevel:"error",this.retryPolicy=r.retryPolicy?r.retryPolicy:{min:1e3,max:12e4,randomness:.2},this.clientMetadata=r.clientMetadata?r.clientMetadata:{},this.clientMetadata.ver=ee,this.initRegistrations=r.initRegistrations?r.initRegistrations:null,this.tweaks=r.tweaks?r.tweaks:null}return E.default(e,[{key:"token",get:function(){return this._token}},{key:"continuationToken",get:function(){return this._continuationToken}},{key:"updateToken",value:function(e){this._token=e}},{key:"updateContinuationToken",value:function(e){this._continuationToken=e}}]),e}(),ne=function e(t){A.default(this,e),this.id=t||"TM".concat(g.v4())};function re(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R.default(e);if(t){var i=R.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return C.default(this,n)}}var ie=function(e){I.default(n,e);var t=re(n);function n(e,r,i,o,s){var a;return A.default(this,n),a=t.call(this),P.default(T.default(a),"method","init"),a.token=e,a.continuation_token=r,a.metadata=i,a.registrations=o,a.tweaks=s,a.capabilities=["client_update","offline_storage","telemetry.v1"],a}return n}(ne);function oe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R.default(e);if(t){var i=R.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return C.default(this,n)}}var se=function(e){I.default(n,e);var t=oe(n);function n(e,r,i,o,s,a,u){var c;return A.default(this,n),(c=t.call(this,e)).continuationToken=r,c.continuationTokenStatus=o,c.offlineStorage=s,c.initRegistrations=a,c.debugInfo=u,c.confirmedCapabilities=i,c}return n}(ne);function ae(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R.default(e);if(t){var i=R.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return C.default(this,n)}}var ue=function(e){I.default(n,e);var t=ae(n);function n(e){var r;return A.default(this,n),r=t.call(this),P.default(T.default(r),"method","update"),r.token=e,r}return n}(ne);function ce(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R.default(e);if(t){var i=R.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return C.default(this,n)}}var le=function(e){I.default(n,e);var t=ce(n);function n(e,r,i){var o;return A.default(this,n),o=t.call(this),P.default(T.default(o),"method","message"),o.active_grant=e,o.payload_type=r,o.http_request=i,o}return n}(ne);function de(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R.default(e);if(t){var i=R.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return C.default(this,n)}}var fe=function(e){I.default(n,e);var t=de(n);function n(e){var r;return A.default(this,n),r=t.call(this,e),P.default(T.default(r),"method","reply"),P.default(T.default(r),"payload_type","application/json"),P.default(T.default(r),"status",{code:200,status:"OK"}),r}return n}(ne);function pe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R.default(e);if(t){var i=R.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return C.default(this,n)}}var he=function(e){I.default(n,e);var t=pe(n);function n(){var e;return A.default(this,n),e=t.call(this),P.default(T.default(e),"method","close"),e}return n}(ne);function ye(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R.default(e);if(t){var i=R.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return C.default(this,n)}}var ve=function e(t,n,r,i,o,s){A.default(this,e),this.start=t,this.end=n,this.title=r,this.details=i,this.id=o,this.type=s},me=function(e){I.default(n,e);var t=ye(n);function n(e){var r;return A.default(this,n),r=t.call(this),P.default(T.default(r),"method","telemetry.v1"),r.events=e,r}return n}(ne);function ge(e){return encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,(function(e,t){return String.fromCharCode(Number("0x"+t))})).length}function be(e){var t=encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,(function(e,t){return String.fromCharCode(Number("0x"+t))})),n=new Uint8Array(t.length);return Array.prototype.forEach.call(t,(function(e,t){n[t]=e.charCodeAt(0)})),n}function _e(e){var t=Array.prototype.map.call(e,(function(e){return String.fromCharCode(e)})).join("").replace(/(.)/g,(function(e,t){var n=t.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n}));return decodeURIComponent(t)}function we(e){return JSON.parse(_e(e))}var ke=function(){function e(){A.default(this,e)}return E.default(e,null,[{key:"parse",value:function(e){var t,n,r=new Uint8Array(e),i=function(e){for(var t="",n=0;n<e.length;++n){var r=String.fromCharCode(e[n]);if(t+=r,"\r"===r){n+=2;break}}var i=t.split(" ");return{size:n,protocol:i[0],version:i[1],headerSize:Number(i[2])}}(r);if("TWILSOCK"!==i.protocol||"V3.0"!==i.version)return Q.error("unsupported protocol: ".concat(i.protocol," ver ").concat(i.version)),null;try{t=we(r.subarray(i.size,i.size+i.headerSize))}catch(t){return Q.error("failed to parse message header",t,e),null}if(Q.debug("message received: ",t.method),Q.trace("message received: ",t),t.payload_size>0){var o=2+i.size+i.headerSize,s=t.payload_size;if(t.hasOwnProperty("payload_type")&&0!==t.payload_type.indexOf("application/json"))0===t.payload_type.indexOf("text/plain")&&(n=_e(r.subarray(o,o+s)));else try{n=we(r.subarray(o,o+s))}catch(t){return Q.error("failed to parse message body",t,e),null}}return{method:t.method,header:t,payload:n}}},{key:"createPacket",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";e.payload_size=ge(t);var n=JSON.stringify(e),r="TWILSOCK V3.0 "+ge(n);Q.debug("send request:",r+n+t);var i=be(r+"\r\n"+n+"\r\n"+t);return i.buffer}}]),e}();function xe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R.default(e);if(t){var i=R.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return C.default(this,n)}}var Se=function(e){I.default(n,e);var t=xe(n);function n(e){return A.default(this,n),t.call(this,e)}return n}(D.default(Error));function Ee(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R.default(e);if(t){var i=R.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return C.default(this,n)}}var Te=function(e){I.default(n,e);var t=Ee(n);function n(e,r){var i;return A.default(this,n),(i=t.call(this,e)).reply=r,i}return n}(Se);function Oe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ie(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Oe(Object(n),!0).forEach((function(t){P.default(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Oe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ce(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R.default(e);if(t){var i=R.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return C.default(this,n)}}var Re=function(e){I.default(n,e);var t=Ce(n);function n(e){var r;return A.default(this,n),r=t.call(this),P.default(T.default(r),"newBackoff",null),P.default(T.default(r),"usedBackoff",null),P.default(T.default(r),"retrier",null),r.options=e?Ie({},e):{},r}return E.default(n,[{key:"inProgress",get:function(){return!!this.retrier}},{key:"start",value:function(){if(this.inProgress)throw new Error("Already waiting for next attempt, call finishAttempt(success : boolean) to finish it");this.createRetrier()}},{key:"stop",value:function(){this.cleanRetrier(),this.newBackoff=null,this.usedBackoff=null}},{key:"modifyBackoff",value:function(e){this.newBackoff=e}},{key:"attemptFailed",value:function(){if(!this.inProgress)throw new Error("No attempt is in progress");var e,t;this.newBackoff?!this.usedBackoff||this.usedBackoff<this.newBackoff?this.createRetrier():null===(e=this.retrier)||void 0===e||e.failed(new Error):null===(t=this.retrier)||void 0===t||t.failed(new Error)}},{key:"cancel",value:function(){var e;null===(e=this.retrier)||void 0===e||e.cancel()}},{key:"cleanRetrier",value:function(){var e,t;null===(e=this.retrier)||void 0===e||e.removeAllListeners(),null===(t=this.retrier)||void 0===t||t.cancel(),this.retrier=null}},{key:"getRetryPolicy",value:function(){var e=Ie({},this.options);return this.newBackoff&&(e.min=this.newBackoff,e.max=this.options.max&&this.options.max>this.newBackoff?this.options.max:this.newBackoff),e.maxAttemptsCount=this.options.maxAttemptsCount?this.options.maxAttemptsCount+1:void 0,e}},{key:"createRetrier",value:function(){var e=this;this.cleanRetrier();var t=this.getRetryPolicy();this.retrier=new _.Retrier(t),this.retrier.once("attempt",(function(){var t,n;null===(t=e.retrier)||void 0===t||t.on("attempt",(function(){return e.emit("attempt")})),null===(n=e.retrier)||void 0===n||n.failed(new Error("Skipping first attempt"))})),this.retrier.on("failed",(function(t){return e.emit("failed",t)})),this.usedBackoff=this.newBackoff,this.newBackoff=null,this.retrier.start()}}]),n}(F);function Ae(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R.default(e);if(t){var i=R.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return C.default(this,n)}}var Pe=function(e){I.default(i,e);var t,n,r=Ae(i);function i(e,t,n){var o;A.default(this,i),o=r.call(this),P.default(T.default(o),"disconnectingTimer",null),P.default(T.default(o),"disconnectedPromiseResolve",null),P.default(T.default(o),"terminalStates",["disconnected","rejected"]),P.default(T.default(o),"tokenExpiredSasCode",20104),P.default(T.default(o),"terminationReason","Connection is not initialized"),o.websocket=e,o.websocket.on("connected",(function(){return o.fsm.socketConnected()})),o.websocket.on("disconnected",(function(){return o.fsm.socketClosed()})),o.websocket.on("message",(function(e){return o.onIncomingMessage(e)})),o.websocket.on("socketError",(function(e){return o.emit("connectionError",{terminal:!1,message:"Socket error: ".concat(e.message),httpStatusCode:null,errorCode:null})})),o.transport=t,o.config=n,o.retrier=new Re(n.retryPolicy),o.retrier.on("attempt",(function(){return o.retry()})),o.retrier.on("failed",(function(e){Q.warn("Retrying failed: ".concat(e.message)),o.disconnect()})),"undefined"!=typeof window&&void 0!==window.addEventListener&&(window.addEventListener("online",(function(){Q.debug("Browser reported connectivity state: online"),o.resetBackoff(),o.fsm.systemOnline()})),window.addEventListener("offline",(function(){Q.debug("Browser reported connectivity state: offline"),o.websocket.close(),o.fsm.socketClosed()})));var s=j.factory({init:"disconnected",transitions:[{name:"userConnect",from:["disconnected","rejected"],to:"connecting"},{name:"userConnect",from:["connecting","connected"]},{name:"userDisconnect",from:["connecting","initialising","connected","updating","retrying","rejected","waitSocketClosed","waitOffloadSocketClosed"],to:"disconnecting"},{name:"userRetry",from:["retrying"],to:"connecting"},{name:"socketConnected",from:["connecting"],to:"initialising"},{name:"socketClosed",from:["connecting","initialising","connected","updating","error","waitOffloadSocketClosed"],to:"retrying"},{name:"socketClosed",from:["disconnecting"],to:"disconnected"},{name:"socketClosed",from:["waitSocketClosed"],to:"disconnected"},{name:"socketClosed",from:["rejected"],to:"rejected"},{name:"initSuccess",from:["initialising"],to:"connected"},{name:"initError",from:["initialising"],to:"error"},{name:"tokenRejected",from:["initialising","updating"],to:"rejected"},{name:"protocolError",from:["initialising","connected","updating"],to:"error"},{name:"receiveClose",from:["initialising","connected","updating"],to:"waitSocketClosed"},{name:"receiveOffload",from:["initialising","connected","updating"],to:"waitOffloadSocketClosed"},{name:"unsupportedProtocol",from:["initialising","connected","updating"],to:"unsupported"},{name:"receiveFatalClose",from:["initialising","connected","updating"],to:"unsupported"},{name:"userUpdateToken",from:["disconnected","rejected","connecting","retrying"],to:"connecting"},{name:"userUpdateToken",from:["connected"],to:"updating"},{name:"updateSuccess",from:["updating"],to:"connected"},{name:"updateError",from:["updating"],to:"error"},{name:"userSend",from:["connected"],to:"connected"},{name:"systemOnline",from:["retrying"],to:"connecting"}],methods:{onConnecting:function(){o.setupSocket(),o.emit("connecting")},onEnterInitialising:function(){o.sendInit()},onLeaveInitialising:function(){o.cancelInit()},onEnterUpdating:function(){o.sendUpdate()},onLeaveUpdating:function(){o.cancelUpdate()},onEnterRetrying:function(){o.initRetry(),o.emit("connecting")},onEnterConnected:function(){o.resetBackoff(),o.onConnected()},onUserUpdateToken:function(){o.resetBackoff()},onTokenRejected:function(){o.resetBackoff(),o.closeSocket(!0),o.finalizeSocket()},onUserDisconnect:function(){o.closeSocket(!0)},onEnterDisconnecting:function(){o.startDisconnectTimer()},onLeaveDisconnecting:function(){o.cancelDisconnectTimer()},onEnterWaitSocketClosed:function(){o.startDisconnectTimer()},onLeaveWaitSocketClosed:function(){o.cancelDisconnectTimer()},onEnterWaitOffloadSocketClosed:function(){o.startDisconnectTimer()},onLeaveWaitOffloadSocketClosed:function(){o.cancelDisconnectTimer()},onDisconnected:function(){o.resetBackoff(),o.finalizeSocket()},onReceiveClose:function(){o.onCloseReceived()},onReceiveOffload:function(e,t){Q.debug("onreceiveoffload: ",t),o.modifyBackoff(t.body),o.onCloseReceived()},onUnsupported:function(){o.closeSocket(!0),o.finalizeSocket()},onError:function(e,t){o.closeSocket(t),o.finalizeSocket()},onEnterState:function(e){"none"!==e.from&&o.changeState(e)},onInvalidTransition:function(e,t,n){Q.warn("FSM: unexpected transition",t,n)}}});return o.fsm=new s,o}return E.default(i,[{key:"changeState",value:function(e){Q.debug("FSM: ".concat(e.transition,": ").concat(e.from," --\x3e ").concat(e.to)),this.lastEmittedState!==this.state&&(this.lastEmittedState=this.state,this.emit("stateChanged",this.state))}},{key:"resetBackoff",value:function(){Q.trace("resetBackoff"),this.retrier.stop()}},{key:"modifyBackoff",value:function(e){Q.trace("modifyBackoff",e);var t=e?e.backoff_policy:null;t&&"number"==typeof t.reconnect_min_ms&&this.retrier.modifyBackoff(t.reconnect_min_ms)}},{key:"startDisconnectTimer",value:function(){var e=this;Q.trace("startDisconnectTimer"),this.disconnectingTimer&&(clearTimeout(this.disconnectingTimer),this.disconnectingTimer=null),this.disconnectingTimer=setTimeout((function(){Q.debug("disconnecting is timed out"),e.closeSocket(!0)}),3e3)}},{key:"cancelDisconnectTimer",value:function(){Q.trace("cancelDisconnectTimer"),this.disconnectingTimer&&(clearTimeout(this.disconnectingTimer),this.disconnectingTimer=null)}},{key:"isConnected",get:function(){return"connected"===this.state&&this.websocket.isConnected}},{key:"state",get:function(){switch(this.fsm.state){case"connecting":case"initialising":case"retrying":case"error":return"connecting";case"updating":case"connected":return"connected";case"rejected":return"denied";case"disconnecting":case"waitSocketClosed":case"waitOffloadSocketClosed":return"disconnecting";default:return"disconnected"}}},{key:"initRetry",value:function(){Q.debug("initRetry"),this.retrier.inProgress?this.retrier.attemptFailed():this.retrier.start()}},{key:"retry",value:function(){"connecting"!=this.fsm.state?(Q.trace("retry"),this.websocket.close(),this.fsm.userRetry()):Q.trace("can\t retry as already connecting")}},{key:"onConnected",value:function(){this.emit("connected")}},{key:"finalizeSocket",value:function(){Q.trace("finalizeSocket"),this.websocket.close(),this.emit("disconnected"),this.disconnectedPromiseResolve&&(this.disconnectedPromiseResolve(),this.disconnectedPromiseResolve=null)}},{key:"setupSocket",value:function(){Q.trace("setupSocket:",this.config.token),this.emit("beforeConnect"),this.websocket.connect()}},{key:"onIncomingMessage",value:function(e){var t=ke.parse(e);if(t){var n=t.method,r=t.header,i=t.payload;if("reply"!==n&&this.confirmReceiving(r),"notification"===n)this.emit("message",r.message_type,i);else if("reply"===r.method)this.transport.processReply({id:r.id,status:r.status,header:r,body:i});else if("client_update"===r.method)"token_about_to_expire"===r.client_update_type&&this.emit("tokenAboutToExpire");else if("close"===r.method)if(308===r.status.code)Q.debug("Connection has been offloaded"),this.fsm.receiveOffload({status:r.status.status,body:i});else if(406===r.status.code){var o="Server closed connection because can't parse protocol: ".concat(JSON.stringify(r.status));this.emitReplyConnectionError(o,r,!0),Q.error(o),this.fsm.receiveFatalClose()}else 417===r.status.code?(Q.error("Server closed connection because can't parse client reply: ".concat(JSON.stringify(r.status))),this.fsm.receiveFatalClose(r.status.status)):410===r.status.code?(Q.warn("Server closed connection: ".concat(JSON.stringify(r.status))),this.fsm.receiveClose(r.status.status),this.emit("tokenExpired")):401===r.status.code?(Q.error("Server closed connection: ".concat(JSON.stringify(r.status))),this.fsm.receiveClose(r.status.status)):(Q.warn("unexpected message: ",r.status),this.fsm.receiveOffload({status:r.status.status,body:null}))}}},{key:"sendInit",value:(n=S.default(N.default.mark((function e(){var t,n;return N.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Q.trace("sendInit"),e.prev=1,this.emit("beforeSendInit"),e.next=5,this.transport.sendInit();case 5:t=e.sent,this.config.updateContinuationToken(t.continuationToken),this.config.confirmedCapabilities=t.confirmedCapabilities,this.fsm.initSuccess(t),this.emit("initialized",t),this.emit("tokenUpdated"),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),e.t0 instanceof Te?(n=!1,Q.warn("Init rejected by server: ".concat(JSON.stringify(e.t0.reply.status))),this.emit("sendInitFailed"),401===e.t0.reply.status.code||403===e.t0.reply.status.code?(n=!0,this.fsm.tokenRejected(e.t0.reply.status),e.t0.reply.status.errorCode===this.tokenExpiredSasCode&&this.emit("tokenExpired")):429===e.t0.reply.status.code?(this.modifyBackoff(e.t0.reply.body),this.fsm.initError(!0)):500===e.t0.reply.status.code?this.fsm.initError(!1):this.fsm.initError(!0),this.emitReplyConnectionError(e.t0.message,e.t0.reply,n)):(this.terminationReason=e.t0.message,this.emit("connectionError",{terminal:!0,message:"Unknown error during connection initialisation: ".concat(e.t0.message,"\n").concat(JSON.stringify(e.t0,null,2)),httpStatusCode:null,errorCode:null}),this.fsm.initError(!0)),this.emit("tokenUpdated",e.t0);case 17:case"end":return e.stop()}}),e,this,[[1,13]])}))),function(){return n.apply(this,arguments)})},{key:"sendUpdate",value:(t=S.default(N.default.mark((function e(){var t,n,r;return N.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Q.trace("sendUpdate"),t=new ue(this.config.token),e.prev=2,e.next=5,this.transport.sendWithReply(t);case 5:n=e.sent,this.fsm.updateSuccess(n.body),this.emit("tokenUpdated"),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(2),e.t0 instanceof Te?(r=!1,Q.warn("Token update rejected by server: ".concat(JSON.stringify(e.t0.reply.status))),401===e.t0.reply.status.code||403===e.t0.reply.status.code?(r=!0,this.fsm.tokenRejected(e.t0.reply.status),e.t0.reply.status.errorCode===this.tokenExpiredSasCode&&this.emit("tokenExpired")):429===e.t0.reply.status.code?(this.modifyBackoff(e.t0.reply.body),this.fsm.updateError(e.t0.reply.status)):this.fsm.updateError(e.t0.reply.status),this.emitReplyConnectionError(e.t0.message,e.t0.reply,r)):(this.emit("error",!1,e.t0.message,null,null),this.fsm.updateError(e.t0)),this.emit("tokenUpdated",e.t0);case 14:case"end":return e.stop()}}),e,this,[[2,10]])}))),function(){return t.apply(this,arguments)})},{key:"emitReplyConnectionError",value:function(e,t,n){var r=t.status&&t.status.description?t.status.description:e,i=t.status.code,o=t.status&&t.status.errorCode?t.status.errorCode:null;n&&(this.terminationReason=r),this.emit("connectionError",{terminal:n,message:"Connection error: ".concat(r),httpStatusCode:i,errorCode:o})}},{key:"cancelInit",value:function(){Q.trace("cancelInit")}},{key:"cancelUpdate",value:function(){Q.trace("cancelUpdate")}},{key:"confirmReceiving",value:function(e){Q.trace("confirmReceiving");try{this.transport.send(new fe(e.id))}catch(e){Q.debug("failed to confirm packet receiving",e)}}},{key:"closeSocket",value:function(e){var t=this;Q.trace("closeSocket (graceful: ".concat(e,")")),e&&this.transport.isConnected&&this.transport.sendClose(),this.websocket.close(),setTimeout((function(){return t.fsm.socketClosed()}),0)}},{key:"connect",value:function(){Q.trace("connect"),this.fsm.userConnect()}},{key:"disconnect",value:function(){var e=this;return Q.trace("disconnect"),this.fsm.is("disconnected")?Promise.resolve():new Promise((function(t){e.disconnectedPromiseResolve=t,e.fsm.userDisconnect()}))}},{key:"updateToken",value:function(e){var t=this;return Q.trace("updateToken:",e),new Promise((function(e,n){t.once("tokenUpdated",(function(t){t?n(t):e()})),t.fsm.userUpdateToken()}))}},{key:"isTerminalState",get:function(){return-1!==this.terminalStates.indexOf(this.fsm.state)}},{key:"getTerminationReason",get:function(){return this.terminationReason}},{key:"onCloseReceived",value:function(){this.websocket.close()}}]),i}(F),Ne=function(){function e(){A.default(this,e)}return E.default(e,null,[{key:"getMetadata",value:function(e){var t,n,r,i,o,s,a,u,c=e&&e.clientMetadata?e.clientMetadata:{},l={env:null!==(t=B.name)&&void 0!==t?t:"unknown",envv:null!==(n=B.version)&&void 0!==n?n:"unknown",os:null!==(r=null===(i=B.os)||void 0===i?void 0:i.family)&&void 0!==r?r:"unknown",osv:null!==(o=null===(s=B.os)||void 0===s?void 0:s.version)&&void 0!==o?o:"unknown",osa:null!==(a=null===(u=B.os)||void 0===u?void 0:u.architecture)&&void 0!==a?a:"unknown",sdk:"js-default"},d={};return["ver","env","envv","os","osv","osa","type","sdk","sdkv","dev","devv","devt","app","appv"].filter((function(e){return e in c||e in l})).forEach((function(e){return d[e]=e in c?c[e]:l[e]})),d}}]),e}();var Le=function(){function e(t,n){var r=this;A.default(this,e),this.config=n,this.activeRequests=new Map,this.channel=t,this.channel.on("reply",(function(e){return r.processReply(e)})),this.channel.on("disconnected",(function(){r.activeRequests.forEach((function(e){clearTimeout(e.timeout),e.reject(new Se("disconnected"))})),r.activeRequests.clear()}))}var t;return E.default(e,[{key:"isConnected",get:function(){return this.channel.isConnected}},{key:"processReply",value:function(e){var t,n=this.activeRequests.get(e.id);n&&(clearTimeout(n.timeout),this.activeRequests.delete(e.id),(t=e.status.code)>=200&&t<300?n.resolve(e):(n.reject(new Te("Transport failure: "+e.status.status,e)),Q.trace("message rejected")))}},{key:"storeRequest",value:function(e,t,n){var r={resolve:t,reject:n,timeout:setTimeout((function(){Q.trace("request",e,"is timed out"),n(new Se("Twilsock: request timeout: "+e))}),3e4)};this.activeRequests.set(e,r)}},{key:"shutdown",value:function(){this.activeRequests.forEach((function(e){clearTimeout(e.timeout),e.reject(new Se("Twilsock: request cancelled by user"))})),this.activeRequests.clear()}},{key:"sendInit",value:(t=S.default(N.default.mark((function e(){var t,n,r;return N.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Q.trace("sendInit"),t=Ne.getMetadata(this.config),n=new ie(this.config.token,this.config.continuationToken,t,this.config.initRegistrations,this.config.tweaks),e.next=5,this.sendWithReply(n);case 5:return r=e.sent,e.abrupt("return",new se(r.id,r.header.continuation_token,new Set(r.header.capabilities),r.header.continuation_token_status,r.header.offline_storage,r.header.init_registrations,r.header.debug_info));case 7:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"sendClose",value:function(){var e=new he;this.send(e)}},{key:"sendWithReply",value:function(e,t){var n=this;return new Promise((function(r,i){var o=n.send(e,t);n.storeRequest(o,r,i)}))}},{key:"send",value:function(e,t){e.id=e.id||"TM".concat(g.v4());var n=ke.createPacket(e,function(e){switch(L.default(e)){case"undefined":return"";case"object":return JSON.stringify(e);default:return e}}(t));try{return this.channel.send(n),e.id}catch(t){throw Q.debug("failed to send ",e,t),Q.trace(t.stack),t}}}]),e}();function Me(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R.default(e);if(t){var i=R.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return C.default(this,n)}}var je=function(e){I.default(n,e);var t=Me(n);function n(e){var i;return A.default(this,n),i=t.call(this),P.default(T.default(i),"socket",null),i.url=e,i.url=e,i.WebSocket=r.WebSocket||r.MozWebSocket||{},i}return E.default(n,[{key:"isConnected",get:function(){return!!this.socket&&1===this.socket.readyState}},{key:"connect",value:function(){var e,t=this;Q.trace("connecting to socket");try{e=new this.WebSocket(this.url)}catch(e){return Q.debug("Socket error: ".concat(this.url)),void this.emit("socketError",e)}e.binaryType="arraybuffer",e.onopen=function(){Q.debug("socket opened ".concat(t.url)),t.emit("connected")},e.onclose=function(e){Q.debug("socket closed",e),t.emit("disconnected",e)},e.onerror=function(e){Q.debug("Socket error:",e),t.emit("socketError",e)},e.onmessage=function(e){t.emit("message",e.data)},this.socket=e}},{key:"send",value:function(e){return this.socket&&this.socket.send(e)}},{key:"close",value:function(){if(Q.trace("closing socket"),this.socket){this.socket.onopen=null,this.socket.onclose=null,this.socket.onerror=null,this.socket.onmessage=null;try{this.socket.close()}finally{}}}}]),n}(F);function De(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R.default(e);if(t){var i=R.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return C.default(this,n)}}var Be=function(e){I.default(u,e);var t,n,r,i,o,s,a=De(u);function u(e){var t;return A.default(this,u),(t=a.call(this)).transport=e,t.registrations=new Map,t.registrationsInProgress=new Map,t}return E.default(u,[{key:"putNotificationContext",value:(s=S.default(N.default.mark((function e(t,n){var r;return N.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={method:"put_notification_ctx",notification_ctx_id:t},e.next=3,this.transport.sendWithReply(r,n);case 3:case"end":return e.stop()}}),e,this)}))),function(e,t){return s.apply(this,arguments)})},{key:"deleteNotificationContext",value:(o=S.default(N.default.mark((function e(t){var n;return N.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={method:"delete_notification_ctx",notification_ctx_id:t},e.next=3,this.transport.sendWithReply(n);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"updateRegistration",value:(i=S.default(N.default.mark((function e(t,n){var r,i;return N.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Q.debug("update registration for context",t),(r=this.registrationsInProgress.get(t))||(r=new Set,this.registrationsInProgress.set(t,r)),i=g.v4(),r.add(i),e.prev=5,e.next=8,this.putNotificationContext(t,n);case 8:Q.debug("registration attempt succeeded for context",n),r.delete(i),0===r.size&&(this.registrationsInProgress.delete(t),this.emit("registered",t)),e.next=19;break;case 13:e.prev=13,e.t0=e.catch(5),Q.warn("registration attempt failed for context",n),Q.debug(e.t0),r.delete(i),0===r.size&&(this.registrationsInProgress.delete(t),this.emit("registrationFailed",t,e.t0));case 19:case"end":return e.stop()}}),e,this,[[5,13]])}))),function(e,t){return i.apply(this,arguments)})},{key:"updateRegistrations",value:(r=S.default(N.default.mark((function e(){var t,n=this;return N.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Q.trace("refreshing ".concat(this.registrations.size," registrations")),t=[],this.registrations.forEach((function(e,r){t.push(n.updateRegistration(r,e))})),e.next=5,Promise.all(t);case 5:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"setNotificationsContext",value:(n=S.default(N.default.mark((function e(t,n){return N.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&n){e.next=2;break}throw new Se("Invalid arguments provided");case 2:return this.registrations.set(t,n),e.next=5,this.updateRegistration(t,n);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"removeNotificationsContext",value:(t=S.default(N.default.mark((function e(t){return N.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.registrations.has(t)){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.deleteNotificationContext(t);case 4:this.transport.isConnected&&this.registrations.delete(t);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),u}(F);function Ue(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R.default(e);if(t){var i=R.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return C.default(this,n)}}var Fe=function(e){I.default(n,e);var t=Ue(n);function n(e,r,i){var o;return A.default(this,n),(o=t.call(this,r)).status=e,o.description=r,o.body=i,o}return n}(Se);function He(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R.default(e);if(t){var i=R.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return C.default(this,n)}}var Ge=function(e){I.default(n,e);var t=He(n);function n(e){return A.default(this,n),t.call(this,e)}return n}(Se);function We(e,t){var n=function(e){var t=e.match(/^(https?\:)\/\/(([^:\/?#]*)(?:\:([0-9]+))?)(\/[^?#]*)(\?[^#]*|)(#.*|)$/);if(t){var n={protocol:t[1],host:t[2],hostname:t[3],port:t[4],pathname:t[5],search:t[6],hash:t[7],params:{}};if(n.search.length>0){var r=n.search.substring(1);n.params=r.split("&").map((function(e){return e.split("=")})).reduce((function(e,t){return e.hasOwnProperty(t[0])?Array.isArray(e[t[0]])?e[t[0]].push(t[1]):e[t[0]]=[e[t[0]],t[1]]:e[t[0]]=t[1],e}),{})}return n}throw new Se("Incorrect URI: "+e)}(t),r={method:e,host:n.host,path:n.pathname};return n.params&&(r.params=n.params),r}function qe(e,t,n,r,i){return{to:We(e,t),headers:n,body:r,grant:i}}var Ve=function(){function e(t,n,r){A.default(this,e),this.config=r,this.transport=t,this.pendingMessages=[],this.twilsock=n}var t;return E.default(e,[{key:"saveMessage",value:function(e){var t=this;return new Promise((function(n,r){var i={message:e,resolve:n,reject:r,alreadyRejected:!1,timeout:setTimeout((function(){Q.debug("request is timed out"),r(new Se("request '".concat(e.to.method,"' to '").concat(e.to.host,"' timed out"))),i.alreadyRejected=!0}),2e4)};t.pendingMessages.push(i)}))}},{key:"sendPendingMessages",value:function(){for(var e=this,t=function(){var t=e.pendingMessages[0];if(!t.alreadyRejected)try{var n=t.message;e.actualSend(n).then((function(e){return t.resolve(e)})).catch((function(e){return t.reject(e)})),clearTimeout(t.timeout)}catch(e){return Q.debug("Failed to send pending message",e),"break"}e.pendingMessages.splice(0,1)};this.pendingMessages.length>0;){if("break"===t())break}}},{key:"rejectPendingMessages",value:function(){var e=this;this.pendingMessages.forEach((function(t){t.reject(new Ge("Unable to connect: "+e.twilsock.getTerminationReason)),t.alreadyRejected=!0,clearTimeout(t.timeout)})),this.pendingMessages.splice(0,this.pendingMessages.length)}},{key:"actualSend",value:(t=S.default(N.default.mark((function e(t){var n,r,i,o,s,a,u,c;return N.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.to,i=t.headers,o=t.body,s=null!==(n=t.grant)&&void 0!==n?n:this.config.activeGrant,a={host:r.host,path:r.path,method:r.method,params:r.params,headers:i},u=new le(s,i["Content-Type"]||"application/json",a),Q.trace("Sending upstream message",u),e.next=9,this.transport.sendWithReply(u,o);case 9:if(c=e.sent,Q.trace("Received upstream message response",c),!((d=c)&&d.header&&d.header.http_status)||(l=c.header.http_status.code)>=200&&l<300){e.next=13;break}throw new Fe(c.header.http_status.code,c.header.http_status.status,c.body);case 13:return e.abrupt("return",{status:c.header.http_status,headers:c.header.http_headers,body:c.body});case 14:case"end":return e.stop()}var l,d}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"send",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;if(this.twilsock.isTerminalState)return Promise.reject(new Ge("Unable to connect: "+this.twilsock.getTerminationReason));var o=qe(e,t,n,r,i);return this.twilsock.isConnected?this.actualSend(o):this.saveMessage(o)}}]),e}(),ze=function(){function e(){var t=this;A.default(this,e),this._promise=new Promise((function(e,n){t._resolve=e,t._reject=n}))}return E.default(e,[{key:"promise",get:function(){return this._promise}},{key:"update",value:function(e){this._resolve(e)}},{key:"set",value:function(e){this._resolve(e)}},{key:"fail",value:function(e){this._reject(e)}}]),e}(),Ye=function(){function e(t){A.default(this,e),this.id=t}return E.default(e,null,[{key:"create",value:function(t){if(t instanceof Object&&"storage_id"in t)return new e(t.storage_id);throw new Se('Field "storage_id" is missing')}}]),e}(),Ke=function(){function e(){return A.default(this,e),P.default(this,"initializedFlag","twilio_twilsock_token_storage"),P.default(this,"tokenStoragePrefix","twilio_continuation_token_"),e._instance||(this.initialize(),e._instance=this),e._instance}return E.default(e,[{key:"sessionStorage",value:function(){try{return r.sessionStorage}catch(e){return null}}},{key:"window",value:function(){try{return r.window}catch(e){return null}}},{key:"storeToken",value:function(e,t){this.canStore()&&this.sessionStorage.setItem(this.getKeyName(t),e)}},{key:"getStoredToken",value:function(e){return this.canStore()?this.sessionStorage.getItem(this.getKeyName(e)):null}},{key:"initialize",value:function(){var e=this;if(this.canStore()){this.sessionStorage.getItem(this.initializedFlag)&&this.clear(),this.sessionStorage.setItem(this.initializedFlag,"true");var t=this.sessionStorage.removeItem;this.window.addEventListener("unload",(function(){t(e.initializedFlag)}))}}},{key:"clear",value:function(){if(this.canStore()){for(var e=[],t=0;t<this.sessionStorage.length;t++){var n=this.sessionStorage.key(t);n&&0===n.indexOf(this.tokenStoragePrefix)&&e.push(n)}var r=this.sessionStorage.removeItem;e.forEach((function(e){return r(e)})),r(this.initializedFlag)}}},{key:"getKeyName",value:function(e){return"".concat(this.tokenStoragePrefix).concat(e)}},{key:"canStore",value:function(){return!!(this.sessionStorage&&this.sessionStorage.length&&this.window)}}]),e}();P.default(Ke,"_instance",null);var $e,Xe,Je=new Ke,Ze=function(){function e(t,n,r,i,o,s){A.default(this,e),this.title=t,this.details=n,this.start=r,this.type=o,this.id=s,this.end=i}return E.default(e,[{key:"toTelemetryEvent",value:function(){var e=new Date,t=this.start,n=this.end?this.end:e;if(n<t){var r=n;n=t,t=r}var i=t.getTime()-e.getTime(),o=n.getTime()-e.getTime();return new ve(i,o,this.title,this.details,this.id,this.type)}}]),e}();t.TelemetryPoint=void 0,($e=t.TelemetryPoint||(t.TelemetryPoint={}))[$e.Start=0]="Start",$e[$e.End=1]="End",t.EventSendingLimitation=void 0,(Xe=t.EventSendingLimitation||(t.EventSendingLimitation={}))[Xe.MinEventsPortion=0]="MinEventsPortion",Xe[Xe.AnyEvents=1]="AnyEvents",Xe[Xe.AnyEventsIncludingUnfinished=2]="AnyEventsIncludingUnfinished";var Qe=function(){function e(t,n){A.default(this,e),P.default(this,"minEventsPortionToSend",50),P.default(this,"maxEventsPortionToSend",100),P.default(this,"pendingEvents",new Map),P.default(this,"readyEvents",[]),P.default(this,"hasInitializationFinished",!1),P.default(this,"_canSendTelemetry",!1),this.config=t,this.packetInterface=n}return E.default(e,[{key:"isTelemetryEnabled",get:function(){return this.config.confirmedCapabilities.has("telemetry.v1")}},{key:"canSendTelemetry",get:function(){return this._canSendTelemetry&&this.isTelemetryEnabled},set:function(e){Q.debug("TelemetryTracker.canSendTelemetry: ".concat(e," TelemetryTracker.isTelemetryEnabled: ").concat(this.isTelemetryEnabled)),this._canSendTelemetry&&!e&&(this.pendingEvents.clear(),this.readyEvents=[]),this._canSendTelemetry=e,e&&this.sendTelemetry(t.EventSendingLimitation.AnyEvents),e&&!this.hasInitializationFinished&&(this.hasInitializationFinished=!0)}},{key:"addTelemetryEvent",value:function(e){!this.canSendTelemetry&&this.hasInitializationFinished||this.readyEvents.push(e)}},{key:"addPartialEvent",value:function(e,n,r){Q.debug("Adding ".concat(r===t.TelemetryPoint.Start?"starting":"ending"," timepoint for '").concat(n,"' event"));var i=this.pendingEvents.has(n);if(r===t.TelemetryPoint.Start)i&&Q.debug("Overwriting starting point for '".concat(n,"' event")),this.pendingEvents.set(n,e);else{if(!i)return void Q.info("Could not find started event for '".concat(n,"' event"));this.addTelemetryEvent(this.merge(this.pendingEvents.get(n),e)),this.pendingEvents.delete(n)}}},{key:"getTelemetryToSend",value:function(e){return this.canSendTelemetry&&0!=this.readyEvents.length?e==t.EventSendingLimitation.MinEventsPortion&&this.readyEvents.length<this.minEventsPortionToSend?[]:this.getTelemetryPortion(e==t.EventSendingLimitation.AnyEventsIncludingUnfinished):[]}},{key:"getTelemetryPortion",value:function(e){var t=this,n=Math.min(this.readyEvents.length,this.maxEventsPortionToSend),r=this.readyEvents.splice(0,n);return e&&r.length<this.maxEventsPortionToSend&&this.pendingEvents.forEach((function(e,n){if(!(r.length>=t.maxEventsPortionToSend)){var i=t.pendingEvents.get(n);t.pendingEvents.delete(n),r.push(new Ze("[UNFINISHED] ".concat(i.title),i.details,i.start,null,i.type,i.id))}})),r}},{key:"merge",value:function(e,t){return new Ze(t.title?t.title:e.title,t.details?t.details:e.details,e.start,t.end,t.type?t.type:e.type,t.id?t.id:e.id)}},{key:"sendTelemetryIfMinimalPortionCollected",value:function(){this.sendTelemetry(t.EventSendingLimitation.MinEventsPortion)}},{key:"sendTelemetry",value:function(e){var t=this.getTelemetryToSend(e);if(0!==t.length)try{this.packetInterface.send(new me(t.map((function(e){return e.toTelemetryEvent()}))))}catch(e){Q.debug("Error while sending ".concat(t.length," telemetry events due to ").concat(e,"; they will be resubmitted")),this.readyEvents=this.readyEvents.concat(t)}}}]),e}();function et(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R.default(e);if(t){var i=R.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return C.default(this,n)}}var tt=function e(){A.default(this,e)};P.default(tt,"TWILSOCK_CONNECT","twilsock.sdk.connect"),P.default(tt,"TWILSOCK_INIT","twilsock.sdk.init"),t.TwilsockClient=function(e){I.default(d,e);var n,r,i,o,s,a,u,c,l=et(d);function d(e,n,r){var i;A.default(this,d),i=l.call(this),P.default(T.default(i),"version",ee),P.default(T.default(i),"offlineStorageDeferred",new ze),r.continuationToken=r.continuationToken?r.continuationToken:Je.getStoredToken(n);var o=i.config=new te(e,n,r);Q.setLevel(o.logLevel);var s=new je(o.url),a=new Le(s,o);return i.channel=new Pe(s,a,o),i.registrations=new Be(a),i.upstream=new Ve(a,i.channel,o),i.telemetryTracker=new Qe(o,a),i.channel.on("initialized",(function(){return i.telemetryTracker.canSendTelemetry=!0})),s.on("disconnected",(function(){return i.telemetryTracker.canSendTelemetry=!1})),i.registrations.on("registered",(function(e){return i.emit("registered",e)})),i.channel.on("message",(function(e,t){return setTimeout((function(){return i.emit("message",e,t)}),0)})),i.channel.on("stateChanged",(function(e){return setTimeout((function(){return i.emit("stateChanged",e)}),0)})),i.channel.on("connectionError",(function(e){return setTimeout((function(){return i.emit("connectionError",e)}),0)})),i.channel.on("tokenAboutToExpire",(function(){return setTimeout((function(){return i.emit("tokenAboutToExpire")}),0)})),i.channel.on("tokenExpired",(function(){return setTimeout((function(){return i.emit("tokenExpired")}),0)})),i.channel.on("connected",(function(){return i.registrations.updateRegistrations()})),i.channel.on("connected",(function(){return i.upstream.sendPendingMessages()})),i.channel.on("connected",(function(){return setTimeout((function(){return i.emit("connected")}),0)})),i.channel.on("beforeConnect",(function(){return i.telemetryTracker.addPartialEvent(new Ze("Establish WebSocket connection","",new Date),tt.TWILSOCK_CONNECT,t.TelemetryPoint.Start)})),i.channel.on("connected",(function(){return i.telemetryTracker.addPartialEvent(new Ze("Establish WebSocket connection","",new Date,new Date),tt.TWILSOCK_CONNECT,t.TelemetryPoint.End)})),i.channel.on("beforeSendInit",(function(){return i.telemetryTracker.addPartialEvent(new Ze("Send Twilsock init","",new Date),tt.TWILSOCK_INIT,t.TelemetryPoint.Start)})),i.channel.on("initialized",(function(){return i.telemetryTracker.addPartialEvent(new Ze("Send Twilsock init","Succeeded",new Date,new Date),tt.TWILSOCK_INIT,t.TelemetryPoint.End)})),i.channel.on("sendInitFailed",(function(){return i.telemetryTracker.addPartialEvent(new Ze("Send Twilsock init","Failed",new Date,new Date),tt.TWILSOCK_INIT,t.TelemetryPoint.End)})),i.channel.on("initialized",(function(e){i.handleStorageId(n,e),Je.storeToken(e.continuationToken,n),setTimeout((function(){return i.emit("initialized",e)}),0)})),i.channel.on("disconnected",(function(){return setTimeout((function(){return i.emit("disconnected")}),0)})),i.channel.on("disconnected",(function(){return i.upstream.rejectPendingMessages()})),i.channel.on("disconnected",(function(){return i.offlineStorageDeferred.fail(new Se("Client disconnected"))})),i.offlineStorageDeferred.promise.catch((function(){})),i}return E.default(d,[{key:"emit",value:function(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return Q.debug("Emitting ".concat(e.toString(),"(").concat(r.map((function(e){return JSON.stringify(e)})).join(", "),")")),(t=O.default(R.default(d.prototype),"emit",this)).call.apply(t,[this,e].concat(r))}},{key:"handleStorageId",value:function(e,t){if(t.offlineStorage)if(t.offlineStorage.hasOwnProperty(e))try{this.offlineStorageDeferred.set(Ye.create(t.offlineStorage[e])),Q.debug("Offline storage for '".concat(e,"' product: ").concat(JSON.stringify(t.offlineStorage[e]),"."))}catch(n){this.offlineStorageDeferred.fail(new Se("Failed to parse offline storage for ".concat(e," ").concat(JSON.stringify(t.offlineStorage[e]),". ").concat(n,".")))}else this.offlineStorageDeferred.fail(new Se("No offline storage id for '".concat(e,"' product: ").concat(JSON.stringify(t.offlineStorage))));else this.offlineStorageDeferred.fail(new Se("No offline storage id"))}},{key:"storageId",value:function(){return this.offlineStorageDeferred.promise}},{key:"isConnected",get:function(){return this.channel.isConnected}},{key:"state",get:function(){return this.channel.state}},{key:"updateToken",value:(c=S.default(N.default.mark((function e(t){return N.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Q.trace("updating token '".concat(t,"'")),this.config.token!==t){e.next=3;break}return e.abrupt("return");case 3:return this.config.updateToken(t),e.next=6,this.channel.updateToken(t);case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"setNotificationsContext",value:(u=S.default(N.default.mark((function e(t,n){return N.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.registrations.setNotificationsContext(t,n);case 2:case"end":return e.stop()}}),e,this)}))),function(e,t){return u.apply(this,arguments)})},{key:"removeNotificationsContext",value:(a=S.default(N.default.mark((function e(t){return N.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.registrations.removeNotificationsContext(t);case 2:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"connect",value:function(){return this.channel.connect()}},{key:"disconnect",value:(s=S.default(N.default.mark((function e(){return N.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.telemetryTracker.sendTelemetry(t.EventSendingLimitation.AnyEventsIncludingUnfinished),e.next=3,this.channel.disconnect();case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"get",value:(o=S.default(N.default.mark((function e(n,r,i){return N.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.telemetryTracker.sendTelemetry(t.EventSendingLimitation.AnyEvents),e.next=3,this.upstream.send("GET",n,r,void 0,i);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return o.apply(this,arguments)})},{key:"post",value:(i=S.default(N.default.mark((function e(n,r,i,o){return N.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.telemetryTracker.sendTelemetry(t.EventSendingLimitation.AnyEvents),e.next=3,this.upstream.send("POST",n,r,i,o);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r){return i.apply(this,arguments)})},{key:"put",value:(r=S.default(N.default.mark((function e(n,r,i,o){return N.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.telemetryTracker.sendTelemetry(t.EventSendingLimitation.AnyEvents),e.next=3,this.upstream.send("PUT",n,r,i,o);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t,n,i){return r.apply(this,arguments)})},{key:"delete",value:(n=S.default(N.default.mark((function e(n,r,i,o){return N.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.telemetryTracker.sendTelemetry(t.EventSendingLimitation.AnyEvents),e.next=3,this.upstream.send("DELETE",n,r,i,o);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t,r,i){return n.apply(this,arguments)})},{key:"addTelemetryEvent",value:function(e){this.telemetryTracker.addTelemetryEvent(e),this.telemetryTracker.sendTelemetryIfMinimalPortionCollected()}},{key:"addPartialTelemetryEvent",value:function(e,n,r){this.telemetryTracker.addPartialEvent(e,n,r),r===t.TelemetryPoint.End&&this.telemetryTracker.sendTelemetryIfMinimalPortionCollected()}}]),d}(F),t.TwilsockClient=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":L.default(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}([y.validateConstructorTypes(y.nonEmptyString,y.nonEmptyString,[y.pureObject,"undefined",y.literal(null)]),function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":L.default(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}("design:paramtypes",[String,String,Object])],t.TwilsockClient);var nt=function(){function e(t){A.default(this,e),this.product=t,this.type="ers",this.notification_protocol_version=0,this.message_types=[]}return E.default(e,[{key:"populateInitRegistrations",value:function(e){var t=new Set(this.message_types);for(var n in e)t.add(e[n]);this.message_types=Array.from(t)}}]),e}();t.InitRegistration=nt,t.TelemetryEventDescription=Ze,t.TelemetryTracker=Qe,t.TransportUnavailableError=Ge,t.Twilsock=t.TwilsockClient,t.TwilsockError=Se},4755:(e,t,n)=>{var r=n(3663),i=n(3341),o=i;o.v1=r,o.v4=i,e.exports=o},2939:e=>{for(var t=[],n=0;n<256;++n)t[n]=(n+256).toString(16).substr(1);e.exports=function(e,n){var r=n||0,i=t;return[i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]]].join("")}},7366:e=>{var t="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(t){var n=new Uint8Array(16);e.exports=function(){return t(n),n}}else{var r=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),r[t]=e>>>((3&t)<<3)&255;return r}}},3663:(e,t,n)=>{var r,i,o=n(7366),s=n(2939),a=0,u=0;e.exports=function(e,t,n){var c=t&&n||0,l=t||[],d=(e=e||{}).node||r,f=void 0!==e.clockseq?e.clockseq:i;if(null==d||null==f){var p=o();null==d&&(d=r=[1|p[0],p[1],p[2],p[3],p[4],p[5]]),null==f&&(f=i=16383&(p[6]<<8|p[7]))}var h=void 0!==e.msecs?e.msecs:(new Date).getTime(),y=void 0!==e.nsecs?e.nsecs:u+1,v=h-a+(y-u)/1e4;if(v<0&&void 0===e.clockseq&&(f=f+1&16383),(v<0||h>a)&&void 0===e.nsecs&&(y=0),y>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");a=h,u=y,i=f;var m=(1e4*(268435455&(h+=122192928e5))+y)%4294967296;l[c++]=m>>>24&255,l[c++]=m>>>16&255,l[c++]=m>>>8&255,l[c++]=255&m;var g=h/4294967296*1e4&268435455;l[c++]=g>>>8&255,l[c++]=255&g,l[c++]=g>>>24&15|16,l[c++]=g>>>16&255,l[c++]=f>>>8|128,l[c++]=255&f;for(var b=0;b<6;++b)l[c+b]=d[b];return t||s(l)}},3341:(e,t,n)=>{var r=n(7366),i=n(2939);e.exports=function(e,t,n){var o=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var s=(e=e||{}).random||(e.rng||r)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t)for(var a=0;a<16;++a)t[o+a]=s[a];return t||i(s)}},9843:e=>{"use strict";e.exports=JSON.parse('{"name":"axios","version":"0.21.4","description":"Promise based HTTP client for the browser and node.js","main":"index.js","scripts":{"test":"grunt test","start":"node ./sandbox/server.js","build":"NODE_ENV=production grunt build","preversion":"npm test","version":"npm run build && grunt version && git add -A dist && git add CHANGELOG.md bower.json package.json","postversion":"git push && git push --tags","examples":"node ./examples/server.js","coveralls":"cat coverage/lcov.info | ./node_modules/coveralls/bin/coveralls.js","fix":"eslint --fix lib/**/*.js"},"repository":{"type":"git","url":"https://github.com/axios/axios.git"},"keywords":["xhr","http","ajax","promise","node"],"author":"Matt Zabriskie","license":"MIT","bugs":{"url":"https://github.com/axios/axios/issues"},"homepage":"https://axios-http.com","devDependencies":{"coveralls":"^3.0.0","es6-promise":"^4.2.4","grunt":"^1.3.0","grunt-banner":"^0.6.0","grunt-cli":"^1.2.0","grunt-contrib-clean":"^1.1.0","grunt-contrib-watch":"^1.0.0","grunt-eslint":"^23.0.0","grunt-karma":"^4.0.0","grunt-mocha-test":"^0.13.3","grunt-ts":"^6.0.0-beta.19","grunt-webpack":"^4.0.2","istanbul-instrumenter-loader":"^1.0.0","jasmine-core":"^2.4.1","karma":"^6.3.2","karma-chrome-launcher":"^3.1.0","karma-firefox-launcher":"^2.1.0","karma-jasmine":"^1.1.1","karma-jasmine-ajax":"^0.1.13","karma-safari-launcher":"^1.0.0","karma-sauce-launcher":"^4.3.6","karma-sinon":"^1.0.5","karma-sourcemap-loader":"^0.3.8","karma-webpack":"^4.0.2","load-grunt-tasks":"^3.5.2","minimist":"^1.2.0","mocha":"^8.2.1","sinon":"^4.5.0","terser-webpack-plugin":"^4.2.3","typescript":"^4.0.5","url-search-params":"^0.10.0","webpack":"^4.44.2","webpack-dev-server":"^3.11.0"},"browser":{"./lib/adapters/http.js":"./lib/adapters/xhr.js"},"jsdelivr":"dist/axios.min.js","unpkg":"dist/axios.min.js","typings":"./index.d.ts","dependencies":{"follow-redirects":"^1.14.0"},"bundlesize":[{"path":"./dist/axios.min.js","threshold":"5kB"}]}')}},__webpack_module_cache__={},inProgress;function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var n=__webpack_module_cache__[e]={id:e,loaded:!1,exports:{}};return __webpack_modules__[e].call(n.exports,n,n.exports,__webpack_require__),n.loaded=!0,n.exports}__webpack_require__.m=__webpack_modules__,__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=(e,t)=>{for(var n in t)__webpack_require__.o(t,n)&&!__webpack_require__.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},__webpack_require__.f={},__webpack_require__.e=e=>Promise.all(Object.keys(__webpack_require__.f).reduce(((t,n)=>(__webpack_require__.f[n](e,t),t)),[])),__webpack_require__.u=e=>(({531:"elements",680:"form"}[e]||e)+".bundle86.js"),__webpack_require__.miniCssF=e=>{},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),inProgress={},__webpack_require__.l=(e,t,n,r)=>{if(inProgress[e])inProgress[e].push(t);else{var i,o;if(void 0!==n)for(var s=document.getElementsByTagName("script"),a=0;a<s.length;a++){var u=s[a];if(u.getAttribute("src")==e){i=u;break}}i||(o=!0,(i=document.createElement("script")).charset="utf-8",i.timeout=120,__webpack_require__.nc&&i.setAttribute("nonce",__webpack_require__.nc),i.src=e),inProgress[e]=[t];var c=(t,n)=>{i.onerror=i.onload=null,clearTimeout(l);var r=inProgress[e];if(delete inProgress[e],i.parentNode&&i.parentNode.removeChild(i),r&&r.forEach((e=>e(n))),t)return t(n)},l=setTimeout(c.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=c.bind(null,i.onerror),i.onload=c.bind(null,i.onload),o&&document.head.appendChild(i)}},__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),__webpack_require__.p="",(()=>{var e={179:0};__webpack_require__.f.j=(t,n)=>{var r=__webpack_require__.o(e,t)?e[t]:void 0;if(0!==r)if(r)n.push(r[2]);else{var i=new Promise(((n,i)=>r=e[t]=[n,i]));n.push(r[2]=i);var o=__webpack_require__.p+__webpack_require__.u(t),s=new Error;__webpack_require__.l(o,(n=>{if(__webpack_require__.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var i=n&&("load"===n.type?"missing":n.type),o=n&&n.target&&n.target.src;s.message="Loading chunk "+t+" failed.\n("+i+": "+o+")",s.name="ChunkLoadError",s.type=i,s.request=o,r[1](s)}}),"chunk-"+t,t)}};var t=(t,n)=>{var r,i,[o,s,a]=n,u=0;if(o.some((t=>0!==e[t]))){for(r in s)__webpack_require__.o(s,r)&&(__webpack_require__.m[r]=s[r]);if(a)a(__webpack_require__)}for(t&&t(n);u<o.length;u++)i=o[u],__webpack_require__.o(e,i)&&e[i]&&e[i][0](),e[i]=0},n=self.webpackChunk=self.webpackChunk||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var __webpack_exports__={};(()=>{"use strict";var e,t,n,r,i,o=__webpack_require__(3931),s=__webpack_require__(4808);i=__webpack_require__(6956).Z,e=window.shopInSync.market,void 0!==(t=window.shopInSync.env)&&""!=t||(window.shopInSync.env="production"),"production"==t?n=e.split("_")[1]+"-"+e.split("_")[0]:"staging"==t?n="staging":"development"==t&&(n="dev"),window.shopInSync.baseServerUrl="https://"+n+".api.shopinsync.com",(void 0===window.shopInSync.envArgs||void 0===window.shopInSync.envArgs.isVoiceFeatureEnabled)&&(window.shopInSync.envArgs={isVoiceFeatureEnabled:!1}),r=(0,__webpack_require__(8739).Z)(),window.shopInSync.store=r,(0,o.sY)((0,o.h)(s.zt,{store:r},(0,o.h)(i,{deviceType:"web"})),document.getElementById("sis-web-sdk"))})()})();